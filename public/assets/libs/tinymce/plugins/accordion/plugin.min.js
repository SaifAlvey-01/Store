!function(){"use strict";var e,r=tinymce.util.Tools.resolve("tinymce.PluginManager");let i=0,o=e=>r=>typeof r===e,n=e=>"string"===(e=>{var r,i;let d=typeof e;return null===e?"null":"object"===d&&Array.isArray(e)?"array":"object"===d&&((r=String).prototype.isPrototypeOf(e)||(null===(i=e.constructor)||void 0===i?void 0:i.name)===r.name)?"string":d})(e),d=o("boolean"),s=e=>null==e,a=e=>!s(e),m=o("function"),g=o("number"),l=e=>()=>e,c=(e,r)=>e===r,y=l(!1);let u=class u{constructor(e,r){this.tag=e,this.value=r}static some(e){return new u(!0,e)}static none(){return u.singletonNone}fold(e,r){return this.tag?r(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?u.some(e(this.value)):u.none()}bind(e){return this.tag?e(this.value):u.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:u.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return a(e)?u.some(e):u.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};u.singletonNone=new u(!1);let N=Array.prototype.indexOf,p=(e,r)=>N.call(e,r)>-1,h=(e,r)=>{let i=e.length,d=Array(i);for(let m=0;m<i;m++){let i=e[m];d[m]=r(i,m)}return d},f=(e,r)=>{for(let i=0,d=e.length;i<d;i++)r(e[i],i)},T=Object.keys;"undefined"!=typeof window?window:Function("return this;")();let v=e=>e.dom.nodeName.toLowerCase(),w=e=>e.dom.nodeType,b=e=>r=>w(r)===e,A=b(1),C=b(3),P=b(9),L=b(11),S=(e,r,i)=>{if(!(n(i)||d(i)||g(i)))throw console.error("Invalid call to Attribute.set. Key ",r,":: Value ",i,":: Element ",e),Error("Attribute value was not simple");e.setAttribute(r,i+"")},x=(e,r)=>{let i=e.dom.getAttribute(r);return null===i?void 0:i},E=(e,r)=>u.from(x(e,r)),D=(e,r)=>{e.dom.removeAttribute(r)},M=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},B={fromHtml:(e,r)=>{let i=(r||document).createElement("div");if(i.innerHTML=e,!i.hasChildNodes()||i.childNodes.length>1){let r="HTML does not have a single root node";throw console.error(r,e),Error(r)}return M(i.childNodes[0])},fromTag:(e,r)=>{let i=(r||document).createElement(e);return M(i)},fromText:(e,r)=>{let i=(r||document).createTextNode(e);return M(i)},fromDom:M,fromPoint:(e,r,i)=>u.from(e.dom.elementFromPoint(r,i)).map(M)},O=(e,r)=>{let i=e.dom;if(1!==i.nodeType)return!1;if(void 0!==i.matches)return i.matches(r);if(void 0!==i.msMatchesSelector)return i.msMatchesSelector(r);if(void 0!==i.webkitMatchesSelector)return i.webkitMatchesSelector(r);if(void 0!==i.mozMatchesSelector)return i.mozMatchesSelector(r);throw Error("Browser lacks native selectors")},k=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,R=(e=/^\s+|\s+$/g,r=>r.replace(e,"")),$=e=>void 0!==e.style&&m(e.style.getPropertyValue),I=e=>P(e)?e:B.fromDom(e.dom.ownerDocument),V=e=>u.from(e.dom.parentNode).map(B.fromDom),j=e=>u.from(e.dom.nextSibling).map(B.fromDom),q=e=>h(e.dom.childNodes,B.fromDom),F=m(Element.prototype.attachShadow)&&m(Node.prototype.getRootNode)?e=>B.fromDom(e.dom.getRootNode()):I,H=e=>B.fromDom(e.dom.host),z=e=>{let r=C(e)?e.dom.parentNode:e.dom;if(null==r||null===r.ownerDocument)return!1;let i=r.ownerDocument;return(e=>{let r=F(e);return L(r)&&a(r.dom.host)?u.some(r):u.none()})(B.fromDom(r)).fold(()=>i.body.contains(r),e=>z(H(e)))},K=(e,r)=>$(e)?e.style.getPropertyValue(r):"",U=(e,r)=>{V(e).each(i=>{i.dom.insertBefore(r.dom,e.dom)})},Y=(e,r)=>{j(e).fold(()=>{V(e).each(e=>{_(e,r)})},e=>{U(e,r)})},_=(e,r)=>{e.dom.appendChild(r.dom)},G=(e,r)=>{f(r,(i,d)=>{let m=0===d?e:r[d-1];Y(m,i)})},J=(e,r)=>{let i=[];return f(q(e),e=>{r(e)&&(i=i.concat([e])),i=i.concat(J(e,r))}),i},Q=(e,r,i)=>{let d=e.dom,g=m(i)?i:y;for(;d.parentNode;){d=d.parentNode;let e=B.fromDom(d);if(r(e))return u.some(e);if(g(e))break}return u.none()},W=e=>{let r=e.dom;null!==r.parentNode&&r.parentNode.removeChild(r)},X=(e,r,i)=>Q(e,e=>O(e,r),i),Z=(e,r)=>((e,r)=>{let i=void 0===r?document:r.dom;return k(i)?u.none():u.from(i.querySelector(e)).map(B.fromDom)})(r,e),ee=((e,r)=>{let o=r=>e(r)?u.from(r.dom.nodeValue):u.none();return{get:r=>{if(!e(r))throw Error("Can only get text value of a text node");return o(r).getOr("")},getOption:o,set:(r,i)=>{if(!e(r))throw Error("Can only set raw text value of a text node");r.dom.nodeValue=i}}})(C);var et=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];let oe=(e,r)=>({element:e,offset:r}),ne=(e,r,i)=>e.property().isText(r)&&0===e.property().getText(r).trim().length||e.property().isComment(r)?i(r).bind(r=>ne(e,r,i).orThunk(()=>u.some(r))):u.none(),re=(e,r)=>e.property().isText(r)?e.property().getText(r).length:e.property().children(r).length,se=(e,r)=>{let i=ne(e,r,e.query().prevSibling).getOr(r);if(e.property().isText(i))return oe(i,re(e,i));let d=e.property().children(i);return d.length>0?se(e,d[d.length-1]):oe(i,re(e,i))},eo={up:l({selector:X,closest:(e,r,i)=>O(e,r)?u.some(e):m(i)&&i(e)?u.none():X(e,r,i),predicate:Q,all:(e,r)=>{let i=m(r)?r:y,d=e.dom,g=[];for(;null!==d.parentNode&&void 0!==d.parentNode;){let e=d.parentNode,r=B.fromDom(e);if(g.push(r),!0===i(r))break;d=e}return g}}),down:l({selector:(e,r)=>((e,r)=>{let i=void 0===r?document:r.dom;return k(i)?[]:h(i.querySelectorAll(e),B.fromDom)})(r,e),predicate:J}),styles:l({get:(e,r)=>{let i=e.dom,d=window.getComputedStyle(i).getPropertyValue(r);return""!==d||z(e)?d:K(i,r)},getRaw:(e,r)=>{let i=e.dom,d=K(i,r);return u.from(d).filter(e=>e.length>0)},set:(e,r,i)=>{((e,r,i)=>{if(!n(i))throw console.error("Invalid call to CSS.set. Property ",r,":: Value ",i,":: Element ",e),Error("CSS value must be a string: "+i);$(e)&&e.style.setProperty(r,i)})(e.dom,r,i)},remove:(e,r)=>{var i;$(i=e.dom)&&i.style.removeProperty(r),((e,r,i=c)=>e.exists(e=>i(e,"")))(E(e,"style").map(R),0)&&D(e,"style")}}),attrs:l({get:x,set:(e,r,i)=>{S(e.dom,r,i)},remove:D,copyTo:(e,r)=>{var i,d,m;let g=(i=e.dom.attributes,d=(e,r)=>(e[r.name]=r.value,e),m={},f(i,(e,r)=>{m=d(m,e)}),m);((e,r)=>{let i=e.dom;((e,r)=>{let i=T(e);for(let d=0,m=i.length;d<m;d++){let m=i[d];r(e[m],m)}})(r,(e,r)=>{S(i,r,e)})})(r,g)}}),insert:l({before:U,after:Y,afterAll:G,append:_,appendAll:(e,r)=>{f(r,r=>{_(e,r)})},prepend:(e,r)=>{((e,r)=>{let i=e.dom.childNodes;return u.from(i[0]).map(B.fromDom)})(e).fold(()=>{_(e,r)},i=>{e.dom.insertBefore(r.dom,i.dom)})},wrap:(e,r)=>{U(e,r),_(r,e)}}),remove:l({unwrap:e=>{let r=q(e);r.length>0&&G(e,r),W(e)},remove:W}),create:l({nu:B.fromTag,clone:e=>B.fromDom(e.dom.cloneNode(!1)),text:B.fromText}),query:l({comparePosition:(e,r)=>e.dom.compareDocumentPosition(r.dom),prevSibling:e=>u.from(e.dom.previousSibling).map(B.fromDom),nextSibling:j}),property:l({children:q,name:v,parent:V,document:e=>I(e).dom,isText:C,isComment:e=>8===w(e)||"#comment"===v(e),isElement:A,isSpecial:e=>{let r=v(e);return p(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],r)},getLanguage:e=>A(e)?E(e,"lang"):u.none(),getText:e=>ee.get(e),setText:(e,r)=>ee.set(e,r),isBoundary:e=>!!A(e)&&("body"===v(e)||p(et,v(e))),isEmptyTag:e=>!!A(e)&&p(["br","img","hr","input"],v(e)),isNonEditable:e=>A(e)&&"false"===x(e,"contenteditable")}),eq:(e,r)=>e.dom===r.dom,is:O},er="details",en="mce-accordion",el="mce-accordion-summary",ei="mce-accordion-body";var ea=tinymce.util.Tools.resolve("tinymce.util.Tools");let pe=e=>"SUMMARY"===(null==e?void 0:e.nodeName),he=e=>"DETAILS"===(null==e?void 0:e.nodeName),fe=e=>e.hasAttribute("open"),ye=e=>{let r=e.selection.getNode();return pe(r)||!!e.dom.getParent(r,pe)},ve=e=>!ye(e)&&e.dom.isEditable(e.selection.getNode()),we=e=>u.from(e.dom.getParent(e.selection.getNode(),he)),be=e=>(e.innerHTML='<br data-mce-bogus="1" />',e),Ne=e=>be(e.dom.create("p")),Te=e=>r=>{((e,r)=>{if(pe(null==r?void 0:r.lastChild)){let i=Ne(e);r.appendChild(i),e.selection.setCursorLocation(i,0)}})(e,r),((e,r)=>{if(!pe(null==r?void 0:r.firstChild)){let i=be(e.dom.create("summary"));r.prepend(i),e.selection.setCursorLocation(i,0)}})(e,r)},Ae=(e,r)=>{let i=null!=r?r:!fe(e);return i?e.setAttribute("open","open"):e.removeAttribute("open"),i},Ce=e=>{e.addCommand("InsertAccordion",()=>(e=>{if(!ve(e))return;let r=B.fromDom(e.getBody()),d=(e=>{let r=(new Date).getTime();return"acc_"+Math.floor(1e9*Math.random())+ ++i+String(r)})(),m=e.dom.encode(e.selection.getRng().toString()||e.translate("Accordion summary...")),g=e.dom.encode(e.translate("Accordion body...")),y=`<summary class="${el}">${m}</summary>`,N=`<div class="${ei}"><p>${g}</p></div>`;e.undoManager.transact(()=>{e.insertContent([`<details data-mce-id="${d}" class="${en}" open="open">`,y,N,"</details>"].join("")),Z(r,`[data-mce-id="${d}"]`).each(r=>{D(r,"data-mce-id"),Z(r,"summary").each(r=>{let i=e.dom.createRng(),d=se(eo,r);i.setStart(d.element.dom,d.offset),i.setEnd(d.element.dom,d.offset),e.selection.setRng(i)})})})})(e)),e.addCommand("ToggleAccordion",(r,i)=>((e,r)=>{we(e).each(i=>{((e,r,i)=>{e.dispatch("ToggledAccordion",{element:r,state:i})})(e,i,Ae(i,r))})})(e,i)),e.addCommand("ToggleAllAccordions",(r,i)=>((e,r)=>{let i=Array.from(e.getBody().querySelectorAll("details"));0!==i.length&&(f(i,e=>Ae(e,null!=r?r:!fe(e))),((e,r,i)=>{e.dispatch("ToggledAllAccordions",{elements:r,state:i})})(e,i,r))})(e,i)),e.addCommand("RemoveAccordion",()=>(e=>{we(e).each(r=>{let{nextSibling:i}=r;i?(e.selection.select(i,!0),e.selection.collapse(!0)):((e,r)=>{let i=Ne(e);r.insertAdjacentElement("afterend",i),e.selection.setCursorLocation(i,0)})(e,r),r.remove()})})(e))};var ed=tinymce.util.Tools.resolve("tinymce.html.Node");let xe=e=>{var r,i;return null!==(i=null===(r=e.attr("class"))||void 0===r?void 0:r.split(" "))&&void 0!==i?i:[]},Ee=(e,r)=>{let i=new Set([...xe(e),...r]),d=Array.from(i);d.length>0&&e.attr("class",d.join(" "))},De=(e,r)=>{let i=((e,i)=>{let d=[];for(let i=0,m=e.length;i<m;i++){let m=e[i];r.has(m)||d.push(m)}return d})(xe(e));e.attr("class",i.length>0?i.join(" "):null)},Me=e=>e.name===er&&p(xe(e),en),Pe=e=>{let r,i;let d=e.children(),m=[];for(let e=0;e<d.length;e++){let g=d[e];"summary"===g.name&&s(r)?r=g:"div"===g.name&&p(xe(g),ei)&&s(i)?i=g:m.push(g)}return{summaryNode:r,wrapperNode:i,otherNodes:m}},Oe=e=>{let r=new ed("br",1);r.attr("data-mce-bogus","1"),e.empty(),e.append(r)};var es=tinymce.util.Tools.resolve("tinymce.util.VK");let Be=e=>{(e=>{e.on("keydown",r=>{(!r.shiftKey&&r.keyCode===es.ENTER&&ye(e)||(e=>{let r=e.selection.getRng();return he(r.startContainer)&&r.collapsed&&0===r.startOffset})(e))&&(r.preventDefault(),e.execCommand("ToggleAccordion"))})})(e),e.on("ExecCommand",r=>{let i=r.command.toLowerCase();("delete"===i||"forwarddelete"===i)&&we(e).isSome()&&ea.each(ea.grep(e.dom.select("details",e.getBody())),Te(e))})};var em=tinymce.util.Tools.resolve("tinymce.Env");let Le=e=>r=>{let o=()=>r.setEnabled(ve(e));return e.on("NodeChange",o),()=>e.off("NodeChange",o)};r.add("accordion",e=>{(e=>{let t=()=>e.execCommand("InsertAccordion");e.ui.registry.addButton("accordion",{icon:"accordion",tooltip:"Insert accordion",onSetup:Le(e),onAction:t}),e.ui.registry.addMenuItem("accordion",{icon:"accordion",text:"Accordion",onSetup:Le(e),onAction:t}),e.ui.registry.addToggleButton("accordiontoggle",{icon:"accordion-toggle",tooltip:"Toggle accordion",onAction:()=>e.execCommand("ToggleAccordion")}),e.ui.registry.addToggleButton("accordionremove",{icon:"remove",tooltip:"Delete accordion",onAction:()=>e.execCommand("RemoveAccordion")}),e.ui.registry.addContextToolbar("accordion",{predicate:r=>e.dom.is(r,"details")&&e.getBody().contains(r)&&e.dom.isEditable(r.parentNode),items:"accordiontoggle accordionremove",scope:"node",position:"node"})})(e),Ce(e),Be(e),(e=>{e.on("PreInit",()=>{let{serializer:r,parser:i}=e;i.addNodeFilter(er,e=>{for(let r=0;r<e.length;r++){let i=e[r];if(Me(i)){let{summaryNode:e,wrapperNode:r,otherNodes:d}=Pe(i),m=a(e),g=m?e:new ed("summary",1);s(g.firstChild)&&Oe(g),Ee(g,[el]),m||(a(i.firstChild)?i.insert(g,i.firstChild,!0):i.append(g));let y=a(r),N=y?r:new ed("div",1);if(N.attr("data-mce-bogus","1"),Ee(N,[ei]),d.length>0)for(let e=0;e<d.length;e++){let r=d[e];N.append(r)}if(s(N.firstChild)){let e=new ed("p",1);Oe(e),N.append(e)}y||i.append(N)}}}),r.addNodeFilter(er,e=>{let r=new Set([el]);for(let i=0;i<e.length;i++){let d=e[i];if(Me(d)){let{summaryNode:e,wrapperNode:i}=Pe(d);a(e)&&De(e,r),a(i)&&i.unwrap()}}})})})(e),em.browser.isSafari()&&e.on("click",r=>{if(pe(r.target)){let i=r.target,d=e.selection.getRng();d.collapsed&&d.startContainer===i.parentNode&&0===d.startOffset&&e.selection.setCursorLocation(i,0)}})})}();