!function(){"use strict";var e,s=tinymce.util.Tools.resolve("tinymce.PluginManager");let t=e=>s=>(e=>{var s,d;let g=typeof e;return null===e?"null":"object"===g&&Array.isArray(e)?"array":"object"===g&&((s=String).prototype.isPrototypeOf(e)||(null===(d=e.constructor)||void 0===d?void 0:d.name)===s.name)?"string":g})(s)===e,n=e=>s=>typeof s===e,d=t("string"),g=t("object"),f=t("array"),y=n("boolean"),l=e=>null!=e,v=n("function"),F=n("number"),c=()=>{},m=e=>()=>e,u=(e,s)=>e===s,p=e=>s=>!e(s),V=m(!1);let h=class h{constructor(e,s){this.tag=e,this.value=s}static some(e){return new h(!0,e)}static none(){return h.singletonNone}fold(e,s){return this.tag?s(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?h.some(e(this.value)):h.none()}bind(e){return this.tag?e(this.value):h.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:h.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return l(e)?h.some(e):h.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};h.singletonNone=new h(!1);let $=Array.prototype.slice,K=Array.prototype.indexOf,G=Array.prototype.push,C=(e,s)=>K.call(e,s)>-1,b=(e,s)=>{for(let d=0,g=e.length;d<g;d++)if(s(e[d],d))return!0;return!1},N=(e,s)=>{let d=e.length,g=Array(d);for(let f=0;f<d;f++){let d=e[f];g[f]=s(d,f)}return g},S=(e,s)=>{for(let d=0,g=e.length;d<g;d++)s(e[d],d)},L=(e,s)=>{let d=[];for(let g=0,f=e.length;g<f;g++){let f=e[g];s(f,g)&&d.push(f)}return d},O=(e,s,d)=>(S(e,(e,g)=>{d=s(d,e,g)}),d),A=(e,s,d)=>{for(let g=0,f=e.length;g<f;g++){let f=e[g];if(s(f,g))return h.some(f);if(d(f,g))break}return h.none()},T=(e,s)=>A(e,s,V),x=(e,s)=>(e=>{let s=[];for(let d=0,g=e.length;d<g;++d){if(!f(e[d]))throw Error("Arr.flatten item "+d+" was not an array, input: "+e);G.apply(s,e[d])}return s})(N(e,s)),E=e=>{let s=$.call(e,0);return s.reverse(),s},w=(e,s)=>s>=0&&s<e.length?h.some(e[s]):h.none(),k=e=>w(e,0),D=e=>w(e,e.length-1),B=(e,s)=>{let d=[],g=v(s)?e=>b(d,d=>s(d,e)):e=>C(d,e);for(let s=0,f=e.length;s<f;s++){let f=e[s];g(f)||d.push(f)}return d},M=(e,s,d=u)=>e.exists(e=>d(e,s)),P=(e,s,d)=>e.isSome()&&s.isSome()?h.some(d(e.getOrDie(),s.getOrDie())):h.none(),I=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},R=(e,s)=>{let d=(s||document).createElement("div");if(d.innerHTML=e,!d.hasChildNodes()||d.childNodes.length>1){let s="HTML does not have a single root node";throw console.error(s,e),Error(s)}return I(d.childNodes[0])},U=(e,s)=>{let d=(s||document).createElement(e);return I(d)},_=(e,s)=>{let d=e.dom;if(1!==d.nodeType)return!1;if(void 0!==d.matches)return d.matches(s);if(void 0!==d.msMatchesSelector)return d.msMatchesSelector(s);if(void 0!==d.webkitMatchesSelector)return d.webkitMatchesSelector(s);if(void 0!==d.mozMatchesSelector)return d.mozMatchesSelector(s);throw Error("Browser lacks native selectors")},H=(e,s)=>e.dom===s.dom,J="undefined"!=typeof window?window:Function("return this;")(),j=(e,s)=>((e,s)=>{let d=null!=s?s:J;for(let s=0;s<e.length&&null!=d;++s)d=d[e[s]];return d})(e.split("."),s),X=Object.getPrototypeOf,z=e=>{let s=j("ownerDocument.defaultView",e);return g(e)&&(((e,s)=>{let d=j(e,s);if(null==d)throw Error(e+" not available on this browser");return d})("HTMLElement",s).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(X(e).constructor.name))},Q=e=>e.dom.nodeName.toLowerCase(),W=e=>e.dom.nodeType,q=e=>s=>W(s)===e,Z=e=>Y(e)&&z(e.dom),Y=q(1),er=q(3),eo=q(9),el=q(11),ee=e=>s=>Y(s)&&Q(s)===e,te=e=>h.from(e.dom.parentNode).map(I),ne=e=>N(e.dom.childNodes,I),oe=(e,s)=>{let d=e.dom.childNodes;return h.from(d[s]).map(I)},re=e=>oe(e,0),se=e=>oe(e,e.dom.childNodes.length-1),ei=v(Element.prototype.attachShadow)&&v(Node.prototype.getRootNode)?e=>I(e.dom.getRootNode()):e=>eo(e)?e:I(e.dom.ownerDocument),le=e=>I(e.dom.host),ae=e=>{let s=er(e)?e.dom.parentNode:e.dom;if(null==s||null===s.ownerDocument)return!1;let d=s.ownerDocument;return(e=>{let s=ei(e);return el(s)&&l(s.dom.host)?h.some(s):h.none()})(I(s)).fold(()=>d.body.contains(s),e=>ae(le(e)))};var de=(e,s,d,g,f)=>e(d,g)?h.some(d):v(f)&&f(d)?h.none():s(d,g,f);let ce=(e,s,d)=>{let g=e.dom,f=v(d)?d:V;for(;g.parentNode;){g=g.parentNode;let e=I(g);if(s(e))return h.some(e);if(f(e))break}return h.none()},me=(e,s,d)=>de((e,s)=>s(e),ce,e,s,d),ue=(e,s,d)=>ce(e,e=>_(e,s),d),pe=(e,s)=>{te(e).each(d=>{d.dom.insertBefore(s.dom,e.dom)})},ge=(e,s)=>{e.dom.appendChild(s.dom)},he=(e,s)=>{S(s,s=>{ge(e,s)})},fe=e=>{e.dom.textContent="",S(ne(e),e=>{ye(e)})},ye=e=>{let s=e.dom;null!==s.parentNode&&s.parentNode.removeChild(s)};var es=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),ea=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),ed=tinymce.util.Tools.resolve("tinymce.util.VK");let Ne=e=>N(e,I),em=Object.keys,Le=(e,s)=>{let d=em(e);for(let g=0,f=d.length;g<f;g++){let f=d[g];s(e[f],f)}},Oe=(e,s)=>{let g=e.dom;Le(s,(e,s)=>{((e,s,g)=>{if(!(d(g)||y(g)||F(g)))throw console.error("Invalid call to Attribute.set. Key ",s,":: Value ",g,":: Element ",e),Error("Attribute value was not simple");e.setAttribute(s,g+"")})(g,s,e)})},Ae=e=>O(e.dom.attributes,(e,s)=>(e[s.name]=s.value,e),{}),Te=e=>I(e.dom.cloneNode(!0)),xe=(e,s)=>{let d=((e,s)=>{let d=U(s),g=Ae(e);return Oe(d,g),d})(e,s);h.from(e.dom.nextSibling).map(I).fold(()=>{te(e).each(e=>{ge(e,d)})},e=>{pe(e,d)});let g=ne(e);return he(d,g),ye(e),d};var eu=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),ec=tinymce.util.Tools.resolve("tinymce.util.Tools");let ke=e=>s=>l(s)&&s.nodeName.toLowerCase()===e,De=e=>s=>l(s)&&e.test(s.nodeName),Be=e=>l(e)&&3===e.nodeType,Me=e=>l(e)&&1===e.nodeType,eh=De(/^(OL|UL|DL)$/),ep=De(/^(OL|UL)$/),eg=ke("ol"),ef=De(/^(LI|DT|DD)$/),ey=De(/^(DT|DD)$/),ev=De(/^(TH|TD)$/),eb=ke("br"),Fe=(e,s)=>l(s)&&s.nodeName in e.schema.getTextBlockElements(),Ve=(e,s)=>l(e)&&e.nodeName in s,je=(e,s)=>l(s)&&s.nodeName in e.schema.getVoidElements(),Ke=(e,s,d)=>{let g=e.isEmpty(s);return!(d&&e.select("span[data-mce-type=bookmark]",s).length>0)&&g},ze=(e,s)=>e.isChildOf(s,e.getRoot()),Qe=e=>s=>s.options.get(e),eC=Qe("lists_indent_on_tab"),eS=Qe("forced_root_block"),eN=Qe("forced_root_block_attrs"),Ge=(e,s)=>{let d=e.dom,g=e.schema.getBlockElements(),f=d.createFragment(),y=eS(e),v=eN(e),F,V,$=!1;for(V=d.create(y,v),Ve(s.firstChild,g)||f.appendChild(V);F=s.firstChild;){let e=F.nodeName;$||"SPAN"===e&&"bookmark"===F.getAttribute("data-mce-type")||($=!0),Ve(F,g)?(f.appendChild(F),V=null):(V||(V=d.create(y,v),f.appendChild(V)),V.appendChild(F))}return!$&&V&&V.appendChild(d.create("br",{"data-mce-bogus":"1"})),f},eL=eu.DOM,eO=ee("dd"),eT=ee("dt"),et=(e,s)=>{eO(s)?xe(s,"dt"):eT(s)&&h.from(s.dom.parentElement).map(I).each(d=>((e,s,d)=>{let g=eL.select('span[data-mce-type="bookmark"]',s),f=Ge(e,d),y=eL.createRng();y.setStartAfter(d),y.setEndAfter(s);let v=y.extractContents();for(let s=v.firstChild;s;s=s.firstChild)if("LI"===s.nodeName&&e.dom.isEmpty(s)){eL.remove(s);break}e.dom.isEmpty(v)||eL.insertAfter(v,s),eL.insertAfter(f,s);let F=d.parentElement;F&&Ke(e.dom,F)&&(e=>{let s=e.parentNode;s&&ec.each(g,e=>{s.insertBefore(e,d.parentNode)}),eL.remove(e)})(F),eL.remove(d),Ke(e.dom,s)&&eL.remove(s)})(e,d.dom,s.dom))},tt=e=>{eT(e)&&xe(e,"dd")},nt=(e,s)=>{if(Be(e))return{container:e,offset:s};let d=es.getNode(e,s);return Be(d)?{container:d,offset:s>=e.childNodes.length?d.data.length:0}:d.previousSibling&&Be(d.previousSibling)?{container:d.previousSibling,offset:d.previousSibling.data.length}:d.nextSibling&&Be(d.nextSibling)?{container:d.nextSibling,offset:0}:{container:e,offset:s}},ot=e=>{let s=e.cloneRange(),d=nt(e.startContainer,e.startOffset);s.setStart(d.container,d.offset);let g=nt(e.endContainer,e.endOffset);return s.setEnd(g.container,g.offset),s},eA=["OL","UL","DL"],ek=eA.join(","),it=(e,s)=>{let d=s||e.selection.getStart(!0);return e.dom.getParent(d,ek,dt(e,d))},lt=e=>{let s=e.selection.getSelectedBlocks();return L(((e,s)=>{let d=ec.map(s,s=>e.dom.getParent(s,"li,dd,dt",dt(e,s))||s);return B(d)})(e,s),ef)},at=(e,s)=>{let d=e.dom.getParents(s,"TD,TH");return d.length>0?d[0]:e.getBody()},dt=(e,s)=>{let d=e.dom.getParents(s,e.dom.isBlock),g=T(d,s=>{var d;return d=e.schema,!eh(s)&&!ef(s)&&b(eA,e=>d.isValidChild(s.nodeName,e))});return g.getOr(e.getBody())},ct=(e,s)=>{let d=e.dom.getParents(s,"ol,ul",dt(e,s));return D(d)},mt=(e,s)=>{let d=N(s,s=>ct(e,s).getOr(s));return B(d)},ut=e=>/\btox\-/.test(e.className),pt=(e,s)=>A(e,eh,ev).exists(e=>e.nodeName===s&&!ut(e)),gt=(e,s)=>null!==s&&!e.dom.isEditable(s),ht=(e,s)=>{let d=e.dom.getParent(s,"ol,ul,dl");return gt(e,d)},ft=(e,s)=>{let d=e.selection.getNode();return s({parents:e.dom.getParents(d),element:d}),e.on("NodeChange",s),()=>e.off("NodeChange",s)},yt=(e,s)=>{let d=(s||document).createDocumentFragment();return S(e,e=>{d.appendChild(e.dom)}),I(d)},vt=(e,s,d)=>e.dispatch("ListMutation",{action:s,element:d}),eE=(e=/^\s+|\s+$/g,s=>s.replace(e,"")),Nt=(e,s,g)=>{((e,s,g)=>{if(!d(g))throw console.error("Invalid call to CSS.set. Property ",s,":: Value ",g,":: Element ",e),Error("CSS value must be a string: "+g);void 0!==e.style&&v(e.style.getPropertyValue)&&e.style.setProperty(s,g)})(e.dom,s,g)},St=e=>_(e,"OL,UL"),Lt=e=>re(e).exists(St),Ot=e=>"listAttributes"in e,At=e=>"isComment"in e,Tt=e=>e.depth>0,xt=e=>e.isSelected,Et=e=>{let s=ne(e),d=se(e).exists(St)?s.slice(0,-1):s;return N(d,Te)},wt=(e,s)=>{ge(e.item,s.list)},kt=(e,s)=>{let d={list:U(s,e),item:U("li",e)};return ge(d.list,d.item),d},Dt=(e,s,d)=>{let g=s.slice(0,d.depth);return D(g).each(s=>{if(Ot(d)){let g=((e,s,d)=>{let g=U("li",e);return Oe(g,s),he(g,d),g})(e,d.itemAttributes,d.content);ge(s.list,g),s.item=g,Q(s.list)!==d.listType&&(s.list=xe(s.list,d.listType)),Oe(s.list,d.listAttributes)}else if("isFragment"in d)he(s.item,d.content);else{let e=R(`<!--${d.content}-->`);ge(s.list,e)}}),g},Bt=(e,s)=>{let d=h.none(),g=O(s,(s,g,f)=>At(g)?0===f?(d=h.some(g),s):Dt(e,s,g):g.depth>s.length?((e,s,d)=>{let g=((e,s,d)=>{let g=[];for(let f=0;f<d;f++)g.push(kt(e,Ot(s)?s.listType:s.parentListType));return g})(e,d,d.depth-s.length);return(e=>{for(let s=1;s<e.length;s++)wt(e[s-1],e[s])})(g),((e,s)=>{for(let s=0;s<e.length-1;s++)Nt(e[s].item,"list-style-type","none");D(e).each(e=>{Ot(s)&&(Oe(e.list,s.listAttributes),Oe(e.item,s.itemAttributes)),he(e.item,s.content)})})(g,d),P(D(s),k(g),wt),s.concat(g)})(e,s,g):Dt(e,s,g),[]);return d.each(e=>{let s=R(`<!--${e.content}-->`);k(g).each(e=>{((e,s)=>{re(e).fold(()=>{ge(e,s)},d=>{e.dom.insertBefore(s.dom,d.dom)})})(e.list,s)})}),k(g).map(e=>e.list)},Mt=e=>(S(e,(s,d)=>{((e,s)=>{let d=e[s].depth,o=e=>e.depth===d&&!e.dirty,r=e=>e.depth<d;return A(E(e.slice(0,s)),o,r).orThunk(()=>A(e.slice(s+1),o,r))})(e,d).fold(()=>{s.dirty&&Ot(s)&&(s.listAttributes=((e,s)=>{var d;let g={};return d=(e,s)=>{g[s]=e},Le(e,(e,g)=>{(s(e,g)?d:c)(e,g)}),g})(s.listAttributes,(e,s)=>"start"!==s))},e=>{Ot(s)&&Ot(e)&&(s.listType=e.listType,s.listAttributes={...e.listAttributes})})}),e),Pt=(e,s,d,g)=>{var f,y;if(8===W(g)||"#comment"===Q(g))return[{depth:e+1,content:null!==(f=g.dom.nodeValue)&&void 0!==f?f:"",dirty:!1,isSelected:!1,isComment:!0}];s.each(e=>{H(e.start,g)&&d.set(!0)});let v=(y=d.get(),te(g).filter(Y).map(s=>({depth:e,dirty:!1,isSelected:y,content:Et(g),itemAttributes:Ae(g),listAttributes:Ae(s),listType:Q(s),isInPreviousLi:!1})));s.each(e=>{H(e.end,g)&&d.set(!1)});let F=se(g).filter(St).map(g=>Rt(e,s,d,g)).getOr([]);return v.toArray().concat(F)},It=(e,s,d,g)=>re(g).filter(St).fold(()=>Pt(e,s,d,g),f=>{let y=O(ne(g),(g,y,v)=>{if(0===v)return g;if(_(y,"LI"))return g.concat(Pt(e,s,d,y));{let s={isFragment:!0,depth:e,content:[y],isSelected:!1,dirty:!1,parentListType:Q(f)};return g.concat(s)}},[]);return Rt(e,s,d,f).concat(y)}),Rt=(e,s,d,g)=>x(ne(g),g=>(St(g)?Rt:It)(e+1,s,d,g)),Ut=(e,s,d)=>{let g=((e,s)=>{let d;let g=(d=!1,{get:()=>d,set:e=>{d=e}});return N(e,e=>({sourceList:e,entries:Rt(0,s,g,e)}))})(s,(e=>{let s=N(lt(e),I);return P(T(s,p(Lt)),T(E(s),p(Lt)),(e,s)=>({start:e,end:s}))})(e));S(g,s=>{var g;S(L(s.entries,xt),e=>((e,s)=>{switch(e){case"Indent":s.depth++;break;case"Outdent":s.depth--;break;case"Flatten":s.depth=0}s.dirty=!0})(d,e));let f=x(((e,s)=>{if(0===e.length)return[];{let d=s(e[0]),g=[],f=[];for(let y=0,v=e.length;y<v;y++){let v=e[y],F=s(v);F!==d&&(g.push(f),f=[]),d=F,f.push(v)}return 0!==f.length&&g.push(f),g}})(s.entries,Tt),s=>k(s).exists(Tt)?((e,s)=>{let d=Mt(s);return Bt(e.contentDocument,d).toArray()})(e,s):((e,s)=>{let d=Mt(s);return N(d,s=>{let d=At(s)?yt([R(`<!--${s.content}-->`)]):yt(s.content);return I(Ge(e,d.dom))})})(e,s));S(f,s=>{vt(e,"Indent"===d?"IndentList":"OutdentList",s.dom)}),g=s.sourceList,S(f,e=>{pe(g,e)}),ye(s.sourceList)})},$t=(e,s)=>{let d=Ne((e=>{let s=(e=>{let s=ct(e,e.selection.getStart()),d=L(e.selection.getSelectedBlocks(),ep);return s.toArray().concat(d)})(e),d=(e=>{let s=e.selection.getStart();return e.dom.getParents(s,"ol,ul",dt(e,s))})(e);return T(d,e=>te(I(e)).exists(e=>ef(e.dom)&&re(e).exists(e=>!eh(e.dom))&&se(e).exists(e=>!eh(e.dom)))).fold(()=>mt(e,s),e=>[e])})(e)),g=Ne(L(lt(e),ey)),f=!1;if(d.length||g.length){let y=e.selection.getBookmark();Ut(e,d,s),S(g,"Indent"===s?tt:s=>et(e,s)),e.selection.moveToBookmark(y),e.selection.setRng(ot(e.selection.getRng())),e.nodeChanged(),f=!0}return f},_t=(e,s)=>!(e=>{let s=it(e);return gt(e,s)})(e)&&$t(e,s),Ht=e=>_t(e,"Indent"),Ft=e=>_t(e,"Outdent"),Vt=e=>_t(e,"Flatten"),jt=e=>"\uFEFF"===e;var eI=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager");let ex=eu.DOM,Qt=e=>{let s={},n=d=>{let g=e[d?"startContainer":"endContainer"],f=e[d?"startOffset":"endOffset"];if(Me(g)){let e=ex.create("span",{"data-mce-type":"bookmark"});g.hasChildNodes()?(f=Math.min(f,g.childNodes.length-1),d?g.insertBefore(e,g.childNodes[f]):ex.insertAfter(e,g.childNodes[f])):g.appendChild(e),g=e,f=0}s[d?"startContainer":"endContainer"]=g,s[d?"startOffset":"endOffset"]=f};return n(!0),e.collapsed||n(),s},Wt=e=>{let t=s=>{let d=e[s?"startContainer":"endContainer"],g=e[s?"startOffset":"endOffset"];if(d){if(Me(d)&&d.parentNode){let e=d;g=(e=>{var s;let d=null===(s=e.parentNode)||void 0===s?void 0:s.firstChild,g=0;for(;d;){if(d===e)return g;Me(d)&&"bookmark"===d.getAttribute("data-mce-type")||g++,d=d.nextSibling}return -1})(d),d=d.parentNode,ex.remove(e),!d.hasChildNodes()&&ex.isBlock(d)&&d.appendChild(ex.create("br"))}e[s?"startContainer":"endContainer"]=d,e[s?"startOffset":"endOffset"]=g}};t(!0),t();let s=ex.createRng();return s.setStart(e.startContainer,e.startOffset),e.endContainer&&s.setEnd(e.endContainer,e.endOffset),ot(s)},qt=e=>{switch(e){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},Zt=(e,s)=>{ec.each(s,(s,d)=>{e.setAttribute(d,s)})},Gt=(e,s,d)=>{((e,s,d)=>{let g=d["list-style-type"]?d["list-style-type"]:null;e.setStyle(s,"list-style-type",g)})(e,s,d),Zt(s,d["list-attributes"]),ec.each(e.select("li",s),e=>{Zt(e,d["list-item-attributes"])})},Jt=(e,s)=>l(s)&&!Ve(s,e.schema.getBlockElements()),Xt=(e,s,d,g)=>{let f=s[d?"startContainer":"endContainer"],y=s[d?"startOffset":"endOffset"];Me(f)&&(f=f.childNodes[Math.min(y,f.childNodes.length-1)]||f),!d&&eb(f.nextSibling)&&(f=f.nextSibling);let i=(s,d)=>{var f;let y;let v=new ea(s,(s=>{for(;!e.dom.isBlock(s)&&s.parentNode&&g!==s;)s=s.parentNode;return s})(s)),F=d?"next":"prev";for(;y=v[F]();)if(!je(e,y)&&!jt(y.textContent)&&0!==(null===(f=y.textContent)||void 0===f?void 0:f.length))return h.some(y);return h.none()};if(d&&Be(f)){if(jt(f.textContent))f=i(f,!1).getOr(f);else for(null!==f.parentNode&&Jt(e,f.parentNode)&&(f=f.parentNode);null!==f.previousSibling&&(Jt(e,f.previousSibling)||Be(f.previousSibling));)f=f.previousSibling}if(!d&&Be(f)){if(jt(f.textContent))f=i(f,!0).getOr(f);else for(null!==f.parentNode&&Jt(e,f.parentNode)&&(f=f.parentNode);null!==f.nextSibling&&(Jt(e,f.nextSibling)||Be(f.nextSibling));)f=f.nextSibling}for(;f.parentNode!==g;){let s=f.parentNode;if(Fe(e,f)||/^(TD|TH)$/.test(s.nodeName))break;f=s}return f},Yt=(e,s,d)=>{let g=e.selection.getRng(),f="LI",y=dt(e,((e,s)=>{let d=e.selection.getStart(!0),g=Xt(e,s,!0,e.getBody());return ce(I(g),function(e,...s){return(...d)=>{let g=s.concat(d);return e.apply(null,g)}}(H,I(s.commonAncestorContainer)),void 0).isSome()?s.commonAncestorContainer:d})(e,g)),v=e.dom;if("false"===v.getContentEditable(e.selection.getNode()))return;"DL"===(s=s.toUpperCase())&&(f="DT");let F=Qt(g),V=L(((e,s,d)=>{let g;let f=[],y=e.dom,v=Xt(e,s,!0,d),F=Xt(e,s,!1,d),V=[];for(let e=v;e&&(V.push(e),e!==F);e=e.nextSibling);return ec.each(V,s=>{var v;if(Fe(e,s))return f.push(s),void(g=null);if(y.isBlock(s)||eb(s))return eb(s)&&y.remove(s),void(g=null);let F=s.nextSibling;eI.isBookmarkNode(s)&&(eh(F)||Fe(e,F)||!F&&s.parentNode===d)?g=null:(g||(g=y.create("p"),null===(v=s.parentNode)||void 0===v||v.insertBefore(g,s),f.push(g)),g.appendChild(s))}),f})(e,g,y),e.dom.isEditable);ec.each(V,g=>{var y;let F;let V=g.previousSibling,$=g.parentNode;ef($)||(V&&eh(V)&&V.nodeName===s&&((e,s,d)=>{let g=e.getStyle(s,"list-style-type"),f=d?d["list-style-type"]:"";return g===(f=null===f?"":f)})(v,V,d)?(F=V,g=v.rename(g,f),V.appendChild(g)):(F=v.create(s),$.insertBefore(F,g),F.appendChild(g),g=v.rename(g,f)),y=g,ec.each(["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"],e=>v.setStyle(y,e,"")),Gt(v,F,d),tn(e.dom,F))}),e.selection.setRng(Wt(F))},en=(e,s,d)=>eh(s)&&s.nodeName===(null==d?void 0:d.nodeName)&&e.getStyle(s,"list-style-type",!0)===e.getStyle(d,"list-style-type",!0)&&s.className===d.className,tn=(e,s)=>{let d,g=s.nextSibling;if(en(e,s,g)){let f=g;for(;d=f.firstChild;)s.appendChild(d);e.remove(f)}if(g=s.previousSibling,en(e,s,g)){let f=g;for(;d=f.lastChild;)s.insertBefore(d,s.firstChild);e.remove(f)}},nn=(e,s,d,g)=>{if(s.nodeName!==d){let f=e.dom.rename(s,d);Gt(e.dom,f,g),vt(e,qt(d),f)}else Gt(e.dom,s,g),vt(e,qt(d),s)},on=(e,s,d,g)=>{if(s.classList.forEach((e,d,g)=>{e.startsWith("tox-")&&(g.remove(e),0===g.length&&s.removeAttribute("class"))}),s.nodeName!==d){let f=e.dom.rename(s,d);Gt(e.dom,f,g),vt(e,qt(d),f)}else Gt(e.dom,s,g),vt(e,qt(d),s)},rn=e=>"list-style-type"in e,sn=(e,s,d)=>{let f=it(e);if(ht(e,f))return;let y=(e=>{let s=it(e),d=e.selection.getSelectedBlocks();return l(s)&&1===d.length&&d[0]===s?L(s.querySelectorAll(ek),eh):L(d,e=>eh(e)&&s!==e)})(e),v=g(d)?d:{};y.length>0?((e,s,d,g,f)=>{let y=eh(s);if(!y||s.nodeName!==g||rn(f)||ut(s)){Yt(e,g,f);let v=Qt(e.selection.getRng()),F=y?[s,...d]:d,V=y&&ut(s)?on:nn;ec.each(F,s=>{V(e,s,g,f)}),e.selection.setRng(Wt(v))}else Vt(e)})(e,f,y,s,v):((e,s,d,g)=>{if(s!==e.getBody()){if(s){if(s.nodeName!==d||rn(g)||ut(s)){let f=Qt(e.selection.getRng());ut(s)&&s.classList.forEach((e,d,g)=>{e.startsWith("tox-")&&(g.remove(e),0===g.length&&s.removeAttribute("class"))}),Gt(e.dom,s,g);let y=e.dom.rename(s,d);tn(e.dom,y),e.selection.setRng(Wt(f)),Yt(e,d,g),vt(e,qt(d),y)}else Vt(e)}else Yt(e,d,g),vt(e,qt(d),s)}})(e,f,s,v)},eD=eu.DOM,an=(e,s)=>{let d=ec.grep(e.select("ol,ul",s));ec.each(d,s=>{((e,s)=>{let d=s.parentElement;if(d&&"LI"===d.nodeName&&d.firstChild===s){let g=d.previousSibling;g&&"LI"===g.nodeName?(g.appendChild(s),Ke(e,d)&&eD.remove(d)):eD.setStyle(d,"listStyleType","none")}if(eh(d)){let e=d.previousSibling;e&&"LI"===e.nodeName&&e.appendChild(s)}})(e,s)})},dn=(e,s,d,g)=>{var f,y;let v=s.startContainer,F=s.startOffset;if(Be(v)&&(d?F<v.data.length:F>0))return v;let V=e.schema.getNonEmptyElements();Me(v)&&(v=es.getNode(v,F));let $=new ea(v,g);d&&(f=e.dom,eb(y=v)&&f.isBlock(y.nextSibling)&&!eb(y.previousSibling))&&$.next();let K=d?$.next.bind($):$.prev2.bind($);for(;v=K();)if("LI"===v.nodeName&&!v.hasChildNodes()||V[v.nodeName]||Be(v)&&v.data.length>0)return v;return null},cn=(e,s)=>{let d=s.childNodes;return 1===d.length&&!eh(d[0])&&e.isBlock(d[0])},mn=e=>h.from(e).map(I).filter(Z).exists(e=>((e,s=!1)=>ae(e)?e.dom.isContentEditable:de((e,s)=>_(e,s),ue,e,"[contenteditable]",void 0).fold(m(s),e=>"true"===e.dom.contentEditable))(e)&&!C(["details"],Q(e))),un=(e,s,d)=>{let g;let f=cn(e,d)?d.firstChild:d;if(cn(e,s)&&mn(s.firstChild)&&e.remove(s.firstChild,!0),!Ke(e,s,!0))for(;g=s.firstChild;)f.appendChild(g)},pn=(e,s,d)=>{let g;let f=s.parentNode;if(!ze(e,s)||!ze(e,d))return;eh(d.lastChild)&&(g=d.lastChild),f===d.lastChild&&eb(f.previousSibling)&&e.remove(f.previousSibling);let y=d.lastChild;y&&eb(y)&&s.hasChildNodes()&&e.remove(y),Ke(e,d,!0)&&fe(I(d)),un(e,s,d),g&&d.appendChild(g);let v=((e,s)=>{let d=e.dom,g=s.dom;return d!==g&&d.contains(g)})(I(d),I(s))?e.getParents(s,eh,d):[];e.remove(s),S(v,s=>{Ke(e,s)&&s!==e.getRoot()&&e.remove(s)})},gn=(e,s)=>{let d=e.dom,g=e.selection,f=g.getStart(),y=at(e,f),v=d.getParent(g.getStart(),"LI",y);if(v){let f=v.parentElement;if(f===e.getBody()&&Ke(d,f))return!0;let F=ot(g.getRng()),V=d.getParent(dn(e,F,s,y),"LI",y),$=V&&(s?d.isChildOf(v,V):d.isChildOf(V,v));if(V&&V!==v&&!$)return e.undoManager.transact(()=>{var d;s?((e,s,d,g)=>{let f=e.dom;if(f.isEmpty(g))fe(I(g)),pn(e.dom,d,g),e.selection.setCursorLocation(g,0);else{let y=Qt(s);pn(f,d,g),e.selection.setRng(Wt(y))}})(e,F,V,v):(null===(d=v.parentNode)||void 0===d?void 0:d.firstChild)===v?Ft(e):((e,s,d,g)=>{let f=Qt(s);pn(e.dom,d,g);let y=Wt(f);e.selection.setRng(y)})(e,F,v,V)}),!0;if($&&!s&&V!==v)return e.undoManager.transact(()=>{if(F.commonAncestorContainer.parentElement){let s=Qt(F),g=F.commonAncestorContainer.parentElement;un(d,F.commonAncestorContainer.parentElement,V),g.remove();let f=Wt(s);e.selection.setRng(f)}}),!0;if(!V&&!s&&0===F.startOffset&&0===F.endOffset)return e.undoManager.transact(()=>{Vt(e)}),!0}return!1},hn=e=>{let s=e.selection.getStart(),d=at(e,s);return e.dom.getParent(s,"LI,DT,DD",d)||lt(e).length>0},fn=(e,s)=>{let d=e.selection;return!ht(e,d.getNode())&&(d.isCollapsed()?gn(e,s)||((e,s)=>{let d=e.dom,g=e.selection.getStart(),f=at(e,g),y=d.getParent(g,d.isBlock,f);if(y&&d.isEmpty(y)){let g=ot(e.selection.getRng()),v=d.getParent(dn(e,g,s,f),"LI",f);if(v){let l=e=>C(["td","th","caption"],Q(e)),a=e=>e.dom===f;return!!((e,s,d=u)=>P(e,s,d).getOr(e.isNone()&&s.isNone()))(me(I(v),l,a),me(I(g.startContainer),l,a),H)&&(e.undoManager.transact(()=>{let g=v.parentNode;((e,s,d)=>{let g=e.getParent(s.parentNode,e.isBlock,d);e.remove(s),g&&e.isEmpty(g)&&e.remove(g)})(d,y,f),tn(d,g),e.selection.select(v,!0),e.selection.collapse(s)}),!0)}}return!1})(e,s):!!hn(e)&&(e.undoManager.transact(()=>{e.execCommand("Delete"),an(e.dom,e.getBody())}),!0))},yn=e=>{let s=E(eE(e).split("")),d=N(s,(e,s)=>{let d=e.toUpperCase().charCodeAt(0)-65+1;return Math.pow(26,s)*d});return O(d,(e,s)=>e+s,0)},vn=e=>{if(--e<0)return"";{let s=e%26,d=Math.floor(e/26);return vn(d)+String.fromCharCode(65+s)}},Cn=e=>{let s=parseInt(e.start,10);return M(e.listStyleType,"upper-alpha")?vn(s):M(e.listStyleType,"lower-alpha")?vn(s).toLowerCase():e.start},bn=(e,s)=>()=>{let d=it(e);return l(d)&&d.nodeName===s},Nn=e=>{e.addCommand("mceListProps",()=>{(e=>{let s=it(e);eg(s)&&!ht(e,s)&&e.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:Cn({start:e.dom.getAttrib(s,"start","1"),listStyleType:h.from(e.dom.getStyle(s,"list-style-type"))})},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:s=>{(e=>{switch(/^[0-9]+$/.test(e)?2:/^[A-Z]+$/.test(e)?0:/^[a-z]+$/.test(e)?1:e.length>0?4:3){case 2:return h.some({listStyleType:h.none(),start:e});case 0:return h.some({listStyleType:h.some("upper-alpha"),start:yn(e).toString()});case 1:return h.some({listStyleType:h.some("lower-alpha"),start:yn(e).toString()});case 3:return h.some({listStyleType:h.none(),start:""});case 4:return h.none()}})(s.getData().start).each(s=>{e.execCommand("mceListUpdate",!1,{attrs:{start:"1"===s.start?"":s.start},styles:{"list-style-type":s.listStyleType.getOr("")}})}),s.close()}})})(e)})};var eB=tinymce.util.Tools.resolve("tinymce.html.Node");let Ln=e=>3===e.type,On=e=>0===e.length,An=e=>{let t=(s,d)=>{let g=eB.create("li");S(s,e=>g.append(e)),d?e.insert(g,d,!0):e.append(g)},s=O(e.children(),(e,s)=>Ln(s)?[...e,s]:On(e)||Ln(s)?e:(t(e,s),[]),[]);On(s)||t(s)},Tn=(e,s)=>d=>(d.setEnabled(e.selection.isEditable()),ft(e,g=>{d.setActive(pt(g.parents,s)),d.setEnabled(!ht(e,g.element)&&e.selection.isEditable())})),xn=(e,s)=>d=>ft(e,g=>d.setEnabled(pt(g.parents,s)&&!ht(e,g.element)));s.add("lists",e=>((e=>{(0,e.options.register)("lists_indent_on_tab",{processor:"boolean",default:!0})})(e),(e=>{e.on("PreInit",()=>{let{parser:s}=e;s.addNodeFilter("ul,ol",e=>S(e,An))})})(e),e.hasPlugin("rtc",!0)?Nn(e):(eC(e)&&(e=>{e.on("keydown",s=>{s.keyCode!==ed.TAB||ed.metaKeyPressed(s)||e.undoManager.transact(()=>{(s.shiftKey?Ft(e):Ht(e))&&s.preventDefault()})})})(e),e.on("ExecCommand",s=>{let d=s.command.toLowerCase();("delete"===d||"forwarddelete"===d)&&hn(e)&&an(e.dom,e.getBody())}),e.on("keydown",s=>{s.keyCode===ed.BACKSPACE?fn(e,!1)&&s.preventDefault():s.keyCode===ed.DELETE&&fn(e,!0)&&s.preventDefault()}),e.on("BeforeExecCommand",s=>{let d=s.command.toLowerCase();"indent"===d?Ht(e):"outdent"===d&&Ft(e)}),e.addCommand("InsertUnorderedList",(s,d)=>{sn(e,"UL",d)}),e.addCommand("InsertOrderedList",(s,d)=>{sn(e,"OL",d)}),e.addCommand("InsertDefinitionList",(s,d)=>{sn(e,"DL",d)}),e.addCommand("RemoveList",()=>{Vt(e)}),Nn(e),e.addCommand("mceListUpdate",(s,d)=>{g(d)&&((e,s)=>{let d=it(e);null===d||ht(e,d)||e.undoManager.transact(()=>{g(s.styles)&&e.dom.setStyles(d,s.styles),g(s.attrs)&&Le(s.attrs,(s,g)=>e.dom.setAttrib(d,g,s))})})(e,d)}),e.addQueryStateHandler("InsertUnorderedList",bn(e,"UL")),e.addQueryStateHandler("InsertOrderedList",bn(e,"OL")),e.addQueryStateHandler("InsertDefinitionList",bn(e,"DL"))),(e=>{let t=s=>()=>e.execCommand(s);e.hasPlugin("advlist")||(e.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:t("InsertOrderedList"),onSetup:Tn(e,"OL")}),e.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:t("InsertUnorderedList"),onSetup:Tn(e,"UL")}))})(e),(e=>{let s={text:"List properties...",icon:"ordered-list",onAction:()=>e.execCommand("mceListProps"),onSetup:xn(e,"OL")};e.ui.registry.addMenuItem("listprops",s),e.ui.registry.addContextMenu("lists",{update:s=>{let d=it(e,s);return eg(d)?["listprops"]:[]}})})(e),{backspaceDelete:s=>{fn(e,s)}}))}();