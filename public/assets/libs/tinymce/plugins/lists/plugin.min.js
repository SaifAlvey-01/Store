!function(){"use strict";var e,s=tinymce.util.Tools.resolve("tinymce.PluginManager");let t=e=>s=>(e=>{var s,d;let h=typeof e;return null===e?"null":"object"===h&&Array.isArray(e)?"array":"object"===h&&((s=String).prototype.isPrototypeOf(e)||(null===(d=e.constructor)||void 0===d?void 0:d.name)===s.name)?"string":h})(s)===e,n=e=>s=>typeof s===e,d=t("string"),h=t("object"),f=t("array"),y=n("boolean"),l=e=>null!=e,R=n("function"),Y=n("number"),c=()=>{},u=(e,s)=>e===s,m=e=>s=>!e(s),p=()=>!1;let g=class g{constructor(e,s){this.tag=e,this.value=s}static some(e){return new g(!0,e)}static none(){return g.singletonNone}fold(e,s){return this.tag?s(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?g.some(e(this.value)):g.none()}bind(e){return this.tag?e(this.value):g.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:g.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return l(e)?g.some(e):g.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};g.singletonNone=new g(!1);let ee=Array.prototype.slice,et=Array.prototype.indexOf,er=Array.prototype.push,v=(e,s)=>et.call(e,s)>-1,C=(e,s)=>{for(let d=0,h=e.length;d<h;d++)if(s(e[d],d))return!0;return!1},b=(e,s)=>{let d=e.length,h=Array(d);for(let f=0;f<d;f++){let d=e[f];h[f]=s(d,f)}return h},S=(e,s)=>{for(let d=0,h=e.length;d<h;d++)s(e[d],d)},N=(e,s)=>{let d=[];for(let h=0,f=e.length;h<f;h++){let f=e[h];s(f,h)&&d.push(f)}return d},L=(e,s,d)=>(S(e,(e,h)=>{d=s(d,e,h)}),d),O=(e,s,d)=>{for(let h=0,f=e.length;h<f;h++){let f=e[h];if(s(f,h))return g.some(f);if(d(f,h))break}return g.none()},k=(e,s)=>O(e,s,p),A=(e,s)=>(e=>{let s=[];for(let d=0,h=e.length;d<h;++d){if(!f(e[d]))throw Error("Arr.flatten item "+d+" was not an array, input: "+e);er.apply(s,e[d])}return s})(b(e,s)),T=e=>{let s=ee.call(e,0);return s.reverse(),s},x=(e,s)=>s>=0&&s<e.length?g.some(e[s]):g.none(),E=e=>x(e,0),w=e=>x(e,e.length-1),D=(e,s)=>{let d=[],h=R(s)?e=>C(d,d=>s(d,e)):e=>v(d,e);for(let s=0,f=e.length;s<f;s++){let f=e[s];h(f)||d.push(f)}return d},B=(e,s,d=u)=>e.exists(e=>d(e,s)),I=(e,s,d)=>e.isSome()&&s.isSome()?g.some(d(e.getOrDie(),s.getOrDie())):g.none(),P=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},M=(e,s)=>{let d=(s||document).createElement(e);return P(d)},U=(e,s)=>e.dom===s.dom;"undefined"!=typeof window?window:Function("return this;")();let $=e=>e.dom.nodeName.toLowerCase(),_=e=>1===e.dom.nodeType,F=e=>s=>_(s)&&$(s)===e,H=e=>g.from(e.dom.parentNode).map(P),V=e=>b(e.dom.childNodes,P),j=(e,s)=>{let d=e.dom.childNodes;return g.from(d[s]).map(P)},K=e=>j(e,0),z=e=>j(e,e.dom.childNodes.length-1),Q=(e,s,d)=>{let h=e.dom,f=R(d)?d:p;for(;h.parentNode;){h=h.parentNode;let e=P(h);if(s(e))return g.some(e);if(f(e))break}return g.none()},W=(e,s,d)=>s(e)?g.some(e):R(d)&&d(e)?g.none():Q(e,s,d),q=(e,s)=>{H(e).each(d=>{d.dom.insertBefore(s.dom,e.dom)})},Z=(e,s)=>{e.dom.appendChild(s.dom)},G=(e,s)=>{S(s,s=>{Z(e,s)})},J=e=>{e.dom.textContent="",S(V(e),e=>{X(e)})},X=e=>{let s=e.dom;null!==s.parentNode&&s.parentNode.removeChild(s)};var el=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),eo=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),ei=tinymce.util.Tools.resolve("tinymce.util.VK");let ne=e=>b(e,P),es=Object.keys,re=(e,s)=>{let d=es(e);for(let h=0,f=d.length;h<f;h++){let f=d[h];s(e[f],f)}},se=(e,s)=>{let h=e.dom;re(s,(e,s)=>{((e,s,h)=>{if(!(d(h)||y(h)||Y(h)))throw console.error("Invalid call to Attribute.set. Key ",s,":: Value ",h,":: Element ",e),Error("Attribute value was not simple");e.setAttribute(s,h+"")})(h,s,e)})},ie=e=>L(e.dom.attributes,(e,s)=>(e[s.name]=s.value,e),{}),le=e=>P(e.dom.cloneNode(!0)),ae=(e,s)=>{let d=((e,s)=>{let d=M(s),h=ie(e);return se(d,h),d})(e,s);g.from(e.dom.nextSibling).map(P).fold(()=>{H(e).each(e=>{Z(e,d)})},e=>{q(e,d)});let h=V(e);return G(d,h),X(e),d};var ea=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),ed=tinymce.util.Tools.resolve("tinymce.util.Tools");let ue=e=>s=>l(s)&&s.nodeName.toLowerCase()===e,me=e=>s=>l(s)&&e.test(s.nodeName),pe=e=>l(e)&&3===e.nodeType,ge=e=>l(e)&&1===e.nodeType,em=me(/^(OL|UL|DL)$/),eu=me(/^(OL|UL)$/),eg=ue("ol"),ec=me(/^(LI|DT|DD)$/),ep=me(/^(DT|DD)$/),eh=me(/^(TH|TD)$/),ef=ue("br"),Ne=(e,s)=>l(s)&&s.nodeName in e.schema.getTextBlockElements(),Le=(e,s)=>l(e)&&e.nodeName in s,Oe=(e,s)=>l(s)&&s.nodeName in e.schema.getVoidElements(),ke=(e,s,d)=>{let h=e.isEmpty(s);return!(d&&e.select("span[data-mce-type=bookmark]",s).length>0)&&h},Ae=(e,s)=>e.isChildOf(s,e.getRoot()),Te=e=>s=>s.options.get(e),ey=Te("lists_indent_on_tab"),ev=Te("forced_root_block"),eb=Te("forced_root_block_attrs"),De=(e,s)=>{let d=e.dom,h=e.schema.getBlockElements(),f=d.createFragment(),y=ev(e),R=eb(e),Y,ee,et=!1;for(ee=d.create(y,R),Le(s.firstChild,h)||f.appendChild(ee);Y=s.firstChild;){let e=Y.nodeName;et||"SPAN"===e&&"bookmark"===Y.getAttribute("data-mce-type")||(et=!0),Le(Y,h)?(f.appendChild(Y),ee=null):(ee||(ee=d.create(y,R),f.appendChild(ee)),ee.appendChild(Y))}return!et&&ee&&ee.appendChild(d.create("br",{"data-mce-bogus":"1"})),f},eC=ea.DOM,eN=F("dd"),eS=F("dt"),Me=(e,s)=>{eN(s)?ae(s,"dt"):eS(s)&&g.from(s.dom.parentElement).map(P).each(d=>((e,s,d)=>{let h=eC.select('span[data-mce-type="bookmark"]',s),f=De(e,d),y=eC.createRng();y.setStartAfter(d),y.setEndAfter(s);let R=y.extractContents();for(let s=R.firstChild;s;s=s.firstChild)if("LI"===s.nodeName&&e.dom.isEmpty(s)){eC.remove(s);break}e.dom.isEmpty(R)||eC.insertAfter(R,s),eC.insertAfter(f,s);let Y=d.parentElement;Y&&ke(e.dom,Y)&&(e=>{let s=e.parentNode;s&&ed.each(h,e=>{s.insertBefore(e,d.parentNode)}),eC.remove(e)})(Y),eC.remove(d),ke(e.dom,s)&&eC.remove(s)})(e,d.dom,s.dom))},Re=e=>{eS(e)&&ae(e,"dd")},Ue=(e,s)=>{if(pe(e))return{container:e,offset:s};let d=el.getNode(e,s);return pe(d)?{container:d,offset:s>=e.childNodes.length?d.data.length:0}:d.previousSibling&&pe(d.previousSibling)?{container:d.previousSibling,offset:d.previousSibling.data.length}:d.nextSibling&&pe(d.nextSibling)?{container:d.nextSibling,offset:0}:{container:e,offset:s}},$e=e=>{let s=e.cloneRange(),d=Ue(e.startContainer,e.startOffset);s.setStart(d.container,d.offset);let h=Ue(e.endContainer,e.endOffset);return s.setEnd(h.container,h.offset),s},eL=["OL","UL","DL"],eO=eL.join(","),He=(e,s)=>{let d=s||e.selection.getStart(!0);return e.dom.getParent(d,eO,Ke(e,d))},Ve=e=>{let s=e.selection.getSelectedBlocks();return N(((e,s)=>{let d=ed.map(s,s=>e.dom.getParent(s,"li,dd,dt",Ke(e,s))||s);return D(d)})(e,s),ec)},je=(e,s)=>{let d=e.dom.getParents(s,"TD,TH");return d.length>0?d[0]:e.getBody()},Ke=(e,s)=>{let d=e.dom.getParents(s,e.dom.isBlock),h=k(d,s=>{var d;return d=e.schema,!em(s)&&!ec(s)&&C(eL,e=>d.isValidChild(s.nodeName,e))});return h.getOr(e.getBody())},ze=(e,s)=>{let d=e.dom.getParents(s,"ol,ul",Ke(e,s));return w(d)},Qe=(e,s)=>{let d=b(s,s=>ze(e,s).getOr(s));return D(d)},We=e=>/\btox\-/.test(e.className),qe=(e,s)=>O(e,em,eh).exists(e=>e.nodeName===s&&!We(e)),Ze=(e,s)=>null!==s&&!e.dom.isEditable(s),Ge=(e,s)=>{let d=e.dom.getParent(s,"ol,ul,dl");return Ze(e,d)},Je=(e,s)=>{let d=e.selection.getNode();return s({parents:e.dom.getParents(d),element:d}),e.on("NodeChange",s),()=>e.off("NodeChange",s)},Xe=(e,s,d)=>e.dispatch("ListMutation",{action:s,element:d}),ek=(e=/^\s+|\s+$/g,s=>s.replace(e,"")),tt=(e,s,h)=>{((e,s,h)=>{if(!d(h))throw console.error("Invalid call to CSS.set. Property ",s,":: Value ",h,":: Element ",e),Error("CSS value must be a string: "+h);void 0!==e.style&&R(e.style.getPropertyValue)&&e.style.setProperty(s,h)})(e.dom,s,h)},nt=(e,s)=>{Z(e.item,s.list)},ot=(e,s)=>{let d={list:M(s,e),item:M("li",e)};return Z(d.list,d.item),d},rt=e=>((e,s)=>{let d=e.dom;if(1!==d.nodeType)return!1;if(void 0!==d.matches)return d.matches(s);if(void 0!==d.msMatchesSelector)return d.msMatchesSelector(s);if(void 0!==d.webkitMatchesSelector)return d.webkitMatchesSelector(s);if(void 0!==d.mozMatchesSelector)return d.mozMatchesSelector(s);throw Error("Browser lacks native selectors")})(e,"OL,UL"),st=e=>K(e).exists(rt),it=e=>e.depth>0,lt=e=>e.isSelected,at=e=>{let s=V(e),d=z(e).exists(rt)?s.slice(0,-1):s;return b(d,le)},dt=e=>(S(e,(s,d)=>{((e,s)=>{let d=e[s].depth,o=e=>e.depth===d&&!e.dirty,r=e=>e.depth<d;return O(T(e.slice(0,s)),o,r).orThunk(()=>O(e.slice(s+1),o,r))})(e,d).fold(()=>{s.dirty&&(s.listAttributes=((e,s)=>{var d;let h={};return d=(e,s)=>{h[s]=e},re(e,(e,h)=>{(s(e,h)?d:c)(e,h)}),h})(s.listAttributes,(e,s)=>"start"!==s))},e=>(s.listType=e.listType,void(s.listAttributes={...e.listAttributes})))}),e),ct=(e,s,d,h)=>K(h).filter(rt).fold(()=>{var f;s.each(e=>{U(e.start,h)&&d.set(!0)});let y=(f=d.get(),H(h).filter(_).map(s=>({depth:e,dirty:!1,isSelected:f,content:at(h),itemAttributes:ie(h),listAttributes:ie(s),listType:$(s)})));s.each(e=>{U(e.end,h)&&d.set(!1)});let R=z(h).filter(rt).map(h=>ut(e,s,d,h)).getOr([]);return y.toArray().concat(R)},h=>ut(e,s,d,h)),ut=(e,s,d,h)=>A(V(h),h=>(rt(h)?ut:ct)(e+1,s,d,h)),mt=(e,s)=>{let d=dt(s);return((e,s)=>{let d=L(s,(s,d)=>d.depth>s.length?((e,s,d)=>{let h=((e,s,d)=>{let h=[];for(let f=0;f<d;f++)h.push(ot(e,s.listType));return h})(e,d,d.depth-s.length);return(e=>{for(let s=1;s<e.length;s++)nt(e[s-1],e[s])})(h),((e,s)=>{for(let s=0;s<e.length-1;s++)tt(e[s].item,"list-style-type","none");w(e).each(e=>{se(e.list,s.listAttributes),se(e.item,s.itemAttributes),G(e.item,s.content)})})(h,d),I(w(s),E(h),nt),s.concat(h)})(e,s,d):((e,s,d)=>{let h=s.slice(0,d.depth);return w(h).each(s=>{let h=((e,s,d)=>{let h=M("li",e);return se(h,s),G(h,d),h})(e,d.itemAttributes,d.content);Z(s.list,h),s.item=h,$(s.list)!==d.listType&&(s.list=ae(s.list,d.listType)),se(s.list,d.listAttributes)}),h})(e,s,d),[]);return E(d).map(e=>e.list)})(e.contentDocument,d).toArray()},pt=(e,s,d)=>{let h=((e,s)=>{let d;let h=(d=!1,{get:()=>d,set:e=>{d=e}});return b(e,e=>({sourceList:e,entries:ut(0,s,h,e)}))})(s,(e=>{let s=b(Ve(e),P);return I(k(s,m(st)),k(T(s),m(st)),(e,s)=>({start:e,end:s}))})(e));S(h,s=>{var h;S(N(s.entries,lt),e=>((e,s)=>{switch(e){case"Indent":s.depth++;break;case"Outdent":s.depth--;break;case"Flatten":s.depth=0}s.dirty=!0})(d,e));let f=A(((e,s)=>{if(0===e.length)return[];{let d=s(e[0]),h=[],f=[];for(let y=0,R=e.length;y<R;y++){let R=e[y],Y=s(R);Y!==d&&(h.push(f),f=[]),d=Y,f.push(R)}return 0!==f.length&&h.push(f),h}})(s.entries,it),s=>E(s).exists(it)?mt(e,s):((e,s)=>{let d=dt(s);return b(d,s=>{let d=((e,s)=>{let d=document.createDocumentFragment();return S(e,e=>{d.appendChild(e.dom)}),P(d)})(s.content);return P(De(e,d.dom))})})(e,s));S(f,s=>{Xe(e,"Indent"===d?"IndentList":"OutdentList",s.dom)}),h=s.sourceList,S(f,e=>{q(h,e)}),X(s.sourceList)})},gt=(e,s)=>{let d=ne((e=>{let s=(e=>{let s=ze(e,e.selection.getStart()),d=N(e.selection.getSelectedBlocks(),eu);return s.toArray().concat(d)})(e);return Qe(e,s)})(e)),h=ne(N(Ve(e),ep)),f=!1;if(d.length||h.length){let y=e.selection.getBookmark();pt(e,d,s),S(h,"Indent"===s?Re:s=>Me(e,s)),e.selection.moveToBookmark(y),e.selection.setRng($e(e.selection.getRng())),e.nodeChanged(),f=!0}return f},ht=(e,s)=>!(e=>{let s=He(e);return Ze(e,s)})(e)&&gt(e,s),ft=e=>ht(e,"Indent"),yt=e=>ht(e,"Outdent"),vt=e=>ht(e,"Flatten"),Ct=e=>"\uFEFF"===e;var eT=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager");let eA=ea.DOM,Nt=e=>{let s={},n=d=>{let h=e[d?"startContainer":"endContainer"],f=e[d?"startOffset":"endOffset"];if(ge(h)){let e=eA.create("span",{"data-mce-type":"bookmark"});h.hasChildNodes()?(f=Math.min(f,h.childNodes.length-1),d?h.insertBefore(e,h.childNodes[f]):eA.insertAfter(e,h.childNodes[f])):h.appendChild(e),h=e,f=0}s[d?"startContainer":"endContainer"]=h,s[d?"startOffset":"endOffset"]=f};return n(!0),e.collapsed||n(),s},Lt=e=>{let t=s=>{let d=e[s?"startContainer":"endContainer"],h=e[s?"startOffset":"endOffset"];if(d){if(ge(d)&&d.parentNode){let e=d;h=(e=>{var s;let d=null===(s=e.parentNode)||void 0===s?void 0:s.firstChild,h=0;for(;d;){if(d===e)return h;ge(d)&&"bookmark"===d.getAttribute("data-mce-type")||h++,d=d.nextSibling}return -1})(d),d=d.parentNode,eA.remove(e),!d.hasChildNodes()&&eA.isBlock(d)&&d.appendChild(eA.create("br"))}e[s?"startContainer":"endContainer"]=d,e[s?"startOffset":"endOffset"]=h}};t(!0),t();let s=eA.createRng();return s.setStart(e.startContainer,e.startOffset),e.endContainer&&s.setEnd(e.endContainer,e.endOffset),$e(s)},Ot=e=>{switch(e){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},kt=(e,s)=>{ed.each(s,(s,d)=>{e.setAttribute(d,s)})},At=(e,s,d)=>{((e,s,d)=>{let h=d["list-style-type"]?d["list-style-type"]:null;e.setStyle(s,"list-style-type",h)})(e,s,d),kt(s,d["list-attributes"]),ed.each(e.select("li",s),e=>{kt(e,d["list-item-attributes"])})},Tt=(e,s)=>l(s)&&!Le(s,e.schema.getBlockElements()),xt=(e,s,d,h)=>{let f=s[d?"startContainer":"endContainer"],y=s[d?"startOffset":"endOffset"];ge(f)&&(f=f.childNodes[Math.min(y,f.childNodes.length-1)]||f),!d&&ef(f.nextSibling)&&(f=f.nextSibling);let i=(s,d)=>{var f;let y;let R=new eo(s,(s=>{for(;!e.dom.isBlock(s)&&s.parentNode&&h!==s;)s=s.parentNode;return s})(s)),Y=d?"next":"prev";for(;y=R[Y]();)if(!Oe(e,y)&&!Ct(y.textContent)&&0!==(null===(f=y.textContent)||void 0===f?void 0:f.length))return g.some(y);return g.none()};if(d&&pe(f)){if(Ct(f.textContent))f=i(f,!1).getOr(f);else for(null!==f.parentNode&&Tt(e,f.parentNode)&&(f=f.parentNode);null!==f.previousSibling&&(Tt(e,f.previousSibling)||pe(f.previousSibling));)f=f.previousSibling}if(!d&&pe(f)){if(Ct(f.textContent))f=i(f,!0).getOr(f);else for(null!==f.parentNode&&Tt(e,f.parentNode)&&(f=f.parentNode);null!==f.nextSibling&&(Tt(e,f.nextSibling)||pe(f.nextSibling));)f=f.nextSibling}for(;f.parentNode!==h;){let s=f.parentNode;if(Ne(e,f)||/^(TD|TH)$/.test(s.nodeName))break;f=s}return f},Et=(e,s,d)=>{let h=e.selection.getRng(),f="LI",y=Ke(e,((e,s)=>{let d=e.selection.getStart(!0),h=xt(e,s,!0,e.getBody());return Q(P(h),function(e,...s){return(...d)=>{let h=s.concat(d);return e.apply(null,h)}}(U,P(s.commonAncestorContainer)),void 0).isSome()?s.commonAncestorContainer:d})(e,h)),R=e.dom;if("false"===R.getContentEditable(e.selection.getNode()))return;"DL"===(s=s.toUpperCase())&&(f="DT");let Y=Nt(h),ee=N(((e,s,d)=>{let h;let f=[],y=e.dom,R=xt(e,s,!0,d),Y=xt(e,s,!1,d),ee=[];for(let e=R;e&&(ee.push(e),e!==Y);e=e.nextSibling);return ed.each(ee,s=>{var R;if(Ne(e,s))return f.push(s),void(h=null);if(y.isBlock(s)||ef(s))return ef(s)&&y.remove(s),void(h=null);let Y=s.nextSibling;eT.isBookmarkNode(s)&&(em(Y)||Ne(e,Y)||!Y&&s.parentNode===d)?h=null:(h||(h=y.create("p"),null===(R=s.parentNode)||void 0===R||R.insertBefore(h,s),f.push(h)),h.appendChild(s))}),f})(e,h,y),e.dom.isEditable);ed.each(ee,h=>{var y;let Y;let ee=h.previousSibling,et=h.parentNode;ec(et)||(ee&&em(ee)&&ee.nodeName===s&&((e,s,d)=>{let h=e.getStyle(s,"list-style-type"),f=d?d["list-style-type"]:"";return h===(f=null===f?"":f)})(R,ee,d)?(Y=ee,h=R.rename(h,f),ee.appendChild(h)):(Y=R.create(s),et.insertBefore(Y,h),Y.appendChild(h),h=R.rename(h,f)),y=h,ed.each(["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"],e=>R.setStyle(y,e,"")),At(R,Y,d),Dt(e.dom,Y))}),e.selection.setRng(Lt(Y))},wt=(e,s,d)=>em(s)&&s.nodeName===(null==d?void 0:d.nodeName)&&e.getStyle(s,"list-style-type",!0)===e.getStyle(d,"list-style-type",!0)&&s.className===d.className,Dt=(e,s)=>{let d,h=s.nextSibling;if(wt(e,s,h)){let f=h;for(;d=f.firstChild;)s.appendChild(d);e.remove(f)}if(h=s.previousSibling,wt(e,s,h)){let f=h;for(;d=f.lastChild;)s.insertBefore(d,s.firstChild);e.remove(f)}},Bt=(e,s,d,h)=>{if(s.nodeName!==d){let f=e.dom.rename(s,d);At(e.dom,f,h),Xe(e,Ot(d),f)}else At(e.dom,s,h),Xe(e,Ot(d),s)},It=(e,s,d,h)=>{if(s.classList.forEach((e,d,h)=>{e.startsWith("tox-")&&(h.remove(e),0===h.length&&s.removeAttribute("class"))}),s.nodeName!==d){let f=e.dom.rename(s,d);At(e.dom,f,h),Xe(e,Ot(d),f)}else At(e.dom,s,h),Xe(e,Ot(d),s)},Pt=e=>"list-style-type"in e,Mt=(e,s,d)=>{let f=He(e);if(Ge(e,f))return;let y=(e=>{let s=He(e),d=e.selection.getSelectedBlocks();return l(s)&&1===d.length&&d[0]===s?N(s.querySelectorAll(eO),em):N(d,e=>em(e)&&s!==e)})(e),R=h(d)?d:{};y.length>0?((e,s,d,h,f)=>{let y=em(s);if(!y||s.nodeName!==h||Pt(f)||We(s)){Et(e,h,f);let R=Nt(e.selection.getRng()),Y=y?[s,...d]:d,ee=y&&We(s)?It:Bt;ed.each(Y,s=>{ee(e,s,h,f)}),e.selection.setRng(Lt(R))}else vt(e)})(e,f,y,s,R):((e,s,d,h)=>{if(s!==e.getBody()){if(s){if(s.nodeName!==d||Pt(h)||We(s)){let f=Nt(e.selection.getRng());We(s)&&s.classList.forEach((e,d,h)=>{e.startsWith("tox-")&&(h.remove(e),0===h.length&&s.removeAttribute("class"))}),At(e.dom,s,h);let y=e.dom.rename(s,d);Dt(e.dom,y),e.selection.setRng(Lt(f)),Et(e,d,h),Xe(e,Ot(d),y)}else vt(e)}else Et(e,d,h),Xe(e,Ot(d),s)}})(e,f,s,R)},eE=ea.DOM,Ut=(e,s)=>{let d=ed.grep(e.select("ol,ul",s));ed.each(d,s=>{((e,s)=>{let d=s.parentElement;if(d&&"LI"===d.nodeName&&d.firstChild===s){let h=d.previousSibling;h&&"LI"===h.nodeName?(h.appendChild(s),ke(e,d)&&eE.remove(d)):eE.setStyle(d,"listStyleType","none")}if(em(d)){let e=d.previousSibling;e&&"LI"===e.nodeName&&e.appendChild(s)}})(e,s)})},$t=(e,s,d,h)=>{var f,y;let R=s.startContainer,Y=s.startOffset;if(pe(R)&&(d?Y<R.data.length:Y>0))return R;let ee=e.schema.getNonEmptyElements();ge(R)&&(R=el.getNode(R,Y));let et=new eo(R,h);d&&(f=e.dom,ef(y=R)&&f.isBlock(y.nextSibling)&&!ef(y.previousSibling))&&et.next();let er=d?et.next.bind(et):et.prev2.bind(et);for(;R=er();)if("LI"===R.nodeName&&!R.hasChildNodes()||ee[R.nodeName]||pe(R)&&R.data.length>0)return R;return null},_t=(e,s)=>{let d=s.childNodes;return 1===d.length&&!em(d[0])&&e.isBlock(d[0])},Ft=(e,s,d)=>{let h;let f=s.parentNode;if(!Ae(e,s)||!Ae(e,d))return;em(d.lastChild)&&(h=d.lastChild),f===d.lastChild&&ef(f.previousSibling)&&e.remove(f.previousSibling);let y=d.lastChild;y&&ef(y)&&s.hasChildNodes()&&e.remove(y),ke(e,d,!0)&&J(P(d)),((e,s,d)=>{let h;let f=_t(e,d)?d.firstChild:d;if(_t(e,s)&&e.remove(s.firstChild,!0),!ke(e,s,!0))for(;h=s.firstChild;)f.appendChild(h)})(e,s,d),h&&d.appendChild(h);let R=((e,s)=>{let d=e.dom,h=s.dom;return d!==h&&d.contains(h)})(P(d),P(s))?e.getParents(s,em,d):[];e.remove(s),S(R,s=>{ke(e,s)&&s!==e.getRoot()&&e.remove(s)})},Ht=(e,s)=>{let d=e.dom,h=e.selection,f=h.getStart(),y=je(e,f),R=d.getParent(h.getStart(),"LI",y);if(R){let f=R.parentElement;if(f===e.getBody()&&ke(d,f))return!0;let Y=$e(h.getRng()),ee=d.getParent($t(e,Y,s,y),"LI",y);if(ee&&ee!==R)return e.undoManager.transact(()=>{var d;s?((e,s,d,h)=>{let f=e.dom;if(f.isEmpty(h))J(P(h)),Ft(e.dom,d,h),e.selection.setCursorLocation(h,0);else{let y=Nt(s);Ft(f,d,h),e.selection.setRng(Lt(y))}})(e,Y,ee,R):(null===(d=R.parentNode)||void 0===d?void 0:d.firstChild)===R?yt(e):((e,s,d,h)=>{let f=Nt(s);Ft(e.dom,d,h);let y=Lt(f);e.selection.setRng(y)})(e,Y,R,ee)}),!0;if(!ee&&!s&&0===Y.startOffset&&0===Y.endOffset)return e.undoManager.transact(()=>{vt(e)}),!0}return!1},Vt=e=>{let s=e.selection.getStart(),d=je(e,s);return e.dom.getParent(s,"LI,DT,DD",d)||Ve(e).length>0},jt=(e,s)=>{let d=e.selection;return!Ge(e,d.getNode())&&(d.isCollapsed()?Ht(e,s)||((e,s)=>{let d=e.dom,h=e.selection.getStart(),f=je(e,h),y=d.getParent(h,d.isBlock,f);if(y&&d.isEmpty(y)){let h=$e(e.selection.getRng()),R=d.getParent($t(e,h,s,f),"LI",f);if(R){let l=e=>v(["td","th","caption"],$(e)),a=e=>e.dom===f;return!!((e,s,d=u)=>I(e,s,d).getOr(e.isNone()&&s.isNone()))(W(P(R),l,a),W(P(h.startContainer),l,a),U)&&(e.undoManager.transact(()=>{let h=R.parentNode;((e,s,d)=>{let h=e.getParent(s.parentNode,e.isBlock,d);e.remove(s),h&&e.isEmpty(h)&&e.remove(h)})(d,y,f),Dt(d,h),e.selection.select(R,!0),e.selection.collapse(s)}),!0)}}return!1})(e,s):!!Vt(e)&&(e.undoManager.transact(()=>{e.execCommand("Delete"),Ut(e.dom,e.getBody())}),!0))},Kt=e=>{let s=T(ek(e).split("")),d=b(s,(e,s)=>{let d=e.toUpperCase().charCodeAt(0)-65+1;return Math.pow(26,s)*d});return L(d,(e,s)=>e+s,0)},zt=e=>{if(--e<0)return"";{let s=e%26,d=Math.floor(e/26);return zt(d)+String.fromCharCode(65+s)}},Qt=e=>{let s=parseInt(e.start,10);return B(e.listStyleType,"upper-alpha")?zt(s):B(e.listStyleType,"lower-alpha")?zt(s).toLowerCase():e.start},Wt=(e,s)=>()=>{let d=He(e);return l(d)&&d.nodeName===s},qt=e=>{e.addCommand("mceListProps",()=>{(e=>{let s=He(e);eg(s)&&!Ge(e,s)&&e.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:Qt({start:e.dom.getAttrib(s,"start","1"),listStyleType:g.from(e.dom.getStyle(s,"list-style-type"))})},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:s=>{(e=>{switch(/^[0-9]+$/.test(e)?2:/^[A-Z]+$/.test(e)?0:/^[a-z]+$/.test(e)?1:e.length>0?4:3){case 2:return g.some({listStyleType:g.none(),start:e});case 0:return g.some({listStyleType:g.some("upper-alpha"),start:Kt(e).toString()});case 1:return g.some({listStyleType:g.some("lower-alpha"),start:Kt(e).toString()});case 3:return g.some({listStyleType:g.none(),start:""});case 4:return g.none()}})(s.getData().start).each(s=>{e.execCommand("mceListUpdate",!1,{attrs:{start:"1"===s.start?"":s.start},styles:{"list-style-type":s.listStyleType.getOr("")}})}),s.close()}})})(e)})};var ex=tinymce.util.Tools.resolve("tinymce.html.Node");let Gt=e=>3===e.type,Jt=e=>0===e.length,Xt=e=>{let t=(s,d)=>{let h=ex.create("li");S(s,e=>h.append(e)),d?e.insert(h,d,!0):e.append(h)},s=L(e.children(),(e,s)=>Gt(s)?[...e,s]:Jt(e)||Gt(s)?e:(t(e,s),[]),[]);Jt(s)||t(s)},Yt=(e,s)=>d=>(d.setEnabled(e.selection.isEditable()),Je(e,h=>{d.setActive(qe(h.parents,s)),d.setEnabled(!Ge(e,h.element)&&e.selection.isEditable())})),en=(e,s)=>d=>Je(e,h=>d.setEnabled(qe(h.parents,s)&&!Ge(e,h.element)));s.add("lists",e=>((e=>{(0,e.options.register)("lists_indent_on_tab",{processor:"boolean",default:!0})})(e),(e=>{e.on("PreInit",()=>{let{parser:s}=e;s.addNodeFilter("ul,ol",e=>S(e,Xt))})})(e),e.hasPlugin("rtc",!0)?qt(e):(ey(e)&&(e=>{e.on("keydown",s=>{s.keyCode!==ei.TAB||ei.metaKeyPressed(s)||e.undoManager.transact(()=>{(s.shiftKey?yt(e):ft(e))&&s.preventDefault()})})})(e),e.on("ExecCommand",s=>{let d=s.command.toLowerCase();("delete"===d||"forwarddelete"===d)&&Vt(e)&&Ut(e.dom,e.getBody())}),e.on("keydown",s=>{s.keyCode===ei.BACKSPACE?jt(e,!1)&&s.preventDefault():s.keyCode===ei.DELETE&&jt(e,!0)&&s.preventDefault()}),e.on("BeforeExecCommand",s=>{let d=s.command.toLowerCase();"indent"===d?ft(e):"outdent"===d&&yt(e)}),e.addCommand("InsertUnorderedList",(s,d)=>{Mt(e,"UL",d)}),e.addCommand("InsertOrderedList",(s,d)=>{Mt(e,"OL",d)}),e.addCommand("InsertDefinitionList",(s,d)=>{Mt(e,"DL",d)}),e.addCommand("RemoveList",()=>{vt(e)}),qt(e),e.addCommand("mceListUpdate",(s,d)=>{h(d)&&((e,s)=>{let d=He(e);null===d||Ge(e,d)||e.undoManager.transact(()=>{h(s.styles)&&e.dom.setStyles(d,s.styles),h(s.attrs)&&re(s.attrs,(s,h)=>e.dom.setAttrib(d,h,s))})})(e,d)}),e.addQueryStateHandler("InsertUnorderedList",Wt(e,"UL")),e.addQueryStateHandler("InsertOrderedList",Wt(e,"OL")),e.addQueryStateHandler("InsertDefinitionList",Wt(e,"DL"))),(e=>{let t=s=>()=>e.execCommand(s);e.hasPlugin("advlist")||(e.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:t("InsertOrderedList"),onSetup:Yt(e,"OL")}),e.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:t("InsertUnorderedList"),onSetup:Yt(e,"UL")}))})(e),(e=>{let s={text:"List properties...",icon:"ordered-list",onAction:()=>e.execCommand("mceListProps"),onSetup:en(e,"OL")};e.ui.registry.addMenuItem("listprops",s),e.ui.registry.addContextMenu("lists",{update:s=>{let d=He(e,s);return eg(d)?["listprops"]:[]}})})(e),{backspaceDelete:s=>{jt(e,s)}}))}();