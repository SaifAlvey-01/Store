!function(){"use strict";let T=Object.getPrototypeOf,t=(T,E,D)=>{var B;return!!D(T,E.prototype)||(null===(B=T.constructor)||void 0===B?void 0:B.name)===E.name},o=T=>E=>(T=>{let E=typeof T;return null===T?"null":"object"===E&&Array.isArray(T)?"array":"object"===E&&t(T,String,(T,E)=>E.isPrototypeOf(T))?"string":E})(E)===T,n=T=>E=>typeof E===T,s=T=>E=>T===E,E=o("string"),D=o("object"),i=E=>{var B;return B=Object,D(E)&&t(E,B,(E,D)=>T(E)===D)},B=o("array"),M=s(null),er=n("boolean"),ec=s(void 0),m=T=>null==T,g=T=>!m(T),eu=n("function"),eg=n("number"),f=(T,E)=>{if(B(T)){for(let D=0,B=T.length;D<B;++D)if(!E(T[D]))return!1;return!0}return!1},b=()=>{},v=T=>()=>T(),y=(T,E)=>(...D)=>T(E.apply(null,D)),x=T=>()=>T,w=T=>T,S=(T,E)=>T===E;function k(T,...E){return(...D)=>{let B=E.concat(D);return T.apply(null,B)}}let C=T=>E=>!T(E),O=T=>()=>{throw Error(T)},_=T=>T(),ep=x(!1),eh=x(!0);let A=class A{constructor(T,E){this.tag=T,this.value=E}static some(T){return new A(!0,T)}static none(){return A.singletonNone}fold(T,E){return this.tag?E(this.value):T()}isSome(){return this.tag}isNone(){return!this.tag}map(T){return this.tag?A.some(T(this.value)):A.none()}bind(T){return this.tag?T(this.value):A.none()}exists(T){return this.tag&&T(this.value)}forall(T){return!this.tag||T(this.value)}filter(T){return!this.tag||T(this.value)?this:A.none()}getOr(T){return this.tag?this.value:T}or(T){return this.tag?this:T}getOrThunk(T){return this.tag?this.value:T()}orThunk(T){return this.tag?this:T()}getOrDie(T){if(this.tag)return this.value;throw Error(null!=T?T:"Called getOrDie on None")}static from(T){return g(T)?A.some(T):A.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(T){this.tag&&T(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};A.singletonNone=new A(!1);let ey=Array.prototype.slice,ex=Array.prototype.indexOf,eO=Array.prototype.push,F=(T,E)=>ex.call(T,E),I=(T,E)=>{let D=F(T,E);return -1===D?A.none():A.some(D)},R=(T,E)=>F(T,E)>-1,N=(T,E)=>{for(let D=0,B=T.length;D<B;D++)if(E(T[D],D))return!0;return!1},V=(T,E)=>{let D=[];for(let B=0;B<T;B++)D.push(E(B));return D},z=(T,E)=>{let D=[];for(let B=0;B<T.length;B+=E){let M=ey.call(T,B,B+E);D.push(M)}return D},H=(T,E)=>{let D=T.length,B=Array(D);for(let M=0;M<D;M++){let D=T[M];B[M]=E(D,M)}return B},L=(T,E)=>{for(let D=0,B=T.length;D<B;D++)E(T[D],D)},P=(T,E)=>{let D=[],B=[];for(let M=0,er=T.length;M<er;M++){let er=T[M];(E(er,M)?D:B).push(er)}return{pass:D,fail:B}},U=(T,E)=>{let D=[];for(let B=0,M=T.length;B<M;B++){let M=T[B];E(M,B)&&D.push(M)}return D},W=(T,E,D)=>(((T,E)=>{for(let D=T.length-1;D>=0;D--)E(T[D],D)})(T,(T,B)=>{D=E(D,T,B)}),D),j=(T,E,D)=>(L(T,(T,B)=>{D=E(D,T,B)}),D),G=(T,E)=>((T,E,D)=>{for(let B=0,M=T.length;B<M;B++){let M=T[B];if(E(M,B))return A.some(M);if(D(M,B))break}return A.none()})(T,E,ep),$=(T,E)=>{for(let D=0,B=T.length;D<B;D++)if(E(T[D],D))return A.some(D);return A.none()},q=T=>{let E=[];for(let D=0,M=T.length;D<M;++D){if(!B(T[D]))throw Error("Arr.flatten item "+D+" was not an array, input: "+T);eO.apply(E,T[D])}return E},X=(T,E)=>q(H(T,E)),Y=(T,E)=>{for(let D=0,B=T.length;D<B;++D)if(!0!==E(T[D],D))return!1;return!0},K=T=>{let E=ey.call(T,0);return E.reverse(),E},J=(T,E)=>U(T,T=>!R(E,T)),Z=(T,E)=>{let D={};for(let B=0,M=T.length;B<M;B++){let M=T[B];D[String(M)]=E(M,B)}return D},Q=T=>[T],ee=(T,E)=>{let D=ey.call(T,0);return D.sort(E),D},te=(T,E)=>E>=0&&E<T.length?A.some(T[E]):A.none(),oe=T=>te(T,0),ne=T=>te(T,T.length-1),eD=eu(Array.from)?Array.from:T=>ey.call(T),re=(T,E)=>{for(let D=0;D<T.length;D++){let B=E(T[D],D);if(B.isSome())return B}return A.none()},eI=Object.keys,eR=Object.hasOwnProperty,le=(T,E)=>{let D=eI(T);for(let B=0,M=D.length;B<M;B++){let M=D[B];E(T[M],M)}},ce=(T,E)=>de(T,(T,D)=>({k:D,v:E(T,D)})),de=(T,E)=>{let D={};return le(T,(T,B)=>{let M=E(T,B);D[M.k]=M.v}),D},ue=T=>(E,D)=>{T[D]=E},me=(T,E,D,B)=>{le(T,(T,M)=>{(E(T,M)?D:B)(T,M)})},ge=(T,E)=>{let D={};return me(T,E,ue(D),b),D},pe=(T,E)=>{let D=[];return le(T,(T,B)=>{D.push(E(T,B))}),D},he=(T,E)=>{let D=eI(T);for(let B=0,M=D.length;B<M;B++){let M=D[B],er=T[M];if(E(er,M,T))return A.some(er)}return A.none()},fe=T=>pe(T,w),be=(T,E)=>ve(T,E)?A.from(T[E]):A.none(),ve=(T,E)=>eR.call(T,E),ye=(T,E)=>ve(T,E)&&void 0!==T[E]&&null!==T[E],xe=(T,E,D=S)=>T.exists(T=>D(T,E)),we=T=>{let E=[],o=T=>{E.push(T)};for(let E=0;E<T.length;E++)T[E].each(o);return E},Se=(T,E,D)=>T.isSome()&&E.isSome()?A.some(D(T.getOrDie(),E.getOrDie())):A.none(),ke=(T,E)=>null!=T?A.some(E(T)):A.none(),Ce=(T,E)=>T?A.some(E):A.none(),Oe=(T,E,D)=>""===E||T.length>=E.length&&T.substr(D,D+E.length)===E,_e=(T,E)=>{var D;return Ee(T,E)?(D=E.length,T.substring(D)):T},Te=(T,E,D=0,B)=>{let M=T.indexOf(E,D);return -1!==M&&(!!ec(B)||M+E.length<=B)},Ee=(T,E)=>Oe(T,E,0),Ae=(T,E)=>Oe(T,E,T.length-E.length),eH=(o0=/^\s+|\s+$/g,T=>T.replace(o0,"")),De=T=>T.length>0,Be=T=>void 0!==T.style&&eu(T.style.getPropertyValue),Fe=T=>{if(null==T)throw Error("Node cannot be null or undefined");return{dom:T}},Ie=(T,E)=>{let D=(E||document).createElement("div");if(D.innerHTML=T,!D.hasChildNodes()||D.childNodes.length>1){let E="HTML does not have a single root node";throw console.error(E,T),Error(E)}return Fe(D.childNodes[0])},Re=(T,E)=>{let D=(E||document).createElement(T);return Fe(D)},Ne=(T,E)=>{let D=(E||document).createTextNode(T);return Fe(D)},eN="undefined"!=typeof window?window:Function("return this;")(),He=(T,E)=>((T,E)=>{let D=null!=E?E:eN;for(let E=0;E<T.length&&null!=D;++E)D=D[T[E]];return D})(T.split("."),E),eU=Object.getPrototypeOf,Pe=T=>{let E=He("ownerDocument.defaultView",T);return D(T)&&(((T,E)=>{let D=He(T,E);if(null==D)throw Error(T+" not available on this browser");return D})("HTMLElement",E).prototype.isPrototypeOf(T)||/^HTML\w*Element$/.test(eU(T).constructor.name))},Ue=T=>T.dom.nodeName.toLowerCase(),We=T=>E=>E.dom.nodeType===T,je=T=>eL(T)&&Pe(T.dom),eL=We(1),ez=We(3),eP=We(9),ej=We(11),Ye=T=>E=>eL(E)&&Ue(E)===T,Ke=(T,E)=>{let D=T.dom;if(1!==D.nodeType)return!1;if(void 0!==D.matches)return D.matches(E);if(void 0!==D.msMatchesSelector)return D.msMatchesSelector(E);if(void 0!==D.webkitMatchesSelector)return D.webkitMatchesSelector(E);if(void 0!==D.mozMatchesSelector)return D.mozMatchesSelector(E);throw Error("Browser lacks native selectors")},Je=T=>1!==T.nodeType&&9!==T.nodeType&&11!==T.nodeType||0===T.childElementCount,Ze=(T,E)=>T.dom===E.dom,Qe=(T,E)=>{let D=T.dom,B=E.dom;return D!==B&&D.contains(B)},et=T=>Fe(T.dom.ownerDocument),tt=T=>eP(T)?T:et(T),ot=T=>Fe(tt(T).dom.documentElement),nt=T=>Fe(tt(T).dom.defaultView),st=T=>A.from(T.dom.parentNode).map(Fe),rt=T=>A.from(T.dom.parentElement).map(Fe),at=T=>A.from(T.dom.offsetParent).map(Fe),it=T=>H(T.dom.childNodes,Fe),lt=(T,E)=>{let D=T.dom.childNodes;return A.from(D[E]).map(Fe)},ct=T=>lt(T,0),dt=(T,E)=>({element:T,offset:E}),ut=(T,E)=>{let D=it(T);return D.length>0&&E<D.length?dt(D[E],0):dt(T,E)},mt=T=>ej(T)&&g(T.dom.host),eW=eu(Element.prototype.attachShadow)&&eu(Node.prototype.getRootNode),eG=x(eW),eJ=eW?T=>Fe(T.dom.getRootNode()):tt,ft=T=>mt(T)?T:Fe(tt(T).dom.body),bt=T=>{let E=eJ(T);return mt(E)?A.some(E):A.none()},vt=T=>Fe(T.dom.host),yt=T=>{let E=ez(T)?T.dom.parentNode:T.dom;if(null==E||null===E.ownerDocument)return!1;let D=E.ownerDocument;return bt(Fe(E)).fold(()=>D.body.contains(E),T=>yt(vt(T)))},xt=()=>wt(Fe(document)),wt=T=>{let E=T.dom.body;if(null==E)throw Error("Body is not available yet");return Fe(E)},St=(T,D,B)=>{if(!(E(B)||er(B)||eg(B)))throw console.error("Invalid call to Attribute.set. Key ",D,":: Value ",B,":: Element ",T),Error("Attribute value was not simple");T.setAttribute(D,B+"")},kt=(T,E,D)=>{St(T.dom,E,D)},Ct=(T,E)=>{let D=T.dom;le(E,(T,E)=>{St(D,E,T)})},Ot=(T,E)=>{let D=T.dom.getAttribute(E);return null===D?void 0:D},_t=(T,E)=>A.from(Ot(T,E)),Tt=(T,E)=>{let D=T.dom;return!(!D||!D.hasAttribute)&&D.hasAttribute(E)},Et=(T,E)=>{T.dom.removeAttribute(E)},At=(T,D,B)=>{if(!E(B))throw console.error("Invalid call to CSS.set. Property ",D,":: Value ",B,":: Element ",T),Error("CSS value must be a string: "+B);Be(T)&&T.style.setProperty(D,B)},Mt=(T,E)=>{Be(T)&&T.style.removeProperty(E)},Dt=(T,E,D)=>{let B=T.dom;At(B,E,D)},Bt=(T,E)=>{let D=T.dom;le(E,(T,E)=>{At(D,E,T)})},Ft=(T,E)=>{let D=T.dom;le(E,(T,E)=>{T.fold(()=>{Mt(D,E)},T=>{At(D,E,T)})})},It=(T,E)=>{let D=T.dom,B=window.getComputedStyle(D).getPropertyValue(E);return""!==B||yt(T)?B:Rt(D,E)},Rt=(T,E)=>Be(T)?T.style.getPropertyValue(E):"",Nt=(T,E)=>{let D=T.dom,B=Rt(D,E);return A.from(B).filter(T=>T.length>0)},Vt=T=>{let E={},D=T.dom;if(Be(D))for(let T=0;T<D.style.length;T++){let B=D.style.item(T);E[B]=D.style[B]}return E},zt=(T,E,D)=>{let B=Re(T);return Dt(B,E,D),Nt(B,E).isSome()},Ht=(T,E)=>{let D=T.dom;Mt(D,E),xe(_t(T,"style").map(eH),"")&&Et(T,"style")},Lt=T=>T.dom.offsetWidth,Pt=(T,E)=>{let o=D=>{let B=E(D);if(B<=0||null===B){let E=It(D,T);return parseFloat(E)||0}return B},n=(T,E)=>j(E,(E,D)=>{let B=It(T,D),M=void 0===B?0:parseInt(B,10);return isNaN(M)?E:E+M},0);return{set:(E,D)=>{if(!eg(D)&&!D.match(/^[0-9]+$/))throw Error(T+".set accepts only positive integer values. Value was "+D);let B=E.dom;Be(B)&&(B.style[T]=D+"px")},get:o,getOuter:o,aggregate:n,max:(T,E,D)=>{let B=n(T,D);return E>B?E-B:0}}},e$=Pt("height",T=>{let E=T.dom;return yt(T)?E.getBoundingClientRect().height:E.offsetHeight}),Wt=T=>e$.get(T),jt=T=>e$.getOuter(T),Gt=(T,E)=>({left:T,top:E,translate:(D,B)=>Gt(T+D,E+B)}),qt=(T,E)=>void 0!==T?T:void 0!==E?E:0,Xt=T=>{let E=T.dom.ownerDocument,D=E.body,B=E.defaultView,M=E.documentElement;if(D===T.dom)return Gt(D.offsetLeft,D.offsetTop);let er=qt(null==B?void 0:B.pageYOffset,M.scrollTop),ec=qt(null==B?void 0:B.pageXOffset,M.scrollLeft),eu=qt(M.clientTop,D.clientTop),eg=qt(M.clientLeft,D.clientLeft);return Yt(T).translate(ec-eg,er-eu)},Yt=T=>{let E=T.dom,D=E.ownerDocument.body;return D===E?Gt(D.offsetLeft,D.offsetTop):yt(T)?(T=>{let E=T.getBoundingClientRect();return Gt(E.left,E.top)})(E):Gt(0,0)},eX=Pt("width",T=>T.dom.offsetWidth),Jt=T=>eX.get(T),Zt=T=>eX.getOuter(T),Qt=T=>{let E,D=!1;return(...B)=>(D||(D=!0,E=T.apply(null,B)),E)},eo=()=>to(0,0),to=(T,E)=>({major:T,minor:E}),eq={nu:to,detect:(T,E)=>{let D=String(E).toLowerCase();return 0===T.length?eo():((T,E)=>{let D=((T,E)=>{for(let D=0;D<T.length;D++){let B=T[D];if(B.test(E))return B}})(T,E);if(!D)return{major:0,minor:0};let n=T=>Number(E.replace(D,"$"+T));return to(n(1),n(2))})(T,D)},unknown:eo},no=(T,E)=>{let D=String(E).toLowerCase();return G(T,T=>T.search(D))},eK=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ro=T=>E=>Te(E,T),eY=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:T=>Te(T,"edge/")&&Te(T,"chrome")&&Te(T,"safari")&&Te(T,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,eK],search:T=>Te(T,"chrome")&&!Te(T,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:T=>Te(T,"msie")||Te(T,"trident")},{name:"Opera",versionRegexes:[eK,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ro("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ro("firefox")},{name:"Safari",versionRegexes:[eK,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:T=>(Te(T,"safari")||Te(T,"mobile/"))&&Te(T,"applewebkit")}],eZ=[{name:"Windows",search:ro("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:T=>Te(T,"iphone")||Te(T,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ro("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:ro("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ro("linux"),versionRegexes:[]},{name:"Solaris",search:ro("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ro("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ro("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],eQ={browsers:x(eY),oses:x(eZ)},e0="Edge",e1="Chromium",e2="Opera",e3="Firefox",e5="Safari",ho=T=>{let E=T.current,D=T.version,n=T=>()=>E===T;return{current:E,version:D,isEdge:n(e0),isChromium:n(e1),isIE:n("IE"),isOpera:n(e2),isFirefox:n(e3),isSafari:n(e5)}},fo=()=>ho({current:void 0,version:eq.unknown()}),e9=(x(e0),x(e1),x("IE"),x(e2),x(e3),x(e5),"Windows"),e4="Android",e6="Linux",e8="macOS",e7="Solaris",tn="FreeBSD",tr="ChromeOS",Oo=T=>{let E=T.current,D=T.version,n=T=>()=>E===T;return{current:E,version:D,isWindows:n(e9),isiOS:n("iOS"),isAndroid:n(e4),isMacOS:n(e8),isLinux:n(e6),isSolaris:n(e7),isFreeBSD:n(tn),isChromeOS:n(tr)}},_o=()=>Oo({current:void 0,version:eq.unknown()}),th=(x(e9),x("iOS"),x(e4),x(e6),x(e8),x(e7),x(tn),x(tr),T=>window.matchMedia(T).matches),tf=Qt(()=>((T,E,D)=>{let B=eQ.browsers(),M=eQ.oses(),er=E.bind(T=>re(T.brands,T=>{let E=T.brand.toLowerCase();return G(B,T=>{var D;return E===(null===(D=T.brand)||void 0===D?void 0:D.toLowerCase())}).map(E=>({current:E.name,version:eq.nu(parseInt(T.version,10),0)}))})).orThunk(()=>no(B,T).map(E=>{let D=eq.detect(E.versionRegexes,T);return{current:E.name,version:D}})).fold(fo,ho),ec=no(M,T).map(E=>{let D=eq.detect(E.versionRegexes,T);return{current:E.name,version:D}}).fold(_o,Oo),eu=((T,E,D,B)=>{let M=T.isiOS()&&!0===/ipad/i.test(D),er=T.isiOS()&&!M,ec=T.isiOS()||T.isAndroid(),eu=ec||B("(pointer:coarse)"),eg=M||!er&&ec&&B("(min-device-width:768px)"),ep=er||ec&&!eg,eh=E.isSafari()&&T.isiOS()&&!1===/safari/i.test(D),ey=!ep&&!eg&&!eh;return{isiPad:x(M),isiPhone:x(er),isTablet:x(eg),isPhone:x(ep),isTouch:x(eu),isAndroid:T.isAndroid,isiOS:T.isiOS,isWebView:x(eh),isDesktop:x(ey)}})(ec,er,T,D);return{browser:er,os:ec,deviceType:eu}})(navigator.userAgent,A.from(navigator.userAgentData),th)),Do=()=>tf(),Bo=T=>{let E=Fe((T=>{if(eG()&&g(T.target)){let E=Fe(T.target);if(eL(E)&&g(E.dom.shadowRoot)&&T.composed&&T.composedPath){let E=T.composedPath();if(E)return oe(E)}}return A.from(T.target)})(T).getOr(T.target)),o=()=>T.stopPropagation(),n=()=>T.preventDefault(),D=y(n,o);return{target:E,x:T.clientX,y:T.clientY,stop:o,prevent:n,kill:D,raw:T}},Fo=(T,E,D,B,M)=>{let r=T=>{D(T)&&B(Bo(T))};return T.dom.addEventListener(E,r,M),{unbind:k(Io,T,E,r,M)}},Io=(T,E,D,B)=>{T.dom.removeEventListener(E,D,B)},Ro=(T,E)=>{st(T).each(D=>{D.dom.insertBefore(E.dom,T.dom)})},No=(T,E)=>{let D=A.from(T.dom.nextSibling).map(Fe);D.fold(()=>{st(T).each(T=>{zo(T,E)})},T=>{Ro(T,E)})},Vo=(T,E)=>{ct(T).fold(()=>{zo(T,E)},D=>{T.dom.insertBefore(E.dom,D.dom)})},zo=(T,E)=>{T.dom.appendChild(E.dom)},Ho=(T,E)=>{L(E,E=>{zo(T,E)})},Lo=T=>{T.dom.textContent="",L(it(T),T=>{Po(T)})},Po=T=>{let E=T.dom;null!==E.parentNode&&E.parentNode.removeChild(E)},Uo=T=>{let E=void 0!==T?T.dom:document,D=E.body.scrollLeft||E.documentElement.scrollLeft,B=E.body.scrollTop||E.documentElement.scrollTop;return Gt(D,B)},Wo=(T,E,D)=>{let B=(void 0!==D?D.dom:document).defaultView;B&&B.scrollTo(T,E)},jo=(T,E,D,B)=>({x:T,y:E,width:D,height:B,right:T+D,bottom:E+B}),Go=T=>{let E=void 0===T?window:T,D=E.document,B=Uo(Fe(D));return(T=>{let E=void 0===T?window:T;return Do().browser.isFirefox()?A.none():A.from(E.visualViewport)})(E).fold(()=>{let T=E.document.documentElement,D=T.clientWidth,M=T.clientHeight;return jo(B.left,B.top,D,M)},T=>jo(Math.max(T.pageLeft,B.left),Math.max(T.pageTop,B.top),T.width,T.height))},$o=()=>Fe(document),qo=(T,E)=>T.view(E).fold(x([]),E=>{let D=T.owner(E),B=qo(T,D);return[E].concat(B)});var tv=Object.freeze({__proto__:null,view:T=>{var E;return(T.dom===document?A.none():A.from(null===(E=T.dom.defaultView)||void 0===E?void 0:E.frameElement)).map(Fe)},owner:T=>et(T)});let Yo=T=>{let E=$o(),D=Uo(E),B=((T,E)=>{let D=E.owner(T),B=qo(E,D);return A.some(B)})(T,tv);return B.fold(k(Xt,T),E=>{let B=Yt(T),M=W(E,(T,E)=>{let D=Yt(E);return{left:T.left+D.left,top:T.top+D.top}},{left:0,top:0});return Gt(M.left+B.left+D.left,M.top+B.top+D.top)})},Ko=(T,E,D,B)=>({x:T,y:E,width:D,height:B,right:T+D,bottom:E+B}),Jo=T=>{let E=Xt(T),D=Zt(T),B=jt(T);return Ko(E.left,E.top,D,B)},Zo=T=>{let E=Yo(T),D=Zt(T),B=jt(T);return Ko(E.left,E.top,D,B)},Qo=(T,E)=>{let D=Math.max(T.x,E.x),B=Math.max(T.y,E.y),M=Math.min(T.right,E.right),er=Math.min(T.bottom,E.bottom);return Ko(D,B,M-D,er-B)},en=()=>Go(window);var ty=tinymce.util.Tools.resolve("tinymce.ThemeManager");let on=T=>{let t=E=>E(T),E=x(T),n=()=>D,D={tag:!0,inner:T,fold:(E,D)=>D(T),isValue:eh,isError:ep,map:E=>tx.value(E(T)),mapError:n,bind:t,exists:t,forall:t,getOr:E,or:n,getOrThunk:E,orThunk:n,getOrDie:E,each:E=>{E(T)},toOptional:()=>A.some(T)};return D},nn=T=>{let t=()=>E,E={tag:!1,inner:T,fold:(E,D)=>E(T),isValue:ep,isError:eh,map:t,mapError:E=>tx.error(E(T)),bind:t,exists:ep,forall:eh,getOr:w,or:w,getOrThunk:_,orThunk:_,getOrDie:O(String(T)),each:b,toOptional:A.none};return E},tx={value:on,error:nn,fromOption:(T,E)=>T.fold(()=>nn(E),on)};(oQ=o1||(o1={}))[oQ.Error=0]="Error",oQ[oQ.Value=1]="Value";let an=(T,E,D)=>T.stype===o1.Error?E(T.serror):D(T.svalue),ln=T=>({stype:o1.Value,svalue:T}),cn=T=>({stype:o1.Error,serror:T}),gn=(T,E,D,B)=>({tag:"field",key:T,newKey:E,presence:D,prop:B}),pn=(T,E,D)=>{switch(T.tag){case"field":return E(T.key,T.newKey,T.presence,T.prop);case"custom":return D(T.newKey,T.instantiator)}},hn=T=>(...E)=>{if(0===E.length)throw Error("Can't merge zero objects");let D={};for(let B=0;B<E.length;B++){let M=E[B];for(let E in M)ve(M,E)&&(D[E]=T(D[E],M[E]))}return D},tw=hn((T,E)=>i(T)&&i(E)?tw(T,E):E),tO=hn((T,E)=>E),vn=T=>({tag:"defaultedThunk",process:T}),yn=T=>vn(x(T)),xn=T=>({tag:"mergeWithThunk",process:T}),wn=T=>{var E;let D=(T=>{let E=[],D=[];return L(T,T=>{an(T,T=>D.push(T),T=>E.push(T))}),{values:E,errors:D}})(T);return D.errors.length>0?(E=D.errors,y(cn,q)(E)):ln(D.values)},Sn=T=>D(T)&&eI(T).length>100?" removed due to size":JSON.stringify(T,null,2),kn=(T,E)=>cn([{path:T,getErrorInfo:E}]),Cn=T=>({extract:(E,D)=>{var B,M;return(B=T(D)).stype===o1.Error?(M=B.serror,kn(E,x(M))):B},toString:x("val")}),tC=Cn(ln),_n=(T,E,D,B)=>B(be(T,E).getOrThunk(()=>D(T))),Tn=(T,E,D,B,M)=>{var er;let r=T=>M.extract(E.concat([B]),T),a=T=>T.fold(()=>ln(A.none()),T=>{var D,er;return D=M.extract(E.concat([B]),T),er=A.some,D.stype===o1.Value?{stype:o1.Value,svalue:er(D.svalue)}:D});switch(T.tag){case"required":return be(D,B).fold(()=>kn(E,()=>'Could not find valid *required* value for "'+B+'" in '+Sn(D)),r);case"defaultedThunk":return _n(D,B,T.process,r);case"option":return a(be(D,B));case"defaultedOptionThunk":return er=T.process,a(be(D,B).map(T=>!0===T?er(D):T));case"mergeWithThunk":return _n(D,B,x({}),E=>{let B=tw(T.process(D),E);return r(B)})}},En=T=>({extract:(E,D)=>T().extract(E,D),toString:()=>T().toString()}),An=T=>eI(ge(T,g)),Mn=T=>{let E=Dn(T),D=W(T,(T,E)=>pn(E,E=>tw(T,{[E]:!0}),x(T)),{});return{extract:(T,B)=>{let M=er(B)?[]:An(B),ec=U(M,T=>!ye(D,T));return 0===ec.length?E.extract(T,B):kn(T,()=>"There are unsupported fields: ["+ec.join(", ")+"] specified")},toString:E.toString}},Dn=T=>({extract:(E,D)=>((T,E,D)=>{let B={},M=[];for(let er of D)pn(er,(D,er,ec,eu)=>{let eg=Tn(ec,T,E,D,eu);an(eg,T=>{M.push(...T)},T=>{B[er]=T})},(T,D)=>{B[T]=D(E)});return M.length>0?cn(M):ln(B)})(E,D,T),toString:()=>{let E=H(T,T=>pn(T,(T,E,D,B)=>T+" -> "+B.toString(),(T,E)=>"state("+T+")"));return"obj{\n"+E.join("\n")+"}"}}),Bn=T=>({extract:(E,D)=>{let B=H(D,(D,B)=>T.extract(E.concat(["["+B+"]"]),D));return wn(B)},toString:()=>"array("+T.toString()+")"}),Fn=(T,E)=>{let D=void 0!==E?E:w;return{extract:(E,B)=>{let M=[];for(let er of T){let T=er.extract(E,B);if(T.stype===o1.Value)return{stype:o1.Value,svalue:D(T.svalue)};M.push(T)}return wn(M)},toString:()=>"oneOf("+H(T,T=>T.toString()).join(", ")+")"}},In=(T,E)=>({extract:(D,B)=>{let M=eI(B),er=Bn(Cn(T)).extract(D,M);return er.stype===o1.Value?(T=>{let M=H(T,T=>gn(T,T,{tag:"required",process:{}},E));return Dn(M).extract(D,B)})(er.svalue):er},toString:()=>"setOf("+E.toString()+")"}),tM=y(Bn,Dn),tI=x(tC),Vn=(T,E)=>Cn(D=>{let B=typeof D;return T(D)?ln(D):cn(`Expected type: ${E} but got: ${B}`)}),tR=Vn(eg,"number"),tH=Vn(E,"string"),tN=Vn(er,"boolean"),tU=Vn(eu,"function"),Un=T=>{if(Object(T)!==T)return!0;switch(({}).toString.call(T).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(T).every(E=>Un(T[E]));default:return!1}},tL=Cn(T=>Un(T)?ln(T):cn("Expected value to be acceptable for sending via postMessage")),jn=(T,E)=>({extract:(D,B)=>be(B,T).fold(()=>kn(D,()=>'Choice schema did not contain choice key: "'+T+'"'),T=>be(E,T).fold(()=>kn(D,()=>'The chosen schema: "'+T+'" did not exist in branches: '+Sn(E)),E=>E.extract(D.concat(["branch: "+T]),B))),toString:()=>"chooseOn("+T+"). Possible values: "+eI(E)}),Gn=T=>Cn(E=>T(E).fold(cn,ln)),$n=(T,E)=>In(E=>T(E).fold(cn,ln),E),qn=(T,E,D)=>{var B;return an((B=E.extract([T],D)).stype===o1.Error?{stype:o1.Error,serror:{input:D,errors:B.serror}}:B,tx.error,tx.value)},Xn=T=>T.fold(T=>{throw Error(Kn(T))},w),Yn=(T,E,D)=>Xn(qn(T,E,D)),Kn=T=>"Errors: \n"+(T=>{let E=T.length>10?T.slice(0,10).concat([{path:[],getErrorInfo:x("... (only showing first ten failures)")}]):T;return H(E,T=>"Failed path: ("+T.path.join(" > ")+")\n"+T.getErrorInfo())})(T.errors).join("\n")+"\n\nInput object: "+Sn(T.input),Jn=(T,E)=>jn(T,ce(E,Dn)),Zn=(T,E)=>((T,E)=>{let D=Qt(E);return{extract:(T,E)=>D().extract(T,E),toString:()=>D().toString()}})(0,E),es=(T,E)=>({tag:"custom",newKey:T,instantiator:E}),ts=T=>Gn(E=>R(T,E)?tx.value(E):tx.error(`Unsupported value: "${E}", choose one of "${T.join(", ")}".`)),os=T=>gn(T,T,{tag:"required",process:{}},tI()),ns=(T,E)=>gn(T,T,{tag:"required",process:{}},E),ss=T=>ns(T,tR),rs=T=>ns(T,tH),as=(T,E)=>gn(T,T,{tag:"required",process:{}},ts(E)),is=T=>ns(T,tU),ls=(T,E)=>gn(T,T,{tag:"required",process:{}},Dn(E)),cs=(T,E)=>gn(T,T,{tag:"required",process:{}},tM(E)),ds=(T,E)=>gn(T,T,{tag:"required",process:{}},Bn(E)),us=T=>gn(T,T,{tag:"option",process:{}},tI()),ms=(T,E)=>gn(T,T,{tag:"option",process:{}},E),gs=T=>ms(T,tR),ps=T=>ms(T,tH),hs=(T,E)=>ms(T,ts(E)),fs=T=>ms(T,tU),bs=(T,E)=>ms(T,Bn(E)),vs=(T,E)=>ms(T,Dn(E)),ys=(T,E)=>gn(T,T,yn(E),tI()),xs=(T,E,D)=>gn(T,T,yn(E),D),ws=(T,E)=>xs(T,E,tR),Ss=(T,E)=>xs(T,E,tH),ks=(T,E,D)=>xs(T,E,ts(D)),Cs=(T,E)=>xs(T,E,tN),Os=(T,E)=>xs(T,E,tU),_s=(T,E,D)=>xs(T,E,Bn(D)),Ts=(T,E,D)=>xs(T,E,Dn(D)),Es=T=>{let E=T;return{get:()=>E,set:T=>{E=T}}},As=T=>{if(!B(T))throw Error("cases must be an array");if(0===T.length)throw Error("there must be at least one case");let E=[],D={};return L(T,(M,er)=>{let ec=eI(M);if(1!==ec.length)throw Error("one and only one name per case");let eu=ec[0],eg=M[eu];if(void 0!==D[eu])throw Error("duplicate key detected:"+eu);if("cata"===eu)throw Error("cannot have a case named cata (sorry)");if(!B(eg))throw Error("case arguments must be an array");E.push(eu),D[eu]=(...D)=>{let B=D.length;if(B!==eg.length)throw Error("Wrong number of arguments to case "+eu+". Expected "+eg.length+" ("+eg+"), got "+B);return{fold:(...E)=>{if(E.length!==T.length)throw Error("Wrong number of arguments to fold. Expected "+T.length+", got "+E.length);return E[er].apply(null,D)},match:T=>{let B=eI(T);if(E.length!==B.length)throw Error("Wrong number of arguments to match. Expected: "+E.join(",")+"\nActual: "+B.join(","));if(!Y(E,T=>R(B,T)))throw Error("Not all branches were specified when using match. Specified: "+B.join(", ")+"\nRequired: "+E.join(", "));return T[eu].apply(null,D)},log:T=>{console.log(T,{constructors:E,constructor:eu,params:D})}}}}),D};As([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);let Ms=(T,E)=>({[T]:E}),Ds=T=>(T=>{let E={};return L(T,T=>{E[T.key]=T.value}),E})(T),Bs=T=>eu(T)?T:ep,Fs=(T,E,D)=>{let B=T.dom,M=Bs(D);for(;B.parentNode;){B=B.parentNode;let T=Fe(B),D=E(T);if(D.isSome())return D;if(M(T))break}return A.none()},Is=(T,E,D)=>{let B=E(T),M=Bs(D);return B.orThunk(()=>M(T)?A.none():Fs(T,E,M))},Rs=(T,E)=>Ze(T.element,E.event.target),tz={can:eh,abort:ep,run:b},Vs=T=>{if(!ye(T,"can")&&!ye(T,"abort")&&!ye(T,"run"))throw Error("EventHandler defined by: "+JSON.stringify(T,null,2)+" does not have can, abort, or run!");return{...tz,...T}},tP=x("touchstart"),tj=x("touchmove"),tW=x("touchend"),tG=x("touchcancel"),tJ=x("mousedown"),t$=x("mousemove"),tX=x("mouseout"),tq=x("mouseup"),tK=x("mouseover"),tY=x("focusin"),tZ=x("focusout"),tQ=x("keydown"),t0=x("keyup"),t1=x("input"),t2=x("change"),t3=x("click"),t5=x("transitioncancel"),t9=x("transitionend"),t4=x("transitionstart"),t6=x("selectstart"),rr=T=>x("alloy."+T),t8={tap:rr("tap")},t7=rr("focus"),oo=rr("blur.post"),or=rr("paste.post"),oh=rr("receive"),of=rr("execute"),ov=rr("focus.item"),oy=t8.tap,ox=rr("longpress"),ow=rr("sandbox.close"),oA=rr("typeahead.cancel"),oS=rr("system.init"),oO=rr("system.touchmove"),oC=rr("system.touchend"),oI=rr("system.scroll"),oR=rr("system.resize"),oH=rr("system.attached"),oN=rr("system.detached"),oU=rr("system.dismissRequested"),oL=rr("system.repositionRequested"),oz=rr("focusmanager.shifted"),oP=rr("slotcontainer.visibility"),oj=rr("system.external.element.scroll"),oW=rr("change.tab"),oG=rr("dismiss.tab"),oJ=rr("highlight"),o$=rr("dehighlight"),Fr=(T,E)=>{Vr(T,T.element,E,{})},Ir=(T,E,D)=>{Vr(T,T.element,E,D)},Rr=T=>{Fr(T,of())},Nr=(T,E,D)=>{Vr(T,E,D,{})},Vr=(T,E,D,B)=>{let M={target:E,...B};T.getSystem().triggerEvent(D,E,M)},zr=(T,E,D,B)=>{T.getSystem().triggerEvent(D,E,B.event)},Hr=T=>Ds(T),Lr=(T,E)=>({key:T,value:Vs({abort:E})}),Pr=T=>({key:T,value:Vs({run:(T,E)=>{E.event.prevent()}})}),Ur=(T,E)=>({key:T,value:Vs({run:E})}),Wr=(T,E,D)=>({key:T,value:Vs({run:(T,B)=>{E.apply(void 0,[T,B].concat(D))}})}),jr=T=>E=>({key:T,value:Vs({run:(T,D)=>{Rs(T,D)&&E(T,D)}})}),Gr=(T,E,D)=>{var B;return B=E.partUids[D],Ur(T,(E,D)=>{E.getSystem().getByUid(B).each(E=>{zr(E,E.element,T,D)})})},$r=(T,E)=>Ur(T,(T,D)=>{let B=D.event,M=T.getSystem().getByDom(B.target).getOrThunk(()=>Is(B.target,E=>T.getSystem().getByDom(E).toOptional(),ep).getOr(T));E(T,M,D)}),qr=T=>Ur(T,(T,E)=>{E.cut()}),Xr=T=>Ur(T,(T,E)=>{E.stop()}),Yr=(T,E)=>jr(T)(E),oX=jr(oH()),oq=jr(oN()),oK=jr(oS()),oY=(o2=of(),T=>Ur(o2,T)),ea=T=>T.dom.innerHTML,ta=(T,E)=>{let D=et(T).dom,B=Fe(D.createDocumentFragment()),M=((T,E)=>{let D=(E||document).createElement("div");return D.innerHTML=T,it(Fe(D))})(E,D);Ho(B,M),Lo(T),zo(T,B)},oa=T=>mt(T)?"#shadow-root":(T=>{let E=Re("div"),D=Fe(T.dom.cloneNode(!0));return zo(E,D),ea(E)})(Fe(T.dom.cloneNode(!1))),na=T=>oa(T),oZ=Hr([{key:t7(),value:Vs({can:(T,E)=>{let D=E.event,B=D.originator,M=D.target;return!Ze(B,T.element)||!!Ze(B,M)||(console.warn(t7()+" did not get interpreted by the desired target. \nOriginator: "+na(B)+"\nTarget: "+na(M)+"\nCheck the "+t7()+" event handlers"),!1)}})}]);var oQ,o0,o1,o2,o3=Object.freeze({__proto__:null,events:oZ});let o5=0,la=T=>{let E=(new Date).getTime();return T+"_"+Math.floor(1e9*Math.random())+ ++o5+String(E)},o9=x("alloy-id-"),o4=x("data-alloy-id"),o6=o9(),o8=o4(),ga=(T,E)=>{Object.defineProperty(T.dom,o8,{value:E,writable:!0})},pa=T=>{let E=eL(T)?T.dom[o8]:null;return A.from(E)},ha=T=>la(T),ba=T=>{let t=E=>`The component must be in a context to execute: ${E}`+(T?"\n"+na(T().element)+" is not in context.":""),o=T=>()=>{throw Error(t(T))},n=T=>()=>{console.warn(t(T))};return{debugInfo:x("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),build:o("build"),buildOrPatch:o("buildOrPatch"),addToWorld:o("addToWorld"),removeFromWorld:o("removeFromWorld"),addToGui:o("addToGui"),removeFromGui:o("removeFromGui"),getByUid:o("getByUid"),getByDom:o("getByDom"),isConnected:ep}},o7=ba(),ya=T=>H(T,T=>Ae(T,"/*")?T.substring(0,T.length-2):T),xa=(T,E)=>{let D=T.toString(),B=D.indexOf(")")+1,M=D.indexOf("("),er=D.substring(M+1,B-1).split(/,\s*/);return T.toFunctionAnnotation=()=>({name:E,parameters:ya(er)}),T},nr=la("alloy-premade"),Sa=T=>(Object.defineProperty(T.element.dom,nr,{value:T.uid,writable:!0}),Ms(nr,T)),ka=T=>be(T,nr),Ca=T=>((T,E)=>{let D=E.toString(),B=D.indexOf(")")+1,M=D.indexOf("("),er=D.substring(M+1,B-1).split(/,\s*/);return T.toFunctionAnnotation=()=>({name:"OVERRIDE",parameters:ya(er.slice(1))}),T})((E,...D)=>T(E.getApis(),E,...D),T),ni={init:()=>_a({readState:x("No State required")})},_a=T=>T,Ta=(T,E)=>{let D={};return le(T,(T,B)=>{le(T,(T,M)=>{let er=be(D,M).getOr([]);D[M]=er.concat([E(B,T)])})}),D},Ea=T=>({classes:ec(T.classes)?[]:T.classes,attributes:ec(T.attributes)?{}:T.attributes,styles:ec(T.styles)?{}:T.styles}),Aa=T=>T.cHandler,Ma=(T,E)=>({name:T,handler:E}),Da=(T,E)=>{let D={};return L(T,T=>{D[T.name()]=T.handlers(E)}),D},Ba=(T,E,D)=>{let B=E[D];return B?((T,E,D,B)=>{try{let M=ee(D,(D,M)=>{let er=D[E],ec=M[E],eu=B.indexOf(er),eg=B.indexOf(ec);if(-1===eu)throw Error("The ordering for "+T+" does not have an entry for "+er+".\nOrder specified: "+JSON.stringify(B,null,2));if(-1===eg)throw Error("The ordering for "+T+" does not have an entry for "+ec+".\nOrder specified: "+JSON.stringify(B,null,2));return eu<eg?-1:eg<eu?1:0});return tx.value(M)}catch(T){return tx.error([T])}})("Event: "+D,"name",T,B).map(T=>{var E;return E=H(T,T=>T.handler),{can:(...T)=>j(E,(E,D)=>E&&(0,D.can).apply(void 0,T),!0),abort:(...T)=>j(E,(E,D)=>E||(0,D.abort).apply(void 0,T),!1),run:(...T)=>{L(E,E=>{E.run.apply(void 0,T)})}}}):tx.error(["The event ("+D+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(H(T,T=>T.name),null,2)])},Fa=(T,E)=>((T,E)=>{var D,B;let M=(T=>{let E=[],D=[];return L(T,T=>{T.fold(T=>{E.push(T)},T=>{D.push(T)})}),{errors:E,values:D}})(T);return M.errors.length>0?(D=M.errors,tx.error(q(D))):0===(B=M.values).length?tx.value(E):tx.value(tw(E,tO.apply(void 0,B)))})(pe(T,(T,D)=>(1===T.length?tx.value(T[0].handler):Ba(T,E,D)).map(B=>{let M=(T=>{let E=eu(T)?{can:eh,abort:ep,run:T}:T;return(T,D,...B)=>{let M=[T,D].concat(B);E.abort.apply(void 0,M)?D.stop():E.can.apply(void 0,M)&&E.run.apply(void 0,M)}})(B),er=T.length>1?U(E[D],E=>N(T,T=>T.name===E)).join(" > "):T[0].name;return Ms(D,{handler:M,purpose:er})})),{}),nc="alloy.base.behaviour",nd=Dn([gn("dom","dom",{tag:"required",process:{}},Dn([os("tag"),ys("styles",{}),ys("classes",[]),ys("attributes",{}),us("value"),us("innerHtml")])),os("components"),os("uid"),ys("events",{}),ys("apis",{}),gn("eventOrder","eventOrder",xn(x({[of()]:["disabling",nc,"toggling","typeaheadevents"],[t7()]:[nc,"focusing","keying"],[oS()]:[nc,"disabling","toggling","representing"],[t1()]:[nc,"representing","streaming","invalidating"],[oN()]:[nc,"representing","item-events","tooltipping"],[tJ()]:["focusing",nc,"item-type-events"],[tP()]:["focusing",nc,"item-type-events"],[tK()]:["item-type-events","tooltipping"],[oh()]:["receiving","reflecting","tooltipping"]})),tI()),us("domModification")]),Na=T=>T.events,Va=(T,E)=>{let D=Ot(T,E);return void 0===D||""===D?[]:D.split(" ")},za=T=>void 0!==T.dom.classList,Ha=T=>Va(T,"class"),La=(T,E)=>{za(T)?T.dom.classList.add(E):((T,E,D)=>{let B=Va(T,E).concat([D]);kt(T,E,B.join(" "))})(T,"class",E)},Pa=(T,E)=>{za(T)?T.dom.classList.remove(E):((T,E,D)=>{let B=U(Va(T,E),T=>T!==D);B.length>0?kt(T,E,B.join(" ")):Et(T,E)})(T,"class",E),0===(za(T)?T.dom.classList:Ha(T)).length&&Et(T,"class")},Ua=(T,E)=>za(T)&&T.dom.classList.contains(E),Wa=(T,E)=>{L(E,E=>{La(T,E)})},ja=(T,E)=>{L(E,E=>{Pa(T,E)})},Ga=(T,E)=>Y(E,E=>Ua(T,E)),$a=T=>T.dom.value,qa=(T,E)=>{if(void 0===E)throw Error("Value.set was undefined");T.dom.value=E},Xa=(T,E,D)=>{D.fold(()=>zo(T,E),T=>{Ze(T,E)||(Ro(T,E),Po(T))})},Ya=(T,E,D)=>{let B=H(E,D),M=it(T);return L(M.slice(B.length),Po),B},Ka=(T,E,D,B)=>{let M=lt(T,E),er=B(D,M),ec=lt(T,E).map(T=>{if(M.exists(E=>!Ze(E,T))){let E=M.map(Ue).getOr("span"),D=Re(E);return Ro(T,D),D}return T});return Xa(T,er.element,ec),er},Ja=(T,E)=>{let D=eI(T),B=eI(E),M=J(B,D),er=((T,D)=>{let B={},M={};return me(T,(T,D)=>!ve(E,D)||T!==E[D],ue(B),ue(M)),{t:B,f:M}})(T).t;return{toRemove:M,toSet:er}},Za=(T,E)=>{let{class:D,style:B,...M}=j(E.dom.attributes,(T,E)=>(T[E.name]=E.value,T),{}),{toSet:er,toRemove:ec}=Ja(T.attributes,M),eu=Vt(E),{toSet:eg,toRemove:ep}=Ja(T.styles,eu),eh=za(E)?(T=>{let E=T.dom.classList,D=Array(E.length);for(let T=0;T<E.length;T++){let B=E.item(T);null!==B&&(D[T]=B)}return D})(E):Ha(E),ey=J(eh,T.classes),ex=J(T.classes,eh);return L(ec,T=>Et(E,T)),Ct(E,er),Wa(E,ex),ja(E,ey),L(ep,T=>Ht(E,T)),Bt(E,eg),T.innerHtml.fold(()=>{let D=T.domChildren;Ya(E,D,(T,D)=>{let B=lt(E,D);return Xa(E,T,B),T})},T=>{ta(E,T)}),(()=>{let D=T.value.getOrUndefined();D!==$a(E)&&qa(E,null!=D?D:"")})(),E},Qa=T=>{let E=(T=>{let E=be(T,"behaviours").getOr({});return X(eI(E),T=>{let D=E[T];return g(D)?[D.me]:[]})})(T);return((T,E)=>{let D=H(E,T=>vs(T.name(),[os("config"),ys("state",ni)])),B=qn("component.behaviours",Dn(D),T.behaviours).fold(E=>{throw Error(Kn(E)+"\nComplete spec:\n"+JSON.stringify(T,null,2))},w);return{list:E,data:ce(B,T=>{let E=T.map(T=>({config:T.config,state:T.state.init(T.config)}));return x(E)})}})(T,E)},ei=(T,E)=>{let o=()=>ex,D=Es(o7),B=Xn(qn("custom.definition",nd,T)),M=Qa(T),er=M.list,ec=M.data,eg=((T,E,D)=>{let B={...T.dom,uid:T.uid,domChildren:H(T.components,T=>T.element)},M=T.domModification.fold(()=>Ea({}),Ea),er=E.length>0?((T,E,D,B)=>{let M={...E};L(D,E=>{M[E.name()]=E.exhibit(T,B)});let er=Ta(M,(T,E)=>({name:T,modification:E})),a=T=>W(T,(T,E)=>({...E.modification,...T}),{}),ec=W(er.classes,(T,E)=>E.modification.concat(T),[]),eu=a(er.attributes),eg=a(er.styles);return Ea({classes:ec,attributes:eu,styles:eg})})(D,{"alloy.base.modification":M},E,B):M;return{...B,attributes:{...B.attributes,...er.attributes},styles:{...B.styles,...er.styles},classes:B.classes.concat(er.classes)}})(B,er,ec),ep=((T,E)=>{let D=E.filter(E=>Ue(E)===T.tag&&(!T.innerHtml.isSome()||!(T.domChildren.length>0))&&!ve(E.dom,nr)).bind(E=>((T,E)=>{try{let D=Za(T,E);return A.some(D)}catch(T){return A.none()}})(T,E)).getOrThunk(()=>(T=>{let E=Re(T.tag);Ct(E,T.attributes),Wa(E,T.classes),Bt(E,T.styles),T.innerHtml.each(T=>ta(E,T));let D=T.domChildren;return Ho(E,D),T.value.each(T=>{qa(E,T)}),E})(T));return ga(D,T.uid),D})(eg,E),eh=((T,E,D)=>{let B={"alloy.base.behaviour":Na(T)};return((T,E,D,B)=>{let M=((T,E,D)=>{let B={...D,...Da(E,T)};return Ta(B,Ma)})(T,D,B);return Fa(M,E)})(D,T.eventOrder,E,B).getOrDie()})(B,er,ec),ey=Es(B.components),ex={uid:T.uid,getSystem:D.get,config:E=>(eu(ec[E.name()])?ec[E.name()]:()=>{throw Error("Could not find "+E.name()+" in "+JSON.stringify(T,null,2))})(),hasConfigured:T=>eu(ec[T.name()]),spec:T,readState:T=>ec[T]().map(T=>T.state.readState()).getOr("not enabled"),getApis:()=>B.apis,connect:T=>{D.set(T)},disconnect:()=>{D.set(ba(o))},element:ep,syncComponents:()=>{let T=it(ep),E=X(T,T=>D.get().getByDom(T).fold(()=>[],Q));ey.set(E)},components:ey.get,events:eh};return ex},ti=T=>{let E=Ne(T);return oi({element:E})},oi=T=>{let E=Yn("external.component",Mn([os("element"),us("uid")]),T),D=Es(ba()),B=E.uid.getOrThunk(()=>ha("external"));ga(E.element,B);let M={uid:B,getSystem:D.get,config:A.none,hasConfigured:ep,connect:T=>{D.set(T)},disconnect:()=>{D.set(ba(()=>M))},getApis:()=>({}),element:E.element,spec:T,readState:x("No state"),syncComponents:b,components:x([]),events:{}};return Sa(M)},si=(T,E)=>ka(T).getOrThunk(()=>((T,E)=>{let{events:D,...B}=w(T),M=((T,E)=>{let D=be(T,"components").getOr([]);return E.fold(()=>H(D,ri),T=>H(D,(E,D)=>si(E,lt(T,D))))})(B,E),er={...B,events:{...o3,...D},components:M};return tx.value(ei(er,E))})(ve(T,"uid")?T:{uid:ha(""),...T},E).getOrDie()),ri=T=>si(T,A.none());var li=(T,E,D,B,M)=>T(D,B)?A.some(D):eu(M)&&M(D)?A.none():E(D,B,M);let ci=(T,E,D)=>{let B=T.dom,M=eu(D)?D:ep;for(;B.parentNode;){B=B.parentNode;let T=Fe(B);if(E(T))return A.some(T);if(M(T))break}return A.none()},di=(T,E,D)=>li((T,E)=>E(T),ci,T,E,D),ui=(T,E,D)=>di(T,E,D).isSome(),mi=(T,E,D)=>ci(T,T=>Ke(T,E),D),gi=(T,E)=>G(T.dom.childNodes,T=>Ke(Fe(T),E)).map(Fe),pi=(T,E)=>((T,E)=>{let D=void 0===E?document:E.dom;return Je(D)?A.none():A.from(D.querySelector(T)).map(Fe)})(E,T),hi=(T,E,D)=>li((T,E)=>Ke(T,E),mi,T,E,D),nf="aria-controls",bi=()=>{let T=la(nf);return{id:T,link:E=>{kt(E,nf,T)},unlink:T=>{Et(T,nf)}}},vi=(T,E)=>ui(E,E=>Ze(E,T.element),ep)||di(E,T=>{if(!eL(T))return!1;let E=Ot(T,"id");return void 0!==E&&E.indexOf(nf)>-1}).bind(T=>{let E=Ot(T,"id"),D=eJ(T);return pi(D,`[${nf}="${E}"]`)}).exists(E=>vi(T,E));(iJ=iK||(iK={}))[iJ.STOP=0]="STOP",iJ[iJ.NORMAL=1]="NORMAL",iJ[iJ.LOGGING=2]="LOGGING";let nv=Es({}),ny=["alloy/data/Fields","alloy/debugging/Debugging"],Si=(T,E,D)=>((T,E,D)=>{switch(be(nv.get(),T).orThunk(()=>{let E=eI(nv.get());return re(E,E=>T.indexOf(E)>-1?A.some(nv.get()[E]):A.none())}).getOr(iK.NORMAL)){case iK.NORMAL:return D(nx());case iK.LOGGING:{let B=((T,E)=>{let D=[],B=(new Date).getTime();return{logEventCut:(T,E,B)=>{D.push({outcome:"cut",target:E,purpose:B})},logEventStopped:(T,E,B)=>{D.push({outcome:"stopped",target:E,purpose:B})},logNoParent:(T,E,B)=>{D.push({outcome:"no-parent",target:E,purpose:B})},logEventNoHandlers:(T,E)=>{D.push({outcome:"no-handlers-left",target:E})},logEventResponse:(T,E,B)=>{D.push({outcome:"response",purpose:B,target:E})},write:()=>{let M=(new Date).getTime();R(["mousemove","mouseover","mouseout",oS()],T)||console.log(T,{event:T,time:M-B,target:E.dom,sequence:H(D,T=>R(["cut","stopped","response"],T.outcome)?"{"+T.purpose+"} "+T.outcome+" at ("+na(T.target)+")":T.outcome)})}}})(T,E),M=D(B);return B.write(),M}case iK.STOP:return!0}})(T,E,D),nx=x({logEventCut:b,logEventStopped:b,logNoParent:b,logEventNoHandlers:b,logEventResponse:b,write:b}),nA=x([os("menu"),os("selectedMenu")]),nO=x([os("item"),os("selectedItem")]);x(Dn(nO().concat(nA())));let nC=x(Dn(nO())),nD=ls("initSize",[os("numColumns"),os("numRows")]),Ei=()=>ls("markers",[os("backgroundMenu")].concat(nA()).concat(nO())),Ai=T=>ls("markers",H(T,os)),Mi=(T,E,D)=>((()=>{let T=Error();if(void 0!==T.stack){let E=T.stack.split("\n");G(E,T=>T.indexOf("alloy")>0&&!N(ny,E=>T.indexOf(E)>-1)).getOr("unknown")}})(),gn(E,E,D,Gn(T=>tx.value((...E)=>T.apply(void 0,E))))),Di=T=>Mi(0,T,yn(b)),Bi=T=>Mi(0,T,yn(A.none)),Fi=T=>Mi(0,T,{tag:"required",process:{}}),Ii=T=>Mi(0,T,{tag:"required",process:{}}),Ri=(T,E)=>es(T,x(E)),Ni=T=>es(T,w),nF=x(nD),zi=(T,E,D,B,M,er,ec,eu=!1)=>({x:T,y:E,bubble:D,direction:B,placement:M,restriction:er,label:`${ec}-${M}`,alwaysFit:eu}),nI=As([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),nR=nI.southeast,nH=nI.southwest,nN=nI.northeast,nU=nI.northwest,nL=nI.south,nz=nI.north,nP=nI.east,nj=nI.west,Xi=(T,E,D,B)=>{let M=T+E;return M>B?D:M<D?B:M},Yi=(T,E,D)=>Math.min(Math.max(T,E),D),Ki=(T,E)=>Z(["left","right","top","bottom"],D=>be(E,D).map(E=>((T,E)=>{switch(E){case 1:return T.x;case 0:return T.x+T.width;case 2:return T.y;case 3:return T.y+T.height}})(T,E))),nW="layout",Zi=T=>T.x,Qi=(T,E)=>T.x+T.width/2-E.width/2,el=(T,E)=>T.x+T.width-E.width,tl=(T,E)=>T.y-E.height,ol=T=>T.y+T.height,nl=(T,E)=>T.y+T.height/2-E.height/2,sl=(T,E,D)=>zi(Zi(T),ol(T),D.southeast(),nR(),"southeast",Ki(T,{left:1,top:3}),nW),rl=(T,E,D)=>zi(el(T,E),ol(T),D.southwest(),nH(),"southwest",Ki(T,{right:0,top:3}),nW),al=(T,E,D)=>zi(Zi(T),tl(T,E),D.northeast(),nN(),"northeast",Ki(T,{left:1,bottom:2}),nW),il=(T,E,D)=>zi(el(T,E),tl(T,E),D.northwest(),nU(),"northwest",Ki(T,{right:0,bottom:2}),nW),ll=(T,E,D)=>zi(Qi(T,E),tl(T,E),D.north(),nz(),"north",Ki(T,{bottom:2}),nW),cl=(T,E,D)=>zi(Qi(T,E),ol(T),D.south(),nL(),"south",Ki(T,{top:3}),nW),dl=(T,E,D)=>zi(T.x+T.width,nl(T,E),D.east(),nP(),"east",Ki(T,{left:0}),nW),ul=(T,E,D)=>zi(T.x-E.width,nl(T,E),D.west(),nj(),"west",Ki(T,{right:1}),nW),ml=()=>[sl,rl,al,il,cl,ll,dl,ul],gl=()=>[rl,sl,il,al,cl,ll,dl,ul],pl=()=>[al,il,sl,rl,ll,cl],hl=()=>[il,al,rl,sl,ll,cl],fl=()=>[sl,rl,al,il,cl,ll],bl=()=>[rl,sl,il,al,cl,ll];var nG=Object.freeze({__proto__:null,events:T=>Hr([Ur(oh(),(E,D)=>{let B=T.channels,M=eI(B),er=D.universal?M:U(M,T=>R(D.channels,T));L(er,T=>{let M=B[T],er=M.schema,ec=Yn("channel["+T+"] data\nReceiver: "+na(E.element),er,D.data);M.onReceive(E,ec)})})])}),nJ=[ns("channels",$n(tx.value,Mn([Fi("onReceive"),ys("schema",tI())])))];let xl=(T,E,D)=>oK((B,M)=>{D(B,T,E)}),wl=T=>({key:T,value:void 0}),Sl=(T,E,D,B,M,er,ec)=>{let i=T=>ye(T,D)?T[D]():A.none(),eu=ce(M,(T,E)=>((T,E,D)=>{let B=D.toString(),M=B.indexOf(")")+1,er=B.indexOf("("),ec=B.substring(er+1,M-1).split(/,\s*/);return T.toFunctionAnnotation=()=>({name:E,parameters:ya(ec.slice(0,1).concat(ec.slice(3)))}),T})((B,...M)=>{let er=[B].concat(M);return B.config({name:x(D)}).fold(()=>{throw Error("We could not find any behaviour configuration for: "+D+". Using API: "+E)},E=>{let D=Array.prototype.slice.call(er,1);return T.apply(void 0,[B,E.config,E.state].concat(D))})},E,T)),eg={...ce(er,(T,E)=>xa(T,E)),...eu,revoke:k(wl,D),config:E=>{let B=Yn(D+"-config",T,E);return{key:D,value:{config:B,me:eg,configAsRaw:Qt(()=>Yn(D+"-config",T,E)),initialConfig:E,state:ec}}},schema:x(E),exhibit:(T,E)=>Se(i(T),be(B,"exhibit"),(T,D)=>D(E,T.config,T.state)).getOrThunk(()=>Ea({})),name:x(D),handlers:T=>i(T).map(T=>be(B,"events").getOr(()=>({}))(T.config,T.state)).getOr({})};return eg},kl=T=>Ds(T),n$=Mn([os("fields"),os("name"),ys("active",{}),ys("apis",{}),ys("state",ni),ys("extra",{})]),Ol=T=>{let E=Yn("Creating behaviour: "+T.name,n$,T);return((T,E,D,B,M,er)=>{let ec=Mn(T),eu=vs(E,[ms("config",Mn(T))]);return Sl(ec,eu,E,D,B,M,er)})(E.fields,E.name,E.active,E.apis,E.extra,E.state)},nX=Mn([os("branchKey"),os("branches"),os("name"),ys("active",{}),ys("apis",{}),ys("state",ni),ys("extra",{})]),Tl=T=>{let E=Yn("Creating behaviour: "+T.name,nX,T);return((T,E,D,B,M,er)=>{let ec=vs(E,[ms("config",T)]);return Sl(T,ec,E,D,B,M,er)})(Jn(E.branchKey,E.branches),E.name,E.active,E.apis,E.extra,E.state)},nq=x(void 0),nK=Ol({fields:nJ,name:"receiving",active:nG});var nY=Object.freeze({__proto__:null,exhibit:(T,E)=>Ea({classes:[],styles:E.useFixed()?{}:{position:"relative"}})});let Dl=T=>T.dom.focus(),Bl=T=>T.dom.blur(),Fl=T=>{let E=eJ(T).dom;return T.dom===E.activeElement},Il=(T=$o())=>A.from(T.dom.activeElement).map(Fe),Rl=T=>Il(eJ(T)).filter(E=>T.dom.contains(E.dom)),Nl=(T,E)=>{let D=eJ(E),B=Il(D).bind(T=>{let o=E=>Ze(T,E);return o(E)?A.some(E):((T,E)=>{let o=T=>{for(let D=0;D<T.childNodes.length;D++){let B=Fe(T.childNodes[D]);if(E(B))return A.some(B);let M=o(T.childNodes[D]);if(M.isSome())return M}return A.none()};return o(T.dom)})(E,o)}),M=T(E);return B.each(T=>{Il(D).filter(E=>Ze(E,T)).fold(()=>{Dl(T)},b)}),M},Vl=(T,E,D,B,M)=>{let r=T=>T+"px";return{position:T,left:E.map(r),top:D.map(r),right:B.map(r),bottom:M.map(r)}},zl=(T,E)=>{Ft(T,{...E,position:A.some(E.position)})},nZ=As([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Ll=(T,E,D,B,M,er)=>{let ec=E.rect,eu=ec.x-D,eg=ec.y-B,ep=M-(eu+ec.width),eh=er-(eg+ec.height),ey=A.some(eu),ex=A.some(eg),eO=A.some(ep),eD=A.some(eh),eI=A.none();return E.direction.fold(()=>Vl(T,ey,ex,eI,eI),()=>Vl(T,eI,ex,eO,eI),()=>Vl(T,ey,eI,eI,eD),()=>Vl(T,eI,eI,eO,eD),()=>Vl(T,ey,ex,eI,eI),()=>Vl(T,ey,eI,eI,eD),()=>Vl(T,ey,ex,eI,eI),()=>Vl(T,eI,ex,eO,eI))},Pl=(T,E)=>T.fold(()=>{let T=E.rect;return Vl("absolute",A.some(T.x),A.some(T.y),A.none(),A.none())},(T,D,B,M)=>Ll("absolute",E,T,D,B,M),(T,D,B,M)=>Ll("fixed",E,T,D,B,M)),Ul=(T,E)=>{let D=k(Yo,E),B=T.fold(D,D,()=>{let T=Uo();return Yo(E).translate(-T.left,-T.top)}),M=Zt(E),er=jt(E);return Ko(B.left,B.top,M,er)},Wl=(T,E)=>E.fold(()=>T.fold(en,en,Ko),E=>T.fold(x(E),x(E),()=>{let D=jl(T,E.x,E.y);return Ko(D.left,D.top,E.width,E.height)})),jl=(T,E,D)=>{let B=Gt(E,D);return T.fold(x(B),x(B),()=>{let T=Uo();return B.translate(-T.left,-T.top)})};nZ.none;let nQ=nZ.relative,n0=nZ.fixed,n1="data-alloy-placement",Xl=T=>_t(T,n1),n2=As([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),Kl=(T,E,D,B)=>{let M=T.bubble,er=M.offset,ec=((T,E,D)=>{let n=(B,M)=>E[B].map(E=>{let er="top"===B||"bottom"===B,ec=er?D.top:D.left,eu=("left"===B||"top"===B?Math.max:Math.min)(E,M)+ec;return er?Yi(eu,T.y,T.bottom):Yi(eu,T.x,T.right)}).getOr(M),B=n("left",T.x),M=n("top",T.y),er=n("right",T.right),ec=n("bottom",T.bottom);return Ko(B,M,er-B,ec-M)})(B,T.restriction,er),eu=T.x+er.left,eg=T.y+er.top,ep=Ko(eu,eg,E,D),{originInBounds:eh,sizeInBounds:ey,visibleW:ex,visibleH:eO}=((T,E)=>{let{x:D,y:B,right:M,bottom:er}=E,{x:ec,y:eu,right:eg,bottom:ep,width:eh,height:ey}=T;return{originInBounds:ec>=D&&ec<=M&&eu>=B&&eu<=er,sizeInBounds:eg<=M&&eg>=D&&ep<=er&&ep>=B,visibleW:Math.min(eh,ec>=D?M-ec:eg-D),visibleH:Math.min(ey,eu>=B?er-eu:ep-B)}})(ep,ec),eD=eh&&ey,eI=eD?ep:((T,E)=>{let{x:D,y:B,right:M,bottom:er}=E,{x:ec,y:eu,width:eg,height:ep}=T,eh=Math.max(D,M-eg),ey=Math.max(B,er-ep),ex=Yi(ec,D,eh),eO=Yi(eu,B,ey),eD=Math.min(ex+eg,M)-ex,eI=Math.min(eO+ep,er)-eO;return Ko(ex,eO,eD,eI)})(ep,ec),eR=eI.width>0&&eI.height>0,{maxWidth:eH,maxHeight:eN}=((T,E,D)=>{let B=x(E.bottom-D.y),M=x(D.bottom-E.y),er=T.fold(M,M,B,B,M,B,M,M),ec=x(E.right-D.x),eu=x(D.right-E.x),eg=T.fold(eu,ec,eu,ec,eu,eu,eu,ec);return{maxWidth:eg,maxHeight:er}})(T.direction,eI,B),eU={rect:eI,maxHeight:eN,maxWidth:eH,direction:T.direction,placement:T.placement,classes:{on:M.classesOn,off:M.classesOff},layout:T.label,testY:eg};return eD||T.alwaysFit?n2.fit(eU):n2.nofit(eU,ex,eO,eR)},Jl=T=>{let E=Es(A.none()),o=()=>E.get().each(T);return{clear:()=>{o(),E.set(A.none())},isSet:()=>E.get().isSome(),get:()=>E.get(),set:T=>{o(),E.set(A.some(T))}}},Zl=()=>Jl(T=>T.unbind()),Ql=()=>{let T=Jl(b);return{...T,on:E=>T.get().each(E)}},tc=(T,E,D)=>Fo(T,E,eh,D,!1),oc=(T,E,D)=>Fo(T,E,eh,D,!0),n3=["top","bottom","right","left"],n5="data-alloy-transition-timer",ac=(T,D,B,M,er,ec)=>{let eu=ec.exists(T=>{let E=M.mode;return"all"===E||T[E]!==er[E]});if(eu||Ga(T,M.classes)){Dt(T,"position",B.position);let ec=Ul(D,T),eg=Pl(D,{...er,rect:ec}),ep=Z(n3,T=>eg[T]);((T,E)=>{let o=T=>parseFloat(T).toFixed(3);return he(E,(E,D)=>!((T,E,D=S)=>Se(T,E,D).getOr(T.isNone()&&E.isNone()))(T[D].map(o),E.map(o))).isSome()})(B,ep)&&(Ft(T,ep),eu&&(Wa(T,M.classes),_t(T,n5).each(E=>{clearTimeout(parseInt(E,10)),Et(T,n5)}),((T,D)=>{let B;let M=Zl(),er=Zl(),a=E=>{var D;let B=null!==(D=E.raw.pseudoElement)&&void 0!==D?D:"";return Ze(E.target,T)&&!De(B)&&R(n3,E.raw.propertyName)},i=E=>{if(m(E)||a(E)){M.clear(),er.clear();let ec=null==E?void 0:E.raw.type;(m(ec)||ec===t9())&&(clearTimeout(B),Et(T,n5),ja(T,D.classes))}},ec=tc(T,t4(),E=>{a(E)&&(ec.unbind(),M.set(tc(T,t9(),i)),er.set(tc(T,t5(),i)))}),eu=(T=>{let t=E=>{let D=It(T,E).split(/\s*,\s*/);return U(D,De)},o=T=>{if(E(T)&&/^[\d.]+/.test(T)){let E=parseFloat(T);return Ae(T,"ms")?E:1e3*E}return 0},D=t("transition-delay"),B=t("transition-duration");return j(B,(T,E,B)=>{let M=o(D[B])+o(E);return Math.max(T,M)},0)})(T);requestAnimationFrame(()=>{kt(T,n5,B=setTimeout(i,eu+17))})})(T,M)),Lt(T))}else ja(T,M.classes)},ic=(T,E)=>{((T,E)=>{let D=e$.max(T,E,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);Dt(T,"max-height",D+"px")})(T,Math.floor(E))},n9=x((T,E)=>{ic(T,E),Bt(T,{"overflow-x":"hidden","overflow-y":"auto"})}),n4=x((T,E)=>{ic(T,E)}),dc=(T,E,D)=>void 0===T[E]?D:T[E],uc=(T,E,D,B)=>{let M=((T,E,D,B)=>{Ht(E,"max-height"),Ht(E,"max-width");let M={width:Zt(E),height:jt(E)};return((T,E,D,B,M,er)=>{let ec=B.width,eu=B.height,l=(E,eg,ep,eh,ey)=>{let ex=E(D,B,M,T,er),eO=Kl(ex,ec,eu,er);return eO.fold(x(eO),(T,E,D,B)=>(ey===B?D>eh||E>ep:!ey&&B)?eO:n2.nofit(eg,ep,eh,ey))};return j(E,(T,E)=>{let D=k(l,E);return T.fold(x(T),D)},n2.nofit({rect:D,maxHeight:B.height,maxWidth:B.width,direction:nR(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:D.y},-1,-1,!1)).fold(w,w)})(E,B.preference,T,M,D,B.bounds)})(T,E,D,B);return((T,E,D)=>{let B=Pl(D.origin,E);D.transition.each(M=>{ac(T,D.origin,B,M,E,D.lastPlacement)}),zl(T,B)})(E,M,B),kt(E,n1,M.placement),((T,E)=>{let D=E.classes;ja(T,D.off),Wa(T,D.on)})(E,M),((T,E,D)=>{(0,D.maxHeightFunction)(T,E.maxHeight)})(E,M,B),((T,E,D)=>{(0,D.maxWidthFunction)(T,E.maxWidth)})(E,M,B),{layout:M.layout,placement:M.placement}},n6=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],gc=(T,E,D,B=1)=>{let M=T*B,er=E*B,a=T=>be(D,T).getOr([]),i=(T,E,D)=>{let B=J(n6,D);return{offset:Gt(T,E),classesOn:X(D,a),classesOff:X(B,a)}};return{southeast:()=>i(-T,E,["top","alignLeft"]),southwest:()=>i(T,E,["top","alignRight"]),south:()=>i(-T/2,E,["top","alignCentre"]),northeast:()=>i(-T,-E,["bottom","alignLeft"]),northwest:()=>i(T,-E,["bottom","alignRight"]),north:()=>i(-T/2,-E,["bottom","alignCentre"]),east:()=>i(T,-E/2,["valignCentre","left"]),west:()=>i(-T,-E/2,["valignCentre","right"]),insetNortheast:()=>i(M,er,["top","alignLeft","inset"]),insetNorthwest:()=>i(-M,er,["top","alignRight","inset"]),insetNorth:()=>i(-M/2,er,["top","alignCentre","inset"]),insetSoutheast:()=>i(M,-er,["bottom","alignLeft","inset"]),insetSouthwest:()=>i(-M,-er,["bottom","alignRight","inset"]),insetSouth:()=>i(-M/2,-er,["bottom","alignCentre","inset"]),insetEast:()=>i(-M,-er/2,["valignCentre","right","inset"]),insetWest:()=>i(M,-er/2,["valignCentre","left","inset"])}},pc=()=>gc(0,0,{}),fc=(T,E)=>D=>"rtl"===bc(D)?E:T,bc=T=>"rtl"===It(T,"direction")?"rtl":"ltr";(i$=iY||(iY={})).TopToBottom="toptobottom",i$.BottomToTop="bottomtotop";let n8="data-alloy-vertical-dir",xc=T=>ui(T,T=>eL(T)&&Ot(T,"data-alloy-vertical-dir")===iY.BottomToTop),wc=()=>vs("layouts",[os("onLtr"),os("onRtl"),us("onBottomLtr"),us("onBottomRtl")]),Sc=(T,E,D,B,M,er,ec)=>{let eu=ec.map(xc).getOr(!1),eg=E.layouts.map(E=>E.onLtr(T)),ep=E.layouts.map(E=>E.onRtl(T)),eh=eu?E.layouts.bind(E=>E.onBottomLtr.map(E=>E(T))).or(eg).getOr(M):eg.getOr(D),ey=eu?E.layouts.bind(E=>E.onBottomRtl.map(E=>E(T))).or(ep).getOr(er):ep.getOr(B);return fc(eh,ey)(T)};var n7=[os("hotspot"),us("bubble"),ys("overrides",{}),wc(),Ri("placement",(T,E,D)=>{let B=E.hotspot,M=Ul(D,B.element),er=Sc(T.element,E,fl(),bl(),pl(),hl(),A.some(E.hotspot.element));return A.some(w({anchorBox:M,bubble:E.bubble.getOr(pc()),overrides:E.overrides,layouts:er}))})],rn=[os("x"),os("y"),ys("height",0),ys("width",0),ys("bubble",pc()),ys("overrides",{}),wc(),Ri("placement",(T,E,D)=>{let B=jl(D,E.x,E.y),M=Ko(B.left,B.top,E.width,E.height),er=Sc(T.element,E,ml(),gl(),ml(),gl(),A.none());return A.some(w({anchorBox:M,bubble:E.bubble,overrides:E.overrides,layouts:er}))})];let ra=As([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),_c=T=>T.fold(w,(T,E,D)=>T.translate(-E,-D)),Tc=T=>T.fold(w,w),Ec=T=>j(T,(T,E)=>T.translate(E.left,E.top),Gt(0,0)),Ac=T=>{let E=H(T,Tc);return Ec(E)},rc=ra.screen,ru=ra.absolute,Bc=(T,E,D)=>{let B=et(T.element),M=Uo(B),er=((T,E,D)=>{let B=nt(D.root).dom;return A.from(B.frameElement).map(Fe).filter(E=>{let D=et(E),B=et(T.element);return Ze(D,B)}).map(Xt)})(T,0,D).getOr(M);return ru(er,M.left,M.top)},Fc=(T,E,D,B)=>{let M=rc(Gt(T,E));return A.some({point:M,width:D,height:B})},Ic=(T,E,D,B,M)=>T.map(T=>{var er;let ec=[E,T.point],eu=B.fold(()=>Ac(ec),()=>Ac(ec),()=>(T=>{let E=H(T,_c);return Ec(E)})(ec)),eg=(er=eu.left,{x:er,y:eu.top,width:T.width,height:T.height}),ep=D.showAbove?pl():fl(),eh=D.showAbove?hl():bl(),ey=Sc(M,D,ep,eh,ep,eh,A.none());return w({anchorBox:eg,bubble:D.bubble.getOr(pc()),overrides:D.overrides,layouts:ey})});var rf=[os("node"),os("root"),us("bubble"),wc(),ys("overrides",{}),ys("showAbove",!1),Ri("placement",(T,E,D)=>{let B=Bc(T,0,E);return E.node.filter(yt).bind(M=>{let er=M.dom.getBoundingClientRect(),ec=Fc(er.left,er.top,er.width,er.height),eu=E.node.getOr(T.element);return Ic(ec,B,E,D,eu)})})];let Nc=(T,E,D,B)=>({start:T,soffset:E,finish:D,foffset:B}),rv=As([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ry=(rv.before,rv.on,rv.after,T=>T.fold(w,w,w)),rA=As([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),rS={domRange:rA.domRange,relative:rA.relative,exact:rA.exact,exactFromRange:T=>rA.exact(T.start,T.soffset,T.finish,T.foffset),getWin:T=>{let E=T.match({domRange:T=>Fe(T.startContainer),relative:(T,E)=>ry(T),exact:(T,E,D,B)=>T});return nt(E)},range:Nc},Pc=(T,E,D)=>{let B=T.document.createRange();return E.fold(T=>{B.setStartBefore(T.dom)},(T,E)=>{B.setStart(T.dom,E)},T=>{B.setStartAfter(T.dom)}),((T,E)=>{E.fold(E=>{T.setEndBefore(E.dom)},(E,D)=>{T.setEnd(E.dom,D)},E=>{T.setEndAfter(E.dom)})})(B,D),B},Uc=(T,E,D,B,M)=>{let er=T.document.createRange();return er.setStart(E.dom,D),er.setEnd(B.dom,M),er},Wc=T=>({left:T.left,top:T.top,right:T.right,bottom:T.bottom,width:T.width,height:T.height}),rO=As([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Gc=(T,E,D)=>E(Fe(D.startContainer),D.startOffset,Fe(D.endContainer),D.endOffset),$c=(T,E)=>((T,E)=>{let D=E.match({domRange:T=>({ltr:x(T),rtl:A.none}),relative:(E,D)=>({ltr:Qt(()=>Pc(T,E,D)),rtl:Qt(()=>A.some(Pc(T,D,E)))}),exact:(E,D,B,M)=>({ltr:Qt(()=>Uc(T,E,D,B,M)),rtl:Qt(()=>A.some(Uc(T,B,M,E,D)))})});return((T,E)=>{let D=E.ltr();return D.collapsed?E.rtl().filter(T=>!1===T.collapsed).map(T=>rO.rtl(Fe(T.endContainer),T.endOffset,Fe(T.startContainer),T.startOffset)).getOrThunk(()=>Gc(0,rO.ltr,D)):Gc(0,rO.ltr,D)})(0,D)})(T,E).match({ltr:(E,D,B,M)=>{let er=T.document.createRange();return er.setStart(E.dom,D),er.setEnd(B.dom,M),er},rtl:(E,D,B,M)=>{let er=T.document.createRange();return er.setStart(B.dom,M),er.setEnd(E.dom,D),er}});rO.ltr,rO.rtl;let qc=(T,E,D)=>U(((T,E)=>{let D=eu(E)?E:ep,B=T.dom,M=[];for(;null!==B.parentNode&&void 0!==B.parentNode;){let T=B.parentNode,E=Fe(T);if(M.push(E),!0===D(E))break;B=T}return M})(T,D),E),Xc=(T,E)=>((T,E)=>{let D=void 0===E?document:E.dom;return Je(D)?[]:H(D.querySelectorAll(T),Fe)})(E,T),Yc=T=>{if(T.rangeCount>0){let E=T.getRangeAt(0),D=T.getRangeAt(T.rangeCount-1);return A.some(Nc(Fe(E.startContainer),E.startOffset,Fe(D.endContainer),D.endOffset))}return A.none()},Kc=T=>{if(null===T.anchorNode||null===T.focusNode)return Yc(T);{let E=Fe(T.anchorNode),D=Fe(T.focusNode);return((T,E,D,B)=>{let M=((T,E,D,B)=>{let M=et(T).dom.createRange();return M.setStart(T.dom,E),M.setEnd(D.dom,B),M})(T,E,D,B),er=Ze(T,D)&&E===B;return M.collapsed&&!er})(E,T.anchorOffset,D,T.focusOffset)?A.some(Nc(E,T.anchorOffset,D,T.focusOffset)):Yc(T)}},Jc=(T,E)=>(T=>{let E=T.getClientRects(),D=E.length>0?E[0]:T.getBoundingClientRect();return D.width>0||D.height>0?A.some(D).map(Wc):A.none()})($c(T,E)),rC=((T,E)=>{let o=E=>T(E)?A.from(E.dom.nodeValue):A.none();return{get:E=>{if(!T(E))throw Error("Can only get text value of a text node");return o(E).getOr("")},getOption:o,set:(E,D)=>{if(!T(E))throw Error("Can only set raw text value of a text node");E.dom.nodeValue=D}}})(ez),Qc=(T,E)=>({element:T,offset:E}),ed=(T,E)=>ez(T)?Qc(T,E):((T,E)=>{let D=it(T);if(0===D.length)return Qc(T,E);if(E<D.length)return Qc(D[E],0);{let T=D[D.length-1],E=ez(T)?rC.get(T).length:it(T).length;return Qc(T,E)}})(T,E),td=T=>void 0!==T.foffset,od=(T,E)=>E.getSelection.getOrThunk(()=>()=>A.from(T.getSelection()).filter(T=>T.rangeCount>0).bind(Kc))().map(T=>{if(td(T)){let E=ed(T.start,T.soffset),D=ed(T.finish,T.foffset);return rS.range(E.element,E.offset,D.element,D.offset)}return T});var rB=[us("getSelection"),os("root"),us("bubble"),wc(),ys("overrides",{}),ys("showAbove",!1),Ri("placement",(T,E,D)=>{let B=nt(E.root).dom,M=Bc(T,0,E),er=od(B,E).bind(T=>{if(td(T)){let E=(T=>{let E=T.getBoundingClientRect();return E.width>0||E.height>0?A.some(E).map(Wc):A.none()})($c(B,rS.exactFromRange(T))).orThunk(()=>{let E=Ne("\uFEFF");Ro(T.start,E);let D=Jc(B,rS.exact(E,0,E,1));return Po(E),D});return E.bind(T=>Fc(T.left,T.top,T.width,T.height))}{let E=ce(T,T=>T.dom.getBoundingClientRect()),D={left:Math.min(E.firstCell.left,E.lastCell.left),right:Math.max(E.firstCell.right,E.lastCell.right),top:Math.min(E.firstCell.top,E.lastCell.top),bottom:Math.max(E.firstCell.bottom,E.lastCell.bottom)};return Fc(D.left,D.top,D.right-D.left,D.bottom-D.top)}}),ec=od(B,E).bind(T=>td(T)?eL(T.start)?A.some(T.start):rt(T.start):A.some(T.firstCell)).getOr(T.element);return Ic(er,M,E,D,ec)})];let rI="link-layout",rd=T=>T.x+T.width,ad=(T,E)=>T.x-E.width,id=(T,E)=>T.y-E.height+T.height,ld=T=>T.y,cd=(T,E,D)=>zi(rd(T),ld(T),D.southeast(),nR(),"southeast",Ki(T,{left:0,top:2}),rI),dd=(T,E,D)=>zi(ad(T,E),ld(T),D.southwest(),nH(),"southwest",Ki(T,{right:1,top:2}),rI),ud=(T,E,D)=>zi(rd(T),id(T,E),D.northeast(),nN(),"northeast",Ki(T,{left:0,bottom:3}),rI),md=(T,E,D)=>zi(ad(T,E),id(T,E),D.northwest(),nU(),"northwest",Ki(T,{right:1,bottom:3}),rI),gd=()=>[cd,dd,ud,md],pd=()=>[dd,cd,md,ud];var rR=Jn("type",{selection:rB,node:rf,hotspot:n7,submenu:[os("item"),wc(),ys("overrides",{}),Ri("placement",(T,E,D)=>{let B=Ul(D,E.item.element),M=Sc(T.element,E,gd(),pd(),gd(),pd(),A.none());return A.some(w({anchorBox:B,bubble:pc(),overrides:E.overrides,layouts:M}))})],makeshift:rn});let rH=[ds("classes",tH),ks("mode","all",["all","layout","placement"])],rN=[ys("useFixed",ep),us("getBounds")],rU=[ns("anchor",rR),vs("transition",rH)],xd=(T,E,D,B,M,er)=>{let ec=Yn("placement.info",Dn(rU),M),eu=ec.anchor,eg=B.element,ep=D.get(B.uid);Nl(()=>{Dt(eg,"position","fixed");let M=Nt(eg,"visibility");Dt(eg,"visibility","hidden");let eh=E.useFixed()?(()=>{let T=document.documentElement;return n0(0,0,T.clientWidth,T.clientHeight)})():(T=>{let E=Xt(T.element),D=T.element.dom.getBoundingClientRect();return nQ(E.left,E.top,D.width,D.height)})(T);eu.placement(T,eu,eh).each(T=>{var M,eu;let eg=er.orThunk(()=>E.getBounds.map(_)),ey=(M=ec.transition,((T,E,D,B,M,er,ec,eu)=>{let eg=dc(ec,"maxHeightFunction",n9()),ep=dc(ec,"maxWidthFunction",b),eh=T.anchorBox,ey=T.origin,ex={bounds:Wl(ey,er),origin:ey,preference:B,maxHeightFunction:eg,maxWidthFunction:ep,lastPlacement:M,transition:eu};return uc(eh,E,D,ex)})({anchorBox:T.anchorBox,origin:eh},B.element,T.bubble,T.layouts,ep,eg,T.overrides,M));D.set(B.uid,ey)}),M.fold(()=>{Ht(eg,"visibility")},T=>{Dt(eg,"visibility",T)}),Nt(eg,"left").isNone()&&Nt(eg,"top").isNone()&&Nt(eg,"right").isNone()&&Nt(eg,"bottom").isNone()&&xe(Nt(eg,"position"),"fixed")&&Ht(eg,"position")},eg)};var rL=Object.freeze({__proto__:null,position:(T,E,D,B,M)=>{let er=A.none();xd(T,E,D,B,M,er)},positionWithinBounds:xd,getMode:(T,E,D)=>E.useFixed()?"fixed":"absolute",reset:(T,E,D,B)=>{let M=B.element;L(["position","left","right","top","bottom"],T=>Ht(M,T)),Et(M,n1),D.clear(B.uid)}});let rz=Ol({fields:rN,name:"positioning",active:nY,apis:rL,state:Object.freeze({__proto__:null,init:()=>{let T={};return _a({readState:()=>T,clear:E=>{g(E)?delete T[E]:T={}},set:(E,D)=>{T[E]=D},get:E=>be(T,E)})}})}),kd=T=>T.getSystem().isConnected(),Cd=T=>{Fr(T,oN());let E=T.components();L(E,Cd)},Od=T=>{let E=T.components();L(E,Od),Fr(T,oH())},_d=(T,E)=>{T.getSystem().addToWorld(E),yt(T.element)&&Od(E)},Td=T=>{Cd(T),T.getSystem().removeFromWorld(T)},Ed=(T,E)=>{zo(T.element,E.element)},Ad=(T,E)=>{Md(T,E,zo)},Md=(T,E,D)=>{T.getSystem().addToWorld(E),D(T.element,E.element),yt(T.element)&&Od(E),T.syncComponents()},Dd=T=>{Cd(T),Po(T.element),T.getSystem().removeFromWorld(T)},Bd=T=>{let E=st(T.element).bind(E=>T.getSystem().getByDom(E).toOptional());Dd(T),E.each(T=>{T.syncComponents()})},Fd=T=>{let E=T.components();L(E,Dd),Lo(T.element),T.syncComponents()},Id=(T,E)=>{Nd(T,E,zo)},Rd=(T,E)=>{Nd(T,E,No)},Nd=(T,E,D)=>{D(T,E.element);let B=it(E.element);L(B,T=>{E.getByDom(T).each(Od)})},Vd=T=>{let E=it(T.element);L(E,E=>{T.getByDom(E).each(Cd)}),Po(T.element)},zd=(T,E,D,B)=>{D.get().each(E=>{Fd(T)});let M=E.getAttachPoint(T);Ad(M,T);let er=T.getSystem().build(B);return Ad(T,er),D.set(er),er},Hd=(T,E,D,B)=>{let M=zd(T,E,D,B);return E.onOpen(T,M),M},Ld=(T,E,D)=>{D.get().each(B=>{Fd(T),Bd(T),E.onClose(T,B),D.clear()})},Pd=(T,E,D)=>D.isOpen(),Ud=(T,E,D)=>{var B,M;let er=E.getAttachPoint(T);Dt(T.element,"position",rz.getMode(er)),B="visibility",M=E.cloakVisibilityAttr,Nt(T.element,B).fold(()=>{Et(T.element,M)},E=>{kt(T.element,M,E)}),Dt(T.element,B,"hidden")},Wd=(T,E,D)=>{var B;B=T.element,N(["top","left","right","bottom"],T=>Nt(B,T).isSome())||Ht(T.element,"position"),((T,E,D)=>{_t(T.element,D).fold(()=>Ht(T.element,E),D=>Dt(T.element,E,D))})(T,"visibility",E.cloakVisibilityAttr)};var rP=Object.freeze({__proto__:null,cloak:Ud,decloak:Wd,open:Hd,openWhileCloaked:(T,E,D,B,M)=>{Ud(T,E),Hd(T,E,D,B),M(),Wd(T,E)},close:Ld,isOpen:Pd,isPartOf:(T,E,D,B)=>Pd(0,0,D)&&D.get().exists(D=>E.isPartOf(T,D,B)),getState:(T,E,D)=>D.get(),setContent:(T,E,D,B)=>D.get().map(()=>zd(T,E,D,B))}),rj=Object.freeze({__proto__:null,events:(T,E)=>Hr([Ur(ow(),(D,B)=>{Ld(D,T,E)})])}),rW=[Di("onOpen"),Di("onClose"),os("isPartOf"),os("getAttachPoint"),ys("cloakVisibilityAttr","data-precloak-visibility")],rG=Object.freeze({__proto__:null,init:()=>{let T=Ql(),E=x("not-implemented");return _a({readState:E,isOpen:T.isSet,clear:T.clear,set:T.set,get:T.get})}});let rJ=Ol({fields:rW,name:"sandboxing",active:rj,apis:rP,state:rG}),r$=x("dismiss.popups"),rX=x("reposition.popups"),rq=x("mouse.released"),rK=Mn([ys("isExtraPart",ep),vs("fireEventInstead",[ys("event",oU())])]),Qd=T=>{let E=Yn("Dismissal",rK,T);return{[r$()]:{schema:Mn([os("target")]),onReceive:(T,D)=>{rJ.isOpen(T)&&(rJ.isPartOf(T,D.target)||E.isExtraPart(T,D.target)||E.fireEventInstead.fold(()=>rJ.close(T),E=>Fr(T,E.event)))}}}},rY=Mn([vs("fireEventInstead",[ys("event",oL())]),is("doReposition")]),tu=T=>{let E=Yn("Reposition",rY,T);return{[rX()]:{onReceive:T=>{rJ.isOpen(T)&&E.fireEventInstead.fold(()=>E.doReposition(T),E=>Fr(T,E.event))}}}},ou=(T,E,D)=>{E.store.manager.onLoad(T,E,D)},nu=(T,E,D)=>{E.store.manager.onUnload(T,E,D)};var rZ=Object.freeze({__proto__:null,onLoad:ou,onUnload:nu,setValue:(T,E,D,B)=>{E.store.manager.setValue(T,E,D,B)},getValue:(T,E,D)=>E.store.manager.getValue(T,E,D),getState:(T,E,D)=>D}),rQ=Object.freeze({__proto__:null,events:(T,E)=>{let D=T.resetOnDom?[oX((D,B)=>{ou(D,T,E)}),oq((D,B)=>{nu(D,T,E)})]:[xl(T,E,ou)];return Hr(D)}});let au=()=>{let T=Es(null);return _a({set:T.set,get:T.get,isNotSet:()=>null===T.get(),clear:()=>{T.set(null)},readState:()=>({mode:"memory",value:T.get()})})},iu=()=>{let T=Es({}),E=Es({});return _a({readState:()=>({mode:"dataset",dataByValue:T.get(),dataByText:E.get()}),lookup:D=>be(T.get(),D).orThunk(()=>be(E.get(),D)),update:D=>{let B=T.get(),M=E.get(),er={},ec={};L(D,T=>{er[T.value]=T,be(T,"meta").each(E=>{be(E,"text").each(E=>{ec[E]=T})})}),T.set({...B,...er}),E.set({...M,...ec})},clear:()=>{T.set({}),E.set({})}})};var r0=Object.freeze({__proto__:null,memory:au,dataset:iu,manual:()=>_a({readState:b}),init:T=>T.store.manager.state(T)});let cu=(T,E,D,B)=>{let M=E.store;D.update([B]),M.setValue(T,B),E.onSetValue(T,B)};var r1=[us("initialValue"),os("getFallbackEntry"),os("getDataKey"),os("setValue"),Ri("manager",{setValue:cu,getValue:(T,E,D)=>{let B=E.store,M=B.getDataKey(T);return D.lookup(M).getOrThunk(()=>B.getFallbackEntry(M))},onLoad:(T,E,D)=>{E.store.initialValue.each(B=>{cu(T,E,D,B)})},onUnload:(T,E,D)=>{D.clear()},state:iu})],r2=[os("getValue"),ys("setValue",b),us("initialValue"),Ri("manager",{setValue:(T,E,D,B)=>{E.store.setValue(T,B),E.onSetValue(T,B)},getValue:(T,E,D)=>E.store.getValue(T),onLoad:(T,E,D)=>{E.store.initialValue.each(D=>{E.store.setValue(T,D)})},onUnload:b,state:ni.init})],r3=[xs("store",{mode:"memory"},Jn("mode",{memory:[us("initialValue"),Ri("manager",{setValue:(T,E,D,B)=>{D.set(B),E.onSetValue(T,B)},getValue:(T,E,D)=>D.get(),onLoad:(T,E,D)=>{E.store.initialValue.each(T=>{D.isNotSet()&&D.set(T)})},onUnload:(T,E,D)=>{D.clear()},state:au})],manual:r2,dataset:r1})),Di("onSetValue"),ys("resetOnDom",!1)];let r5=Ol({fields:r3,name:"representing",active:rQ,apis:rZ,extra:{setValueFrom:(T,E)=>{let D=r5.getValue(E);r5.setValue(T,D)}},state:r0}),hu=(T,E)=>Ts(T,{},H(E,E=>{var D,B;return D=E.name(),B="Cannot configure "+E.name()+" for "+T,gn(D,D,{tag:"option",process:{}},Cn(T=>cn("The field: "+D+" is forbidden. "+B)))}).concat([es("dump",w)])),fu=T=>T.dump,bu=(T,E)=>({...kl(E),...T.dump}),r9="placeholder",r4=As([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Su=T=>ve(T,"uiType"),ku=(T,E,D,B)=>(Su(D)&&D.uiType===r9?T.exists(T=>T!==D.owner)?r4.single(!0,x(D)):be(B,D.name).fold(()=>{throw Error("Unknown placeholder component: "+D.name+"\nKnown: ["+eI(B)+"]\nNamespace: "+T.getOr("none")+"\nSpec: "+JSON.stringify(D,null,2))},T=>T.replace()):r4.single(!1,x(D))).fold((M,er)=>{let ec=Su(D)?er(E,D.config,D.validated):er(E),eu=be(ec,"components").getOr([]),eg=X(eu,D=>ku(T,E,D,B));return[{...ec,components:eg}]},(T,B)=>{if(Su(D)){let T=B(E,D.config,D.validated);return D.validated.preprocess.getOr(w)(T)}return B(E)}),r6=r4.single,r8=r4.multiple,r7=x(r9),ae=As([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),ao=ys("factory",{sketch:w}),ar=ys("schema",[]),aa=os("name"),ai=gn("pname","pname",vn(T=>"<alloy."+la(T.name)+">"),tI()),ap=es("schema",()=>[us("preprocess")]),ah=ys("defaults",x({})),af=ys("overrides",x({})),av=Dn([ao,ar,aa,ai,ah,af]),ay=Dn([ao,ar,aa,ah,af]),aw=Dn([ao,ar,aa,ai,ah,af]),aS=Dn([ao,ap,aa,os("unit"),ai,ah,af]),Hu=T=>T.fold(A.some,A.none,A.some,A.some),Lu=T=>{let t=T=>T.name;return T.fold(t,t,t,t)},Pu=(T,E)=>D=>{let B=Yn("Converting part type",E,D);return T(B)},aC=Pu(ae.required,av),a_=Pu(ae.external,ay),aE=Pu(ae.optional,aw),aD=Pu(ae.group,aS),aB=x("entirety");var aI=Object.freeze({__proto__:null,required:aC,external:a_,optional:aE,group:aD,asNamedPart:Hu,name:Lu,asCommon:T=>T.fold(w,w,w,w),original:aB});let Xu=(T,E,D,B)=>tw(E.defaults(T,D,B),D,{uid:T.partUids[E.name]},E.overrides(T,D,B)),Yu=(T,E)=>{let D={};return L(E,E=>{Hu(E).each(E=>{let B=Ku(T,E.pname);D[E.name]=D=>{let M=Yn("Part: "+E.name+" in "+T,Dn(E.schema),D);return{...B,config:D,validated:M}}})}),D},Ku=(T,E)=>({uiType:r7(),owner:T,name:E}),Ju=(T,E,D)=>({uiType:r7(),owner:T,name:E,config:D,validated:{}}),Zu=T=>X(T,T=>T.fold(A.none,A.some,A.none,A.none).map(T=>ls(T.name,T.schema.concat([Ni(aB())]))).toArray()),Qu=T=>H(T,Lu),em=(T,E,D)=>((T,E,D)=>{let B={},M={};return L(D,T=>{T.fold(T=>{B[T.pname]=r6(!0,(E,D,B)=>T.factory.sketch(Xu(E,T,D,B)))},T=>{let D=E.parts[T.name];M[T.name]=x(T.factory.sketch(Xu(E,T,D[aB()]),D))},T=>{B[T.pname]=r6(!1,(E,D,B)=>T.factory.sketch(Xu(E,T,D,B)))},T=>{B[T.pname]=r8(!0,(E,D,B)=>{let M=E[T.name];return H(M,D=>T.factory.sketch(tw(T.defaults(E,D,B),D,T.overrides(E,D))))})})}),{internals:x(B),externals:x(M)}})(0,E,D),tm=(T,E,D)=>((T,E,D,B)=>{let M=ce(B,(T,E)=>{let D;return D=!1,{name:x(E),required:()=>T.fold((T,E)=>T,(T,E)=>T),used:()=>D,replace:()=>{if(D)throw Error("Trying to use the same placeholder more than once: "+E);return D=!0,T}}}),er=X(D,D=>ku(T,E,D,M));return le(M,D=>{if(!1===D.used()&&D.required())throw Error("Placeholder: "+D.name()+" was not found in components list\nNamespace: "+T.getOr("none")+"\nComponents: "+JSON.stringify(E.components,null,2))}),er})(A.some(T),E,E.components,D),om=(T,E,D)=>{let B=E.partUids[D];return T.getSystem().getByUid(B).toOptional()},nm=(T,E,D)=>om(T,E,D).getOrDie("Could not find part: "+D),sm=(T,E,D)=>{let B={},M=E.partUids,er=T.getSystem();return L(D,T=>{B[T]=x(er.getByUid(M[T]))}),B},rm=(T,E)=>{let D=T.getSystem();return ce(E.partUids,(T,E)=>x(D.getByUid(T)))},am=T=>eI(T.partUids),im=(T,E,D)=>{let B={},M=E.partUids,er=T.getSystem();return L(D,T=>{B[T]=x(er.getByUid(M[T]).getOrDie())}),B},lm=(T,E)=>{let D=Qu(E);return Ds(H(D,E=>({key:E,value:T+"-"+E})))},cm=T=>gn("partUids","partUids",xn(E=>lm(E.uid,T)),tI());var aH=Object.freeze({__proto__:null,generate:Yu,generateOne:Ju,schemas:Zu,names:Qu,substitutes:em,components:tm,defaultUids:lm,defaultUidsSchema:cm,getAllParts:rm,getAllPartNames:am,getPart:om,getPartOrDie:nm,getParts:sm,getPartsOrDie:im});let um=(T,E,D,B,M)=>{let er=(B.length>0?[ls("parts",B)]:[]).concat([os("uid"),ys("dom",{}),ys("components",[]),Ni("originalSpec"),ys("debug.sketcher",{})]).concat(M);return Yn(T+" [SpecSchema]",Mn(er.concat(E)),D)},mm=(T,E,D,B,M)=>{let er=gm(M),ec=Zu(D),eu=cm(D),eg=um(T,E,er,ec,[eu]),ep=em(0,eg,D);return B(eg,tm(T,eg,ep.internals()),er,ep.externals())},gm=T=>ve(T,"uid")?T:{...T,uid:ha("uid")},aN=Mn([os("name"),os("factory"),os("configFields"),ys("apis",{}),ys("extraApis",{})]),aU=Mn([os("name"),os("factory"),os("configFields"),os("partFields"),ys("apis",{}),ys("extraApis",{})]),fm=T=>{let E=Yn("Sketcher for "+T.name,aN,T),D=ce(E.apis,Ca),B=ce(E.extraApis,(T,E)=>xa(T,E));return{name:E.name,configFields:E.configFields,sketch:T=>((T,E,D,B)=>{let M=gm(B);return D(um(T,E,M,[],[]),M)})(E.name,E.configFields,E.factory,T),...D,...B}},bm=T=>{let E=Yn("Sketcher for "+T.name,aU,T),D=Yu(E.name,E.partFields),B=ce(E.apis,Ca),M=ce(E.extraApis,(T,E)=>xa(T,E));return{name:E.name,partFields:E.partFields,configFields:E.configFields,sketch:T=>mm(E.name,E.configFields,E.partFields,E.factory,T),parts:D,...B,...M}},vm=T=>Ye("input")(T)&&"radio"!==Ot(T,"type")||Ye("textarea")(T);var aL=Object.freeze({__proto__:null,getCurrent:(T,E,D)=>E.find(T)});let az=[os("find")],aP=Ol({fields:az,name:"composing",apis:aL}),aj=["input","button","textarea","select"],km=(T,E,D)=>{(E.disabled()?Am:Mm)(T,E)},Cm=(T,E)=>!0===E.useNative&&R(aj,Ue(T.element)),Om=T=>{kt(T.element,"disabled","disabled")},_m=T=>{Et(T.element,"disabled")},Tm=T=>{kt(T.element,"aria-disabled","true")},Em=T=>{kt(T.element,"aria-disabled","false")},Am=(T,E,D)=>{E.disableClass.each(E=>{La(T.element,E)}),(Cm(T,E)?Om:Tm)(T),E.onDisabled(T)},Mm=(T,E,D)=>{E.disableClass.each(E=>{Pa(T.element,E)}),(Cm(T,E)?_m:Em)(T),E.onEnabled(T)},Dm=(T,E)=>Cm(T,E)?Tt(T.element,"disabled"):"true"===Ot(T.element,"aria-disabled");var aW=Object.freeze({__proto__:null,enable:Mm,disable:Am,isDisabled:Dm,onLoad:km,set:(T,E,D,B)=>{(B?Am:Mm)(T,E)}}),aG=Object.freeze({__proto__:null,exhibit:(T,E)=>Ea({classes:E.disabled()?E.disableClass.toArray():[]}),events:(T,E)=>Hr([Lr(of(),(E,D)=>Dm(E,T)),xl(T,E,km)])}),aJ=[Os("disabled",ep),ys("useNative",!0),us("disableClass"),Di("onDisabled"),Di("onEnabled")];let a$=Ol({fields:aJ,name:"disabling",active:aG,apis:aW}),Nm=(T,E,D,B)=>{let M=Xc(T.element,"."+E.highlightClass);L(M,D=>{N(B,T=>Ze(T.element,D))||(Pa(D,E.highlightClass),T.getSystem().getByDom(D).each(D=>{E.onDehighlight(T,D),Fr(D,o$())}))})},Vm=(T,E,D,B)=>{Nm(T,E,0,[B]),zm(T,E,D,B)||(La(B.element,E.highlightClass),E.onHighlight(T,B),Fr(B,oJ()))},zm=(T,E,D,B)=>Ua(B.element,E.highlightClass),Hm=(T,E,D)=>pi(T.element,"."+E.itemClass).bind(E=>T.getSystem().getByDom(E).toOptional()),Lm=(T,E,D)=>{let B=Xc(T.element,"."+E.itemClass);return(B.length>0?A.some(B[B.length-1]):A.none()).bind(E=>T.getSystem().getByDom(E).toOptional())},Pm=(T,E,D,B)=>{let M=Xc(T.element,"."+E.itemClass);return $(M,T=>Ua(T,E.highlightClass)).bind(E=>{let D=Xi(E,B,0,M.length-1);return T.getSystem().getByDom(M[D]).toOptional()})},Um=(T,E,D)=>{let B=Xc(T.element,"."+E.itemClass);return we(H(B,E=>T.getSystem().getByDom(E).toOptional()))};var aX=Object.freeze({__proto__:null,dehighlightAll:(T,E,D)=>Nm(T,E,0,[]),dehighlight:(T,E,D,B)=>{zm(T,E,D,B)&&(Pa(B.element,E.highlightClass),E.onDehighlight(T,B),Fr(B,o$()))},highlight:Vm,highlightFirst:(T,E,D)=>{Hm(T,E).each(B=>{Vm(T,E,D,B)})},highlightLast:(T,E,D)=>{Lm(T,E).each(B=>{Vm(T,E,D,B)})},highlightAt:(T,E,D,B)=>{((T,E,D,B)=>{let M=Xc(T.element,"."+E.itemClass);return A.from(M[B]).fold(()=>tx.error(Error("No element found with index "+B)),T.getSystem().getByDom)})(T,E,0,B).fold(T=>{throw T},B=>{Vm(T,E,D,B)})},highlightBy:(T,E,D,B)=>{let M=Um(T,E);G(M,B).each(B=>{Vm(T,E,D,B)})},isHighlighted:zm,getHighlighted:(T,E,D)=>pi(T.element,"."+E.highlightClass).bind(E=>T.getSystem().getByDom(E).toOptional()),getFirst:Hm,getLast:Lm,getPrevious:(T,E,D)=>Pm(T,E,0,-1),getNext:(T,E,D)=>Pm(T,E,0,1),getCandidates:Um}),aq=[os("highlightClass"),os("itemClass"),Di("onHighlight"),Di("onDehighlight")];let aK=Ol({fields:aq,name:"highlighting",apis:aX}),aY=[9],aZ=[13],aQ=[27],a0=[32],a1=[37],a2=[38],a3=[39],a5=[40],tg=(T,E,D)=>{let B=K(T.slice(0,E)),M=K(T.slice(E+1));return G(B.concat(M),D)},og=(T,E,D)=>{let B=K(T.slice(0,E));return G(B,D)},ng=(T,E,D)=>{let B=T.slice(0,E),M=T.slice(E+1);return G(M.concat(B),D)},sg=(T,E,D)=>{let B=T.slice(E+1);return G(B,D)},rg=T=>E=>{let D=E.raw;return R(T,D.which)},ag=T=>E=>Y(T,T=>T(E)),ig=T=>!0===T.raw.shiftKey,lg=T=>!0===T.raw.ctrlKey,a9=C(ig),dg=(T,E)=>({matches:T,classification:E}),ug=(T,E,D)=>{E.exists(T=>D.exists(E=>Ze(E,T)))||Ir(T,oz(),{prevFocus:E,newFocus:D})},mg=()=>{let e=T=>Rl(T.element);return{get:e,set:(T,E)=>{let D=e(T);T.getSystem().triggerFocus(E,T.element);let B=e(T);ug(T,D,B)}}},gg=()=>{let e=T=>aK.getHighlighted(T).map(T=>T.element);return{get:e,set:(T,E)=>{let D=e(T);T.getSystem().getByDom(E).fold(b,E=>{aK.highlight(T,E)});let B=e(T);ug(T,D,B)}}};(iX=iZ||(iZ={})).OnFocusMode="onFocus",iX.OnEnterOrSpaceMode="onEnterOrSpace",iX.OnApiMode="onApi";let hg=(T,E,D,B,M)=>{let r=(T,E,D,B,M)=>{var er,ec;return(er=D(T,E,B,M),ec=E.event,G(er,T=>T.matches(ec)).map(T=>T.classification)).bind(D=>D(T,E,B,M))},er={schema:()=>T.concat([ys("focusManager",mg()),xs("focusInside","onFocus",Gn(T=>R(["onFocus","onEnterOrSpace","onApi"],T)?tx.value(T):tx.error("Invalid value for focusInside"))),Ri("handler",er),Ri("state",E),Ri("sendFocusIn",M)]),processKey:r,toEvents:(T,E)=>{let er=T.focusInside!==iZ.OnFocusMode?A.none():M(T).map(D=>Ur(t7(),(B,M)=>{D(B,T,E),M.stop()})),ec=[Ur(tQ(),(B,er)=>{r(B,er,D,T,E).fold(()=>{((D,B)=>{let er=rg(a0.concat(aZ))(B.event);T.focusInside===iZ.OnEnterOrSpaceMode&&er&&Rs(D,B)&&M(T).each(M=>{M(D,T,E),B.stop()})})(B,er)},T=>{er.stop()})}),Ur(t0(),(D,M)=>{r(D,M,B,T,E).each(T=>{M.stop()})})];return Hr(er.toArray().concat(ec))}};return er},fg=T=>{let E=[us("onEscape"),us("onEnter"),ys("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),ys("firstTabstop",0),ys("useTabstopAt",eh),us("visibilitySelector")].concat([T]),o=(T,E)=>{let D=T.visibilitySelector.bind(T=>hi(E,T)).getOr(E);return Wt(D)>0},n=(T,E)=>E.focusManager.get(T).bind(T=>hi(T,E.selector)),s=(T,E,D)=>{((T,E)=>{let D=Xc(T.element,E.selector),B=U(D,T=>o(E,T));return A.from(B[E.firstTabstop])})(T,E).each(D=>{E.focusManager.set(T,D)})},r=(T,E,D,B)=>{let M=Xc(T.element,D.selector);return n(T,D).bind(E=>$(M,k(Ze,E)).bind(E=>B(M,E,T=>o(D,T)&&D.useTabstopAt(T)).fold(()=>D.cyclic?A.some(!0):A.none(),E=>(D.focusManager.set(T,E),A.some(!0)))))},a=(T,E,D)=>{let B=D.cyclic?tg:og;return r(T,0,D,B)},i=(T,E,D)=>{let B=D.cyclic?ng:sg;return r(T,0,D,B)},D=x([dg(ag([ig,rg(aY)]),a),dg(rg(aY),i),dg(ag([a9,rg(aZ)]),(T,E,D)=>D.onEnter.bind(D=>D(T,E)))]),B=x([dg(rg(aQ),(T,E,D)=>D.onEscape.bind(D=>D(T,E))),dg(rg(aY),(T,E,D)=>n(T,D).filter(T=>!D.useTabstopAt(T)).bind(B=>(st(B).bind(ct).exists(T=>Ze(T,B))?a:i)(T,E,D)))]);return hg(E,ni.init,D,B,()=>A.some(s))};var a4=fg(es("cyclic",ep)),a6=fg(es("cyclic",eh));let yg=(T,E,D)=>vm(D)&&rg(a0)(E.event)?A.none():(Nr(T,D,of()),A.some(!0)),xg=(T,E)=>A.some(!0),a8=[ys("execute",yg),ys("useSpace",!1),ys("useEnter",!0),ys("useControlEnter",!1),ys("useDown",!1)],Sg=(T,E,D)=>D.execute(T,E,T.element);var a7=hg(a8,ni.init,(T,E,D,B)=>{let M=D.useSpace&&!vm(T.element)?a0:[],er=D.useEnter?aZ:[],ec=D.useDown?a5:[],eu=M.concat(er).concat(ec);return[dg(rg(eu),Sg)].concat(D.useControlEnter?[dg(ag([lg,rg(aZ)]),Sg)]:[])},(T,E,D,B)=>D.useSpace&&!vm(T.element)?[dg(rg(a0),xg)]:[],()=>A.none());let Cg=()=>{let T=Ql();return _a({readState:()=>T.get().map(T=>({numRows:String(T.numRows),numColumns:String(T.numColumns)})).getOr({numRows:"?",numColumns:"?"}),setGridSize:(E,D)=>{T.set({numRows:E,numColumns:D})},getNumRows:()=>T.get().map(T=>T.numRows),getNumColumns:()=>T.get().map(T=>T.numColumns)})};var se=Object.freeze({__proto__:null,flatgrid:Cg,init:T=>T.state(T)});let _g=T=>(E,D,B,M)=>{let er=T(E.element);return Mg(er,E,D,B,M)},Tg=(T,E)=>{let D=fc(T,E);return _g(D)},Eg=(T,E)=>{let D=fc(E,T);return _g(D)},Ag=T=>(E,D,B,M)=>Mg(T,E,D,B,M),Mg=(T,E,D,B,M)=>B.focusManager.get(E).bind(D=>T(E.element,D,B,M)).map(T=>(B.focusManager.set(E,T),!0)),Ig=T=>{var E;return!((E=T.dom).offsetWidth<=0)||!(E.offsetHeight<=0)},Rg=(T,E,D)=>{var B;let M=Xc(T,D);return $(B=U(M,Ig),T=>Ze(T,E)).map(T=>({index:T,candidates:B}))},Ng=(T,E)=>$(T,T=>Ze(E,T)),Vg=(T,E,D,B)=>B(Math.floor(E/D),E%D).bind(E=>{let B=E.row*D+E.column;return B>=0&&B<T.length?A.some(T[B]):A.none()}),zg=(T,E,D,B,M)=>Vg(T,E,B,(E,er)=>{let ec=E===D-1?T.length-E*B:B,eu=Xi(er,M,0,ec-1);return A.some({row:E,column:eu})}),Hg=(T,E,D,B,M)=>Vg(T,E,B,(E,er)=>{let ec=Xi(E,M,0,D-1),eu=ec===D-1?T.length-ec*B:B,eg=Yi(er,0,eu-1);return A.some({row:ec,column:eg})}),so=[os("selector"),ys("execute",yg),Bi("onEscape"),ys("captureTab",!1),nF()],Pg=(T,E,D)=>{pi(T.element,E.selector).each(D=>{E.focusManager.set(T,D)})},Ug=T=>(E,D,B,M)=>Rg(E,D,B.selector).bind(E=>T(E.candidates,E.index,M.getNumRows().getOr(B.initSize.numRows),M.getNumColumns().getOr(B.initSize.numColumns))),Wg=(T,E,D)=>D.captureTab?A.some(!0):A.none(),sn=Ug((T,E,D,B)=>zg(T,E,D,B,-1)),sr=Ug((T,E,D,B)=>zg(T,E,D,B,1)),sa=Ug((T,E,D,B)=>Hg(T,E,D,B,-1)),sc=Ug((T,E,D,B)=>Hg(T,E,D,B,1)),sd=x([dg(rg(a1),Tg(sn,sr)),dg(rg(a3),Eg(sn,sr)),dg(rg(a2),Ag(sa)),dg(rg(a5),Ag(sc)),dg(ag([ig,rg(aY)]),Wg),dg(ag([a9,rg(aY)]),Wg),dg(rg(a0.concat(aZ)),(T,E,D,B)=>D.focusManager.get(T).bind(T=>hi(T,D.selector)).bind(B=>D.execute(T,E,B)))]),su=x([dg(rg(aQ),(T,E,D)=>D.onEscape(T,E)),dg(rg(a0),xg)]);var sf=hg(so,Cg,sd,su,()=>A.some(Pg));let Jg=(T,E,D,B,M)=>{let r=(T,E,D)=>M(T,E,B,0,D.length-1,D[E],E=>{var B;return"button"===Ue(B=D[E])&&"disabled"===Ot(B,"disabled")?r(T,E,D):A.from(D[E])});return Rg(T,D,E).bind(T=>{let E=T.index,D=T.candidates;return r(E,E,D)})},Zg=(T,E,D,B)=>Jg(T,E,D,B,(T,E,D,B,M,er,ec)=>{let eu=Yi(E+D,B,M);return eu===T?A.from(er):ec(eu)}),Qg=(T,E,D,B)=>Jg(T,E,D,B,(T,E,D,B,M,er,ec)=>{let eu=Xi(E,D,B,M);return eu===T?A.none():ec(eu)}),sv=[os("selector"),ys("getInitial",A.none),ys("execute",yg),Bi("onEscape"),ys("executeOnMove",!1),ys("allowVertical",!0),ys("allowHorizontal",!0),ys("cycles",!0)],tp=(T,E,D)=>D.focusManager.get(T).bind(T=>hi(T,D.selector)).bind(B=>D.execute(T,E,B)),op=(T,E,D)=>{E.getInitial(T).orThunk(()=>pi(T.element,E.selector)).each(D=>{E.focusManager.set(T,D)})},np=(T,E,D)=>(D.cycles?Qg:Zg)(T,D.selector,E,-1),sp=(T,E,D)=>(D.cycles?Qg:Zg)(T,D.selector,E,1),rp=T=>(E,D,B,M)=>T(E,D,B,M).bind(()=>B.executeOnMove?tp(E,D,B):A.some(!0)),sy=x([dg(rg(a0),xg),dg(rg(aQ),(T,E,D)=>D.onEscape(T,E))]);var sx=hg(sv,ni.init,(T,E,D,B)=>{let M=[...D.allowHorizontal?a1:[]].concat(D.allowVertical?a2:[]),er=[...D.allowHorizontal?a3:[]].concat(D.allowVertical?a5:[]);return[dg(rg(M),rp(Tg(np,sp))),dg(rg(er),rp(Eg(np,sp))),dg(rg(aZ),tp),dg(rg(a0),tp)]},sy,()=>A.some(op));let lp=(T,E,D)=>A.from(T[E]).bind(T=>A.from(T[D]).map(T=>({rowIndex:E,columnIndex:D,cell:T}))),cp=(T,E,D,B)=>{let M=T[E].length,er=Xi(D,B,0,M-1);return lp(T,E,er)},dp=(T,E,D,B)=>{let M=Xi(D,B,0,T.length-1),er=T[M].length,ec=Yi(E,0,er-1);return lp(T,M,ec)},up=(T,E,D,B)=>{let M=T[E].length,er=Yi(D+B,0,M-1);return lp(T,E,er)},mp=(T,E,D,B)=>{let M=Yi(D+B,0,T.length-1),er=T[M].length,ec=Yi(E,0,er-1);return lp(T,M,ec)},sA=[ls("selectors",[os("row"),os("cell")]),ys("cycles",!0),ys("previousSelector",A.none),ys("execute",yg)],pp=(T,E,D)=>{E.previousSelector(T).orThunk(()=>{let D=E.selectors;return pi(T.element,D.cell)}).each(D=>{E.focusManager.set(T,D)})},hp=(T,E)=>(D,B,M)=>{let er=M.cycles?T:E;return hi(B,M.selectors.row).bind(T=>{let E=Xc(T,M.selectors.cell);return Ng(E,B).bind(E=>{let B=Xc(D,M.selectors.row);return Ng(B,T).bind(T=>{let D=H(B,T=>Xc(T,M.selectors.cell));return er(D,T,E).map(T=>T.cell)})})})},sS=hp((T,E,D)=>cp(T,E,D,-1),(T,E,D)=>up(T,E,D,-1)),sO=hp((T,E,D)=>cp(T,E,D,1),(T,E,D)=>up(T,E,D,1)),sC=hp((T,E,D)=>dp(T,D,E,-1),(T,E,D)=>mp(T,D,E,-1)),s_=hp((T,E,D)=>dp(T,D,E,1),(T,E,D)=>mp(T,D,E,1)),sD=x([dg(rg(a1),Tg(sS,sO)),dg(rg(a3),Eg(sS,sO)),dg(rg(a2),Ag(sC)),dg(rg(a5),Ag(s_)),dg(rg(a0.concat(aZ)),(T,E,D)=>Rl(T.element).bind(B=>D.execute(T,E,B)))]),sF=x([dg(rg(a0),xg)]);var sB=hg(sA,ni.init,sD,sF,()=>A.some(pp));let sI=[os("selector"),ys("execute",yg),ys("moveOnTab",!1)],Cp=(T,E,D)=>D.focusManager.get(T).bind(B=>D.execute(T,E,B)),Op=(T,E,D)=>{pi(T.element,E.selector).each(D=>{E.focusManager.set(T,D)})},_p=(T,E,D)=>Qg(T,D.selector,E,-1),Tp=(T,E,D)=>Qg(T,D.selector,E,1),sR=x([dg(rg(a2),Ag(_p)),dg(rg(a5),Ag(Tp)),dg(ag([ig,rg(aY)]),(T,E,D,B)=>D.moveOnTab?Ag(_p)(T,E,D,B):A.none()),dg(ag([a9,rg(aY)]),(T,E,D,B)=>D.moveOnTab?Ag(Tp)(T,E,D,B):A.none()),dg(rg(aZ),Cp),dg(rg(a0),Cp)]),sH=x([dg(rg(a0),xg)]);var sN=hg(sI,ni.init,sR,sH,()=>A.some(Op));let sU=[Bi("onSpace"),Bi("onEnter"),Bi("onShiftEnter"),Bi("onLeft"),Bi("onRight"),Bi("onTab"),Bi("onShiftTab"),Bi("onUp"),Bi("onDown"),Bi("onEscape"),ys("stopSpaceKeyup",!1),us("focusIn")];var sL=hg(sU,ni.init,(T,E,D)=>[dg(rg(a0),D.onSpace),dg(ag([a9,rg(aZ)]),D.onEnter),dg(ag([ig,rg(aZ)]),D.onShiftEnter),dg(ag([ig,rg(aY)]),D.onShiftTab),dg(ag([a9,rg(aY)]),D.onTab),dg(rg(a2),D.onUp),dg(rg(a5),D.onDown),dg(rg(a1),D.onLeft),dg(rg(a3),D.onRight),dg(rg(a0),D.onSpace)],(T,E,D)=>[...D.stopSpaceKeyup?[dg(rg(a0),xg)]:[],dg(rg(aQ),D.onEscape)],T=>T.focusIn);let sz=a4.schema(),sP=a6.schema(),sj=sx.schema(),sW=sf.schema(),sG=sB.schema(),sJ=a7.schema(),s$=sN.schema(),sX=sL.schema(),sq=Tl({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:sz,cyclic:sP,flow:sj,flatgrid:sW,matrix:sG,execution:sJ,menu:s$,special:sX}),name:"keying",active:{events:(T,E)=>T.handler.toEvents(T,E)},apis:{focusIn:(T,E,D)=>{E.sendFocusIn(E).fold(()=>{T.getSystem().triggerFocus(T.element,T.element)},B=>{B(T,E,D)})},setGridSize:(T,E,D,B,M)=>{ye(D,"setGridSize")?D.setGridSize(B,M):console.error("Layout does not support setGridSize")}},state:se}),Up=(T,E)=>{Nl(()=>{((T,E,D)=>{let B=T.components();L(T.components(),T=>Po(T.element)),Lo(T.element),T.syncComponents();let M=D(E),er=J(B,M);L(er,E=>{Cd(E),T.getSystem().removeFromWorld(E)}),L(M,E=>{kd(E)?Ed(T,E):(T.getSystem().addToWorld(E),Ed(T,E),yt(T.element)&&Od(E))}),T.syncComponents()})(T,E,()=>H(E,T.getSystem().build))},T.element)},Wp=(T,E)=>{Nl(()=>{((D,B,M)=>{var er,ec;let eu=D.components(),eg=X(B,T=>ka(T).toArray());L(eu,T=>{R(eg,T)||Td(T)});let ep=(er=T.element,ec=T.getSystem().buildOrPatch,Ya(er,E,(T,E)=>Ka(er,E,T,ec))),eh=J(eu,ep);L(eh,T=>{kd(T)&&Td(T)}),L(ep,T=>{kd(T)||_d(D,T)}),D.syncComponents()})(T,E)},T.element)},jp=(T,E,D,B)=>{Td(E);let M=Ka(T.element,D,B,T.getSystem().buildOrPatch);_d(T,M),T.syncComponents()},Gp=(T,E,D)=>{let B=T.getSystem().build(D);Md(T,B,E)},$p=(T,E,D,B)=>{Bd(E),Gp(T,(T,E)=>((T,E,D)=>{lt(T,D).fold(()=>{zo(T,E)},T=>{Ro(T,E)})})(T,E,D),B)},qp=(T,E)=>T.components(),Xp=(T,E,D,B,M)=>{let er=qp(T);return A.from(er[B]).map(D=>(M.fold(()=>Bd(D),M=>{(E.reuseDom?jp:$p)(T,D,B,M)}),D))};var sK=Object.freeze({__proto__:null,append:(T,E,D,B)=>{Gp(T,zo,B)},prepend:(T,E,D,B)=>{Gp(T,Vo,B)},remove:(T,E,D,B)=>{let M=qp(T),er=G(M,T=>Ze(B.element,T.element));er.each(Bd)},replaceAt:Xp,replaceBy:(T,E,D,B,M)=>{let er=qp(T);return $(er,B).bind(D=>Xp(T,E,0,D,M))},set:(T,E,D,B)=>(E.reuseDom?Wp:Up)(T,B),contents:qp});let sY=Ol({fields:[Cs("reuseDom",!0)],name:"replacing",apis:sK}),Jp=(T,E)=>{let D=((T,E)=>{let D=Hr(E);return Ol({fields:[os("enabled")],name:T,active:{events:x(D)}})})(T,E);return{key:T,value:{config:{},me:D,configAsRaw:x({}),initialConfig:{},state:ni}}},Zp=(T,E)=>{E.ignore||(Dl(T.element),E.onFocus(T))};var sZ=Object.freeze({__proto__:null,focus:Zp,blur:(T,E)=>{E.ignore||Bl(T.element)},isFocused:T=>Fl(T.element)}),sQ=Object.freeze({__proto__:null,exhibit:(T,E)=>{let D=E.ignore?{}:{attributes:{tabindex:"-1"}};return Ea(D)},events:T=>Hr([Ur(t7(),(E,D)=>{Zp(E,T),D.stop()})].concat(T.stopMousedown?[Ur(tJ(),(T,E)=>{E.event.prevent()})]:[]))}),s0=[Di("onFocus"),ys("stopMousedown",!1),ys("ignore",!1)];let s1=Ol({fields:s0,name:"focusing",active:sQ,apis:sZ}),nh=(T,E,D,B)=>{let M=D.get();D.set(B),((T,E,D)=>{E.toggleClass.each(E=>{D.get()?La(T.element,E):Pa(T.element,E)})})(T,E,D),((T,E,D)=>{let B=E.aria;B.update(T,B,D.get())})(T,E,D),M!==B&&E.onToggled(T,B)},sh=(T,E,D)=>{nh(T,E,D,!D.get())},rh=(T,E,D)=>{nh(T,E,D,E.selected)};var s2=Object.freeze({__proto__:null,onLoad:rh,toggle:sh,isOn:(T,E,D)=>D.get(),on:(T,E,D)=>{nh(T,E,D,!0)},off:(T,E,D)=>{nh(T,E,D,!1)},set:nh}),s3=Object.freeze({__proto__:null,exhibit:()=>Ea({}),events:(T,E)=>{let D=oY(D=>{sh(D,T,E)}),B=xl(T,E,rh);return Hr(q([T.toggleOnExecute?[D]:[],[B]]))}});let lh=(T,E,D)=>{kt(T.element,"aria-expanded",D)};var s5=[ys("selected",!1),us("toggleClass"),ys("toggleOnExecute",!0),Di("onToggled"),xs("aria",{mode:"none"},Jn("mode",{pressed:[ys("syncWithExpanded",!1),Ri("update",(T,E,D)=>{kt(T.element,"aria-pressed",D),E.syncWithExpanded&&lh(T,0,D)})],checked:[Ri("update",(T,E,D)=>{kt(T.element,"aria-checked",D)})],expanded:[Ri("update",lh)],selected:[Ri("update",(T,E,D)=>{kt(T.element,"aria-selected",D)})],none:[Ri("update",b)]}))];let s9=Ol({fields:s5,name:"toggling",active:s3,apis:s2,state:{init:()=>{let T=Es(!1);return{get:()=>T.get(),set:E=>T.set(E),clear:()=>T.set(!1),readState:()=>T.get()}}}}),uh=()=>{let e=(T,E)=>{E.stop(),Rr(T)};return[Ur(t3(),e),Ur(oy(),e),qr(tP()),qr(tJ())]},mh=T=>Hr(q([T.map(T=>oY((E,D)=>{T(E),D.stop()})).toArray(),uh()])),s4="alloy.item-hover",s6="alloy.item-focus",s8="alloy.item-toggled",fh=T=>{(Rl(T.element).isNone()||s1.isFocused(T))&&(s1.isFocused(T)||s1.focus(T),Ir(T,s4,{item:T}))},bh=T=>{Ir(T,s6,{item:T})},s7=x(s4),ie=x(s6),io=x(s8),wh=T=>T.toggling.map(T=>T.exclusive?"menuitemradio":"menuitemcheckbox").getOr("menuitem"),ir=[os("data"),os("components"),os("dom"),ys("hasSubmenu",!1),us("toggling"),hu("itemBehaviours",[s9,s1,sq,r5]),ys("ignoreFocus",!1),ys("domModification",{}),Ri("builder",T=>({dom:T.dom,domModification:{...T.domModification,attributes:{role:wh(T),...T.domModification.attributes,"aria-haspopup":T.hasSubmenu,...T.hasSubmenu?{"aria-expanded":!1}:{}}},behaviours:bu(T.itemBehaviours,[T.toggling.fold(s9.revoke,T=>s9.config({aria:{mode:"checked"},...ge(T,(T,E)=>"exclusive"!==E),onToggled:(E,D)=>{eu(T.onToggled)&&T.onToggled(E,D),Ir(E,s8,{item:E,state:D})}})),s1.config({ignore:T.ignoreFocus,stopMousedown:T.ignoreFocus,onFocus:T=>{bh(T)}}),sq.config({mode:"execution"}),r5.config({store:{mode:"memory",initialValue:T.data}}),Jp("item-type-events",[...uh(),Ur(tK(),fh),Ur(ov(),s1.focus)])]),components:T.components,eventOrder:T.eventOrder})),ys("eventOrder",{})],ia=[os("dom"),os("components"),Ri("builder",T=>({dom:T.dom,components:T.components,events:Hr([Xr(ov())])}))],ii=x("item-widget"),ip=x([aC({name:"widget",overrides:T=>({behaviours:kl([r5.config({store:{mode:"manual",getValue:E=>T.data,setValue:b}})])})})]),ih=[os("uid"),os("data"),os("components"),os("dom"),ys("autofocus",!1),ys("ignoreFocus",!1),hu("widgetBehaviours",[r5,s1,sq]),ys("domModification",{}),cm(ip()),Ri("builder",T=>{let E=em(ii(),T,ip()),D=tm(ii(),T,E.internals()),n=E=>om(E,T,"widget").map(T=>(sq.focusIn(T),T)),s=(E,D)=>(vm(D.event.target)||T.autofocus&&D.setSource(E.element),A.none());return{dom:T.dom,components:D,domModification:T.domModification,events:Hr([oY((T,E)=>{n(T).each(T=>{E.stop()})}),Ur(tK(),fh),Ur(ov(),(E,D)=>{T.autofocus?n(E):s1.focus(E)})]),behaviours:bu(T.widgetBehaviours,[r5.config({store:{mode:"memory",initialValue:T.data}}),s1.config({ignore:T.ignoreFocus,onFocus:T=>{bh(T)}}),sq.config({mode:"special",focusIn:T.autofocus?T=>{n(T)}:nq(),onLeft:s,onRight:s,onEscape:(E,D)=>s1.isFocused(E)||T.autofocus?(T.autofocus&&D.setSource(E.element),A.none()):(s1.focus(E),A.some(!0))})])}})],iv=Jn("type",{widget:ih,item:ir,separator:ia}),iA=x([aD({factory:{sketch:T=>{let E=Yn("menu.spec item",iv,T);return E.builder(E)}},name:"items",unit:"item",defaults:(T,E)=>ve(E,"uid")?E:{...E,uid:ha("item")},overrides:(T,E)=>({type:E.type,ignoreFocus:T.fakeFocus,domModification:{classes:[T.markers.item]}})})]),iS=x([os("value"),os("items"),os("dom"),os("components"),ys("eventOrder",{}),hu("menuBehaviours",[aK,r5,aP,sq]),xs("movement",{mode:"menu",moveOnTab:!0},Jn("mode",{grid:[nF(),Ri("config",(T,E)=>({mode:"flatgrid",selector:"."+T.markers.item,initSize:{numColumns:E.initSize.numColumns,numRows:E.initSize.numRows},focusManager:T.focusManager}))],matrix:[Ri("config",(T,E)=>({mode:"matrix",selectors:{row:E.rowSelector,cell:"."+T.markers.item},previousSelector:E.previousSelector,focusManager:T.focusManager})),os("rowSelector"),ys("previousSelector",A.none)],menu:[ys("moveOnTab",!0),Ri("config",(T,E)=>({mode:"menu",selector:"."+T.markers.item,moveOnTab:E.moveOnTab,focusManager:T.focusManager}))]})),ns("markers",nC()),ys("fakeFocus",!1),ys("focusManager",mg()),Di("onHighlight"),Di("onDehighlight")]),iE=x("alloy.menu-focus"),iD=bm({name:"Menu",configFields:iS(),partFields:iA(),factory:(T,E,D,B)=>({uid:T.uid,dom:T.dom,markers:T.markers,behaviours:bu(T.menuBehaviours,[aK.config({highlightClass:T.markers.selectedItem,itemClass:T.markers.item,onHighlight:T.onHighlight,onDehighlight:T.onDehighlight}),r5.config({store:{mode:"memory",initialValue:T.value}}),aP.config({find:A.some}),sq.config(T.movement.config(T,T.movement))]),events:Hr([Ur(ie(),(T,E)=>{let D=E.event;T.getSystem().getByDom(D.target).each(D=>{aK.highlight(T,D),E.stop(),Ir(T,iE(),{menu:T,item:D})})}),Ur(s7(),(T,E)=>{let D=E.event.item;aK.highlight(T,D)}),Ur(io(),(T,E)=>{let{item:D,state:B}=E.event;B&&"menuitemradio"===Ot(D.element,"role")&&((T,E)=>{let D=Xc(T.element,'[role="menuitemradio"][aria-checked="true"]');L(D,D=>{Ze(D,E.element)||T.getSystem().getByDom(D).each(T=>{s9.off(T)})})})(T,D)})]),components:E,eventOrder:T.eventOrder,domModification:{attributes:{role:"menu"}}})}),Bh=(T,E,D,B)=>be(D,B).bind(B=>be(T,B).bind(B=>{let M=Bh(T,E,D,B);return A.some([B].concat(M))})).getOr([]),Fh=T=>"prepared"===T.type?A.some(T.menu):A.none(),Ih=()=>{let T=Es({}),E=Es({}),D=Es({}),B=Ql(),M=Es({}),r=T=>a(T).bind(Fh),a=T=>be(E.get(),T),i=E=>be(T.get(),E);return{setMenuBuilt:(T,D)=>{E.set({...E.get(),[T]:{type:"prepared",menu:D}})},setContents:(er,ec,eu,eg)=>{B.set(er),T.set(eu),E.set(ec),M.set(eg);let ep=((T,E)=>{let D={};le(T,(T,E)=>{L(T,T=>{D[T]=E})});let B=de(E,(T,E)=>({k:T,v:E})),M=ce(B,(T,M)=>[M].concat(Bh(D,E,B,M)));return ce(D,T=>be(M,T).getOr([T]))})(eg,eu);D.set(ep)},expand:E=>be(T.get(),E).map(T=>{let B=be(D.get(),E).getOr([]);return[T].concat(B)}),refresh:T=>be(D.get(),T),collapse:T=>be(D.get(),T).bind(T=>T.length>1?A.some(T.slice(1)):A.none()),lookupMenu:a,lookupItem:i,otherMenus:T=>{let E=M.get();return J(eI(E),T)},getPrimary:()=>B.get().bind(r),getMenus:()=>E.get(),clear:()=>{T.set({}),E.set({}),D.set({}),B.clear()},isClear:()=>B.get().isNone(),getTriggeringPath:(E,M)=>{let er=U(i(E).toArray(),T=>r(T).isSome());return be(D.get(),E).bind(E=>{let D=K(er.concat(E));return(T=>{let E=[];for(let D=0;D<T.length;D++){let B=T[D];if(!B.isSome())return A.none();E.push(B.getOrDie())}return A.some(E)})(X(D,(E,er)=>{var ec;return(ec=D.slice(0,er+1),r(E).bind(D=>he(T.get(),(T,D)=>T===E).bind(T=>M(T).map(T=>({triggeredMenu:D,triggeringItem:T,triggeringPath:ec}))))).fold(()=>xe(B.get(),E)?[]:[A.none()],T=>[A.some(T)])}))})}}},iB=la("tiered-menu-item-highlight"),iI=la("tiered-menu-item-dehighlight");(iq=iQ||(iQ={}))[iq.HighlightMenuAndItem=0]="HighlightMenuAndItem",iq[iq.HighlightJustMenu=1]="HighlightJustMenu",iq[iq.HighlightNone=2]="HighlightNone";let iR=x("collapse-item"),iH=fm({name:"TieredMenu",configFields:[Ii("onExecute"),Ii("onEscape"),Fi("onOpenMenu"),Fi("onOpenSubmenu"),Di("onRepositionMenu"),Di("onCollapseMenu"),ys("highlightOnOpen",iQ.HighlightMenuAndItem),ls("data",[os("primary"),os("menus"),os("expansions")]),ys("fakeFocus",!1),Di("onHighlightItem"),Di("onDehighlightItem"),Di("onHover"),Ei(),os("dom"),ys("navigateOnHover",!0),ys("stayInDom",!1),hu("tmenuBehaviours",[sq,aK,aP,sY]),ys("eventOrder",{})],apis:{collapseMenu:(T,E)=>{T.collapseMenu(E)},highlightPrimary:(T,E)=>{T.highlightPrimary(E)},repositionMenus:(T,E)=>{T.repositionMenus(E)}},factory:(T,E)=>{var D;let B;let M=Ql(),er=Ih(),s=T=>r5.getValue(T).value,r=E=>ce(T.data.menus,(T,E)=>X(T.items,T=>"separator"===T.type?[]:[T.data.value])),ec=aK.highlight,i=(E,D)=>{ec(E,D),aK.getHighlighted(D).orThunk(()=>aK.getFirst(D)).each(B=>{T.fakeFocus?aK.highlight(D,B):Nr(E,B.element,ov())})},l=(T,E)=>we(H(E,E=>T.lookupMenu(E).bind(T=>"prepared"===T.type?A.some(T.menu):A.none()))),c=(E,D,B)=>{let M=l(D,D.otherMenus(B));L(M,D=>{ja(D.element,[T.markers.backgroundMenu]),T.stayInDom||sY.remove(E,D)})},d=(E,D)=>{let B=M.get().getOrThunk(()=>{let D={},B=Xc(E.element,`.${T.markers.item}`),er=U(B,T=>"true"===Ot(T,"aria-haspopup"));return L(er,T=>{E.getSystem().getByDom(T).each(T=>{let E=s(T);D[E]=T})}),M.set(D),D});le(B,(T,E)=>{let B=R(D,E);kt(T.element,"aria-expanded",B)})},u=(E,D,B)=>A.from(B[0]).bind(M=>D.lookupMenu(M).bind(M=>{if("notbuilt"===M.type)return A.none();{let er=M.menu,ec=l(D,B.slice(1));return L(ec,E=>{La(E.element,T.markers.backgroundMenu)}),yt(er.element)||sY.append(E,Sa(er)),ja(er.element,[T.markers.backgroundMenu]),i(E,er),c(E,D,B),A.some(er)}}));(D=B||(B={}))[D.HighlightSubmenu=0]="HighlightSubmenu",D[D.HighlightParent=1]="HighlightParent";let g=(E,D,M=B.HighlightSubmenu)=>{if(D.hasConfigured(a$)&&a$.isDisabled(D))return A.some(D);{let ec=s(D);return er.expand(ec).bind(ec=>(d(E,ec),A.from(ec[0]).bind(eu=>er.lookupMenu(eu).bind(eg=>{let ep=((T,E,D)=>{if("notbuilt"===D.type){let B=T.getSystem().build(D.nbMenu());return er.setMenuBuilt(E,B),B}return D.menu})(E,eu,eg);return yt(ep.element)||sY.append(E,Sa(ep)),T.onOpenSubmenu(E,D,ep,K(ec)),M===B.HighlightSubmenu?(aK.highlightFirst(ep),u(E,er,ec)):(aK.dehighlightAll(ep),A.some(D))}))))}},p=(E,D)=>{let B=s(D);return er.collapse(B).bind(B=>(d(E,B),u(E,er,B).map(B=>(T.onCollapseMenu(E,D,B),B))))},h=E=>(D,B)=>hi(B.getSource(),`.${T.markers.item}`).bind(T=>D.getSystem().getByDom(T).toOptional().bind(T=>E(D,T).map(eh))),eu=Hr([Ur(iE(),(T,E)=>{let D=E.event.item;er.lookupItem(s(D)).each(()=>{let D=E.event.menu;aK.highlight(T,D);let B=s(E.event.item);er.refresh(B).each(E=>c(T,er,E))})}),oY((E,D)=>{let M=D.event.target;E.getSystem().getByDom(M).each(D=>{0===s(D).indexOf("collapse-item")&&p(E,D),g(E,D,B.HighlightSubmenu).fold(()=>{T.onExecute(E,D)},b)})}),oX((E,D)=>{(E=>{var D;let B=(D=T.data.primary,ce(T.data.menus,(B,M)=>{let r=()=>iD.sketch({...B,value:M,markers:T.markers,fakeFocus:T.fakeFocus,onHighlight:(T,E)=>{Ir(T,iB,{menuComp:T,itemComp:E})},onDehighlight:(T,E)=>{Ir(T,iI,{menuComp:T,itemComp:E})},focusManager:T.fakeFocus?gg():mg()});return M===D?{type:"prepared",menu:E.getSystem().build(r())}:{type:"notbuilt",nbMenu:r}})),M=r();return er.setContents(T.data.primary,B,T.data.expansions,M),er.getPrimary()})(E).each(D=>{sY.append(E,Sa(D)),T.onOpenMenu(E,D),T.highlightOnOpen===iQ.HighlightMenuAndItem?i(E,D):T.highlightOnOpen===iQ.HighlightJustMenu&&ec(E,D)})}),Ur(iB,(E,D)=>{T.onHighlightItem(E,D.event.menuComp,D.event.itemComp)}),Ur(iI,(E,D)=>{T.onDehighlightItem(E,D.event.menuComp,D.event.itemComp)}),...T.navigateOnHover?[Ur(s7(),(E,D)=>{let M=D.event.item;((T,E)=>{let D=s(E);er.refresh(D).bind(E=>(d(T,E),u(T,er,E)))})(E,M),g(E,M,B.HighlightParent),T.onHover(E,M)})]:[]]),v=T=>aK.getHighlighted(T).bind(aK.getHighlighted);return{uid:T.uid,dom:T.dom,markers:T.markers,behaviours:bu(T.tmenuBehaviours,[sq.config({mode:"special",onRight:h((T,E)=>vm(E.element)?A.none():g(T,E,B.HighlightSubmenu)),onLeft:h((T,E)=>vm(E.element)?A.none():p(T,E)),onEscape:h((E,D)=>p(E,D).orThunk(()=>T.onEscape(E,D).map(()=>E))),focusIn:(T,E)=>{er.getPrimary().each(E=>{Nr(T,E.element,ov())})}}),aK.config({highlightClass:T.markers.selectedMenu,itemClass:T.markers.menu}),aP.config({find:T=>aK.getHighlighted(T)}),sY.config({})]),eventOrder:T.eventOrder,apis:{collapseMenu:T=>{v(T).each(E=>{p(T,E)})},highlightPrimary:T=>{er.getPrimary().each(E=>{i(T,E)})},repositionMenus:E=>{let D=er.getPrimary().bind(T=>v(E).bind(T=>{let E=s(T),D=fe(er.getMenus()),B=we(H(D,Fh));return er.getTriggeringPath(E,T=>re(B,E=>{if(!E.getSystem().isConnected())return A.none();let D=aK.getCandidates(E);return G(D,E=>s(E)===T)}))}).map(E=>({primary:T,triggeringPath:E})));D.fold(()=>{A.from(E.components()[0]).filter(T=>"menu"===Ot(T.element,"role")).each(D=>{T.onRepositionMenu(E,D,[])})},({primary:D,triggeringPath:B})=>{T.onRepositionMenu(E,D,B)})}},events:eu}},extraApis:{tieredData:(T,E,D)=>({primary:T,menus:E,expansions:D}),singleData:(T,E)=>({primary:T,menus:Ms(T,E),expansions:{}}),collapseItem:T=>({value:la(iR()),meta:{text:T}})}}),iN=fm({name:"InlineView",configFields:[os("lazySink"),Di("onShow"),Di("onHide"),fs("onEscape"),hu("inlineBehaviours",[rJ,r5,nK]),vs("fireDismissalEventInstead",[ys("event",oU())]),vs("fireRepositionEventInstead",[ys("event",oL())]),ys("getRelated",A.none),ys("isExtraPart",ep),ys("eventOrder",A.none)],factory:(T,E)=>{let o=(E,D,B,M)=>{let er=T.lazySink(E).getOrDie();rJ.openWhileCloaked(E,D,()=>rz.positionWithinBounds(er,E,B,M())),r5.setValue(E,A.some({mode:"position",config:B,getBounds:M}))},n=(E,D,B,M)=>{let er=((T,E,D,B,M)=>{let r=()=>T.lazySink(E),er="horizontal"===B.type?{layouts:{onLtr:()=>fl(),onRtl:()=>bl()}}:{},i=T=>2===T.length?er:{};return iH.sketch({dom:{tag:"div"},data:B.data,markers:B.menu.markers,highlightOnOpen:B.menu.highlightOnOpen,fakeFocus:B.menu.fakeFocus,onEscape:()=>(rJ.close(E),T.onEscape.map(T=>T(E)),A.some(!0)),onExecute:()=>A.some(!0),onOpenMenu:(T,E)=>{rz.positionWithinBounds(r().getOrDie(),E,D,M())},onOpenSubmenu:(T,E,D,B)=>{let M=r().getOrDie();rz.position(M,D,{anchor:{type:"submenu",item:E,...i(B)}})},onRepositionMenu:(T,E,B)=>{let er=r().getOrDie();rz.positionWithinBounds(er,E,D,M()),L(B,T=>{let E=i(T.triggeringPath);rz.position(er,T.triggeredMenu,{anchor:{type:"submenu",item:T.triggeringItem,...E}})})}})})(T,E,D,B,M);rJ.open(E,er),r5.setValue(E,A.some({mode:"menu",menu:er}))},s=E=>{rJ.isOpen(E)&&r5.getValue(E).each(D=>{switch(D.mode){case"menu":rJ.getState(E).each(iH.repositionMenus);break;case"position":let B=T.lazySink(E).getOrDie();rz.positionWithinBounds(B,E,D.config,D.getBounds())}})},D={setContent:(T,E)=>{rJ.setContent(T,E)},showAt:(T,E,D)=>{let B=A.none;o(T,E,D,B)},showWithinBounds:o,showMenuAt:(T,E,D)=>{n(T,E,D,A.none)},showMenuWithinBounds:n,hide:T=>{rJ.isOpen(T)&&(r5.setValue(T,A.none()),rJ.close(T))},getContent:T=>rJ.getState(T),reposition:s,isOpen:rJ.isOpen};return{uid:T.uid,dom:T.dom,behaviours:bu(T.inlineBehaviours,[rJ.config({isPartOf:(E,D,B)=>vi(D,B)||T.getRelated(E).exists(T=>vi(T,B)),getAttachPoint:E=>T.lazySink(E).getOrDie(),onOpen:E=>{T.onShow(E)},onClose:E=>{T.onHide(E)}}),r5.config({store:{mode:"memory",initialValue:A.none()}}),nK.config({channels:{...Qd({isExtraPart:E.isExtraPart,...T.fireDismissalEventInstead.map(T=>({fireEventInstead:{event:T.event}})).getOr({})}),...tu({...T.fireRepositionEventInstead.map(T=>({fireEventInstead:{event:T.event}})).getOr({}),doReposition:s})}})]),eventOrder:T.eventOrder,apis:D}},apis:{showAt:(T,E,D,B)=>{T.showAt(E,D,B)},showWithinBounds:(T,E,D,B,M)=>{T.showWithinBounds(E,D,B,M)},showMenuAt:(T,E,D,B)=>{T.showMenuAt(E,D,B)},showMenuWithinBounds:(T,E,D,B,M)=>{T.showMenuWithinBounds(E,D,B,M)},hide:(T,E)=>{T.hide(E)},isOpen:(T,E)=>T.isOpen(E),getContent:(T,E)=>T.getContent(E),setContent:(T,E,D)=>{T.setContent(E,D)},reposition:(T,E)=>{T.reposition(E)}}});var iU=tinymce.util.Tools.resolve("tinymce.util.Delay");let iL=fm({name:"Button",factory:T=>{let E=mh(T.action),D=T.dom.tag,n=E=>be(T.dom,"attributes").bind(T=>be(T,E));return{uid:T.uid,dom:T.dom,components:T.components,events:E,behaviours:bu(T.buttonBehaviours,[s1.config({}),sq.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:"button"===D?{type:n("type").getOr("button"),...n("role").map(T=>({role:T})).getOr({})}:{role:T.role.getOr(n("role").getOr("button"))}},eventOrder:T.eventOrder}},configFields:[ys("uid",void 0),os("dom"),ys("components",[]),hu("buttonBehaviours",[s1,sq]),us("action"),us("role"),ys("eventOrder",{})]}),jh=T=>{let E=void 0!==T.uid&&ye(T,"uid")?T.uid:ha("memento");return{get:T=>T.getSystem().getByUid(E).getOrDie(),getOpt:T=>T.getSystem().getByUid(E).toOptional(),asSpec:()=>({...T,uid:E})}};var iz=tinymce.util.Tools.resolve("tinymce.util.I18n");let iP={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},ij="temporary-placeholder",Xh=T=>()=>be(T,ij).getOr("!not found!"),Yh=(T,E)=>{let D=T.toLowerCase();if(iz.isRtl()){var B;let T=Ae(D,B="-rtl")?D:D+B;return ve(E,T)?T:D}return D},Kh=(T,E)=>be(E,Yh(T,E)),Jh=(T,E)=>{let D=E();return Kh(T,D).getOrThunk(Xh(D))},Zh=()=>Jp("add-focusable",[oX(T=>{gi(T.element,"svg").each(T=>kt(T,"focusable","false"))})]),Qh=(T,E,D,B)=>{var M,er;let ec=iz.isRtl()&&ve(iP,E)?["tox-icon--flip"]:[],eu=be(D,Yh(E,D)).or(B).getOrThunk(Xh(D));return{dom:{tag:T.tag,attributes:null!==(M=T.attributes)&&void 0!==M?M:{},classes:T.classes.concat(ec),innerHtml:eu},behaviours:kl([...null!==(er=T.behaviours)&&void 0!==er?er:[],Zh()])}},ef=(T,E,D,B=A.none())=>Qh(E,T,D(),B),iW={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},iG=fm({name:"Notification",factory:T=>{let E=jh({dom:{tag:"p",innerHtml:T.translationProvider(T.text)},behaviours:kl([sY.config({})])}),o=T=>({dom:{tag:"div",classes:["tox-bar"],styles:{width:`${T}%`}}}),n=T=>({dom:{tag:"div",classes:["tox-text"],innerHtml:`${T}%`}}),D=jh({dom:{tag:"div",classes:T.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(0)]},n(0)],behaviours:kl([sY.config({})])}),B=q([T.icon.toArray(),T.level.toArray(),T.level.bind(T=>A.from(iW[T])).toArray()]),M=jh(iL.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[ef("close",{tag:"span",classes:["tox-icon"],attributes:{"aria-label":T.translationProvider("Close")}},T.iconProvider)],action:E=>{T.onAction(E)}})),er=((T,E,D)=>{let B=D(),M=G(T,T=>ve(B,Yh(T,B)));return Qh({tag:"div",classes:["tox-notification__icon"]},M.getOr(ij),B,A.none())})(B,0,T.iconProvider),ec=[er,{dom:{tag:"div",classes:["tox-notification__body"]},components:[E.asSpec()],behaviours:kl([sY.config({})])}];return{uid:T.uid,dom:{tag:"div",attributes:{role:"alert"},classes:T.level.map(T=>["tox-notification","tox-notification--in",`tox-notification--${T}`]).getOr(["tox-notification","tox-notification--in"])},behaviours:kl([s1.config({}),Jp("notification-events",[Ur(tY(),T=>{M.getOpt(T).each(s1.focus)})])]),components:ec.concat(T.progress?[D.asSpec()]:[]).concat(T.closeButton?[M.asSpec()]:[]),apis:{updateProgress:(T,E)=>{T.getSystem().isConnected()&&D.getOpt(T).each(T=>{sY.set(T,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(E)]},n(E)])})},updateText:(T,D)=>{if(T.getSystem().isConnected()){let B=E.get(T);sY.set(B,[ti(D)])}}}}},configFields:[us("level"),os("progress"),us("icon"),os("onAction"),os("text"),os("iconProvider"),os("translationProvider"),Cs("closeButton",!0)],apis:{updateProgress:(T,E,D)=>{T.updateProgress(E,D)},updateText:(T,E,D)=>{T.updateText(E,D)}}});var iJ,i$,iX,iq,iK,iY,iZ,iQ,i0,i1,i2=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),i3=tinymce.util.Tools.resolve("tinymce.EditorManager"),i5=tinymce.util.Tools.resolve("tinymce.Env");(pU=i0||(i0={})).default="wrap",pU.floating="floating",pU.sliding="sliding",pU.scrolling="scrolling",(pL=i1||(i1={})).auto="auto",pL.top="top",pL.bottom="bottom";let cf=T=>E=>E.options.get(T),df=T=>E=>A.from(T(E)),uf=T=>{let D=i5.deviceType.isPhone(),M=i5.deviceType.isTablet()||D,ec=T.options.register,s=T=>E(T)||!1===T,a=T=>E(T)||eg(T);ec("skin",{processor:T=>E(T)||!1===T,default:"oxide"}),ec("skin_url",{processor:"string"}),ec("height",{processor:a,default:Math.max(T.getElement().offsetHeight,400)}),ec("width",{processor:a,default:i2.DOM.getStyle(T.getElement(),"width")}),ec("min_height",{processor:"number",default:100}),ec("min_width",{processor:"number"}),ec("max_height",{processor:"number"}),ec("max_width",{processor:"number"}),ec("style_formats",{processor:"object[]"}),ec("style_formats_merge",{processor:"boolean",default:!1}),ec("style_formats_autohide",{processor:"boolean",default:!1}),ec("line_height_formats",{processor:"string",default:"1 1.1 1.2 1.3 1.4 1.5 2"}),ec("font_family_formats",{processor:"string",default:"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"}),ec("font_size_formats",{processor:"string",default:"8pt 10pt 12pt 14pt 18pt 24pt 36pt"}),ec("font_size_input_default_unit",{processor:"string",default:"pt"}),ec("block_formats",{processor:"string",default:"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre"}),ec("content_langs",{processor:"object[]"}),ec("removed_menuitems",{processor:"string",default:""}),ec("menubar",{processor:T=>E(T)||er(T),default:!D}),ec("menu",{processor:"object",default:{}}),ec("toolbar",{processor:T=>er(T)||E(T)||B(T)?{value:T,valid:!0}:{valid:!1,message:"Must be a boolean, string or array."},default:!0}),V(9,T=>{ec("toolbar"+(T+1),{processor:"string"})}),ec("toolbar_mode",{processor:"string",default:M?"scrolling":"floating"}),ec("toolbar_groups",{processor:"object",default:{}}),ec("toolbar_location",{processor:"string",default:i1.auto}),ec("toolbar_persist",{processor:"boolean",default:!1}),ec("toolbar_sticky",{processor:"boolean",default:T.inline}),ec("toolbar_sticky_offset",{processor:"number",default:0}),ec("fixed_toolbar_container",{processor:"string",default:""}),ec("fixed_toolbar_container_target",{processor:"object"}),ec("ui_mode",{processor:"string",default:"combined"}),ec("file_picker_callback",{processor:"function"}),ec("file_picker_validator_handler",{processor:"function"}),ec("file_picker_types",{processor:"string"}),ec("typeahead_urls",{processor:"boolean",default:!0}),ec("anchor_top",{processor:s,default:"#top"}),ec("anchor_bottom",{processor:s,default:"#bottom"}),ec("draggable_modal",{processor:"boolean",default:!1}),ec("statusbar",{processor:"boolean",default:!0}),ec("elementpath",{processor:"boolean",default:!0}),ec("branding",{processor:"boolean",default:!0}),ec("promotion",{processor:"boolean",default:!0}),ec("resize",{processor:T=>"both"===T||er(T),default:!i5.deviceType.isTouch()}),ec("sidebar_show",{processor:"string"}),ec("help_accessibility",{processor:"boolean",default:T.hasPlugin("help")})},i9=cf("readonly"),i4=cf("height"),i6=cf("width"),i8=df(cf("min_width")),i7=df(cf("min_height")),lo=df(cf("max_width")),lr=df(cf("max_height")),lc=df(cf("style_formats")),lu=cf("style_formats_merge"),lf=cf("style_formats_autohide"),lv=cf("content_langs"),lw=cf("removed_menuitems"),lA=cf("toolbar_mode"),lS=cf("toolbar_groups"),lE=cf("toolbar_location"),lD=cf("fixed_toolbar_container"),lF=cf("fixed_toolbar_container_target"),lB=cf("toolbar_persist"),lI=cf("toolbar_sticky_offset"),lR=cf("menubar"),lH=cf("toolbar"),lN=cf("file_picker_callback"),lU=cf("file_picker_validator_handler"),lL=cf("font_size_input_default_unit"),lz=cf("file_picker_types"),lP=cf("typeahead_urls"),lj=cf("anchor_top"),lW=cf("anchor_bottom"),lG=cf("draggable_modal"),lJ=cf("statusbar"),l$=cf("elementpath"),lX=cf("branding"),lq=cf("resize"),lK=cf("paste_as_text"),lY=cf("sidebar_show"),lZ=cf("promotion"),lQ=cf("help_accessibility"),Yf=T=>!1===T.options.get("skin"),Kf=T=>!1!==T.options.get("menubar"),Jf=T=>{let E=T.options.get("skin_url");if(Yf(T))return E;if(E)return T.documentBaseURI.toAbsolute(E);{let E=T.options.get("skin");return i3.baseURL+"/skins/ui/"+E}},Zf=T=>T.options.get("line_height_formats").split(" "),Qf=T=>{let D=lH(T),M=E(D),er=B(D)&&D.length>0;return!tb(T)&&(er||M||!0===D)},eb=T=>{let D=V(9,E=>T.options.get("toolbar"+(E+1))),B=U(D,E);return Ce(B.length>0,B)},tb=T=>eb(T).fold(()=>{let D=lH(T);return f(D,E)&&D.length>0},eh),ob=T=>lE(T)===i1.bottom,nb=T=>{var E;if(!T.inline)return A.none();let D=null!==(E=lD(T))&&void 0!==E?E:"";if(D.length>0)return pi(xt(),D);let B=lF(T);return g(B)?A.some(Fe(B)):A.none()},sb=T=>T.inline&&nb(T).isSome(),rb=T=>nb(T).getOrThunk(()=>ft(eJ(Fe(T.getElement())))),ab=T=>T.inline&&!Kf(T)&&!Qf(T)&&!tb(T),ib=T=>(T.options.get("toolbar_sticky")||T.inline)&&!sb(T)&&!ab(T),lb=T=>!sb(T)&&"split"===T.options.get("ui_mode"),cb=T=>{let E=T.options.get("menu");return ce(E,T=>({...T,items:T.items}))};var l0=Object.freeze({__proto__:null,get ToolbarMode(){return i0},get ToolbarLocation(){return i1},register:uf,getSkinUrl:Jf,isReadOnly:i9,isSkinDisabled:Yf,getHeightOption:i4,getWidthOption:i6,getMinWidthOption:i8,getMinHeightOption:i7,getMaxWidthOption:lo,getMaxHeightOption:lr,getUserStyleFormats:lc,shouldMergeStyleFormats:lu,shouldAutoHideStyleFormats:lf,getLineHeightFormats:Zf,getContentLanguages:lv,getRemovedMenuItems:lw,isMenubarEnabled:Kf,isMultipleToolbars:tb,isToolbarEnabled:Qf,isToolbarPersist:lB,getMultipleToolbarsOption:eb,getUiContainer:rb,useFixedContainer:sb,isSplitUiMode:lb,getToolbarMode:lA,isDraggableModal:lG,isDistractionFree:ab,isStickyToolbar:ib,getStickyToolbarOffset:lI,getToolbarLocation:lE,isToolbarLocationBottom:ob,getToolbarGroups:lS,getMenus:cb,getMenubar:lR,getToolbar:lH,getFilePickerCallback:lN,getFilePickerTypes:lz,useTypeaheadUrls:lP,getAnchorTop:lj,getAnchorBottom:lW,getFilePickerValidatorHandler:lU,getFontSizeInputDefaultUnit:lL,useStatusBar:lJ,useElementPath:l$,promotionEnabled:lZ,useBranding:lX,getResize:lq,getPasteAsText:lK,getSidebarShow:lY,useHelpAccessibility:lQ});let l1="[data-mce-autocompleter]",mb=T=>hi(T,l1);(pz=pj||(pj={}))[pz.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",pz[pz.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var l2=pj;let l3="tox-menu-nav__js",l5="tox-collection__item",l9="tox-swatch",l4={normal:l3,color:l9},l6="tox-collection__item--enabled",l8="tox-collection__item-icon",l7="tox-collection__item-label",co="tox-collection__item-caret",cr="tox-collection__item--active",ca="tox-collection__item-container",cc="tox-collection__item-container--row",_b=T=>be(l4,T).getOr(l3),Tb=T=>"color"===T?"tox-swatches":"tox-menu",Eb=T=>({backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:Tb(T),tieredMenu:"tox-tiered-menu"}),Ab=T=>{let E=Eb(T);return{backgroundMenu:E.backgroundMenu,selectedMenu:E.selectedMenu,menu:E.menu,selectedItem:E.selectedItem,item:_b(T)}},Mb=(T,E,D)=>{let B=Eb(D);return{tag:"div",classes:q([[B.menu,`tox-menu-${E}-column`],T?[B.hasIcons]:[]])}},cg=[iD.parts.items({})],Bb=(T,E,D)=>{let B=Eb(D);return{dom:{tag:"div",classes:q([[B.tieredMenu]])},markers:Ab(D)}},ch=x([us("data"),ys("inputAttributes",{}),ys("inputStyles",{}),ys("tag","input"),ys("inputClasses",[]),Di("onSetValue"),ys("styles",{}),ys("eventOrder",{}),hu("inputBehaviours",[r5,s1]),ys("selectOnFocus",!0)]),Ib=T=>kl([s1.config({onFocus:T.selectOnFocus?T=>{let E=T.element,D=$a(E);E.dom.setSelectionRange(0,D.length)}:b})]),Rb=T=>({...Ib(T),...bu(T.inputBehaviours,[r5.config({store:{mode:"manual",...T.data.map(T=>({initialValue:T})).getOr({}),getValue:T=>$a(T.element),setValue:(T,E)=>{$a(T.element)!==E&&qa(T.element,E)}},onSetValue:T.onSetValue})])}),Nb=T=>({tag:T.tag,attributes:{type:"text",...T.inputAttributes},styles:T.inputStyles,classes:T.inputClasses}),cv=fm({name:"Input",configFields:ch(),factory:(T,E)=>({uid:T.uid,dom:Nb(T),components:[],behaviours:Rb(T),eventOrder:T.eventOrder})}),cy=la("refetch-trigger-event"),cw=la("redirect-menu-item-interaction"),cA="tox-menu__searcher",Pb=T=>pi(T.element,`.${cA}`).bind(E=>T.getSystem().getByDom(E).toOptional()),Wb=T=>({fetchPattern:r5.getValue(T),selectionStart:T.element.dom.selectionStart,selectionEnd:T.element.dom.selectionEnd}),jb=T=>{let t=(T,E)=>(E.cut(),A.none()),o=(T,E)=>{let D={interactionEvent:E.event,eventType:E.event.raw.type};return Ir(T,cw,D),A.some(!0)},E="searcher-events";return{dom:{tag:"div",classes:[l5]},components:[cv.sketch({inputClasses:[cA,"tox-textfield"],inputAttributes:{...T.placeholder.map(E=>({placeholder:T.i18n(E)})).getOr({}),type:"search","aria-autocomplete":"list"},inputBehaviours:kl([Jp(E,[Ur(t1(),T=>{Fr(T,cy)}),Ur(tQ(),(T,E)=>{"Escape"===E.event.raw.key&&E.stop()})]),sq.config({mode:"special",onLeft:t,onRight:t,onSpace:t,onEnter:o,onEscape:o,onUp:o,onDown:o})]),eventOrder:{keydown:[E,sq.name()]}})]}},cS="tox-collection--results__js",$b=T=>{var E;return T.dom?{...T,dom:{...T.dom,attributes:{...null!==(E=T.dom.attributes)&&void 0!==E?E:{},id:la("aria-item-search-result-id"),"aria-selected":"false"}}}:T},qb=(T,E)=>D=>{let B=z(D,E);return H(B,E=>({dom:T,components:E}))},Xb=(T,E)=>{let D=[],B=[];return L(T,(T,M)=>{E(T,M)?(B.length>0&&D.push(B),B=[],(ve(T.dom,"innerHtml")||T.components&&T.components.length>0)&&B.push(T)):B.push(T)}),B.length>0&&D.push(B),H(D,T=>({dom:{tag:"div",classes:["tox-collection__group"]},components:T}))},Yb=(T,E,D)=>iD.parts.items({preprocess:B=>{let M=H(B,D);return"auto"!==T&&T>1?qb({tag:"div",classes:["tox-collection__group"]},T)(M):Xb(M,(T,D)=>"separator"===E[D].type)}}),Kb=(T,E,D=!0)=>({dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===T?["tox-collection--list"]:["tox-collection--grid"])},components:[Yb(T,E,w)]}),Jb=T=>N(T,T=>"icon"in T&&void 0!==T.icon),Zb=T=>(console.error(Kn(T)),console.log(T),A.none()),Qb=(T,E,D,B,M)=>{let er={dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[iD.parts.items({preprocess:T=>Xb(T,(T,E)=>"separator"===D[E].type)})]};return{value:T,dom:er.dom,components:er.components,items:D}},ev=(T,E,D,B,M)=>{if("color"===M.menuType){let E={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[iD.parts.items({preprocess:"auto"!==B?qb({tag:"div",classes:["tox-swatches__row"]},B):w})]}]};return{value:T,dom:E.dom,components:E.components,items:D}}if("normal"===M.menuType&&"auto"===B){let E=Kb(B,D);return{value:T,dom:E.dom,components:E.components,items:D}}if("normal"===M.menuType||"searchable"===M.menuType){let E="searchable"!==M.menuType?Kb(B,D):"search-with-field"===M.searchMode.searchMode?((T,E,D)=>{let B=la("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===T?["tox-collection--list"]:["tox-collection--grid"])},components:[jb({i18n:iz.translate,placeholder:D.placeholder}),{dom:{tag:"div",classes:[...1===T?["tox-collection--list"]:["tox-collection--grid"],cS],attributes:{id:B}},components:[Yb(T,E,$b)]}]}})(B,D,M.searchMode):((T,E,D=!0)=>{let B=la("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection",cS].concat(1===T?["tox-collection--list"]:["tox-collection--grid"]),attributes:{id:B}},components:[Yb(T,E,$b)]}})(B,D);return{value:T,dom:E.dom,components:E.components,items:D}}if("listpreview"===M.menuType&&"auto"!==B){let E={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[iD.parts.items({preprocess:qb({tag:"div",classes:["tox-collection__group"]},B)})]};return{value:T,dom:E.dom,components:E.components,items:D}}return{value:T,dom:Mb(E,B,M.menuType),components:cg,items:D}},cO=rs("type"),c_=rs("name"),cE=rs("label"),cF=rs("text"),cM=rs("title"),cI=rs("icon"),cR=rs("value"),cH=is("fetch"),cN=is("getSubmenuItems"),cU=is("onAction"),cL=is("onItemAction"),cz=Os("onSetup",()=>b),cP=ps("name"),cj=ps("text"),cW=ps("icon"),cG=ps("tooltip"),cJ=ps("label"),c$=ps("shortcut"),cX=fs("select"),cq=Cs("active",!1),cK=Cs("borderless",!1),cY=Cs("enabled",!0),cZ=Cs("primary",!1),Cv=T=>ys("columns",T),cQ=ys("meta",{}),c0=Os("onAction",b),Tv=T=>Ss("type",T),Ev=T=>gn("name","name",vn(()=>la(`${T}-name`)),tH),c1=Dn([cO,cj]),c2=Dn([Tv("autocompleteitem"),cq,cY,cQ,cR,cj,cW]),c3=[cY,cG,cW,cj,cz],c5=Dn([cO,cU].concat(c3)),Fv=T=>qn("toolbarbutton",c5,T),c9=[cq].concat(c3),c4=Dn(c9.concat([cO,cU])),Nv=T=>qn("ToggleButton",c4,T),c6=[Os("predicate",ep),ks("scope","node",["node","editor"]),ks("position","selection",["node","selection","line"])],c8=c3.concat([Tv("contextformbutton"),cZ,cU,es("original",w)]),c7=c9.concat([Tv("contextformbutton"),cZ,cU,es("original",w)]),dn=c3.concat([Tv("contextformbutton")]),dr=c9.concat([Tv("contextformtogglebutton")]),da=Jn("type",{contextformbutton:c8,contextformtogglebutton:c7}),du=Dn([Tv("contextform"),Os("initValue",x("")),cJ,ds("commands",da),ms("launch",Jn("type",{contextformbutton:dn,contextformtogglebutton:dr}))].concat(c6)),dm=Dn([Tv("contexttoolbar"),rs("items")].concat(c6)),dh=[cO,rs("src"),ps("alt"),_s("classes",[],tH)],db=Dn(dh),dv=[cO,cF,cP,_s("classes",["tox-collection__item-label"],tH)],dy=Dn(dv),dw=En(()=>jn("type",{cardimage:db,cardtext:dy,cardcontainer:dA})),dA=Dn([cO,Ss("direction","horizontal"),Ss("align","left"),Ss("valign","middle"),ds("items",dw)]),dS=[cY,cj,c$,gn("value","value",vn(()=>la("menuitem-value")),tI()),cQ],dO=Dn([cO,cJ,ds("items",dw),cz,c0].concat(dS)),dC=Dn([cO,cq,cW].concat(dS)),dE=[cO,rs("fancytype"),c0],dM=[ys("initData",{})].concat(dE),dI=[fs("select"),Ts("initData",{},[Cs("allowCustomColors",!0),Ss("storageKey","default"),bs("colors",tI())])].concat(dE),dR=Jn("fancytype",{inserttable:dM,colorswatch:dI}),dH=Dn([cO,cz,c0,cW].concat(dS)),dN=Dn([cO,cN,cz,cW].concat(dS)),dU=Dn([cO,cW,cq,cz,cU].concat(dS)),iy=(T,E,D)=>{let B=Xc(T.element,"."+D);if(B.length>0){let T=$(B,T=>{let D=T.dom.getBoundingClientRect().top,M=B[0].dom.getBoundingClientRect().top;return Math.abs(D-M)>E}).getOr(B.length);return A.some({numColumns:T,numRows:Math.ceil(B.length/T)})}return A.none()},ly=T=>kl([Jp(la("unnamed-events"),T)]),dL=la("tooltip.exclusive"),dz=la("tooltip.show"),dP=la("tooltip.hide"),my=(T,E,D)=>{T.getSystem().broadcastOn([dL],{})};var dj=Object.freeze({__proto__:null,hideAllExclusive:my,setComponents:(T,E,D,B)=>{D.getTooltip().each(T=>{T.getSystem().isConnected()&&sY.set(T,B)})}}),dW=Object.freeze({__proto__:null,events:(T,E)=>{let o=D=>{E.getTooltip().each(B=>{Bd(B),T.onHide(D,B),E.clearTooltip()}),E.clearTimer()};return Hr(q([[Ur(dz,D=>{E.resetTimer(()=>{(D=>{if(!E.isShowing()){my(D);let B=T.lazySink(D).getOrDie(),M=D.getSystem().build({dom:T.tooltipDom,components:T.tooltipComponents,events:Hr("normal"===T.mode?[Ur(tK(),T=>{Fr(D,dz)}),Ur(tX(),T=>{Fr(D,dP)})]:[]),behaviours:kl([sY.config({})])});E.setTooltip(M),Ad(B,M),T.onShow(D,M),rz.position(B,M,{anchor:T.anchor(D)})}})(D)},T.delay)}),Ur(dP,D=>{E.resetTimer(()=>{o(D)},T.delay)}),Ur(oh(),(T,E)=>{E.universal||R(E.channels,dL)&&o(T)}),oq(T=>{o(T)})],"normal"===T.mode?[Ur(tY(),T=>{Fr(T,dz)}),Ur(oo(),T=>{Fr(T,dP)}),Ur(tK(),T=>{Fr(T,dz)}),Ur(tX(),T=>{Fr(T,dP)})]:[Ur(oJ(),(T,E)=>{Fr(T,dz)}),Ur(o$(),T=>{Fr(T,dP)})]]))}}),dG=[os("lazySink"),os("tooltipDom"),ys("exclusive",!0),ys("tooltipComponents",[]),ys("delay",300),ks("mode","normal",["normal","follow-highlight"]),ys("anchor",T=>({type:"hotspot",hotspot:T,layouts:{onLtr:x([cl,ll,sl,al,rl,il]),onRtl:x([cl,ll,sl,al,rl,il])}})),Di("onHide"),Di("onShow")],dJ=Object.freeze({__proto__:null,init:()=>{let T=Ql(),E=Ql(),o=()=>{T.on(clearTimeout)},D=x("not-implemented");return _a({getTooltip:E.get,isShowing:E.isSet,setTooltip:E.set,clearTooltip:E.clear,clearTimer:o,resetTimer:(E,D)=>{o(),T.set(setTimeout(E,D))},readState:D})}});let d$=Ol({fields:dG,name:"tooltipping",active:dW,state:dJ,apis:dj}),dX="silver.readonly",dq=Dn([ns("readonly",tN)]),xy=(T,E)=>{let D=T.mainUi.outerContainer.element,B=[T.mainUi.mothership,...T.uiMotherships];E&&L(B,T=>{T.broadcastOn([r$()],{target:D})}),L(B,T=>{T.broadcastOn([dX],{readonly:E})})},wy=(T,E)=>{T.on("init",()=>{T.mode.isReadOnly()&&xy(E,!0)}),T.on("SwitchMode",()=>xy(E,T.mode.isReadOnly())),i9(T)&&T.mode.set("readonly")},Sy=()=>nK.config({channels:{[dX]:{schema:dq,onReceive:(T,E)=>{a$.set(T,E.readonly)}}}}),ky=T=>a$.config({disabled:T}),Cy=T=>a$.config({disabled:T,disableClass:"tox-tbtn--disabled"}),Oy=T=>a$.config({disabled:T,disableClass:"tox-tbtn--disabled",useNative:!1}),_y=(T,E)=>{let D=T.getApi(E);return T=>{T(D)}},Ty=(T,E)=>oX(D=>{_y(T,D)(D=>{let B=T.onSetup(D);eu(B)&&E.set(B)})}),Ey=(T,E)=>oq(D=>_y(T,D)(E.get())),Ay=(T,E)=>oY((D,B)=>{_y(T,D)(T.onAction),T.triggersSubmenu||E!==l2.CLOSE_ON_EXECUTE||(D.getSystem().isConnected()&&Fr(D,ow()),B.stop())}),dK={[of()]:["disabling","alloy.base.behaviour","toggling","item-events"]},By=(T,E,D,B)=>{let M=Es(b);return{type:"item",dom:E.dom,components:we(E.optComponents),data:T.data,eventOrder:dK,hasSubmenu:T.triggersSubmenu,itemBehaviours:kl([Jp("item-events",[Ay(T,D),Ty(T,M),Ey(T,M)]),a$.config({disabled:()=>!T.enabled||B.isDisabled(),disableClass:"tox-collection__item--state-disabled"}),Sy(),sY.config({})].concat(T.itemBehaviours))}},Fy=T=>({value:T.value,meta:{text:T.text.getOr(""),...T.meta}}),Iy=T=>{let E=i5.os.isMacOS()||i5.os.isiOS(),D=E?{alt:"⌥",ctrl:"⌃",shift:"⇧",meta:"⌘",access:"⌃⌥"}:{meta:"Ctrl",access:"Shift+Alt"},B=T.split("+"),M=H(B,T=>{let E=T.toLowerCase().trim();return ve(D,E)?D[E]:T});return E?M.join(""):M.join("+")},Ry=(T,E,D=[l8])=>ef(T,{tag:"div",classes:D},E),Ny=T=>({dom:{tag:"div",classes:[l7]},components:[ti(iz.translate(T))]}),Vy=(T,E)=>({dom:{tag:"div",classes:E,innerHtml:T}}),zy=(T,E)=>({dom:{tag:"div",classes:[l7]},components:[{dom:{tag:T.tag,styles:T.styles},components:[ti(iz.translate(E))]}]}),Hy=T=>({dom:{tag:"div",classes:["tox-collection__item-accessory"]},components:[ti(Iy(T))]}),Ly=T=>Ry("checkmark",T,["tox-collection__item-checkmark"]),Py=T=>{let E=T.map(T=>({attributes:{title:iz.translate(T),id:la("menu-item")}})).getOr({});return{tag:"div",classes:[l3,l5],...E}},Uy=(T,E,D,B=A.none())=>"color"===T.presets?((T,E,D)=>{let B=T.ariaLabel,M=T.value,er=T.iconContent.map(T=>((T,E,D)=>{let B=E();return Kh(T,B).or(D).getOrThunk(Xh(B))})(T,E.icons,D));return{dom:(()=>{let T=er.getOr(""),D=B.map(T=>({title:E.translate(T)})).getOr({}),ec={tag:"div",attributes:D,classes:[l9]};return"custom"===M?{...ec,tag:"button",classes:[...ec.classes,"tox-swatches__picker-btn"],innerHtml:T}:"remove"===M?{...ec,classes:[...ec.classes,"tox-swatch--remove"],innerHtml:T}:g(M)?{...ec,attributes:{...ec.attributes,"data-mce-color":M},styles:{"background-color":M},innerHtml:T}:ec})(),optComponents:[]}})(T,E,B):((T,E,D,B)=>{let M={tag:"div",classes:[l8]},er=D?T.iconContent.map(T=>ef(T,M,E.icons,B)).orThunk(()=>A.some({dom:M})):A.none(),ec=T.checkMark,eu=A.from(T.meta).fold(()=>Ny,T=>ve(T,"style")?k(zy,T.style):Ny),eg=T.htmlContent.fold(()=>T.textContent.map(eu),T=>A.some(Vy(T,[l7])));return{dom:Py(T.ariaLabel),optComponents:[er,eg,T.shortcutContent.map(Hy),ec,T.caret]}})(T,E,D,B),Wy=(T,E)=>be(T,"tooltipWorker").map(T=>[d$.config({lazySink:E.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:T=>({type:"submenu",item:T,overrides:{maxHeightFunction:n4}}),mode:"follow-highlight",onShow:(E,D)=>{T(T=>{d$.setComponents(E,[oi({element:Fe(T)})])})}})]).getOr([]),jy=(T,E)=>{var D;let B=(D=iz.translate(T),i2.DOM.encode(D));if(E.length>0){let T=RegExp(E.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return B.replace(T,T=>`<span class="tox-autocompleter-highlight">${T}</span>`)}return B},Gy=(T,E)=>H(T,T=>{switch(T.type){case"cardcontainer":return((T,E)=>{let D="vertical"===T.direction?"tox-collection__item-container--column":cc,B="left"===T.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right";return{dom:{tag:"div",classes:[ca,D,B,(()=>{switch(T.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}})()]},components:E}})(T,Gy(T.items,E));case"cardimage":var D;return D=T.src,{dom:{tag:"img",classes:T.classes,attributes:{src:D,alt:T.alt.getOr("")}}};case"cardtext":let B=T.name.exists(T=>R(E.cardText.highlightOn,T)),M=B?A.from(E.cardText.matchText).getOr(""):"";return Vy(jy(T.text,M),T.classes)}}),dY=Yu(ii(),ip()),qy=T=>({value:Jy(T)}),dZ=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,dQ=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Ky=T=>dZ.test(T)||dQ.test(T),Jy=T=>_e(T,"#").toUpperCase(),Zy=T=>{let E=T.toString(16);return(1===E.length?"0"+E:E).toUpperCase()},Qy=T=>{let E=Zy(T.red)+Zy(T.green)+Zy(T.blue);return qy(E)},d0=Math.min,d1=Math.max,d2=Math.round,d3=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,d5=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,rx=(T,E,D,B)=>({red:T,green:E,blue:D,alpha:B}),ax=T=>{let E=parseInt(T,10);return E.toString()===T&&E>=0&&E<=255},ix=T=>{let E,D,B;let M=(T.hue||0)%360,er=T.saturation/100,ec=T.value/100;if(er=d1(0,d0(er,1)),ec=d1(0,d0(ec,1)),0===er)return rx(E=D=B=d2(255*ec),D,B,1);let eu=M/60,eg=ec*er,ep=eg*(1-Math.abs(eu%2-1)),eh=ec-eg;switch(Math.floor(eu)){case 0:E=eg,D=ep,B=0;break;case 1:E=ep,D=eg,B=0;break;case 2:E=0,D=eg,B=ep;break;case 3:E=0,D=ep,B=eg;break;case 4:E=ep,D=0,B=eg;break;case 5:E=eg,D=0,B=ep;break;default:E=D=B=0}return rx(E=d2(255*(E+eh)),D=d2(255*(D+eh)),B=d2(255*(B+eh)),1)},lx=T=>{let E=(T=>{let E=(T=>{let E=T.value.replace(dZ,(T,E,D,B)=>E+E+D+D+B+B);return{value:E}})(T),D=dQ.exec(E.value);return null===D?["FFFFFF","FF","FF","FF"]:D})(T),D=parseInt(E[1],16),B=parseInt(E[2],16),M=parseInt(E[3],16);return rx(D,B,M,1)},cx=(T,E,D,B)=>{let M=parseInt(T,10),er=parseInt(E,10),ec=parseInt(D,10),eu=parseFloat(B);return rx(M,er,ec,eu)},dx=T=>{if("transparent"===T)return A.some(rx(0,0,0,0));let E=d3.exec(T);if(null!==E)return A.some(cx(E[1],E[2],E[3],"1"));let D=d5.exec(T);return null!==D?A.some(cx(D[1],D[2],D[3],D[4])):A.none()},ux=T=>`rgba(${T.red},${T.green},${T.blue},${T.alpha})`,d9=rx(255,0,0,1),gx=(T,E)=>{T.dispatch("ResizeContent",E)},px=(T,E)=>{T.dispatch("TextColorChange",E)},hx=(T,E)=>T.dispatch("ResolveName",{name:E.nodeName.toLowerCase(),target:E}),fx=(T,E)=>()=>{T(),E()},bx=T=>yx(T,"NodeChange",E=>{E.setEnabled(T.selection.isEditable())}),vx=(T,E)=>D=>{let B=bx(T)(D),M=(D=>{let B=Zl(),s=()=>{D.setActive(T.formatter.match(E));let M=T.formatter.formatChanged(E,D.setActive);B.set(M)};return T.initialized?s():T.once("init",s),()=>{T.off("init",s),B.clear()}})(D);return()=>{B(),M()}},yx=(T,E,D)=>B=>{let s=()=>D(B),r=()=>{D(B),T.on(E,s)};return T.initialized?r():T.once("init",r),()=>{T.off("init",r),T.off(E,s)}},xx=T=>E=>()=>{T.undoManager.transact(()=>{T.focus(),T.execCommand("mceToggleFormat",!1,E.format)})},wx=(T,E)=>()=>T.execCommand(E);var d4=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");let d6={},Cx=T=>be(d6,T).getOrThunk(()=>{let D=`tinymce-custom-colors-${T}`,B=d4.getItem(D);if(m(B)){let T=d4.getItem("tinymce-custom-colors");d4.setItem(D,g(T)?T:"[]")}let M=((T,D=10)=>{let B=d4.getItem(T),M=E(B)?JSON.parse(B):[],er=D-M.length<0?M.slice(0,D):M,i=T=>{er.splice(T,1)};return{add:E=>{I(er,E).each(i),er.unshift(E),er.length>D&&er.pop(),d4.setItem(T,JSON.stringify(er))},state:()=>er.slice(0)}})(D,10);return d6[T]=M,M}),Ox=(T,E)=>{Cx(T).add(E)},_x=(T,E,D)=>({hue:T,saturation:E,value:D}),Tx=T=>{let E=0,D=T.red/255,B=T.green/255,M=T.blue/255,er=Math.min(D,Math.min(B,M)),ec=Math.max(D,Math.max(B,M));return er===ec?_x(0,0,100*er):_x(Math.round(60*((D===er?3:M===er?1:5)-(D===er?B-M:M===er?D-B:M-D)/(ec-er))),Math.round(100*((ec-er)/ec)),Math.round(100*ec))},Ex=T=>Qy(ix(T)),Ax=T=>(Ky(T)?A.some({value:Jy(T)}):A.none()).orThunk(()=>dx(T).map(Qy)).getOrThunk(()=>{let E=document.createElement("canvas");E.height=1,E.width=1;let D=E.getContext("2d");D.clearRect(0,0,E.width,E.height),D.fillStyle="#FFFFFF",D.fillStyle=T,D.fillRect(0,0,1,1);let B=D.getImageData(0,0,1,1).data,M=B[0],er=B[1],ec=B[2],eu=B[3];return Qy(rx(M,er,ec,eu))}),d8="forecolor",d7="hilitecolor",Bx=T=>{let E=[];for(let D=0;D<T.length;D+=2)E.push({text:T[D+1],value:"#"+Ax(T[D]).value,icon:"checkmark",type:"choiceitem"});return E},Fx=T=>E=>E.options.get(T),uo="#000000",Rx=(T,E)=>E===d8&&T.options.isSet("color_map_foreground")?Fx("color_map_foreground")(T):E===d7&&T.options.isSet("color_map_background")?Fx("color_map_background")(T):Fx("color_map")(T),Nx=(T,E="default")=>Math.max(5,Math.ceil(Math.sqrt(Rx(T,E).length))),Vx=(T,E)=>{let D=Fx("color_cols")(T),B=Nx(T,E);return D===Nx(T)?B:D},zx=(T,E="default")=>Math.round(E===d8?Fx("color_cols_foreground")(T):E===d7?Fx("color_cols_background")(T):Fx("color_cols")(T)),un=Fx("custom_colors"),ur=Fx("color_default_foreground"),ua=Fx("color_default_background"),Ux=(T,E)=>{let D=Fe(T.selection.getStart()),B="hilitecolor"===E?Is(D,T=>{if(eL(T)){let E=It(T,"background-color");return Ce(dx(E).exists(T=>0!==T.alpha),E)}return A.none()}).getOr("rgba(0, 0, 0, 0)"):It(D,"color");return dx(B).map(T=>"#"+Qy(T).value)},Wx=T=>{let E="choiceitem",D={type:E,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return T?[D,{type:E,text:"Custom color",icon:"color-picker",value:"custom"}]:[D]},jx=(T,E,D,B)=>{"custom"===D?Jx(T)(D=>{D.each(D=>{Ox(E,D),T.execCommand("mceApplyTextcolor",E,D),B(D)})},Ux(T,E).getOr(uo)):"remove"===D?(B(""),T.execCommand("mceRemoveTextcolor",E)):(B(D),T.execCommand("mceApplyTextcolor",E,D))},Gx=(T,E,D)=>T.concat(H(Cx(E).state(),T=>({type:"choiceitem",text:T,icon:"checkmark",value:T})).concat(Wx(D))),$x=(T,E,D)=>B=>{B(Gx(T,E,D))},qx=(T,E,D)=>{T.setIconFill("forecolor"===E?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",D)},Xx=(T,E)=>D=>{let B=Ux(T,E);return xe(B,D.toUpperCase())},Yx=(T,E,D,B,M)=>{T.ui.registry.addSplitButton(E,{tooltip:B,presets:"color",icon:"forecolor"===E?"text-color":"highlight-bg-color",select:Xx(T,D),columns:zx(T,D),fetch:$x(Rx(T,D),D,un(T)),onAction:E=>{jx(T,D,M.get(),b)},onItemAction:(B,er)=>{jx(T,D,er,D=>{M.set(D),px(T,{name:E,color:D})})},onSetup:D=>{qx(D,E,M.get());let n=T=>{T.name===E&&qx(D,T.name,T.color)};return T.on("TextColorChange",n),fx(bx(T)(D),()=>{T.off("TextColorChange",n)})}})},Kx=(T,E,D,B,M)=>{T.ui.registry.addNestedMenuItem(E,{text:B,icon:"forecolor"===E?"text-color":"highlight-bg-color",onSetup:D=>(qx(D,E,M.get()),bx(T)(D)),getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"colorswatch",select:Xx(T,D),initData:{storageKey:D},onAction:B=>{jx(T,D,B.value,D=>{M.set(D),px(T,{name:E,color:D})})}}]})},Jx=T=>(E,D)=>{let B=!1;T.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:D},onAction:(T,E)=>{"hex-valid"===E.name&&(B=E.value)},onSubmit:D=>{let M=D.getData().colorpicker;B?(E(A.from(M)),D.close()):T.windowManager.alert(T.translate(["Invalid hex color code: {0}",M]))},onClose:b,onCancel:()=>{E(A.none())}})},Zx=(T,E,D,B,M,er,ec,eu)=>{let eg=Jb(E),ep=Qx(E,D,B,"color"!==M?"normal":"color",er,ec,eu);return ev(T,eg,ep,B,{menuType:M})},Qx=(T,E,D,B,M,er,ec)=>we(H(T,eu=>"choiceitem"===eu.type?qn("choicemenuitem",dC,eu).fold(Zb,eu=>A.some(((T,E,D,B,M,er,ec,eu=!0)=>{let eg=Uy({presets:D,textContent:E?T.text:A.none(),htmlContent:A.none(),ariaLabel:T.text,iconContent:T.icon,shortcutContent:E?T.shortcut:A.none(),checkMark:E?A.some(Ly(ec.icons)):A.none(),caret:A.none(),value:T.value},ec,eu);return tw(By({data:Fy(T),enabled:T.enabled,getApi:T=>({setActive:E=>{s9.set(T,E)},isActive:()=>s9.isOn(T),isEnabled:()=>!a$.isDisabled(T),setEnabled:E=>a$.set(T,!E)}),onAction:E=>B(T.value),onSetup:T=>(T.setActive(M),b),triggersSubmenu:!1,itemBehaviours:[]},eg,er,ec),{toggling:{toggleClass:l6,toggleOnExecute:!1,selected:T.active,exclusive:!0}})})(eu,1===D,B,E,er(eu.value),M,ec,Jb(T)))):A.none())),ew=(T,E)=>{let D=Ab(E);return 1===T?{mode:"menu",moveOnTab:!0}:"auto"===T?{mode:"grid",selector:"."+D.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===E?"tox-swatches__row":"tox-collection__group"),previousSelector:T=>"color"===E?pi(T.element,"[aria-checked=true]"):A.none()}},uu=la("cell-over"),ub=la("cell-execute"),nw=(T,E,D)=>{let n=D=>Ir(D,ub,{row:T,col:E}),s=(T,E)=>{E.stop(),n(T)};return ri({dom:{tag:"div",attributes:{role:"button","aria-label":D}},behaviours:kl([Jp("insert-table-picker-cell",[Ur(tK(),s1.focus),Ur(of(),n),Ur(t3(),s),Ur(oy(),s)]),s9.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),s1.config({onFocus:D=>Ir(D,uu,{row:T,col:E})})])})},sw=T=>X(T,T=>H(T,Sa)),rw=(T,E)=>ti(`${E}x${T}`),uv={inserttable:(T,E)=>{let D=((T,E,D)=>{let B=[];for(let E=0;E<10;E++){let D=[];for(let B=0;B<10;B++){let M=T(E+1,B+1);D.push(nw(E,B,M))}B.push(D)}return B})((T,D)=>E.shared.providers.translate(`${D} columns, ${T} rows`)),B=rw(0,0),M=jh({dom:{tag:"span",classes:["tox-insert-table-picker__label"]},components:[B],behaviours:kl([sY.config({})])});return{type:"widget",data:{value:la("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[dY.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:sw(D).concat(M.asSpec()),behaviours:kl([Jp("insert-table-picker",[oX(T=>{sY.set(M.get(T),[B])}),$r(uu,(T,E,B)=>{let{row:er,col:ec}=B.event;((T,E,D,B,M)=>{for(let B=0;B<10;B++)for(let M=0;M<10;M++)s9.set(T[B][M],B<=E&&M<=D)})(D,er,ec),sY.set(M.get(T),[rw(er+1,ec+1)])}),$r(ub,(E,D,B)=>{let{row:M,col:er}=B.event;T.onAction({numRows:M+1,numColumns:er+1}),Fr(E,ow())})]),sq.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:(T,E)=>{let D=((T,E)=>{let D=T.initData.allowCustomColors&&E.colorinput.hasCustomColors();return T.initData.colors.fold(()=>Gx(E.colorinput.getColors(T.initData.storageKey),T.initData.storageKey,D),T=>T.concat(Wx(D)))})(T,E),B=E.colorinput.getColorCols(T.initData.storageKey),M="color",er={...Zx(la("menu-value"),D,E=>{T.onAction({value:E})},B,M,l2.CLOSE_ON_EXECUTE,T.select.getOr(ep),E.shared.providers),markers:Ab(M),movement:ew(B,M)};return{type:"widget",data:{value:la("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[dY.widget(iD.sketch(er))]}}},iw=T=>({type:"separator",dom:{tag:"div",classes:[l5,"tox-collection__group-heading"]},components:T.text.map(ti).toArray()});var uy=Object.freeze({__proto__:null,getCoupled:(T,E,D,B)=>D.getOrCreate(T,E,B),getExistingCoupled:(T,E,D,B)=>D.getExisting(T,E,B)}),uw=[ns("others",$n(tx.value,tI()))],uO=Object.freeze({__proto__:null,init:()=>{let T={},t=(E,D)=>{if(0===eI(E.others).length)throw Error("Cannot find any known coupled components");return be(T,D)},E=x({});return _a({readState:E,getExisting:(T,E,D)=>t(E,D).orThunk(()=>(be(E.others,D).getOrDie("No information found for coupled component: "+D),A.none())),getOrCreate:(E,D,B)=>t(D,B).getOrThunk(()=>{let M=be(D.others,B).getOrDie("No information found for coupled component: "+B)(E),er=E.getSystem().build(M);return T[B]=er,er})})}});let uC=Ol({fields:uw,name:"coupling",apis:uy,state:uO}),mw=T=>{let E=A.none(),D=[],n=T=>{s()?r(T):D.push(T)},s=()=>E.isSome(),r=T=>{E.each(E=>{setTimeout(()=>{T(E)},0)})};return T(T=>{s()||(E=A.some(T),L(D,r),D=[])}),{get:n,map:T=>mw(E=>{n(D=>{E(T(D))})}),isReady:s}},u_={nu:mw,pure:T=>mw(E=>{E(T)})},pw=T=>{setTimeout(()=>{throw T},0)},hw=T=>{let t=E=>{T().then(E,pw)};return{map:E=>hw(()=>T().then(E)),bind:E=>hw(()=>T().then(T=>E(T).toPromise())),anonBind:E=>hw(()=>T().then(()=>E.toPromise())),toLazy:()=>u_.nu(t),toCached:()=>{let E=null;return hw(()=>(null===E&&(E=T()),E))},toPromise:T,get:t}},fw=T=>hw(()=>new Promise(T)),bw=T=>hw(()=>Promise.resolve(T)),uE=x("sink"),uM=x(aE({name:uE(),overrides:x({dom:{tag:"div"},behaviours:kl([rz.config({useFixed:eh})]),events:Hr([qr(tQ()),qr(tJ()),qr(t3())])})})),xw=(T,E)=>{let D=T.getHotspot(E).getOr(E),B="hotspot",M=T.getAnchorOverrides();return T.layouts.fold(()=>({type:B,hotspot:D,overrides:M}),T=>({type:B,hotspot:D,overrides:M,layouts:T}))},ww=(T,E,D,B,M,er,ec)=>{let eu=((T,E,D,B,M,er,ec)=>{let eu=(0,T.fetch)(B).map(E),eg=Cw(B,T);return eu.map(T=>T.bind(T=>A.from(iH.sketch({...er.menu(),uid:ha(""),data:T,highlightOnOpen:ec,onOpenMenu:(T,E)=>{let B=eg().getOrDie();rz.position(B,E,{anchor:D}),rJ.decloak(M)},onOpenSubmenu:(T,E,D)=>{let B=eg().getOrDie();rz.position(B,D,{anchor:{type:"submenu",item:E}}),rJ.decloak(M)},onRepositionMenu:(T,E,B)=>{let M=eg().getOrDie();rz.position(M,E,{anchor:D}),L(B,T=>{rz.position(M,T.triggeredMenu,{anchor:{type:"submenu",item:T.triggeringItem}})})},onEscape:()=>(s1.focus(B),rJ.close(M),A.some(!0))}))))})(T,E,xw(T,D),D,B,M,ec);return eu.map(T=>(T.fold(()=>{rJ.isOpen(B)&&rJ.close(B)},T=>{rJ.cloak(B),rJ.open(B,T),er(B)}),B))},Sw=(T,E,D,B,M,er,ec)=>(rJ.close(B),bw(B)),kw=(T,E,D,B,M,er)=>{let ec=uC.getCoupled(D,"sandbox");return(rJ.isOpen(ec)?Sw:ww)(T,E,D,ec,B,M,er)},Cw=(T,E)=>T.getSystem().getByUid(E.uid+"-"+uE()).map(T=>()=>tx.value(T)).getOrThunk(()=>E.lazySink.fold(()=>()=>tx.error(Error("No internal sink is specified, nor could an external sink be found")),E=>()=>E(T))),Ow=T=>{rJ.getState(T).each(T=>{iH.repositionMenus(T)})},_w=(T,E,D)=>{let B=bi(),M=Cw(E,T);return{dom:{tag:"div",classes:T.sandboxClasses,attributes:{id:B.id,role:"listbox"}},behaviours:bu(T.sandboxBehaviours,[r5.config({store:{mode:"memory",initialValue:E}}),rJ.config({onOpen:(M,er)=>{let ec=xw(T,E);B.link(E.element),T.matchWidth&&((T,E,D)=>{var B;let M=aP.getCurrent(E).getOr(E),er=Jt(T.element);D?Dt(M.element,"min-width",er+"px"):(B=M.element,eX.set(B,er))})(ec.hotspot,er,T.useMinWidth),T.onOpen(ec,M,er),void 0!==D&&void 0!==D.onOpen&&D.onOpen(M,er)},onClose:(T,M)=>{B.unlink(E.element),void 0!==D&&void 0!==D.onClose&&D.onClose(T,M)},isPartOf:(T,D,B)=>vi(D,B)||vi(E,B),getAttachPoint:()=>M().getOrDie()}),aP.config({find:T=>rJ.getState(T).bind(T=>aP.getCurrent(T))}),nK.config({channels:{...Qd({isExtraPart:ep}),...tu({doReposition:Ow})}})])}},Tw=T=>{let E=uC.getCoupled(T,"sandbox");Ow(E)},Ew=()=>[ys("sandboxClasses",[]),hu("sandboxBehaviours",[aP,nK,rJ,r5])],uI=x([os("dom"),os("fetch"),Di("onOpen"),Bi("onExecute"),ys("getHotspot",A.some),ys("getAnchorOverrides",x({})),wc(),hu("dropdownBehaviours",[s9,uC,sq,s1]),os("toggleClass"),ys("eventOrder",{}),us("lazySink"),ys("matchWidth",!1),ys("useMinWidth",!1),us("role")].concat(Ew())),uR=x([a_({schema:[Ei(),ys("fakeFocus",!1)],name:"menu",defaults:T=>({onExecute:T.onExecute})}),uM()]),uH=bm({name:"Dropdown",configFields:uI(),partFields:uR(),factory:(T,E,D,B)=>{let s=T=>{rJ.getState(T).each(T=>{iH.highlightPrimary(T)})},r=(E,D,M)=>kw(T,w,E,B,D,M),M={expand:T=>{s9.isOn(T)||r(T,b,iQ.HighlightNone).get(b)},open:T=>{s9.isOn(T)||r(T,b,iQ.HighlightMenuAndItem).get(b)},refetch:E=>uC.getExistingCoupled(E,"sandbox").fold(()=>r(E,b,iQ.HighlightMenuAndItem).map(b),D=>ww(T,w,E,D,B,b,iQ.HighlightMenuAndItem).map(b)),isOpen:s9.isOn,close:T=>{s9.isOn(T)&&r(T,b,iQ.HighlightMenuAndItem).get(b)},repositionMenus:T=>{s9.isOn(T)&&Tw(T)}},i=(T,E)=>(Rr(T),A.some(!0));return{uid:T.uid,dom:T.dom,components:E,behaviours:bu(T.dropdownBehaviours,[s9.config({toggleClass:T.toggleClass,aria:{mode:"expanded"}}),uC.config({others:{sandbox:E=>_w(T,E,{onOpen:()=>s9.on(E),onClose:()=>s9.off(E)})}}),sq.config({mode:"special",onSpace:i,onEnter:i,onDown:(T,E)=>{if(uH.isOpen(T)){let E=uC.getCoupled(T,"sandbox");s(E)}else uH.open(T);return A.some(!0)},onEscape:(T,E)=>uH.isOpen(T)?(uH.close(T),A.some(!0)):A.none()}),s1.config({})]),events:mh(A.some(T=>{r(T,s,iQ.HighlightMenuAndItem).get(b)})),eventOrder:{...T.eventOrder,[of()]:["disabling","toggling","alloy.base.behaviour"]},apis:M,domModification:{attributes:{"aria-haspopup":"true",...T.role.fold(()=>({}),T=>({role:T})),..."button"===T.dom.tag?{type:be(T.dom,"attributes").bind(T=>be(T,"type")).getOr("button")}:{}}}}},apis:{open:(T,E)=>T.open(E),refetch:(T,E)=>T.refetch(E),expand:(T,E)=>T.expand(E),close:(T,E)=>T.close(E),isOpen:(T,E)=>T.isOpen(E),repositionMenus:(T,E)=>T.repositionMenus(E)}}),Bw=(T,E,D)=>{Pb(T).each(T=>{((T,E)=>{_t(E.element,"id").each(E=>kt(T.element,"aria-activedescendant",E))})(T,D),(Ua(E.element,cS)?A.some(E.element):pi(E.element,"."+cS)).each(E=>{_t(E,"id").each(E=>kt(T.element,"aria-controls",E))})}),kt(D.element,"aria-selected","true")},Fw=(T,E,D)=>{kt(D.element,"aria-selected","false")},Iw=T=>uC.getExistingCoupled(T,"sandbox").bind(Pb).map(Wb).map(T=>T.fetchPattern).getOr("");(pP=pW||(pW={}))[pP.ContentFocus=0]="ContentFocus",pP[pP.UiFocus=1]="UiFocus";let Nw=(T,E,D,B,M)=>{let er=D.shared.providers,a=T=>M?{...T,shortcut:A.none(),icon:T.text.isSome()?A.none():T.icon}:T;switch(T.type){case"menuitem":return qn("menuitem",dH,T).fold(Zb,T=>A.some(((T,E,D,B=!0)=>{let M=Uy({presets:"normal",iconContent:T.icon,textContent:T.text,htmlContent:A.none(),ariaLabel:T.text,caret:A.none(),checkMark:A.none(),shortcutContent:T.shortcut},D,B);return By({data:Fy(T),getApi:T=>({isEnabled:()=>!a$.isDisabled(T),setEnabled:E=>a$.set(T,!E)}),enabled:T.enabled,onAction:T.onAction,onSetup:T.onSetup,triggersSubmenu:!1,itemBehaviours:[]},M,E,D)})(a(T),E,er,B)));case"nestedmenuitem":return qn("nestedmenuitem",dN,T).fold(Zb,T=>A.some(((T,E,D,B=!0,M=!1)=>{let er=M?Ry("chevron-down",D.icons,[co]):Ry("chevron-right",D.icons,[co]),ec=Uy({presets:"normal",iconContent:T.icon,textContent:T.text,htmlContent:A.none(),ariaLabel:T.text,caret:A.some(er),checkMark:A.none(),shortcutContent:T.shortcut},D,B);return By({data:Fy(T),getApi:T=>({isEnabled:()=>!a$.isDisabled(T),setEnabled:E=>a$.set(T,!E),setIconFill:(E,D)=>{pi(T.element,`svg path[class="${E}"], rect[class="${E}"]`).each(T=>{kt(T,"fill",D)})}}),enabled:T.enabled,onAction:b,onSetup:T.onSetup,triggersSubmenu:!0,itemBehaviours:[]},ec,E,D)})(a(T),E,er,B,M)));case"togglemenuitem":return qn("togglemenuitem",dU,T).fold(Zb,T=>A.some(((T,E,D,B=!0)=>{let M=Uy({iconContent:T.icon,textContent:T.text,htmlContent:A.none(),ariaLabel:T.text,checkMark:A.some(Ly(D.icons)),caret:A.none(),shortcutContent:T.shortcut,presets:"normal",meta:T.meta},D,B);return tw(By({data:Fy(T),enabled:T.enabled,getApi:T=>({setActive:E=>{s9.set(T,E)},isActive:()=>s9.isOn(T),isEnabled:()=>!a$.isDisabled(T),setEnabled:E=>a$.set(T,!E)}),onAction:T.onAction,onSetup:T.onSetup,triggersSubmenu:!1,itemBehaviours:[]},M,E,D),{toggling:{toggleClass:l6,toggleOnExecute:!1,selected:T.active}})})(a(T),E,er,B)));case"separator":return qn("separatormenuitem",c1,T).fold(Zb,T=>A.some(iw(T)));case"fancymenuitem":return qn("fancymenuitem",dR,T).fold(Zb,T=>be(uv,T.fancytype).map(E=>E(T,D)));default:return console.error("Unknown item in general menu",T),A.none()}},Vw=(T,E,D,B,M,er,ec)=>{let eu=1===B,eg=!eu||Jb(T);return we(H(T,T=>{switch(T.type){case"separator":return qn("Autocompleter.Separator",c1,T).fold(Zb,T=>A.some(iw(T)));case"cardmenuitem":return qn("cardmenuitem",dO,T).fold(Zb,T=>A.some(((T,E,D,B)=>{let M={dom:Py(T.label),optComponents:[A.some({dom:{tag:"div",classes:[ca,cc]},components:Gy(T.items,B)})]};return By({data:Fy({text:A.none(),...T}),enabled:T.enabled,getApi:T=>({isEnabled:()=>!a$.isDisabled(T),setEnabled:E=>{a$.set(T,!E),L(Xc(T.element,"*"),D=>{T.getSystem().getByDom(D).each(T=>{T.hasConfigured(a$)&&a$.set(T,!E)})})}}),onAction:T.onAction,onSetup:T.onSetup,triggersSubmenu:!1,itemBehaviours:A.from(B.itemBehaviours).getOr([])},M,E,D.providers)})({...T,onAction:E=>{T.onAction(E),D(T.value,T.meta)}},M,er,{itemBehaviours:Wy(T.meta,er),cardText:{matchText:E,highlightOn:ec}})));default:return qn("Autocompleter.Item",c2,T).fold(Zb,T=>A.some(((T,E,D,B,M,er,ec,eu=!0)=>{let eg=Uy({presets:B,textContent:A.none(),htmlContent:D?T.text.map(T=>jy(T,E)):A.none(),ariaLabel:T.text,iconContent:T.icon,shortcutContent:A.none(),checkMark:A.none(),caret:A.none(),value:T.value},ec.providers,eu,T.icon);return By({data:Fy(T),enabled:T.enabled,getApi:x({}),onAction:E=>M(T.value,T.meta),onSetup:x(b),triggersSubmenu:!1,itemBehaviours:Wy(T.meta,ec)},eg,er,ec.providers)})(T,E,eu,"normal",D,M,er,eg)))}}))},zw=(T,E,D,B,M,er)=>{let ec=Jb(E),eu=we(H(E,T=>{var E;return E="nestedmenuitem"===T.type&&T.getSubmenuItems().length<=0?{...T,enabled:!1}:T,Nw(E,D,B,M?!ve(E,"text"):ec,M)})),eg="no-search"===er.searchMode?{menuType:"normal"}:{menuType:"searchable",searchMode:er};return(M?Qb:ev)(T,ec,eu,1,eg)},Hw=T=>iH.singleData(T.value,T),Lw=(T,E)=>{let D=Es(!1),B=Es(!1),M=ri(iN.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:kl([Jp("dismissAutocompleter",[Ur(oU(),()=>c())])]),lazySink:E.getSink})),r=()=>iN.isOpen(M),er=B.get,i=()=>{r()&&iN.hide(M)},l=()=>iN.getContent(M).bind(T=>te(T.components(),0)),c=()=>T.execCommand("mceAutocompleterClose"),d=B=>{let er=(B=>{let M=re(B,T=>A.from(T.columns)).getOr(1);return X(B,B=>{let er=B.items;return Vw(er,B.matchText,(E,M)=>{var er;let ec=T.selection.getRng();(er=T.dom,mb(Fe(ec.startContainer)).map(T=>{let E=er.createRng();return E.selectNode(T.dom),E})).each(er=>{D.set(!0),B.onAction({hide:()=>c(),reload:E=>{i(),T.execCommand("mceAutocompleterReload",!1,{fetchOptions:E})}},er,E,M),D.set(!1)})},M,l2.BUBBLE_TO_SANDBOX,E,B.highlightOn)})})(B);er.length>0?(pi(Fe(T.getBody()),l1).each(E=>{let D=re(B,T=>A.from(T.columns)).getOr(1);iN.showMenuAt(M,{anchor:{type:"node",root:Fe(T.getBody()),node:A.from(E)}},((T,E,D,B)=>{let M=ew(E,B),er=Ab(B);return{data:Hw({...T,movement:M,menuBehaviours:ly("auto"!==E?[]:[oX((T,E)=>{iy(T,4,er.item).each(({numColumns:E,numRows:D})=>{sq.setGridSize(T,D,E)})})])}),menu:{markers:Ab(B),fakeFocus:D===pW.ContentFocus}}})(ev("autocompleter-value",!0,er,D,{menuType:"normal"}),D,pW.ContentFocus,"normal"))}),l().each(aK.highlightFirst)):i()};T.on("AutocompleterStart",({lookupData:T})=>{B.set(!0),D.set(!1),d(T)}),T.on("AutocompleterUpdate",({lookupData:T})=>d(T)),T.on("AutocompleterEnd",()=>{i(),B.set(!1),D.set(!1)}),((T,E)=>{let o=(T,E)=>{Ir(T,tQ(),{raw:E})},n=()=>T.getMenu().bind(aK.getHighlighted);E.on("keydown",E=>{let D=E.which;T.isActive()&&(T.isMenuOpen()?13===D?(n().each(Rr),E.preventDefault()):40===D?(n().fold(()=>{T.getMenu().each(aK.highlightFirst)},T=>{o(T,E)}),E.preventDefault(),E.stopImmediatePropagation()):37!==D&&38!==D&&39!==D||n().each(T=>{o(T,E),E.preventDefault(),E.stopImmediatePropagation()}):13!==D&&38!==D&&40!==D||T.cancelIfNecessary())}),E.on("NodeChange",E=>{T.isActive()&&!T.isProcessingAction()&&mb(Fe(E.element)).isNone()&&T.cancelIfNecessary()})})({cancelIfNecessary:c,isMenuOpen:r,isActive:er,isProcessingAction:D.get,getMenu:l},T)},uN=["visible","hidden","clip"],Uw=T=>eH(T).length>0&&!R(uN,T),Ww=T=>{if(je(T)){let E=It(T,"overflow-x"),D=It(T,"overflow-y");return Uw(E)||Uw(D)}return!1},jw=(T,E)=>lb(T)?(T=>{let E=qc(T,Ww),D=0===E.length?bt(T).map(vt).map(T=>qc(T,Ww)).getOr([]):E;return oe(D).map(T=>({element:T,others:D.slice(1)}))})(E):A.none(),Gw=T=>{let E=[...H(T.others,Jo),en()];return j(E,(T,E)=>Qo(T,E),Jo(T.element))},$w=(T,E,D)=>hi(T,E,D).isSome(),qw=(T,E)=>{let D=null;return{cancel:()=>{null!==D&&(clearTimeout(D),D=null)},schedule:(...B)=>{D=setTimeout(()=>{T.apply(null,B),D=null},E)}}},Xw=T=>{let E=T.raw;return void 0===E.touches||1!==E.touches.length?A.none():A.some(E.touches[0])},Yw=(T,E)=>{let D={stopBackspace:!0,...E},B=(T=>{let E=Ql(),D=Es(!1),B=qw(E=>{T.triggerEvent(ox(),E),D.set(!0)},400),M=Ds([{key:tP(),value:T=>(Xw(T).each(M=>{B.cancel();let er={x:M.clientX,y:M.clientY,target:T.target};B.schedule(T),D.set(!1),E.set(er)}),A.none())},{key:tj(),value:T=>(B.cancel(),Xw(T).each(T=>{E.on(D=>{((T,E)=>{let D=Math.abs(T.clientX-E.x),B=Math.abs(T.clientY-E.y);return D>5||B>5})(T,D)&&E.clear()})}),A.none())},{key:tW(),value:M=>(B.cancel(),E.get().filter(T=>Ze(T.target,M.target)).map(E=>D.get()?(M.prevent(),!1):T.triggerEvent(oy(),M)))}]);return{fireIfReady:(T,E)=>be(M,E).bind(E=>E(T))}})(D),M=H(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),E=>tc(T,E,T=>{B.fireIfReady(T,E).each(E=>{E&&T.kill()}),D.triggerEvent(E,T)&&T.kill()})),er=Ql(),ec=tc(T,"paste",T=>{B.fireIfReady(T,"paste").each(E=>{E&&T.kill()}),D.triggerEvent("paste",T)&&T.kill(),er.set(setTimeout(()=>{D.triggerEvent(or(),T)},0))}),eu=tc(T,"keydown",T=>{D.triggerEvent("keydown",T)?T.kill():!D.stopBackspace||8!==T.raw.which||R(["input","textarea"],Ue(T.target))||$w(T.target,'[contenteditable="true"]')||T.prevent()}),eg=tc(T,"focusin",T=>{D.triggerEvent("focusin",T)&&T.kill()}),ep=Ql(),eh=tc(T,"focusout",T=>{D.triggerEvent("focusout",T)&&T.kill(),ep.set(setTimeout(()=>{D.triggerEvent(oo(),T)},0))});return{unbind:()=>{L(M,T=>{T.unbind()}),eu.unbind(),eg.unbind(),eh.unbind(),ec.unbind(),er.on(clearTimeout),ep.on(clearTimeout)}}},Kw=(T,E)=>{let D=be(T,"target").getOr(E);return Es(D)},uU=As([{stopped:[]},{resume:["element"]},{complete:[]}]),Zw=(T,E,D,B,M,er)=>{let ec=T(E,B),eu=((T,E)=>{let D=Es(!1),B=Es(!1);return{stop:()=>{D.set(!0)},cut:()=>{B.set(!0)},isStopped:D.get,isCut:B.get,event:T,setSource:E.set,getSource:E.get}})(D,M);return ec.fold(()=>(er.logEventNoHandlers(E,B),uU.complete()),T=>{let D=T.descHandler;return Aa(D)(eu),eu.isStopped()?(er.logEventStopped(E,T.element,D.purpose),uU.stopped()):eu.isCut()?(er.logEventCut(E,T.element,D.purpose),uU.complete()):st(T.element).fold(()=>(er.logNoParent(E,T.element,D.purpose),uU.complete()),B=>(er.logEventResponse(E,T.element,D.purpose),uU.resume(B)))})},Qw=(T,E,D,B,M,er)=>Zw(T,E,D,B,M,er).fold(eh,B=>Qw(T,E,D,B,M,er),ep),eS=(T,E,D,B,M)=>{let er=Kw(D,B);return Qw(T,E,D,B,er,M)},tS=()=>{let T=(()=>{let T={};return{registerId:(E,D,B)=>{le(B,(B,M)=>{let er=void 0!==T[M]?T[M]:{};er[D]={cHandler:k.apply(void 0,[B.handler].concat(E)),purpose:B.purpose},T[M]=er})},unregisterId:E=>{le(T,(T,D)=>{ve(T,E)&&delete T[E]})},filterByType:E=>be(T,E).map(T=>pe(T,(T,E)=>({id:E,descHandler:T}))).getOr([]),find:(E,D,B)=>be(T,D).bind(T=>Is(B,E=>pa(E).bind(E=>be(T,E)).map(T=>({element:E,descHandler:T})),E))}})(),E={},o=D=>{pa(D.element).each(D=>{delete E[D],T.unregisterId(D)})};return{find:(E,D,B)=>T.find(E,D,B),filter:E=>T.filterByType(E),register:D=>{let B=(T=>{let E=T.element;return pa(E).getOrThunk(()=>((T,E)=>{let D=la(o6+"uid-");return ga(E,D),D})(0,T.element))})(D);ye(E,B)&&((T,D)=>{let B=E[D];if(B!==T)throw Error('The tagId "'+D+'" is already used by: '+na(B.element)+"\nCannot use it for: "+na(T.element)+"\nThe conflicting element is"+(yt(B.element)?" ":" not ")+"already in the DOM");o(T)})(D,B);let M=[D];T.registerId(M,B,D.events),E[B]=D},unregister:o,getById:T=>be(E,T)}},uL=fm({name:"Container",factory:T=>{let{attributes:E,...D}=T.dom;return{uid:T.uid,dom:{tag:"div",attributes:{role:"presentation",...E},...D},components:T.components,behaviours:fu(T.containerBehaviours),events:T.events,domModification:T.domModification,eventOrder:T.eventOrder}},configFields:[ys("components",[]),hu("containerBehaviours",[]),ys("events",{}),ys("domModification",{}),ys("eventOrder",{})]}),nS=T=>{let t=E=>st(T.element).fold(eh,T=>Ze(E,T)),E=tS(),n=(T,D)=>E.find(t,T,D),D=Yw(T.element,{triggerEvent:(T,E)=>Si(T,E.target,D=>eS(n,T,E,E.target,D))}),B={debugInfo:x("real"),triggerEvent:(T,E,D)=>{Si(T,E,B=>eS(n,T,D,E,B))},triggerFocus:(T,E)=>{pa(T).fold(()=>{Dl(T)},D=>{Si(t7(),T,D=>(((T,E,D,B,M)=>{let er=Kw(D,B);Zw(T,E,D,B,er,M)})(n,t7(),{originator:E,kill:b,prevent:b,target:T},T,D),!1))})},triggerEscape:(T,E)=>{B.triggerEvent("keydown",T.element,E.event)},getByUid:T=>p(T),getByDom:T=>h(T),build:ri,buildOrPatch:si,addToGui:T=>{l(T)},removeFromGui:T=>{c(T)},addToWorld:T=>{a(T)},removeFromWorld:T=>{i(T)},broadcast:T=>{u(T)},broadcastOn:(T,E)=>{m(T,E)},broadcastEvent:(T,E)=>{g(T,E)},isConnected:eh},a=T=>{T.connect(B),ez(T.element)||(E.register(T),L(T.components(),a),B.triggerEvent(oS(),T.element,{target:T.element}))},i=T=>{ez(T.element)||(L(T.components(),i),E.unregister(T)),T.disconnect()},l=E=>{Ad(T,E)},c=T=>{Bd(T)},d=T=>{let D=E.filter(oh());L(D,E=>{let D=E.descHandler;Aa(D)(T)})},u=T=>{d({universal:!0,data:T})},m=(T,E)=>{d({universal:!1,channels:T,data:E})},g=(T,D)=>((T,E,D)=>{let B=(T=>{let E=Es(!1);return{stop:()=>{E.set(!0)},cut:b,isStopped:E.get,isCut:ep,event:T,setSource:O("Cannot set source of a broadcasted event"),getSource:O("Cannot get source of a broadcasted event")}})(E);return L(T,T=>{let E=T.descHandler;Aa(E)(B)}),B.isStopped()})(E.filter(T),D),p=T=>E.getById(T).fold(()=>tx.error(Error('Could not find component with uid: "'+T+'" in system.')),tx.value),h=T=>{let E=pa(T).getOr("not found");return p(E)};return a(T),{root:T,element:T.element,destroy:()=>{D.unbind(),Po(T.element)},add:l,remove:c,getByUid:p,getByDom:h,addToWorld:a,removeFromWorld:i,broadcast:u,broadcastOn:m,broadcastEvent:g}},uz=x([ys("prefix","form-field"),hu("fieldBehaviours",[aP,r5])]),uP=x([aE({schema:[os("dom")],name:"label"}),aE({factory:{sketch:T=>({uid:T.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:T.text}})},schema:[os("text")],name:"aria-descriptor"}),aC({factory:{sketch:T=>{let E=((T,E)=>{let D={};return le(T,(T,B)=>{R(E,B)||(D[B]=T)}),D})(T,["factory"]);return T.factory.sketch(E)}},schema:[os("factory")],name:"field"})]),uj=bm({name:"FormField",configFields:uz(),partFields:uP(),factory:(T,E,D,B)=>{let M=bu(T.fieldBehaviours,[aP.config({find:E=>om(E,T,"field")}),r5.config({store:{mode:"manual",getValue:T=>aP.getCurrent(T).bind(r5.getValue),setValue:(T,E)=>{aP.getCurrent(T).each(T=>{r5.setValue(T,E)})}}})]),er=Hr([oX((E,D)=>{let B=sm(E,T,["label","field","aria-descriptor"]);B.field().each(E=>{let D=la(T.prefix);B.label().each(T=>{kt(T.element,"for",D),kt(E.element,"id",D)}),B["aria-descriptor"]().each(D=>{let B=la(T.prefix);kt(D.element,"id",B),kt(E.element,"aria-describedby",B)})})})]);return{uid:T.uid,dom:T.dom,components:E,behaviours:M,events:er,apis:{getField:E=>om(E,T,"field"),getLabel:E=>om(E,T,"label")}}},apis:{getField:(T,E)=>T.getField(E),getLabel:(T,E)=>T.getLabel(E)}});var uW=Object.freeze({__proto__:null,exhibit:(T,E)=>Ea({attributes:Ds([{key:E.tabAttr,value:"true"}])})}),uG=[ys("tabAttr","data-alloy-tabstop")];let uJ=Ol({fields:uG,name:"tabstopping",active:uW});var u$=tinymce.util.Tools.resolve("tinymce.html.Entities");let uS=(T,E,D,B)=>{let M=mS(T,E,D,B);return uj.sketch(M)},mS=(T,E,D,B)=>({dom:gS(D),components:T.toArray().concat([E]),fieldBehaviours:kl(B)}),gS=T=>({tag:"div",classes:["tox-form__group"].concat(T)}),pS=(T,E)=>uj.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[ti(E.translate(T))]}),uX=la("form-component-change"),uq=la("form-close"),uK=la("form-cancel"),uY=la("form-action"),uZ=la("form-submit"),uQ=la("form-block"),u0=la("form-unblock"),u1=la("form-tabchange"),u2=la("form-resize"),u3=["input","textarea"],OS=T=>{let E=Ue(T);return R(u3,E)},_S=(T,E)=>{let D=E.getRoot(T).getOr(T.element);Pa(D,E.invalidClass),E.notify.each(E=>{OS(T.element)&&kt(T.element,"aria-invalid",!1),E.getContainer(T).each(T=>{ta(T,E.validHtml)}),E.onValid(T)})},TS=(T,E,D,B)=>{let M=E.getRoot(T).getOr(T.element);La(M,E.invalidClass),E.notify.each(E=>{OS(T.element)&&kt(T.element,"aria-invalid",!0),E.getContainer(T).each(T=>{ta(T,B)}),E.onInvalid(T,B)})},ES=(T,E,D)=>E.validator.fold(()=>bw(tx.value(!0)),E=>E.validate(T)),AS=(T,E,D)=>(E.notify.each(E=>{E.onValidate(T)}),ES(T,E).map(D=>T.getSystem().isConnected()?D.fold(D=>(TS(T,E,0,D),tx.error(D)),D=>(_S(T,E),tx.value(D))):tx.error("No longer in system")));var u5=Object.freeze({__proto__:null,markValid:_S,markInvalid:TS,query:ES,run:AS,isInvalid:(T,E)=>{let D=E.getRoot(T).getOr(T.element);return Ua(D,E.invalidClass)}}),u9=Object.freeze({__proto__:null,events:(T,E)=>T.validator.map(E=>Hr([Ur(E.onEvent,E=>{AS(E,T).get(w)})].concat(E.validateOnLoad?[oX(E=>{AS(E,T).get(b)})]:[]))).getOr({})}),u4=[os("invalidClass"),ys("getRoot",A.none),vs("notify",[ys("aria","alert"),ys("getContainer",A.none),ys("validHtml",""),Di("onValid"),Di("onInvalid"),Di("onValidate")]),vs("validator",[os("validate"),ys("onEvent","input"),ys("validateOnLoad",!0)])];let u6=Ol({fields:u4,name:"invalidating",active:u9,apis:u5,extra:{validation:T=>E=>{let D=r5.getValue(E);return bw(T(D))}}}),u8=Ol({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:()=>Hr([Lr(t6(),eh)]),exhibit:()=>Ea({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})})}),u7=la("color-input-change"),mo=la("color-swatch-change"),mn=la("color-picker-cancel"),mr=aE({schema:[os("dom")],name:"label"}),HS=T=>aE({name:T+"-edge",overrides:E=>E.model.manager.edgeActions[T].fold(()=>({}),T=>({events:Hr([Wr(tP(),(E,D,B)=>T(E,B),[E]),Wr(tJ(),(E,D,B)=>T(E,B),[E]),Wr(t$(),(E,D,B)=>{B.mouseIsDown.get()&&T(E,B)},[E])])}))}),ma=HS("top-left"),mc=HS("top"),mu=HS("top-right"),mf=HS("right"),mv=HS("bottom-right"),mx=HS("bottom"),mO=HS("bottom-left");var mC=[mr,HS("left"),mf,mc,mx,ma,mu,mO,mv,aC({name:"thumb",defaults:x({dom:{styles:{position:"absolute"}}}),overrides:T=>({events:Hr([Gr(tP(),T,"spectrum"),Gr(tj(),T,"spectrum"),Gr(tW(),T,"spectrum"),Gr(tJ(),T,"spectrum"),Gr(t$(),T,"spectrum"),Gr(tq(),T,"spectrum")])})}),aC({schema:[es("mouseIsDown",()=>Es(!1))],name:"spectrum",overrides:T=>{let E=T.model.manager,o=(D,B)=>E.getValueFromEvent(B).map(B=>E.setValueFrom(D,T,B));return{behaviours:kl([sq.config({mode:"special",onLeft:D=>E.onLeft(D,T),onRight:D=>E.onRight(D,T),onUp:D=>E.onUp(D,T),onDown:D=>E.onDown(D,T)}),s1.config({})]),events:Hr([Ur(tP(),o),Ur(tj(),o),Ur(tJ(),o),Ur(t$(),(E,D)=>{T.mouseIsDown.get()&&o(E,D)})])}}})];let m_=x("slider.change.value"),YS=T=>{let E=T.event.raw;return -1!==E.type.indexOf("touch")?void 0!==E.touches&&1===E.touches.length?A.some(E.touches[0]).map(T=>Gt(T.clientX,T.clientY)):A.none():void 0!==E.clientX?A.some(E).map(T=>Gt(T.clientX,T.clientY)):A.none()},KS=T=>T.model.minX,JS=T=>T.model.minY,ZS=T=>T.model.minX-1,QS=T=>T.model.minY-1,ek=T=>T.model.maxX,tk=T=>T.model.maxY,ok=T=>T.model.maxX+1,nk=T=>T.model.maxY+1,sk=(T,E,D)=>E(T)-D(T),rk=T=>sk(T,ek,KS),ak=T=>sk(T,tk,JS),ik=T=>rk(T)/2,lk=T=>ak(T)/2,ck=T=>T.stepSize,dk=T=>T.snapToGrid,uk=T=>T.snapStart,mk=T=>T.rounded,gk=(T,E)=>void 0!==T[E+"-edge"],pk=T=>gk(T,"left"),hk=T=>gk(T,"right"),fk=T=>gk(T,"top"),bk=T=>gk(T,"bottom"),vk=T=>T.model.value.get(),yk=(T,E)=>({x:T,y:E}),xk=(T,E)=>{Ir(T,m_(),{value:E})},wk=(T,E,D,B)=>T<E?T:T>D?D:T===E?E-1:Math.max(E,T-B),Sk=(T,E,D,B)=>T>D?T:T<E?E:T===D?D+1:Math.min(D,T+B),kk=(T,E,D)=>Math.max(E,Math.min(D,T)),Ck=T=>{let{min:E,max:D,range:B,value:M,step:er,snap:ec,snapStart:eu,rounded:eg,hasMinEdge:ep,hasMaxEdge:eh,minBound:ey,maxBound:ex,screenRange:eO}=T,eD=ep?E-1:E,eI=eh?D+1:D;if(M<ey)return eD;if(M>ex)return eI;{let T=kk((Math.min(ex,Math.max(M,ey))-ey)/eO*B+E,eD,eI);return ec&&T>=E&&T<=D?eu.fold(()=>kk(E+Math.round((T-E)/er)*er,E-1,D+1),E=>Math.max(E,E+Math.min(Math.floor((D-E)/er),Math.floor((T-E)/er)+Math.round((T-E)%er/er))*er)):eg?Math.round(T):T}},Ok=T=>{let{min:E,max:D,range:B,value:M,hasMinEdge:er,hasMaxEdge:ec,maxBound:eu,maxOffset:eg,centerMinEdge:ep,centerMaxEdge:eh}=T;return M<E?er?0:ep:M>D?ec?eu:eh:(M-E)/B*eg},mE="right",mM="bottom",mI="left",Mk=T=>T.element.dom.getBoundingClientRect(),Dk=(T,E)=>T[E],Bk=T=>{let E=Mk(T);return Dk(E,mI)},Fk=T=>{let E=Mk(T);return Dk(E,mE)},Ik=T=>{let E=Mk(T);return Dk(E,"top")},Rk=T=>{let E=Mk(T);return Dk(E,mM)},Nk=T=>{let E=Mk(T);return Dk(E,"width")},Vk=T=>{let E=Mk(T);return Dk(E,"height")},zk=(T,E,D)=>(T+E)/2-D,Hk=(T,E)=>{let D=Mk(T),B=Mk(E),M=Dk(D,mI),er=Dk(D,mE),ec=Dk(B,mI);return zk(M,er,ec)},Lk=(T,E)=>{let D=Mk(T),B=Mk(E),M=Dk(D,"top"),er=Dk(D,mM),ec=Dk(B,"top");return zk(M,er,ec)},Pk=(T,E)=>{Ir(T,m_(),{value:E})},Uk=(T,E,D)=>{let B={min:KS(E),max:ek(E),range:rk(E),value:D,step:ck(E),snap:dk(E),snapStart:uk(E),rounded:mk(E),hasMinEdge:pk(E),hasMaxEdge:hk(E),minBound:Bk(T),maxBound:Fk(T),screenRange:Nk(T)};return Ck(B)},Wk=T=>(E,D)=>((T,E,D)=>{let B=(T>0?Sk:wk)(vk(D),KS(D),ek(D),ck(D));return Pk(E,B),A.some(B)})(T,E,D).map(eh),jk=(T,E,D,B,M,er)=>{let ec=((T,E,D,B,M)=>{let er=Nk(T),ec=B.bind(E=>A.some(Hk(E,T))).getOr(0),eu=M.bind(E=>A.some(Hk(E,T))).getOr(er),eg={min:KS(E),max:ek(E),range:rk(E),value:D,hasMinEdge:pk(E),hasMaxEdge:hk(E),minBound:Bk(T),minOffset:0,maxBound:Fk(T),maxOffset:er,centerMinEdge:ec,centerMaxEdge:eu};return Ok(eg)})(E,er,D,B,M);return Bk(E)-Bk(T)+ec},mR=Wk(-1),mH=Wk(1),mN=A.none,mU=A.none,mL={"top-left":A.none(),top:A.none(),"top-right":A.none(),right:A.some((T,E)=>{xk(T,ok(E))}),"bottom-right":A.none(),bottom:A.none(),"bottom-left":A.none(),left:A.some((T,E)=>{xk(T,ZS(E))})};var mz=Object.freeze({__proto__:null,setValueFrom:(T,E,D)=>{let B=Uk(T,E,D);return Pk(T,B),B},setToMin:(T,E)=>{let D=KS(E);Pk(T,D)},setToMax:(T,E)=>{let D=ek(E);Pk(T,D)},findValueOfOffset:Uk,getValueFromEvent:T=>YS(T).map(T=>T.left),findPositionOfValue:jk,setPositionFromValue:(T,E,D,B)=>{let M=vk(D),er=jk(T,B.getSpectrum(T),M,B.getLeftEdge(T),B.getRightEdge(T),D),ec=Jt(E.element)/2;Dt(E.element,"left",er-ec+"px")},onLeft:mR,onRight:mH,onUp:mN,onDown:mU,edgeActions:mL});let Jk=(T,E)=>{Ir(T,m_(),{value:E})},Zk=(T,E,D)=>{let B={min:JS(E),max:tk(E),range:ak(E),value:D,step:ck(E),snap:dk(E),snapStart:uk(E),rounded:mk(E),hasMinEdge:fk(E),hasMaxEdge:bk(E),minBound:Ik(T),maxBound:Rk(T),screenRange:Vk(T)};return Ck(B)},Qk=T=>(E,D)=>((T,E,D)=>{let B=(T>0?Sk:wk)(vk(D),JS(D),tk(D),ck(D));return Jk(E,B),A.some(B)})(T,E,D).map(eh),eC=(T,E,D,B,M,er)=>{let ec=((T,E,D,B,M)=>{let er=Vk(T),ec=B.bind(E=>A.some(Lk(E,T))).getOr(0),eu=M.bind(E=>A.some(Lk(E,T))).getOr(er),eg={min:JS(E),max:tk(E),range:ak(E),value:D,hasMinEdge:fk(E),hasMaxEdge:bk(E),minBound:Ik(T),minOffset:0,maxBound:Rk(T),maxOffset:er,centerMinEdge:ec,centerMaxEdge:eu};return Ok(eg)})(E,er,D,B,M);return Ik(E)-Ik(T)+ec},mP=A.none,mj=A.none,mW=Qk(-1),mG=Qk(1),mJ={"top-left":A.none(),top:A.some((T,E)=>{xk(T,QS(E))}),"top-right":A.none(),right:A.none(),"bottom-right":A.none(),bottom:A.some((T,E)=>{xk(T,nk(E))}),"bottom-left":A.none(),left:A.none()};var m$=Object.freeze({__proto__:null,setValueFrom:(T,E,D)=>{let B=Zk(T,E,D);return Jk(T,B),B},setToMin:(T,E)=>{let D=JS(E);Jk(T,D)},setToMax:(T,E)=>{let D=tk(E);Jk(T,D)},findValueOfOffset:Zk,getValueFromEvent:T=>YS(T).map(T=>T.top),findPositionOfValue:eC,setPositionFromValue:(T,E,D,B)=>{let M=vk(D),er=eC(T,B.getSpectrum(T),M,B.getTopEdge(T),B.getBottomEdge(T),D),ec=Wt(E.element)/2;Dt(E.element,"top",er-ec+"px")},onLeft:mP,onRight:mj,onUp:mW,onDown:mG,edgeActions:mJ});let iC=(T,E)=>{Ir(T,m_(),{value:E})},lC=(T,E)=>({x:T,y:E}),cC=(T,E)=>(D,B)=>((T,E,D,B)=>{let M=T>0?Sk:wk,er=E?vk(B).x:M(vk(B).x,KS(B),ek(B),ck(B)),ec=E?M(vk(B).y,JS(B),tk(B),ck(B)):vk(B).y;return iC(D,lC(er,ec)),A.some(er)})(T,E,D,B).map(eh),mX=cC(-1,!1),mq=cC(1,!1),mK=cC(-1,!0),mY=cC(1,!0),mZ={"top-left":A.some((T,E)=>{xk(T,yk(ZS(E),QS(E)))}),top:A.some((T,E)=>{xk(T,yk(ik(E),QS(E)))}),"top-right":A.some((T,E)=>{xk(T,yk(ok(E),QS(E)))}),right:A.some((T,E)=>{xk(T,yk(ok(E),lk(E)))}),"bottom-right":A.some((T,E)=>{xk(T,yk(ok(E),nk(E)))}),bottom:A.some((T,E)=>{xk(T,yk(ik(E),nk(E)))}),"bottom-left":A.some((T,E)=>{xk(T,yk(ZS(E),nk(E)))}),left:A.some((T,E)=>{xk(T,yk(ZS(E),lk(E)))})};var mQ=Object.freeze({__proto__:null,setValueFrom:(T,E,D)=>{let B=Uk(T,E,D.left),M=Zk(T,E,D.top),er=lC(B,M);return iC(T,er),er},setToMin:(T,E)=>{let D=KS(E),B=JS(E);iC(T,lC(D,B))},setToMax:(T,E)=>{let D=ek(E),B=tk(E);iC(T,lC(D,B))},getValueFromEvent:T=>YS(T),setPositionFromValue:(T,E,D,B)=>{let M=vk(D),er=jk(T,B.getSpectrum(T),M.x,B.getLeftEdge(T),B.getRightEdge(T),D),ec=eC(T,B.getSpectrum(T),M.y,B.getTopEdge(T),B.getBottomEdge(T),D),eu=Jt(E.element)/2,eg=Wt(E.element)/2;Dt(E.element,"left",er-eu+"px"),Dt(E.element,"top",ec-eg+"px")},onLeft:mX,onRight:mq,onUp:mK,onDown:mY,edgeActions:mZ});let m0=bm({name:"Slider",configFields:[ys("stepSize",1),ys("onChange",b),ys("onChoose",b),ys("onInit",b),ys("onDragStart",b),ys("onDragEnd",b),ys("snapToGrid",!1),ys("rounded",!0),us("snapStart"),ns("model",Jn("mode",{x:[ys("minX",0),ys("maxX",100),es("value",T=>Es(T.mode.minX)),os("getInitialValue"),Ri("manager",mz)],y:[ys("minY",0),ys("maxY",100),es("value",T=>Es(T.mode.minY)),os("getInitialValue"),Ri("manager",m$)],xy:[ys("minX",0),ys("maxX",100),ys("minY",0),ys("maxY",100),es("value",T=>Es({x:T.mode.minX,y:T.mode.minY})),os("getInitialValue"),Ri("manager",mQ)]})),hu("sliderBehaviours",[sq,r5]),es("mouseIsDown",()=>Es(!1))],partFields:mC,factory:(T,E,D,B)=>{let s=E=>nm(E,T,"thumb"),r=E=>nm(E,T,"spectrum"),a=E=>om(E,T,"left-edge"),i=E=>om(E,T,"right-edge"),l=E=>om(E,T,"top-edge"),c=E=>om(E,T,"bottom-edge"),M=T.model,er=M.manager,m=(E,D)=>{er.setPositionFromValue(E,D,T,{getLeftEdge:a,getRightEdge:i,getTopEdge:l,getBottomEdge:c,getSpectrum:r})},g=(T,E)=>{M.value.set(E);let D=s(T);m(T,D)},p=E=>{let D=T.mouseIsDown.get();T.mouseIsDown.set(!1),D&&om(E,T,"thumb").each(D=>{let B=M.value.get();T.onChoose(E,D,B)})},h=(E,D)=>{D.stop(),T.mouseIsDown.set(!0),T.onDragStart(E,s(E))},f=(E,D)=>{D.stop(),T.onDragEnd(E,s(E)),p(E)};return{uid:T.uid,dom:T.dom,components:E,behaviours:bu(T.sliderBehaviours,[sq.config({mode:"special",focusIn:E=>om(E,T,"spectrum").map(sq.focusIn).map(eh)}),r5.config({store:{mode:"manual",getValue:T=>M.value.get(),setValue:g}}),nK.config({channels:{[rq()]:{onReceive:p}}})]),events:Hr([Ur(m_(),(E,D)=>{((E,D)=>{g(E,D);let B=s(E);T.onChange(E,B,D),A.some(!0)})(E,D.event.value)}),oX((E,D)=>{let B=M.getInitialValue();M.value.set(B);let er=s(E);m(E,er);let ec=r(E);T.onInit(E,er,ec,M.value.get())}),Ur(tP(),h),Ur(tW(),f),Ur(tJ(),h),Ur(tq(),f)]),apis:{resetToMin:E=>{er.setToMin(E,T)},resetToMax:E=>{er.setToMax(E,T)},setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{setValue:(T,E,D)=>{T.setValue(E,D)},resetToMin:(T,E)=>{T.resetToMin(E)},resetToMax:(T,E)=>{T.resetToMax(E)},refresh:(T,E)=>{T.refresh(E)}}}),m1=la("rgb-hex-update"),m2=la("slider-update"),m3=la("palette-update"),m5="form",m9=[hu("formBehaviours",[r5])],SC=T=>"<alloy.field."+T+">",kC=(T,E)=>({uid:T.uid,dom:T.dom,components:E,behaviours:bu(T.formBehaviours,[r5.config({store:{mode:"manual",getValue:E=>{let D=rm(E,T);return ce(D,(T,E)=>T().bind(T=>{var D,B;return D=aP.getCurrent(T),B=Error(`Cannot find a current component to extract the value from for form part '${E}': `+na(T.element)),D.fold(()=>tx.error(B),tx.value)}).map(r5.getValue))},setValue:(E,D)=>{le(D,(D,B)=>{om(E,T,B).each(T=>{aP.getCurrent(T).each(T=>{r5.setValue(T,D)})})})}}})]),apis:{getField:(E,D)=>om(E,T,D).bind(aP.getCurrent)}}),m4={getField:Ca((T,E,D)=>T.getField(E,D)),sketch:T=>{let E=(()=>{let T=[];return{field:(E,D)=>(T.push(E),Ju(m5,SC(E),D)),record:x(T)}})(),D=T(E),B=E.record(),M=H(B,T=>aC({name:T,pname:SC(T)}));return mm(m5,m9,M,kC,D)}},m6=la("valid-input"),m8=la("invalid-input"),m7=la("validating-input"),gt="colorcustom.rgb.",AC=(T,E,D,B)=>{let s=(D,B)=>u6.config({invalidClass:E("invalid"),notify:{onValidate:T=>{Ir(T,m7,{type:D})},onValid:T=>{Ir(T,m6,{type:D,value:r5.getValue(T)})},onInvalid:T=>{Ir(T,m8,{type:D,value:r5.getValue(T)})}},validator:{validate:E=>{let D=r5.getValue(E),M=B(D)?tx.value(!0):tx.error(T("aria.input.invalid"));return bw(M)},validateOnLoad:!1}}),r=(D,B,M,er,ec)=>{let eu=T(gt+"range"),eg=uj.parts.label({dom:{tag:"label",attributes:{"aria-label":er}},components:[ti(M)]}),ep=uj.parts.field({data:ec,factory:cv,inputAttributes:{type:"text",..."hex"===B?{"aria-live":"polite"}:{}},inputClasses:[E("textfield")],inputBehaviours:kl([s(B,D),uJ.config({})]),onSetValue:T=>{u6.isInvalid(T)&&u6.run(T).get(b)}}),eh="hex"!==B?[uj.parts["aria-descriptor"]({text:eu})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:[eg,ep].concat(eh)}},a=(T,E)=>{let D=E.red,B=E.green,M=E.blue;r5.setValue(T,{red:D,green:B,blue:M})},M=jh({dom:{tag:"div",classes:[E("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),l=(T,E)=>{M.getOpt(T).each(T=>{Dt(T.element,"background-color","#"+E.value)})},er=fm({factory:()=>{let er={red:Es(A.some(255)),green:Es(A.some(255)),blue:Es(A.some(255)),hex:Es(A.some("ffffff"))},c=T=>er[T].get(),d=(T,E)=>{er[T].set(E)},u=T=>{let E=T.red,D=T.green,B=T.blue;d("red",A.some(E)),d("green",A.some(D)),d("blue",A.some(B))},m=(T,E)=>{let D=E.event;"hex"!==D.type?d(D.type,A.none()):B(T)},g=(T,E)=>{let B=E.event;"hex"===B.type?((T,E)=>{D(T);let B=qy(E);d("hex",A.some(B.value));let M=lx(B);a(T,M),u(M),Ir(T,m1,{hex:B}),l(T,B)})(T,B.value):((T,E,D)=>{let B=parseInt(D,10);d(E,A.some(B)),c("red").bind(T=>c("green").bind(E=>c("blue").map(D=>rx(T,E,D,1)))).each(E=>{let D=((T,E)=>{let D=Qy(E);return m4.getField(T,"hex").each(E=>{s1.isFocused(E)||r5.setValue(T,{hex:D.value})}),D})(T,E);Ir(T,m1,{hex:D}),l(T,D)})})(T,B.type,B.value)},p=E=>({label:T(gt+E+".label"),description:T(gt+E+".description")}),ec=p("red"),eu=p("green"),eg=p("blue"),ep=p("hex");return tw(m4.sketch(D=>({dom:{tag:"form",classes:[E("rgb-form")],attributes:{"aria-label":T("aria.color.picker")}},components:[D.field("red",uj.sketch(r(ax,"red",ec.label,ec.description,255))),D.field("green",uj.sketch(r(ax,"green",eu.label,eu.description,255))),D.field("blue",uj.sketch(r(ax,"blue",eg.label,eg.description,255))),D.field("hex",uj.sketch(r(Ky,"hex",ep.label,ep.description,"ffffff"))),M.asSpec()],formBehaviours:kl([u6.config({invalidClass:E("form-invalid")}),Jp("rgb-form-events",[Ur(m6,g),Ur(m8,m),Ur(m7,m)])])})),{apis:{updateHex:(T,E)=>{r5.setValue(T,{hex:E.value}),((T,E)=>{let D=lx(E);a(T,D),u(D)})(T,E),l(T,E)}}})},name:"RgbForm",configFields:[],apis:{updateHex:(T,E,D)=>{T.updateHex(E,D)}},extraApis:{}});return er},MC=(T,E)=>{let D=fm({name:"ColourPicker",configFields:[os("dom"),ys("onValidHex",b),ys("onInvalidHex",b)],factory:D=>{let B=AC(T,E,D.onValidHex,D.onInvalidHex),M=((T,E)=>{let D=m0.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[E("sv-palette-spectrum")]}}),B=m0.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[E("sv-palette-thumb")],innerHtml:`<div class=${E("sv-palette-inner-thumb")} role="presentation"></div>`}}),s=(T,E)=>{let{width:D,height:B}=T,M=T.getContext("2d");if(null===M)return;M.fillStyle=E,M.fillRect(0,0,D,B);let er=M.createLinearGradient(0,0,D,0);er.addColorStop(0,"rgba(255,255,255,1)"),er.addColorStop(1,"rgba(255,255,255,0)"),M.fillStyle=er,M.fillRect(0,0,D,B);let ec=M.createLinearGradient(0,0,0,B);ec.addColorStop(0,"rgba(0,0,0,0)"),ec.addColorStop(1,"rgba(0,0,0,1)"),M.fillStyle=ec,M.fillRect(0,0,D,B)};return fm({factory:T=>{let M=x({x:0,y:0}),er=kl([aP.config({find:A.some}),s1.config({})]);return m0.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[E("sv-palette")]},model:{mode:"xy",getInitialValue:M},rounded:!1,components:[D,B],onChange:(T,E,D)=>{Ir(T,m3,{value:D})},onInit:(T,E,D,B)=>{s(D.element.dom,ux(d9))},sliderBehaviours:er})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:(T,E,D)=>{((T,E)=>{let D=T.components()[0].element.dom,B=_x(E,100,100),M=ix(B);s(D,ux(M))})(E,D)},setThumb:(T,E,D)=>{((T,E)=>{let D=Tx(lx(E));m0.setValue(T,{x:D.saturation,y:100-D.value})})(E,D)}},extraApis:{}})})(0,E),er={paletteRgba:Es(d9),paletteHue:Es(0)},ec=jh(((T,E)=>{let D=m0.parts.spectrum({dom:{tag:"div",classes:[E("hue-slider-spectrum")],attributes:{role:"presentation"}}}),B=m0.parts.thumb({dom:{tag:"div",classes:[E("hue-slider-thumb")],attributes:{role:"presentation"}}});return m0.sketch({dom:{tag:"div",classes:[E("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:x(0)},components:[D,B],sliderBehaviours:kl([s1.config({})]),onChange:(T,E,D)=>{Ir(T,m2,{value:D})}})})(0,E)),eu=jh(M.sketch({})),eg=jh(B.sketch({})),c=(T,E,D)=>{eu.getOpt(T).each(T=>{M.setHue(T,D)})},d=(T,E)=>{eg.getOpt(T).each(T=>{B.updateHex(T,E)})},u=(T,E,D)=>{ec.getOpt(T).each(T=>{m0.setValue(T,100-D/360*100)})},m=(T,E)=>{eu.getOpt(T).each(T=>{M.setThumb(T,E)})},g=(T,E,D,B)=>{((T,E)=>{let D=lx(T);er.paletteRgba.set(D),er.paletteHue.set(E)})(E,D),L(B,B=>{B(T,E,D)})};return{uid:D.uid,dom:D.dom,components:[eu.asSpec(),ec.asSpec(),eg.asSpec()],behaviours:kl([Jp("colour-picker-events",[Ur(m1,(()=>{let T=[c,u,m];return(E,D)=>{let B=D.event.hex,M=Tx(lx(B));g(E,B,M.hue,T)}})()),Ur(m3,(()=>{let T=[d];return(E,D)=>{let B=D.event.value,M=er.paletteHue.get(),ec=_x(M,B.x,100-B.y),eu=Ex(ec);g(E,eu,M,T)}})()),Ur(m2,(()=>{let T=[c,d];return(E,D)=>{let B=(100-D.event.value)/100*360,M=er.paletteRgba.get(),ec=Tx(M),eu=_x(B,ec.saturation,ec.value),eg=Ex(eu);g(E,eg,B,T)}})())]),aP.config({find:T=>eg.getOpt(T)}),sq.config({mode:"acyclic"})])}}});return D},DC=()=>aP.config({find:A.some}),BC=T=>aP.config({find:E=>lt(E.element,T).bind(T=>E.getSystem().getByDom(T).toOptional())}),go=Dn([ys("preprocess",w),ys("postprocess",w)]),IC=(T,E)=>{let D=Yn("RepresentingConfigs.memento processors",go,E);return r5.config({store:{mode:"manual",getValue:E=>{let B=T.get(E),M=r5.getValue(B);return D.postprocess(M)},setValue:(E,B)=>{let M=D.preprocess(B),er=T.get(E);r5.setValue(er,M)}}})},RC=(T,E,D)=>r5.config({store:{mode:"manual",...T.map(T=>({initialValue:T})).getOr({}),getValue:E,setValue:D}}),NC=(T,E,D)=>RC(T,T=>E(T.element),(T,E)=>D(T.element,E)),VC=T=>r5.config({store:{mode:"memory",initialValue:T}}),gr={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"};var gu=tinymce.util.Tools.resolve("tinymce.Resource"),gp=tinymce.util.Tools.resolve("tinymce.util.Tools");let PC=(T,E)=>{let D=null,n=()=>{M(D)||(clearTimeout(D),D=null)};return{cancel:n,throttle:(...B)=>{n(),D=setTimeout(()=>{D=null,T.apply(null,B)},E)}}},gh=la("alloy-fake-before-tabstop"),gf=la("alloy-fake-after-tabstop"),jC=T=>({dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:T},behaviours:kl([s1.config({ignore:!0}),uJ.config({})])}),GC=(T,E)=>({dom:{tag:"div",classes:["tox-navobj",...T.getOr([])]},components:[jC([gh]),E,jC([gf])],behaviours:kl([BC(1)])}),$C=(T,E)=>{Ir(T,tQ(),{raw:{which:9,shiftKey:E}})},qC=(T,E)=>{let D=E.element;Ua(D,gh)?$C(T,!0):Ua(D,gf)&&$C(T,!1)},XC=T=>$w(T,["."+gh,"."+gf].join(","),ep),gb=la("update-dialog"),gv=la("update-title"),gy=la("update-body"),gw=la("update-footer"),gA=la("body-send-message"),gC=la("dialog-focus-shifted"),gE=Do().browser,gD=gE.isSafari(),gM=gE.isFirefox(),gI=gD||gM,gR=gE.isChromium(),aO=({scrollTop:T,scrollHeight:E,clientHeight:D})=>Math.ceil(T)+D>=E,iO=(T,E)=>T.scrollTo(0,"bottom"===E?99999999:E),lO=(T,E,D)=>{let B=T.dom;A.from(B.contentDocument).fold(D,T=>{let D=0,M=((T,E)=>{let D=T.body;return A.from(!/^<!DOCTYPE (html|HTML)/.test(E)&&(!gR&&!gD||g(D)&&(0!==D.scrollTop||Math.abs(D.scrollHeight-D.clientHeight)>1))?D:T.documentElement)})(T,E).map(T=>(D=T.scrollTop,T)).forall(aO),r=()=>{let T=B.contentWindow;g(T)&&(M?iO(T,"bottom"):!M&&gI&&0!==D&&iO(T,D))};gD&&B.addEventListener("load",r,{once:!0}),T.open(),T.write(E),T.close(),gD||r()})},gH=Ce(gI,gD?500:200).map(T=>{let E,D;return E=null,D=null,{cancel:()=>{M(E)||(clearTimeout(E),E=null,D=null)},throttle:(...B)=>{D=B,M(E)&&(E=setTimeout(()=>{let T=D;E=null,D=null,lO.apply(null,T)},T))}}}),gN=la("toolbar.button.execute"),gU=la("common-button-display-events"),gL={[of()]:["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],[oH()]:["toolbar-button-events",gU],[tJ()]:["focusing","alloy.base.behaviour",gU]},gO=T=>Dt(T.element,"width",It(T.element,"width")),pO=(T,E,D)=>ef(T,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:D},E),hO=(T,E)=>pO(T,E,[]),fO=(T,E)=>pO(T,E,[sY.config({})]),bO=(T,E,D)=>({dom:{tag:"span",classes:[`${E}__select-label`]},components:[ti(D.translate(T))],behaviours:kl([sY.config({})])}),gz=la("update-menu-text"),gP=la("update-menu-icon"),xO=(T,E,D)=>{let B=Es(b),M=T.text.map(T=>jh(bO(T,E,D.providers))),er=T.icon.map(T=>jh(fO(T,D.providers.icons))),a=(T,E)=>{let D=r5.getValue(T);return s1.focus(D),Ir(D,"keydown",{raw:E.event.raw}),uH.close(D),A.some(!0)},ec=T.role.fold(()=>({}),T=>({role:T})),eu=T.tooltip.fold(()=>({}),T=>{let E=D.providers.translate(T);return{title:E,"aria-label":E}}),eg=ef("chevron-down",{tag:"div",classes:[`${E}__select-chevron`]},D.providers.icons),ep=la("common-button-display-events"),eh=jh(uH.sketch({...T.uid?{uid:T.uid}:{},...ec,dom:{tag:"button",classes:[E,`${E}--select`].concat(H(T.classes,T=>`${E}--${T}`)),attributes:{...eu}},components:we([er.map(T=>T.asSpec()),M.map(T=>T.asSpec()),A.some(eg)]),matchWidth:!0,useMinWidth:!0,onOpen:(E,D,B)=>{T.searchable&&(T=>{Pb(T).each(T=>s1.focus(T))})(B)},dropdownBehaviours:kl([...T.dropdownBehaviours,ky(()=>T.disabled||D.providers.isDisabled()),Sy(),u8.config({}),sY.config({}),Jp("dropdown-events",[Ty(T,B),Ey(T,B)]),Jp(ep,[oX((T,E)=>gO(T))]),Jp("menubutton-update-display-text",[Ur(gz,(T,E)=>{M.bind(E=>E.getOpt(T)).each(T=>{sY.set(T,[ti(D.providers.translate(E.event.text))])})}),Ur(gP,(T,E)=>{er.bind(E=>E.getOpt(T)).each(T=>{sY.set(T,[fO(E.event.icon,D.providers.icons)])})})])]),eventOrder:tw(gL,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"],[oH()]:["toolbar-button-events","dropdown-events",ep]}),sandboxBehaviours:kl([sq.config({mode:"special",onLeft:a,onRight:a}),Jp("dropdown-sandbox-events",[Ur(cy,(T,E)=>{(T=>{let E=r5.getValue(T),D=Pb(T).map(Wb);uH.refetch(E).get(()=>{let T=uC.getCoupled(E,"sandbox");D.each(E=>Pb(T).each(T=>{r5.setValue(T,E.fetchPattern),T.element.dom.selectionStart=E.selectionStart,T.element.dom.selectionEnd=E.selectionEnd}))})})(T),E.stop()}),Ur(cw,(T,E)=>{((T,E)=>{rJ.getState(T).bind(aK.getHighlighted).bind(aK.getHighlighted).each(D=>{((T,E,D,B)=>{let M={...B,target:E};T.getSystem().triggerEvent(D,E,M)})(T,D.element,E.event.eventType,E.event.interactionEvent)})})(T,E),E.stop()})])]),lazySink:D.getSink,toggleClass:`${E}--active`,parts:{menu:{...Bb(0,T.columns,T.presets),fakeFocus:T.searchable,onHighlightItem:Bw,onCollapseMenu:(T,E,D)=>{aK.getHighlighted(D).each(E=>{Bw(T,D,E)})},onDehighlightItem:Fw}},getAnchorOverrides:()=>({maxHeightFunction:(T,E)=>{n9()(T,E-10)}}),fetch:E=>fw(k(T.fetch,E))}));return eh.asSpec()},wO=T=>"separator"===T.type,gj={type:"separator"},kO=(T,D)=>{let B=((T,D)=>{let B=j(T,(T,B)=>E(B)?""===B?T:"|"===B?T.length>0&&!wO(T[T.length-1])?T.concat([gj]):T:ve(D,B.toLowerCase())?T.concat([D[B.toLowerCase()]]):T:T.concat([B]),[]);return B.length>0&&wO(B[B.length-1])&&B.pop(),B})(E(T)?T.split(" "):T,D);return W(B,(T,E)=>{if(ve(E,"getSubmenuItems")){let B=(T=>{let E=be(T,"value").getOrThunk(()=>la("generated-menu-item"));return tw({value:E},T)})(E),M=((T,E)=>{let D=T.getSubmenuItems(),B=kO(D,E);return{item:T,menus:tw(B.menus,{[T.value]:B.items}),expansions:tw(B.expansions,{[T.value]:T.value})}})(B,D);return{menus:tw(T.menus,M.menus),items:[M.item,...T.items],expansions:tw(T.expansions,M.expansions)}}return{...T,items:[E,...T.items]}},{menus:{},expansions:{},items:[]})},CO=(T,E,D,B)=>{let M=la("primary-menu"),er=kO(T,D.shared.providers.menuItems());if(0===er.items.length)return A.none();let ec=B.search.fold(()=>({searchMode:"no-search"}),T=>({searchMode:"search-with-field",placeholder:T.placeholder})),eu=zw(M,er.items,E,D,B.isHorizontalMenu,ec),eg=B.search.fold(()=>({searchMode:"no-search"}),T=>({searchMode:"search-with-results"})),ep=ce(er.menus,(T,B)=>zw(B,T,E,D,!1,eg)),eh=tw(ep,Ms(M,eu));return A.from(iH.tieredData(M,eh,er.expansions))},OO=T=>!ve(T,"items"),gW="data-value",TO=(T,E,D,B)=>H(D,D=>OO(D)?{type:"togglemenuitem",text:D.text,value:D.value,active:D.value===B,onAction:()=>{r5.setValue(T,D.value),Ir(T,uX,{name:E}),s1.focus(T)}}:{type:"nestedmenuitem",text:D.text,getSubmenuItems:()=>TO(T,E,D.items,B)}),EO=(T,E)=>re(T,T=>OO(T)?Ce(T.value===E,T):EO(T.items,E)),gG=fm({name:"HtmlSelect",configFields:[os("options"),hu("selectBehaviours",[s1,r5]),ys("selectClasses",[]),ys("selectAttributes",{}),us("data")],factory:(T,E)=>{let D=H(T.options,T=>({dom:{tag:"option",value:T.value,innerHtml:T.text}})),B=T.data.map(T=>Ms("initialValue",T)).getOr({});return{uid:T.uid,dom:{tag:"select",classes:T.selectClasses,attributes:T.selectAttributes},components:D,behaviours:bu(T.selectBehaviours,[s1.config({}),r5.config({store:{mode:"manual",getValue:T=>$a(T.element),setValue:(E,D)=>{let B=oe(T.options);G(T.options,T=>T.value===D).isSome()?qa(E.element,D):-1===E.element.dom.selectedIndex&&""===D&&B.each(T=>qa(E.element,T.value))},...B}})])}}}),gJ=x([ys("field1Name","field1"),ys("field2Name","field2"),Fi("onLockedChange"),Ai(["lockClass"]),ys("locked",!1),hu("coupledFieldBehaviours",[aP,r5])]),DO=(T,E)=>aC({factory:uj,name:T,overrides:T=>({fieldBehaviours:kl([Jp("coupled-input-behaviour",[Ur(t1(),D=>{om(D,T,E).bind(aP.getCurrent).each(E=>{om(D,T,"lock").each(B=>{s9.isOn(B)&&T.onLockedChange(D,E,B)})})})])])})}),g$=x([DO("field1","field2"),DO("field2","field1"),aC({factory:iL,schema:[os("dom")],name:"lock",overrides:T=>({buttonBehaviours:kl([s9.config({selected:T.locked,toggleClass:T.markers.lockClass,aria:{mode:"pressed"}})])})})]),gX=bm({name:"FormCoupledInputs",configFields:gJ(),partFields:g$(),factory:(T,E,D,B)=>({uid:T.uid,dom:T.dom,components:E,behaviours:bu(T.coupledFieldBehaviours,[aP.config({find:A.some}),r5.config({store:{mode:"manual",getValue:E=>{let D=im(E,T,["field1","field2"]);return{[T.field1Name]:r5.getValue(D.field1()),[T.field2Name]:r5.getValue(D.field2())}},setValue:(E,D)=>{let B=im(E,T,["field1","field2"]);ye(D,T.field1Name)&&r5.setValue(B.field1(),D[T.field1Name]),ye(D,T.field2Name)&&r5.setValue(B.field2(),D[T.field2Name])}}})]),apis:{getField1:E=>om(E,T,"field1"),getField2:E=>om(E,T,"field2"),getLock:E=>om(E,T,"lock")}}),apis:{getField1:(T,E)=>T.getField1(E),getField2:(T,E)=>T.getField2(E),getLock:(T,E)=>T.getLock(E)}}),IO=T=>{let E=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(T);if(null!==E){let T=parseFloat(E[1]),D=E[2];return tx.value({value:T,unit:D})}return tx.error(T)},RO=(T,E)=>{let D={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},n=T=>ve(D,T);return T.unit===E?A.some(T.value):n(T.unit)&&n(E)?D[T.unit]===D[E]?A.some(T.value):A.some(T.value/D[T.unit]*D[E]):A.none()},NO=T=>A.none(),VO=(T,E)=>{let D=T.label.map(T=>pS(T,E)),B=[a$.config({disabled:()=>T.disabled||E.isDisabled()}),Sy(),sq.config({mode:"execution",useEnter:!0!==T.multiline,useControlEnter:!0===T.multiline,execute:T=>(Fr(T,uZ),A.some(!0))}),Jp("textfield-change",[Ur(t1(),(E,D)=>{Ir(E,uX,{name:T.name})}),Ur(or(),(E,D)=>{Ir(E,uX,{name:T.name})})]),uJ.config({})],M=T.validation.map(T=>u6.config({getRoot:T=>rt(T.element),invalidClass:"tox-invalid",validator:{validate:E=>{let D=r5.getValue(E),B=T.validator(D);return bw(!0===B?tx.value(D):tx.error(B))},validateOnLoad:T.validateOnLoad}})).toArray(),er={...T.placeholder.fold(x({}),T=>({placeholder:E.translate(T)})),...T.inputMode.fold(x({}),T=>({inputmode:T}))},ec=uj.parts.field({tag:!0===T.multiline?"textarea":"input",...T.data.map(T=>({data:T})).getOr({}),inputAttributes:er,inputClasses:[T.classname],inputBehaviours:kl(q([B,M])),selectOnFocus:!1,factory:cv}),eu=T.multiline?{dom:{tag:"div",classes:["tox-textarea-wrap"]},components:[ec]}:ec,eg=(T.flex?["tox-form__group--stretched"]:[]).concat(T.maximized?["tox-form-group--maximize"]:[]),ep=[a$.config({disabled:()=>T.disabled||E.isDisabled(),onDisabled:T=>{uj.getField(T).each(a$.disable)},onEnabled:T=>{uj.getField(T).each(a$.enable)}}),Sy()];return uS(D,eu,eg,ep)},zO=(T,E)=>E.getAnimationRoot.fold(()=>T.element,E=>E(T)),HO=T=>T.dimension.property,LO=(T,E)=>T.dimension.getDimension(E),PO=(T,E)=>{let D=zO(T,E);ja(D,[E.shrinkingClass,E.growingClass])},UO=(T,E)=>{Pa(T.element,E.openClass),La(T.element,E.closedClass),Dt(T.element,HO(E),"0px"),Lt(T.element)},WO=(T,E)=>{Pa(T.element,E.closedClass),La(T.element,E.openClass),Ht(T.element,HO(E))},jO=(T,E,D,B)=>{D.setCollapsed(),Dt(T.element,HO(E),LO(E,T.element)),PO(T,E),UO(T,E),E.onStartShrink(T),E.onShrunk(T)},GO=(T,E,D,B)=>{let M=B.getOrThunk(()=>LO(E,T.element));D.setCollapsed(),Dt(T.element,HO(E),M),Lt(T.element);let er=zO(T,E);Pa(er,E.growingClass),La(er,E.shrinkingClass),UO(T,E),E.onStartShrink(T)},$O=(T,E,D)=>{let B=LO(E,T.element);("0px"===B?jO:GO)(T,E,D,A.some(B))},qO=(T,E,D)=>{let B=zO(T,E),M=Ua(B,E.shrinkingClass),er=LO(E,T.element);WO(T,E);let ec=LO(E,T.element);(M?()=>{Dt(T.element,HO(E),er),Lt(T.element)}:()=>{UO(T,E)})(),Pa(B,E.shrinkingClass),La(B,E.growingClass),WO(T,E),Dt(T.element,HO(E),ec),D.setExpanded(),E.onStartGrow(T)},XO=(T,E,D)=>{let B=zO(T,E);return!0===Ua(B,E.growingClass)},YO=(T,E,D)=>{let B=zO(T,E);return!0===Ua(B,E.shrinkingClass)};var gq=Object.freeze({__proto__:null,refresh:(T,E,D)=>{if(D.isExpanded()){Ht(T.element,HO(E));let D=LO(E,T.element);Dt(T.element,HO(E),D)}},grow:(T,E,D)=>{D.isExpanded()||qO(T,E,D)},shrink:(T,E,D)=>{D.isExpanded()&&$O(T,E,D)},immediateShrink:(T,E,D)=>{D.isExpanded()&&jO(T,E,D)},hasGrown:(T,E,D)=>D.isExpanded(),hasShrunk:(T,E,D)=>D.isCollapsed(),isGrowing:XO,isShrinking:YO,isTransitioning:(T,E,D)=>XO(T,E)||YO(T,E),toggleGrow:(T,E,D)=>{(D.isExpanded()?$O:qO)(T,E,D)},disableTransitions:PO,immediateGrow:(T,E,D)=>{D.isExpanded()||(WO(T,E),Dt(T.element,HO(E),LO(E,T.element)),PO(T,E),D.setExpanded(),E.onStartGrow(T),E.onGrown(T))}}),gK=Object.freeze({__proto__:null,exhibit:(T,E,D)=>{let B=E.expanded;return Ea(B?{classes:[E.openClass],styles:{}}:{classes:[E.closedClass],styles:Ms(E.dimension.property,"0px")})},events:(T,E)=>Hr([Yr(t9(),(D,B)=>{B.event.raw.propertyName===T.dimension.property&&(PO(D,T),E.isExpanded()&&Ht(D.element,T.dimension.property),(E.isExpanded()?T.onGrown:T.onShrunk)(D))})])}),gY=[os("closedClass"),os("openClass"),os("shrinkingClass"),os("growingClass"),us("getAnimationRoot"),Di("onShrunk"),Di("onStartShrink"),Di("onGrown"),Di("onStartGrow"),ys("expanded",!1),ns("dimension",Jn("property",{width:[Ri("property","width"),Ri("getDimension",T=>Jt(T)+"px")],height:[Ri("property","height"),Ri("getDimension",T=>Wt(T)+"px")]}))];let gZ=Ol({fields:gY,name:"sliding",active:gK,apis:gq,state:Object.freeze({__proto__:null,init:T=>{let E=Es(T.expanded);return _a({isExpanded:()=>!0===E.get(),isCollapsed:()=>!1===E.get(),setCollapsed:k(E.set,!1),setExpanded:k(E.set,!0),readState:()=>"expanded: "+E.get()})}})}),e_=T=>({isEnabled:()=>!a$.isDisabled(T),setEnabled:E=>a$.set(T,!E),setActive:E=>{let D=T.element;E?(La(D,"tox-tbtn--enabled"),kt(D,"aria-pressed",!0)):(Pa(D,"tox-tbtn--enabled"),Et(D,"aria-pressed"))},isActive:()=>Ua(T.element,"tox-tbtn--enabled"),setText:E=>{Ir(T,gz,{text:E})},setIcon:E=>Ir(T,gP,{icon:E})}),t_=(T,E,D,B,M=!0)=>xO({text:T.text,icon:T.icon,tooltip:T.tooltip,searchable:T.search.isSome(),role:B,fetch:(E,B)=>{let M={pattern:T.search.isSome()?Iw(E):""};T.fetch(E=>{B(CO(E,l2.CLOSE_ON_EXECUTE,D,{isHorizontalMenu:!1,search:T.search}))},M,e_(E))},onSetup:T.onSetup,getApi:e_,columns:1,presets:"normal",classes:[],dropdownBehaviours:[...M?[uJ.config({})]:[]]},E,D.shared),o_=(T,E,D)=>{let n=T=>B=>{let M=!B.isActive();B.setActive(M),T.storage.set(M),D.shared.getSink().each(D=>{E().getOpt(D).each(E=>{Dl(E.element),Ir(E,uY,{name:T.name,value:T.storage.get()})})})},s=T=>E=>{E.setActive(T.storage.get())};return E=>{E(H(T,T=>{let E=T.text.fold(()=>({}),T=>({text:T}));return{type:T.type,active:!1,...E,onAction:n(T),onSetup:s(T)}}))}},n_=T=>({dom:{tag:"span",classes:["tox-tree__label"],attributes:{title:T,"aria-label":T}},components:[ti(T)]}),gQ=la("leaf-label-event-id"),r_=({leaf:T,onLeafAction:E,visible:D,treeId:B,selectedId:M,backstage:er})=>{let ec=T.menu.map(T=>t_(T,"tox-mbtn",er,A.none(),D)),eu=[n_(T.title)];return ec.each(T=>eu.push(T)),iL.sketch({dom:{tag:"div",classes:["tox-tree--leaf__label","tox-trbtn"].concat(D?["tox-tree--leaf__label--visible"]:[])},components:eu,role:"treeitem",action:D=>{E(T.id),D.getSystem().broadcastOn([`update-active-item-${B}`],{value:T.id})},eventOrder:{[tQ()]:[gQ,"keying"]},buttonBehaviours:kl([...D?[uJ.config({})]:[],s9.config({toggleClass:"tox-trbtn--enabled",toggleOnExecute:!1,aria:{mode:"selected"}}),nK.config({channels:{[`update-active-item-${B}`]:{onReceive:(E,D)=>{(D.value===T.id?s9.on:s9.off)(E)}}}}),Jp(gQ,[oX((E,D)=>{M.each(D=>{(D===T.id?s9.on:s9.off)(E)})}),Ur(tQ(),(T,E)=>{let D="ArrowLeft"===E.event.raw.code,B="ArrowRight"===E.event.raw.code;D?(mi(T.element,".tox-tree--directory").each(E=>{T.getSystem().getByDom(E).each(T=>{gi(E,".tox-tree--directory__label").each(E=>{T.getSystem().getByDom(E).each(s1.focus)})})}),E.stop()):B&&E.stop()})])])})},g0=la("directory-label-event-id"),i_=({directory:T,visible:E,noChildren:D,backstage:B})=>{var M;let er=T.menu.map(T=>t_(T,"tox-mbtn",B,A.none())),ec=[{dom:{tag:"div",classes:["tox-chevron"]},components:[ef("chevron-right",{tag:"span",classes:["tox-tree__icon-wrap","tox-icon"],behaviours:[]},B.shared.providers.icons)]},n_(T.title)];er.each(T=>{ec.push(T)});let l=E=>{mi(E.element,".tox-tree--directory").each(D=>{E.getSystem().getByDom(D).each(D=>{let B=!s9.isOn(D);s9.toggle(D),Ir(E,"expand-tree-node",{expanded:B,node:T.id})})})};return iL.sketch({dom:{tag:"div",classes:["tox-tree--directory__label","tox-trbtn"].concat(E?["tox-tree--directory__label--visible"]:[])},components:ec,action:l,eventOrder:{[tQ()]:[g0,"keying"]},buttonBehaviours:kl([...E?[uJ.config({})]:[],Jp(g0,[Ur(tQ(),(T,E)=>{let B="ArrowRight"===E.event.raw.code,M="ArrowLeft"===E.event.raw.code;B&&D&&E.stop(),(B||M)&&mi(T.element,".tox-tree--directory").each(D=>{T.getSystem().getByDom(D).each(D=>{!s9.isOn(D)&&B||s9.isOn(D)&&M?(l(T),E.stop()):M&&!s9.isOn(D)&&(mi(D.element,".tox-tree--directory").each(T=>{gi(T,".tox-tree--directory__label").each(T=>{D.getSystem().getByDom(T).each(s1.focus)})}),E.stop())})})})])])})},l_=({children:T,onLeafAction:E,visible:D,treeId:B,expandedIds:M,selectedId:er,backstage:ec})=>({dom:{tag:"div",classes:["tox-tree--directory__children"]},components:T.map(T=>"leaf"===T.type?r_({leaf:T,selectedId:er,onLeafAction:E,visible:D,treeId:B,backstage:ec}):d_({directory:T,expandedIds:M,selectedId:er,onLeafAction:E,labelTabstopping:D,treeId:B,backstage:ec})),behaviours:kl([gZ.config({dimension:{property:"height"},closedClass:"tox-tree--directory__children--closed",openClass:"tox-tree--directory__children--open",growingClass:"tox-tree--directory__children--growing",shrinkingClass:"tox-tree--directory__children--shrinking",expanded:D}),sY.config({})])}),g1=la("directory-event-id"),d_=({directory:T,onLeafAction:E,labelTabstopping:D,treeId:B,backstage:M,expandedIds:er,selectedId:ec})=>{let{children:eu}=T,eg=Es(er),ep=er.includes(T.id);return{dom:{tag:"div",classes:["tox-tree--directory"],attributes:{role:"treeitem"}},components:[i_({directory:T,visible:D,noChildren:0===T.children.length,backstage:M}),l_({children:eu,expandedIds:er,selectedId:ec,onLeafAction:E,visible:ep,treeId:B,backstage:M})],behaviours:kl([Jp(g1,[oX((T,E)=>{s9.set(T,ep)}),Ur("expand-tree-node",(T,E)=>{let{expanded:D,node:B}=E.event;eg.set(D?[...eg.get(),B]:eg.get().filter(T=>T!==B))})]),s9.config({...T.children.length>0?{aria:{mode:"expanded"}}:{},toggleClass:"tox-tree--directory--expanded",onToggled:(T,D)=>{let er=T.components()[1],ep=eu.map(T=>"leaf"===T.type?r_({leaf:T,selectedId:ec,onLeafAction:E,visible:D,treeId:B,backstage:M}):d_({directory:T,expandedIds:eg.get(),selectedId:ec,onLeafAction:E,labelTabstopping:D,treeId:B,backstage:M}));D?gZ.grow(er):gZ.shrink(er),sY.set(er,ep)}})])}},g2=la("tree-event-id");var g3=Object.freeze({__proto__:null,events:(T,E)=>{let D=T.stream.streams.setup(T,E);return Hr([Ur(T.event,D),oq(()=>E.cancel())].concat(T.cancelEvent.map(T=>[Ur(T,()=>E.cancel())]).getOr([])))}});let g_=T=>{let E=Es(null);return _a({readState:()=>({timer:null!==E.get()?"set":"unset"}),setTimer:T=>{E.set(T)},cancel:()=>{let T=E.get();null!==T&&T.cancel()}})};var g5=Object.freeze({__proto__:null,throttle:g_,init:T=>T.stream.streams.state(T)}),g9=[ns("stream",Jn("mode",{throttle:[os("delay"),ys("stopEvent",!0),Ri("streams",{setup:(T,E)=>{let D=T.stream,B=PC(T.onStream,D.delay);return E.setTimer(B),(T,E)=>{B.throttle(T,E),D.stopEvent&&E.stop()}},state:g_})]})),ys("event","input"),us("cancelEvent"),Fi("onStream")];let g4=Ol({fields:g9,name:"streaming",active:g3,state:g5}),b_=(T,E,D)=>{let B=r5.getValue(D);r5.setValue(E,B),y_(E)},v_=(T,E)=>{let D=T.element,B=$a(D),M=D.dom;"number"!==Ot(D,"type")&&E(M,B)},y_=T=>{v_(T,(T,E)=>T.setSelectionRange(E.length,E.length))},g6=x("alloy.typeahead.itemexecute"),g8=x([us("lazySink"),os("fetch"),ys("minChars",5),ys("responseTime",1e3),Di("onOpen"),ys("getHotspot",A.some),ys("getAnchorOverrides",x({})),ys("layouts",A.none()),ys("eventOrder",{}),Ts("model",{},[ys("getDisplayText",T=>void 0!==T.meta&&void 0!==T.meta.text?T.meta.text:T.value),ys("selectsOver",!0),ys("populateFromBrowse",!0)]),Di("onSetValue"),Bi("onExecute"),Di("onItemExecute"),ys("inputClasses",[]),ys("inputAttributes",{}),ys("inputStyles",{}),ys("matchWidth",!0),ys("useMinWidth",!1),ys("dismissOnBlur",!0),Ai(["openClass"]),us("initialData"),hu("typeaheadBehaviours",[s1,r5,g4,sq,s9,uC]),es("lazyTypeaheadComp",()=>Es(A.none)),es("previewing",()=>Es(!0))].concat(ch()).concat(Ew())),g7=x([a_({schema:[Ei()],name:"menu",overrides:T=>({fakeFocus:!0,onHighlightItem:(E,D,B)=>{T.previewing.get()?T.lazyTypeaheadComp.get().each(E=>{((T,E,D)=>{if(T.selectsOver){let B=r5.getValue(E),M=T.getDisplayText(B),er=r5.getValue(D);return 0===T.getDisplayText(er).indexOf(M)?A.some(()=>{var T;b_(0,E,D),T=M.length,v_(E,(E,D)=>E.setSelectionRange(T,D.length))}):A.none()}return A.none()})(T.model,E,B).fold(()=>{T.model.selectsOver?(aK.dehighlight(D,B),T.previewing.set(!0)):T.previewing.set(!1)},E=>{E(),T.previewing.set(!1)})}):T.lazyTypeaheadComp.get().each(E=>{T.model.populateFromBrowse&&b_(T.model,E,B),_t(B.element,"id").each(T=>kt(E.element,"aria-activedescendant",T))})},onExecute:(E,D)=>T.lazyTypeaheadComp.get().map(T=>(Ir(T,g6(),{item:D}),!0)),onHover:(E,D)=>{T.previewing.set(!1),T.lazyTypeaheadComp.get().each(E=>{T.model.populateFromBrowse&&b_(T.model,E,D)})}})})]),pt=bm({name:"Typeahead",configFields:g8(),partFields:g7(),factory:(T,E,D,B)=>{let s=(E,D,M)=>{T.previewing.set(!1);let er=uC.getCoupled(E,"sandbox");rJ.isOpen(er)?aP.getCurrent(er).each(T=>{aK.getHighlighted(T).fold(()=>{M(T)},()=>{zr(er,T.element,"keydown",D)})}):ww(T,a(E),E,er,B,T=>{aP.getCurrent(T).each(M)},iQ.HighlightMenuAndItem).get(b)},M=Ib(T),a=T=>E=>E.map(E=>{let D=fe(E.menus),B=X(D,T=>U(T.items,T=>"item"===T.type));return r5.getState(T).update(H(B,T=>T.data)),E}),i=T=>aP.getCurrent(T),er="typeaheadevents",ec=[s1.config({}),r5.config({onSetValue:T.onSetValue,store:{mode:"dataset",getDataKey:T=>$a(T.element),getFallbackEntry:T=>({value:T,meta:{}}),setValue:(E,D)=>{qa(E.element,T.model.getDisplayText(D))},...T.initialData.map(T=>Ms("initialValue",T)).getOr({})}}),g4.config({stream:{mode:"throttle",delay:T.responseTime,stopEvent:!1},onStream:(E,D)=>{let M=uC.getCoupled(E,"sandbox");if(s1.isFocused(E)&&$a(E.element).length>=T.minChars){let D=i(M).bind(T=>aK.getHighlighted(T).map(r5.getValue));T.previewing.set(!0),ww(T,a(E),E,M,B,E=>{i(M).each(E=>{D.fold(()=>{T.model.selectsOver&&aK.highlightFirst(E)},T=>{aK.highlightBy(E,E=>r5.getValue(E).value===T.value),aK.getHighlighted(E).orThunk(()=>(aK.highlightFirst(E),A.none()))})})},iQ.HighlightJustMenu).get(b)}},cancelEvent:oA()}),sq.config({mode:"special",onDown:(T,E)=>(s(T,E,aK.highlightFirst),A.some(!0)),onEscape:T=>{let E=uC.getCoupled(T,"sandbox");return rJ.isOpen(E)?(rJ.close(E),A.some(!0)):A.none()},onUp:(T,E)=>(s(T,E,aK.highlightLast),A.some(!0)),onEnter:E=>{let D=uC.getCoupled(E,"sandbox"),B=rJ.isOpen(D);if(B&&!T.previewing.get())return i(D).bind(T=>aK.getHighlighted(T)).map(T=>(Ir(E,g6(),{item:T}),!0));{let M=r5.getValue(E);return Fr(E,oA()),T.onExecute(D,E,M),B&&rJ.close(D),A.some(!0)}}}),s9.config({toggleClass:T.markers.openClass,aria:{mode:"expanded"}}),uC.config({others:{sandbox:E=>_w(T,E,{onOpen:()=>s9.on(E),onClose:()=>{T.lazyTypeaheadComp.get().each(T=>Et(T.element,"aria-activedescendant")),s9.off(E)}})}}),Jp(er,[oX(E=>{T.lazyTypeaheadComp.set(A.some(E))}),oq(E=>{T.lazyTypeaheadComp.set(A.none())}),oY(E=>{kw(T,a(E),E,B,b,iQ.HighlightMenuAndItem).get(b)}),Ur(g6(),(E,D)=>{let B=uC.getCoupled(E,"sandbox");b_(T.model,E,D.event.item),Fr(E,oA()),T.onItemExecute(E,B,D.event.item,r5.getValue(E)),rJ.close(B),y_(E)})].concat(T.dismissOnBlur?[Ur(oo(),T=>{let E=uC.getCoupled(T,"sandbox");Rl(E.element).isNone()&&rJ.close(E)})]:[]))],eu={[oN()]:[r5.name(),g4.name(),er],...T.eventOrder};return{uid:T.uid,dom:Nb(tw(T,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:{...M,...bu(T.typeaheadBehaviours,ec)},eventOrder:eu}}}),C_=T=>({...T,toCached:()=>C_(T.toCached()),bindFuture:E=>C_(T.bind(T=>T.fold(T=>bw(tx.error(T)),T=>E(T)))),bindResult:E=>C_(T.map(T=>T.bind(E))),mapResult:E=>C_(T.map(T=>T.map(E))),mapError:E=>C_(T.map(T=>T.mapError(E))),foldResult:(E,D)=>T.map(T=>T.fold(E,D)),withTimeout:(E,D)=>C_(fw(B=>{let M=!1,er=setTimeout(()=>{M=!0,B(tx.error(D()))},E);T.get(T=>{M||(clearTimeout(er),B(T))})}))}),O_=T=>C_(fw(T)),__=(T,E,D=[],B,M,er)=>{let ec=E.fold(()=>({}),T=>({action:T})),eu={buttonBehaviours:kl([ky(()=>!T.enabled||er.isDisabled()),Sy(),uJ.config({}),Jp("button press",[Pr("click"),Pr("mousedown")])].concat(D)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]},...ec},eg=tw(eu,{dom:B});return tw(eg,{components:M})},T_=(T,E,D,B=[])=>{let M={tag:"button",classes:["tox-tbtn"],attributes:T.tooltip.map(T=>({"aria-label":D.translate(T),title:D.translate(T)})).getOr({})},er=T.icon.map(T=>hO(T,D.icons)),ec=we([er]);return __(T,E,B,M,ec,D)},E_=T=>{switch(T){case"primary":return["tox-button"];case"toolbar":return["tox-tbtn"];default:return["tox-button","tox-button--secondary"]}},A_=(T,E,D,B=[],M=[])=>{let er=D.translate(T.text),ec=T.icon.map(T=>hO(T,D.icons)),eu=[ec.getOrThunk(()=>ti(er))],eg=T.buttonType.getOr(T.primary||T.borderless?"primary":"secondary"),ep=[...E_(eg),...ec.isSome()?["tox-button--icon"]:[],...T.borderless?["tox-button--naked"]:[],...M];return __(T,E,B,{tag:"button",classes:ep,attributes:{title:er}},eu,D)},M_=(T,E,D,B=[],M=[])=>{let er=A_(T,A.some(E),D,B,M);return iL.sketch(er)},D_=(T,E)=>D=>{"custom"===E?Ir(D,uY,{name:T,value:{}}):"submit"===E?Fr(D,uZ):"cancel"===E?Fr(D,uK):console.error("Unknown button type: ",E)},B_=(T,E,D)=>{if("menu"===E){let E={...T,type:"menubutton",search:A.none(),onSetup:E=>(E.setEnabled(T.enabled),b),fetch:o_(T.items,()=>B,D)},B=jh(t_(E,"tox-tbtn",D,A.none()));return B.asSpec()}if("custom"===E||"cancel"===E||"submit"===E){let B=D_(T.name,E),M={...T,borderless:!1};return M_(M,B,D.shared.providers,[])}if("togglebutton"===E)return((T,E)=>{var D,B;let M=T.icon.map(T=>fO(T,E.icons)).map(jh),er=T.buttonType.getOr(T.primary?"primary":"secondary"),ec={...T,name:null!==(D=T.name)&&void 0!==D?D:"",primary:"primary"===er,tooltip:A.from(T.tooltip),enabled:null!==(B=T.enabled)&&void 0!==B&&B,borderless:!1},eu=ec.tooltip.map(T=>({"aria-label":E.translate(T),title:E.translate(T)})).getOr({}),eg=E_(null!=er?er:"secondary"),ep=T.icon.isSome()&&T.text.isSome(),eh={tag:"button",classes:[...eg.concat(T.icon.isSome()?["tox-button--icon"]:[]),...T.active?["tox-button--enabled"]:[],...ep?["tox-button--icon-and-text"]:[]],attributes:eu},ey=E.translate(T.text.getOr("")),ex=ti(ey),eO=[...we([M.map(T=>T.asSpec())]),...T.text.isSome()?[ex]:[]],eD=__(ec,A.some(D=>{Ir(D,uY,{name:T.name,value:{setIcon:T=>{M.map(B=>B.getOpt(D).each(D=>{sY.set(D,[fO(T,E.icons)])}))}}})}),[],eh,eO,E);return iL.sketch(eD)})(T,D.shared.providers);throw console.error("Unknown footer button type: ",E),Error("Unknown footer button type")},po={type:"separator"},I_=T=>({type:"menuitem",value:T.url,text:T.title,meta:{attach:T.attach},onAction:b}),R_=(T,E)=>({type:"menuitem",value:E,text:T,meta:{attach:void 0},onAction:b}),N_=(T,E)=>H(U(E,E=>E.type===T),I_),V_=T=>N_("header",T.targets),z_=T=>N_("anchor",T.targets),H_=T=>A.from(T.anchorTop).map(T=>R_("<top>",T)).toArray(),L_=T=>A.from(T.anchorBottom).map(T=>R_("<bottom>",T)).toArray(),P_=(T,E)=>{let D=T.toLowerCase();return U(E,T=>{var E;let B=void 0!==T.meta&&void 0!==T.meta.text?T.meta.text:T.text,M=null!==(E=T.value)&&void 0!==E?E:"";return Te(B.toLowerCase(),D)||Te(M.toLowerCase(),D)})},pr=la("aria-invalid"),W_=(T,E)=>{T.dom.checked=E},j_=T=>T.dom.checked,G_=T=>(E,D,B,M)=>be(D,"name").fold(()=>T(D,M,A.none()),er=>E.field(er,T(D,M,be(B,er)))),pu={bar:G_((T,E)=>{var D;return D=E.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:H(T.items,D.interpreter)}}),collection:G_((T,E,D)=>((T,E,D)=>{var B;let M=T.label.map(T=>pS(T,E)),s=T=>(E,D)=>{hi(D.event.target,"[data-collection-item-value]").each(B=>{T(E,D,B,Ot(B,"data-collection-item-value"))})},er=s((D,B,M,er)=>{B.stop(),E.isDisabled()||Ir(D,uY,{name:T.name,value:er})}),ec=[Ur(tK(),s((T,E,D)=>{Dl(D)})),Ur(t3(),er),Ur(oy(),er),Ur(tY(),s((T,E,D)=>{pi(T.element,"."+cr).each(T=>{Pa(T,cr)}),La(D,cr)})),Ur(tZ(),s(T=>{pi(T.element,"."+cr).each(T=>{Pa(T,cr)})})),oY(s((E,D,B,M)=>{Ir(E,uY,{name:T.name,value:M})}))],i=(T,E)=>H(Xc(T.element,".tox-collection__item"),E),eu=uj.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==T.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:w},behaviours:kl([a$.config({disabled:E.isDisabled,onDisabled:T=>{i(T,T=>{La(T,"tox-collection__item--state-disabled"),kt(T,"aria-disabled",!0)})},onEnabled:T=>{i(T,T=>{Pa(T,"tox-collection__item--state-disabled"),Et(T,"aria-disabled")})}}),Sy(),sY.config({}),r5.config({store:{mode:"memory",initialValue:D.getOr([])},onSetValue:(D,B)=>{((D,B)=>{let M=H(B,D=>{let B=iz.translate(D.text),M=1===T.columns?`<div class="tox-collection__item-label">${B}</div>`:"",er=`<div class="tox-collection__item-icon">${D.icon}</div>`,ec={_:" "," - ":" ","-":" "},eu=B.replace(/\_| \- |\-/g,T=>ec[T]);return`<div class="tox-collection__item${E.isDisabled()?" tox-collection__item--state-disabled":""}" tabindex="-1" data-collection-item-value="${u$.encodeAllRaw(D.value)}" title="${eu}" aria-label="${eu}">${er}${M}</div>`}),er="auto"!==T.columns&&T.columns>1?z(M,T.columns):[M],ec=H(er,T=>`<div class="tox-collection__group">${T.join("")}</div>`);ta(D.element,ec.join(""))})(D,B),"auto"===T.columns&&iy(D,5,"tox-collection__item").each(({numRows:T,numColumns:E})=>{sq.setGridSize(D,T,E)}),Fr(D,u2)}}),uJ.config({}),sq.config(1===(B=T.columns)?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===B?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:`.${l5}`}}),Jp("collection-events",ec)]),eventOrder:{[of()]:["disabling","alloy.base.behaviour","collection-events"]}});return uS(M,eu,["tox-form__group--collection"],[])})(T,E.shared.providers,D)),alertbanner:G_((T,E)=>((T,E)=>{let D=Jh(T.icon,E.icons);return uL.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in",`tox-notification--${T.level}`]},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:T.url?void 0:D},components:T.url?[iL.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:D,attributes:{title:E.translate(T.iconTooltip)}},action:E=>Ir(E,uY,{name:"alert-banner",value:T.url}),buttonBehaviours:kl([Zh()])})]:void 0},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:E.translate(T.text)}}]})})(T,E.shared.providers)),input:G_((T,E,D)=>{var B;return B=E.shared.providers,VO({name:T.name,multiline:!1,label:T.label,inputMode:T.inputMode,placeholder:T.placeholder,flex:!1,disabled:!T.enabled,classname:"tox-textfield",validation:A.none(),maximized:T.maximized,data:D},B)}),textarea:G_((T,E,D)=>{var B;return B=E.shared.providers,VO({name:T.name,multiline:!0,label:T.label,inputMode:A.none(),placeholder:T.placeholder,flex:!0,disabled:!T.enabled,classname:"tox-textarea",validation:A.none(),maximized:T.maximized,data:D},B)}),label:G_((T,E)=>((T,E)=>{let D="tox-label";return{dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"label",classes:[D,..."center"===T.align?[`${D}--center`]:[],..."end"===T.align?[`${D}--end`]:[]]},components:[ti(E.providers.translate(T.label))]},...H(T.items,E.interpreter)],behaviours:kl([DC(),sY.config({}),NC(A.none(),ea,ta),sq.config({mode:"acyclic"})])}})(T,E.shared)),iframe:(pG=(T,E,D)=>((T,E,D)=>{let B="tox-dialog__iframe",M=T.transparent?[]:[`${B}--opaque`],er=T.border?["tox-navobj-bordered"]:[],ec={...T.label.map(T=>({title:T})).getOr({}),...D.map(T=>({srcdoc:T})).getOr({}),...T.sandboxed?{sandbox:"allow-scripts allow-same-origin"}:{}},eu=((T,E)=>{let D=Es(T.getOr(""));return{getValue:T=>D.get(),setValue:(T,B)=>{if(D.get()!==B){let D=T.element,s=()=>kt(D,"srcdoc",B);E?gH.fold(x(lO),T=>T.throttle)(D,B,s):s()}D.set(B)}}})(D,T.streamContent),eg=T.label.map(T=>pS(T,E)),ep=uj.parts.field({factory:{sketch:T=>GC(A.from(er),{uid:T.uid,dom:{tag:"iframe",attributes:ec,classes:[B,...M]},behaviours:kl([uJ.config({}),s1.config({}),RC(D,eu.getValue,eu.setValue),nK.config({channels:{[gC]:{onReceive:(T,E)=>{E.newFocus.each(E=>{rt(T.element).each(D=>{(Ze(T.element,E)?La:Pa)(D,"tox-navobj-bordered-focus")})})}}}})])})}});return uS(eg,ep,["tox-form__group--stretched"],[])})(T,E.shared.providers,D),(T,E,D,B)=>{let M=tw(E,{source:"dynamic"});return G_(pG)(T,M,D,B)}),button:G_((T,E)=>((T,E)=>{let D=D_(T.name,"custom");return uS(A.none(),uj.parts.field({factory:iL,...A_(T,A.some(D),E,[VC(""),DC()])}),[],[])})(T,E.shared.providers)),checkbox:G_((T,E,D)=>((T,E,D)=>{let n=T=>(T.element.dom.click(),A.some(!0)),B=uj.parts.field({factory:{sketch:w},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:kl([DC(),a$.config({disabled:()=>!T.enabled||E.isDisabled(),onDisabled:T=>{rt(T.element).each(T=>La(T,"tox-checkbox--disabled"))},onEnabled:T=>{rt(T.element).each(T=>Pa(T,"tox-checkbox--disabled"))}}),uJ.config({}),s1.config({}),NC(D,j_,W_),sq.config({mode:"special",onEnter:n,onSpace:n,stopSpaceKeyup:!0}),Jp("checkbox-events",[Ur(t2(),(E,D)=>{Ir(E,uX,{name:T.name})})])])}),M=uj.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"]},components:[ti(E.translate(T.label))],behaviours:kl([u8.config({})])}),a=T=>ef("checked"===T?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+T]},E.icons),er=jh({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[a("checked"),a("unchecked")]});return uj.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[B,er.asSpec(),M],fieldBehaviours:kl([a$.config({disabled:()=>!T.enabled||E.isDisabled()}),Sy()])})})(T,E.shared.providers,D)),colorinput:G_((T,E,D)=>((T,E,D,B)=>{var M;let er=uj.parts.field({factory:cv,inputClasses:["tox-textfield"],data:B,onSetValue:T=>u6.run(T).get(b),inputBehaviours:kl([a$.config({disabled:E.providers.isDisabled}),Sy(),uJ.config({}),u6.config({invalidClass:"tox-textbox-field-invalid",getRoot:T=>rt(T.element),notify:{onValid:T=>{let E=r5.getValue(T);Ir(T,u7,{color:E})}},validator:{validateOnLoad:!1,validate:T=>{let E=r5.getValue(T);if(0===E.length)return bw(tx.value(!0));{let T=Re("span");Dt(T,"background-color",E);let D=Nt(T,"background-color").fold(()=>tx.error("blah"),T=>tx.value(E));return bw(D)}}}})]),selectOnFocus:!1}),ec=T.label.map(T=>pS(T,E.providers)),a=(T,E)=>{Ir(T,mo,{value:E})},eu=jh((M={dom:{tag:"span",attributes:{"aria-label":E.providers.translate("Color swatch")}},layouts:{onRtl:()=>[rl,sl,cl],onLtr:()=>[sl,rl,cl]},components:[],fetch:$x(D.getColors(T.storageKey),T.storageKey,D.hasCustomColors()),columns:D.getColorCols(T.storageKey),presets:"color",onItemAction:(E,B)=>{eu.getOpt(E).each(E=>{"custom"===B?D.colorPicker(D=>{D.fold(()=>Fr(E,mn),D=>{a(E,D),Ox(T.storageKey,D)})},"#ffffff"):a(E,"remove"===B?"":B)})}},uH.sketch({dom:M.dom,components:M.components,toggleClass:"mce-active",dropdownBehaviours:kl([ky(E.providers.isDisabled),Sy(),u8.config({}),uJ.config({})]),layouts:M.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:E.getSink,fetch:T=>fw(T=>M.fetch(T)).map(D=>A.from(Hw(tw(Zx(la("menu-value"),D,E=>{M.onItemAction(T,E)},M.columns,M.presets,l2.CLOSE_ON_EXECUTE,ep,E.providers),{movement:ew(M.columns,M.presets)})))),parts:{menu:Bb(0,0,M.presets)}})));return uj.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:ec.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[er,eu.asSpec()]}]),fieldBehaviours:kl([Jp("form-field-events",[Ur(u7,(E,D)=>{eu.getOpt(E).each(T=>{Dt(T.element,"background-color",D.event.color)}),Ir(E,uX,{name:T.name})}),Ur(mo,(T,E)=>{uj.getField(T).each(D=>{r5.setValue(D,E.event.value),aP.getCurrent(T).each(s1.focus)})}),Ur(mn,(T,E)=>{uj.getField(T).each(E=>{aP.getCurrent(T).each(s1.focus)})})])])})})(T,E.shared,E.colorinput,D)),colorpicker:G_((T,E,D)=>((T,E,D)=>{let n=T=>"tox-"+T,B=MC(T=>E.translate(gr[T]),n),M=jh(B.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:T=>{Ir(T,uY,{name:"hex-valid",value:!0})},onInvalidHex:T=>{Ir(T,uY,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[M.asSpec()],behaviours:kl([RC(D,T=>{let E=M.get(T);return aP.getCurrent(E).bind(T=>r5.getValue(T).hex).map(T=>"#"+_e(T,"#")).getOr("")},(T,E)=>{let D=A.from(/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(E)).bind(T=>te(T,1)),B=M.get(T);aP.getCurrent(B).fold(()=>{console.log("Can not find form")},T=>{r5.setValue(T,{hex:D.getOr("")}),m4.getField(T,"hex").each(T=>{Fr(T,t1())})})}),DC()])}})(0,E.shared.providers,D)),dropzone:G_((T,E,D)=>((T,E,D)=>{let n=(T,E)=>{E.stop()},s=T=>(E,D)=>{L(T,T=>{T(E,D)})},r=(T,E)=>{var D;if(!a$.isDisabled(T)){let B=E.event.raw;i(T,null===(D=B.dataTransfer)||void 0===D?void 0:D.files)}},a=(T,E)=>{let D=E.event.raw.target;i(T,D.files)},i=(D,B)=>{B&&(r5.setValue(D,((T,E)=>{let D=gp.explode(E.getOption("images_file_types"));return U(eD(T),T=>N(D,E=>Ae(T.name.toLowerCase(),`.${E.toLowerCase()}`)))})(B,E)),Ir(D,uX,{name:T.name}))},B=jh({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:kl([Jp("input-file-events",[qr(t3()),qr(oy())])])}),M=T.label.map(T=>pS(T,E)),er=uj.parts.field({factory:{sketch:T=>({uid:T.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:kl([VC(D.getOr([])),DC(),a$.config({}),s9.config({toggleClass:"dragenter",toggleOnExecute:!1}),Jp("dropzone-events",[Ur("dragenter",s([n,s9.toggle])),Ur("dragleave",s([n,s9.toggle])),Ur("dragover",n),Ur("drop",s([n,r])),Ur(t2(),a)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p"},components:[ti(E.translate("Drop an image here"))]},iL.sketch({dom:{tag:"button",styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[ti(E.translate("Browse for an image")),B.asSpec()],action:T=>{B.get(T).element.dom.click()},buttonBehaviours:kl([uJ.config({}),ky(E.isDisabled),Sy()])})]}]})}});return uS(M,er,["tox-form__group--stretched"],[])})(T,E.shared.providers,D)),grid:G_((T,E)=>{var D;return D=E.shared,{dom:{tag:"div",classes:["tox-form__grid",`tox-form__grid--${T.columns}col`]},components:H(T.items,D.interpreter)}}),listbox:G_((T,E,D)=>((T,E,D)=>{let B=E.shared.providers,M=D.bind(E=>EO(T.items,E)).orThunk(()=>oe(T.items).filter(OO)),er=T.label.map(T=>pS(T,B)),ec=uj.parts.field({dom:{},factory:{sketch:D=>xO({uid:D.uid,text:M.map(T=>T.text),icon:A.none(),tooltip:T.label,role:A.none(),fetch:(D,B)=>{let M=TO(D,T.name,T.items,r5.getValue(D));B(CO(M,l2.CLOSE_ON_EXECUTE,E,{isHorizontalMenu:!1,search:A.none()}))},onSetup:x(b),getApi:x({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[uJ.config({}),RC(M.map(T=>T.value),T=>Ot(T.element,gW),(E,D)=>{EO(T.items,D).each(T=>{kt(E.element,gW,T.value),Ir(E,gz,{text:T.text})})})]},"tox-listbox",E.shared)}});return uj.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:q([er.toArray(),[{dom:{tag:"div",classes:["tox-listboxfield"]},components:[ec]}]]),fieldBehaviours:kl([a$.config({disabled:x(!T.enabled),onDisabled:T=>{uj.getField(T).each(a$.disable)},onEnabled:T=>{uj.getField(T).each(a$.enable)}})])})})(T,E,D)),selectbox:G_((T,E,D)=>((T,E,D)=>{let B=H(T.items,T=>({text:E.translate(T.text),value:T.value})),M=T.label.map(T=>pS(T,E)),er=uj.parts.field({dom:{},...D.map(T=>({data:T})).getOr({}),selectAttributes:{size:T.size},options:B,factory:gG,selectBehaviours:kl([a$.config({disabled:()=>!T.enabled||E.isDisabled()}),uJ.config({}),Jp("selectbox-change",[Ur(t2(),(E,D)=>{Ir(E,uX,{name:T.name})})])])}),ec=T.size>1?A.none():A.some(ef("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},E.icons)),eu={dom:{tag:"div",classes:["tox-selectfield"]},components:q([[er],ec.toArray()])};return uj.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:q([M.toArray(),[eu]]),fieldBehaviours:kl([a$.config({disabled:()=>!T.enabled||E.isDisabled(),onDisabled:T=>{uj.getField(T).each(a$.disable)},onEnabled:T=>{uj.getField(T).each(a$.enable)}}),Sy()])})})(T,E.shared.providers,D)),sizeinput:G_((T,E)=>((T,E)=>{let D=NO,B=la("ratio-event"),s=T=>ef(T,{tag:"span",classes:["tox-icon","tox-lock-icon__"+T]},E.icons),M=gX.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:E.translate(T.label.getOr("Constrain proportions"))}},components:[s("lock"),s("unlock")],buttonBehaviours:kl([a$.config({disabled:()=>!T.enabled||E.isDisabled()}),Sy(),uJ.config({})])}),a=T=>({dom:{tag:"div",classes:["tox-form__group"]},components:T}),i=D=>uj.parts.field({factory:cv,inputClasses:["tox-textfield"],inputBehaviours:kl([a$.config({disabled:()=>!T.enabled||E.isDisabled()}),Sy(),uJ.config({}),Jp("size-input-events",[Ur(tY(),(T,E)=>{Ir(T,B,{isField1:D})}),Ur(t2(),(E,D)=>{Ir(E,uX,{name:T.name})})])]),selectOnFocus:!1}),l=T=>({dom:{tag:"label",classes:["tox-label"]},components:[ti(E.translate(T))]}),er=gX.parts.field1(a([uj.parts.label(l("Width")),i(!0)])),ec=gX.parts.field2(a([uj.parts.label(l("Height")),i(!1)]));return gX.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[er,ec,a([l("\xa0"),M])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:(T,E,B)=>{IO(r5.getValue(T)).each(T=>{D(T).each(T=>{r5.setValue(E,(T=>{var E;let D={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},B=T.value.toFixed((E=T.unit)in D?D[E]:1);return -1!==B.indexOf(".")&&(B=B.replace(/\.?0*$/,"")),B+T.unit})(T))})})},coupledFieldBehaviours:kl([a$.config({disabled:()=>!T.enabled||E.isDisabled(),onDisabled:T=>{gX.getField1(T).bind(uj.getField).each(a$.disable),gX.getField2(T).bind(uj.getField).each(a$.disable),gX.getLock(T).each(a$.disable)},onEnabled:T=>{gX.getField1(T).bind(uj.getField).each(a$.enable),gX.getField2(T).bind(uj.getField).each(a$.enable),gX.getLock(T).each(a$.enable)}}),Sy(),Jp("size-input-events2",[Ur(B,(T,E)=>{let B=E.event.isField1,M=B?gX.getField1(T):gX.getField2(T),er=B?gX.getField2(T):gX.getField1(T),ec=M.map(r5.getValue).getOr(""),eu=er.map(r5.getValue).getOr("");D=((T,E)=>{let D=IO(T).toOptional(),B=IO(E).toOptional();return Se(D,B,(T,E)=>RO(T,E.unit).map(T=>E.value/T).map(T=>{var D;return D=E.unit,E=>RO(E,D).map(E=>({value:E*T,unit:D}))}).getOr(NO)).getOr(NO)})(ec,eu)})])])})})(T,E.shared.providers)),slider:G_((T,E,D)=>((T,E,D)=>{let B=m0.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[ti(E.translate(T.label))]}),M=m0.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),er=m0.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return m0.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:T.min,maxX:T.max,getInitialValue:x(D.getOrThunk(()=>(Math.abs(T.max)-Math.abs(T.min))/2))},components:[B,M,er],sliderBehaviours:kl([DC(),s1.config({})]),onChoose:(E,D,B)=>{Ir(E,uX,{name:T.name,value:B})}})})(T,E.shared.providers,D)),urlinput:G_((T,E,D)=>((T,E,D,B)=>{let M=E.shared.providers,r=E=>{let B=r5.getValue(E);D.addToHistory(B.value,T.filetype)},er={...B.map(T=>({initialData:T})).getOr({}),dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":pr,type:"url"},minChars:0,responseTime:0,fetch:B=>{let M=((T,E,D)=>{var B,M;let er=r5.getValue(E),ec=null!==(M=null===(B=null==er?void 0:er.meta)||void 0===B?void 0:B.text)&&void 0!==M?M:er.value;return D.getLinkInformation().fold(()=>[],E=>{let B=P_(ec,H(D.getHistory(T),T=>R_(T,T)));return"file"===T?j([B,P_(ec,V_(E)),P_(ec,q([H_(E),z_(E),L_(E)]))],(T,E)=>0===T.length||0===E.length?T.concat(E):T.concat(po,E),[]):B})})(T.filetype,B,D),er=CO(M,l2.BUBBLE_TO_SANDBOX,E,{isHorizontalMenu:!1,search:A.none()});return bw(er)},getHotspot:T=>ex.getOpt(T),onSetValue:(T,E)=>{T.hasConfigured(u6)&&u6.run(T).get(b)},typeaheadBehaviours:kl([...D.getValidationHandler().map(E=>u6.config({getRoot:T=>rt(T.element),invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:(T,E)=>{eg.getOpt(T).each(T=>{kt(T.element,"title",M.translate(E))})}},validator:{validate:D=>{let B=r5.getValue(D);return O_(D=>{E({type:T.filetype,url:B.value},T=>{if("invalid"===T.status){let E=tx.error(T.message);D(E)}else{let E=tx.value(T.message);D(E)}})})},validateOnLoad:!1}})).toArray(),a$.config({disabled:()=>!T.enabled||M.isDisabled()}),uJ.config({}),Jp("urlinput-events",[Ur(t1(),E=>{let D=$a(E.element),B=D.trim();B!==D&&qa(E.element,B),"file"===T.filetype&&Ir(E,uX,{name:T.name})}),Ur(t2(),E=>{Ir(E,uX,{name:T.name}),r(E)}),Ur(or(),E=>{Ir(E,uX,{name:T.name}),r(E)})])]),eventOrder:{[t1()]:["streaming","urlinput-events","invalidating"]},model:{getDisplayText:T=>T.value,selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:E.shared.getSink,parts:{menu:Bb(0,0,"normal")},onExecute:(T,E,D)=>{Ir(E,uZ,{})},onItemExecute:(E,D,B,M)=>{r(E),Ir(E,uX,{name:T.name})}},ec=uj.parts.field({...er,factory:pt}),eu=T.label.map(T=>pS(T,M)),eg=jh(((T,E,D=T,B=T)=>ef(D,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+T],attributes:{title:M.translate(B),"aria-live":"polite",...E.fold(()=>({}),T=>({id:T}))}},M.icons))("invalid",A.some(pr),"warning")),ep=jh({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[eg.asSpec()]}),eh=D.getUrlPicker(T.filetype),ey=la("browser.url.event"),ex=jh({dom:{tag:"div",classes:["tox-control-wrap"]},components:[ec,ep.asSpec()],behaviours:kl([a$.config({disabled:()=>!T.enabled||M.isDisabled()})])}),eO=jh(M_({name:T.name,icon:A.some("browse"),text:T.label.getOr(""),enabled:T.enabled,primary:!1,buttonType:A.none(),borderless:!0},T=>Fr(T,ey),M,[],["tox-browse-url"]));return uj.sketch({dom:gS([]),components:eu.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:q([[ex.asSpec()],eh.map(()=>eO.asSpec()).toArray()])}]),fieldBehaviours:kl([a$.config({disabled:()=>!T.enabled||M.isDisabled(),onDisabled:T=>{uj.getField(T).each(a$.disable),eO.getOpt(T).each(a$.disable)},onEnabled:T=>{uj.getField(T).each(a$.enable),eO.getOpt(T).each(a$.enable)}}),Sy(),Jp("url-input-events",[Ur(ey,E=>{aP.getCurrent(E).each(D=>{let B=r5.getValue(D),M={fieldname:T.name,...B};eh.each(B=>{B(M).get(B=>{r5.setValue(D,B),Ir(E,uX,{name:T.name})})})})})])])})})(T,E,E.urlinput,D)),customeditor:G_(T=>{let E=Ql(),D=jh({dom:{tag:T.tag}}),B=Ql();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:kl([Jp("custom-editor-events",[oX(M=>{D.getOpt(M).each(D=>{(ve(T,"init")?T.init(D.element.dom):gu.load(T.scriptId,T.scriptUrl).then(E=>E(D.element.dom,T.settings))).then(T=>{B.on(E=>{T.setValue(E)}),B.clear(),E.set(T)})})})]),RC(A.none(),()=>E.get().fold(()=>B.get().getOr(""),T=>T.getValue()),(T,D)=>{E.get().fold(()=>B.set(D),T=>T.setValue(D))}),DC()]),components:[D.asSpec()]}}),htmlpanel:G_(T=>"presentation"===T.presets?uL.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:T.html}}):uL.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:T.html,attributes:{role:"document"}},containerBehaviours:kl([uJ.config({}),s1.config({})])})),imagepreview:G_((T,E,D)=>((T,E)=>{let D=Es(E.getOr({url:""})),B=jh({dom:{tag:"img",classes:["tox-imagepreview__image"],attributes:E.map(T=>({src:T.url})).getOr({})}}),M=jh({dom:{tag:"div",classes:["tox-imagepreview__container"],attributes:{role:"presentation"}},components:[B.asSpec()]}),er={};T.height.each(T=>er.height=T);let eu=E.map(T=>({url:T.url,zoom:A.from(T.zoom),cachedWidth:A.from(T.cachedWidth),cachedHeight:A.from(T.cachedHeight)}));return{dom:{tag:"div",classes:["tox-imagepreview"],styles:er,attributes:{role:"presentation"}},components:[M.asSpec()],behaviours:kl([DC(),RC(eu,()=>D.get(),(T,E)=>{let er={url:E.url};E.zoom.each(T=>er.zoom=T),E.cachedWidth.each(T=>er.cachedWidth=T),E.cachedHeight.each(T=>er.cachedHeight=T),D.set(er);let a=()=>{let{cachedWidth:E,cachedHeight:D,zoom:B}=er;if(!ec(E)&&!ec(D)){if(ec(B)){let B=((T,E,D)=>{let B=Jt(T),M=Wt(T);return Math.min(B/E,M/D,1)})(T.element,E,D);er.zoom=B}let eu=((T,E,D,B,M)=>{let er=D*M,ec=B*M;return{left:Math.max(0,T/2-er/2).toString()+"px",top:Math.max(0,E/2-ec/2).toString()+"px",width:er.toString()+"px",height:ec.toString()+"px"}})(Jt(T.element),Wt(T.element),E,D,er.zoom);M.getOpt(T).each(T=>{Bt(T.element,eu)})}};B.getOpt(T).each(D=>{let B=D.element;E.url!==Ot(B,"src")&&(kt(B,"src",E.url),Pa(T.element,"tox-imagepreview__loaded")),a(),new Promise((T,E)=>{let o=()=>{r(),T(B)},D=[tc(B,"load",o),tc(B,"error",()=>{r(),E("Unable to load data from image: "+B.dom.src)})],r=()=>L(D,T=>T.unbind());B.dom.complete&&o()}).then(E=>{T.getSystem().isConnected()&&(La(T.element,"tox-imagepreview__loaded"),er.cachedWidth=E.dom.naturalWidth,er.cachedHeight=E.dom.naturalHeight,a())})})})])}})(T,D)),table:G_((T,E)=>((T,E)=>{let o=T=>({dom:{tag:"td",innerHtml:E.translate(T)}});return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:H(T.header,T=>({dom:{tag:"th",innerHtml:E.translate(T)}}))}]},{dom:{tag:"tbody"},components:H(T.cells,T=>({dom:{tag:"tr"},components:H(T,o)}))}],behaviours:kl([uJ.config({}),s1.config({})])}})(T,E.shared.providers)),tree:G_((T,E)=>((T,E)=>{let D=T.onLeafAction.getOr(b),B=T.onToggleExpand.getOr(b),M=T.defaultExpandedIds,er=Es(M),ec=Es(T.defaultSelectedId),eu=la("tree-id"),l=(B,M)=>T.items.map(T=>"leaf"===T.type?r_({leaf:T,selectedId:B,onLeafAction:D,visible:!0,treeId:eu,backstage:E}):d_({directory:T,selectedId:B,onLeafAction:D,expandedIds:M,labelTabstopping:!0,treeId:eu,backstage:E}));return{dom:{tag:"div",classes:["tox-tree"],attributes:{role:"tree"}},components:l(ec.get(),er.get()),behaviours:kl([sq.config({mode:"flow",selector:".tox-tree--leaf__label--visible, .tox-tree--directory__label--visible",cycles:!1}),Jp(g2,[Ur("expand-tree-node",(T,E)=>{let{expanded:D,node:M}=E.event;er.set(D?[...er.get(),M]:er.get().filter(T=>T!==M)),B(er.get(),{expanded:D,node:M})})]),nK.config({channels:{[`update-active-item-${eu}`]:{onReceive:(T,E)=>{ec.set(A.some(E.value)),sY.set(T,l(A.some(E.value),er.get()))}}}}),sY.config({})])}})(T,E)),panel:G_((T,E)=>({dom:{tag:"div",classes:T.classes},components:H(T.items,E.shared.interpreter)}))},pm={field:(T,E)=>E,record:x([])},X_=(T,E,D,B)=>{let M=tw(B,{shared:{interpreter:E=>Y_(T,E,D,M)}});return Y_(T,E,D,M)},Y_=(T,E,D,B)=>be(pu,E.type).fold(()=>(console.error(`Unknown factory type "${E.type}", defaulting to container: `,E),E),M=>M(T,E,D,B)),K_=(T,E,D)=>Y_(pm,T,E,D),pg="layout-inset",Z_=T=>T.x,Q_=(T,E)=>T.x+T.width/2-E.width/2,eT=(T,E)=>T.x+T.width-E.width,tT=T=>T.y,oT=(T,E)=>T.y+T.height-E.height,nT=(T,E)=>T.y+T.height/2-E.height/2,sT=(T,E,D)=>zi(eT(T,E),oT(T,E),D.insetSouthwest(),nU(),"southwest",Ki(T,{right:0,bottom:3}),pg),rT=(T,E,D)=>zi(Z_(T),oT(T,E),D.insetSoutheast(),nN(),"southeast",Ki(T,{left:1,bottom:3}),pg),aT=(T,E,D)=>zi(eT(T,E),tT(T),D.insetNorthwest(),nH(),"northwest",Ki(T,{right:0,top:2}),pg),iT=(T,E,D)=>zi(Z_(T),tT(T),D.insetNortheast(),nR(),"northeast",Ki(T,{left:1,top:2}),pg),lT=(T,E,D)=>zi(Q_(T,E),tT(T),D.insetNorth(),nL(),"north",Ki(T,{top:2}),pg),cT=(T,E,D)=>zi(Q_(T,E),oT(T,E),D.insetSouth(),nz(),"south",Ki(T,{bottom:3}),pg),dT=(T,E,D)=>zi(eT(T,E),nT(T,E),D.insetEast(),nj(),"east",Ki(T,{right:0}),pg),uT=(T,E,D)=>zi(Z_(T),nT(T,E),D.insetWest(),nP(),"west",Ki(T,{left:1}),pg),mT=T=>{switch(T){case"north":return lT;case"northeast":return iT;case"northwest":return aT;case"south":return cT;case"southeast":return rT;case"southwest":return sT;case"east":return dT;case"west":return uT}},gT=(T,E,D,B,M)=>Xl(B).map(mT).getOr(lT)(T,E,D,B,M),pT=T=>{switch(T){case"north":return cT;case"northeast":return rT;case"northwest":return sT;case"south":return lT;case"southeast":return iT;case"southwest":return aT;case"east":return uT;case"west":return dT}},hT=(T,E,D,B,M)=>Xl(B).map(pT).getOr(lT)(T,E,D,B,M),ph={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},bT=(T,E,D)=>{let B={maxHeightFunction:n4()};return()=>D()?{type:"node",root:ft(eJ(T())),node:A.from(T()),bubble:gc(12,12,ph),layouts:{onRtl:()=>[iT],onLtr:()=>[aT]},overrides:B}:{type:"hotspot",hotspot:E(),bubble:gc(-12,12,ph),layouts:{onRtl:()=>[sl,rl,cl],onLtr:()=>[rl,sl,cl]},overrides:B}},vT=(T,E,D,B)=>{let M={maxHeightFunction:n4()};return()=>B()?{type:"node",root:ft(eJ(E())),node:A.from(E()),bubble:gc(12,12,ph),layouts:{onRtl:()=>[lT],onLtr:()=>[lT]},overrides:M}:T?{type:"node",root:ft(eJ(E())),node:A.from(E()),bubble:gc(0,-jt(E()),ph),layouts:{onRtl:()=>[ll],onLtr:()=>[ll]},overrides:M}:{type:"hotspot",hotspot:D(),bubble:gc(0,0,ph),layouts:{onRtl:()=>[ll],onLtr:()=>[ll]},overrides:M}},yT=(T,E,D)=>()=>D()?{type:"node",root:ft(eJ(T())),node:A.from(T()),layouts:{onRtl:()=>[lT],onLtr:()=>[lT]}}:{type:"hotspot",hotspot:E(),layouts:{onRtl:()=>[cl],onLtr:()=>[cl]}},xT=(T,E)=>()=>({type:"selection",root:E(),getSelection:()=>{let E=T.selection.getRng(),D=T.model.table.getSelectedCells();if(D.length>1){let T=D[0],E=D[D.length-1],B={firstCell:Fe(T),lastCell:Fe(E)};return A.some(B)}return A.some(rS.range(Fe(E.startContainer),E.startOffset,Fe(E.endContainer),E.endOffset))}}),wT=T=>E=>({type:"node",root:T(),node:E}),ST=(T,E,D,B)=>{let M=sb(T),r=()=>Fe(T.getBody()),a=()=>Fe(T.getContentAreaContainer()),i=()=>M||!B();return{inlineDialog:bT(a,E,i),inlineBottomDialog:vT(T.inline,a,D,i),banner:yT(a,E,i),cursor:xT(T,r),node:wT(r)}},kT=T=>(E,D)=>{Jx(T)(E,D)},CT=T=>()=>un(T),OT=T=>E=>Rx(T,E),_T=T=>E=>zx(T,E),TT=T=>()=>lG(T),ET=T=>ye(T,"items"),AT=T=>ye(T,"format"),pf=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],DT=T=>j(T,(T,D)=>{if(ve(D,"items")){let E=DT(D.items);return{customFormats:T.customFormats.concat(E.customFormats),formats:T.formats.concat([{title:D.title,items:E.formats}])}}if(ve(D,"inline")||ve(D,"block")||ve(D,"selector")){let B=`custom-${E(D.name)?D.name:D.title.toLowerCase()}`;return{customFormats:T.customFormats.concat([{name:B,format:D}]),formats:T.formats.concat([{title:D.title,format:B,icon:D.icon}])}}return{...T,formats:T.formats.concat(D)}},{customFormats:[],formats:[]}),BT=T=>lc(T).map(E=>{let D=((T,E)=>{let D=DT(E),n=E=>{L(E,E=>{T.formatter.has(E.name)||T.formatter.register(E.name,E.format)})};return T.formatter?n(D.customFormats):T.on("init",()=>{n(D.customFormats)}),D.formats})(T,E);return lu(T)?pf.concat(D):D}).getOr(pf),FT=(T,E,D)=>({...T,type:"formatter",isSelected:E(T.format),getStylePreview:D(T.format)}),IT=(T,D,B,M)=>{let s=D=>H(D,D=>ET(D)?(T=>{let E=s(T.items);return{...T,type:"submenu",getStyleItems:x(E)}})(D):AT(D)?FT(D,B,M):(T=>{let E=eI(T);return 1===E.length&&R(E,"title")})(D)?{...D,type:"separator"}:(D=>{let er=E(D.name)?D.name:la(D.title),ec=`custom-${er}`,eu={...D,type:"formatter",format:ec,isSelected:B(ec),getStylePreview:M(ec)};return T.formatter.register(er,eu),eu})(D));return s(D)},pb=gp.trim,NT=T=>E=>!!g(E)&&1===E.nodeType&&(E.contentEditable===T||E.getAttribute("data-mce-contenteditable")===T),pv=NT("true"),py=NT("false"),HT=(T,E,D,B,M)=>({type:T,title:E,url:D,level:B,attach:M}),LT=T=>T.innerText||T.textContent,PT=T=>T&&"A"===T.nodeName&&void 0!==(T.id||T.name)&&WT(T),UT=T=>T&&/^(H[1-6])$/.test(T.nodeName),WT=T=>(T=>{let E=T;for(;E=E.parentNode;){let T=E.contentEditable;if(T&&"inherit"!==T)return pv(E)}return!1})(T)&&!py(T),jT=T=>UT(T)&&WT(T),GT=T=>{var E;let D=T.id?T.id:la("h");return HT("header",null!==(E=LT(T))&&void 0!==E?E:"","#"+D,UT(T)?parseInt(T.nodeName.substr(1),10):0,()=>{T.id=D})},$T=T=>{let E=T.id||T.name,D=LT(T);return HT("anchor",D||"#"+E,"#"+E,0,b)},qT=T=>pb(T.title).length>0,XT=T=>{let E=(T=>{let E=H(Xc(Fe(T),"h1,h2,h3,h4,h5,h6,a:not([href])"),T=>T.dom);return E})(T);return U(H(U(E,jT),GT).concat(H(U(E,PT),$T)),qT)},pA="tinymce-url-history",KT=T=>E(T)&&/^https?/.test(T),JT=T=>D(T)&&he(T,T=>!(B(T)&&T.length<=5&&Y(T,KT))).isNone(),ZT=()=>{let T;let E=d4.getItem(pA);if(null===E)return{};try{T=JSON.parse(E)}catch(T){if(T instanceof SyntaxError)return console.log("Local storage "+pA+" was not valid JSON",T),{};throw T}return JT(T)?T:(console.log("Local storage "+pA+" was not valid format",T),{})},QT=T=>{let E=ZT();return be(E,T).getOr([])},eE=(T,E)=>{if(!KT(T))return;let D=ZT(),B=be(D,E).getOr([]),M=U(B,E=>E!==T);D[E]=[T].concat(M).slice(0,5),(T=>{if(!JT(T))throw Error("Bad format for history:\n"+JSON.stringify(T));d4.setItem(pA,JSON.stringify(T))})(D)},tE=T=>!!T,oE=T=>ce(gp.makeMap(T,/[, ]/),tE),nE=T=>A.from(lN(T)),sE=T=>A.from(T).filter(E).getOrUndefined(),rE=T=>({getHistory:QT,addToHistory:eE,getLinkInformation:()=>lP(T)?A.some({targets:XT(T.getBody()),anchorTop:sE(lj(T)),anchorBottom:sE(lW(T))}):A.none(),getValidationHandler:()=>A.from(lU(T)),getUrlPicker:B=>((T,E)=>{let D=(T=>{let E=A.from(lz(T)).filter(tE).map(oE);return nE(T).fold(ep,T=>E.fold(eh,T=>eI(T).length>0&&T))})(T);return er(D)?D?nE(T):A.none():D[E]?nE(T):A.none()})(T,B).map(M=>er=>fw(ec=>{let eu={filetype:B,fieldname:er.fieldname,...A.from(er.meta).getOr({})};M.call(T,(T,B)=>{if(!E(T))throw Error("Expected value to be string");if(void 0!==B&&!D(B))throw Error("Expected meta to be a object");ec({value:T,meta:B})},er.value,eu)}))}),pC=x([ys("shell",!1),os("makeItem"),ys("setupItem",b),hu("listBehaviours",[sY])]),p_=aE({name:"items",overrides:()=>({behaviours:kl([sY.config({})])})}),pE=x([p_]),pD=bm({name:x("CustomList")(),configFields:pC(),partFields:pE(),factory:(T,E,D,B)=>{let M=T.shell?{behaviours:[sY.config({})],components:[]}:{behaviours:[],components:E};return{uid:T.uid,dom:T.dom,components:M.components,behaviours:bu(T.listBehaviours,M.behaviours),apis:{setItems:(E,D)=>{(T.shell?A.some(E):om(E,T,"items")).fold(()=>{throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),Error("Custom List was defined to not be a shell, but no item container was specified in components")},B=>{let M=sY.contents(B),er=D.length,ec=er-M.length,eu=ec>0?V(ec,()=>T.makeItem()):[],eg=M.slice(er);L(eg,T=>sY.remove(B,T)),L(eu,T=>sY.append(B,T));let ep=sY.contents(B);L(ep,(B,M)=>{T.setupItem(E,B,D[M],M)})})}}}},apis:{setItems:(T,E,D)=>{T.setItems(E,D)}}}),pI=x([os("dom"),ys("shell",!0),hu("toolbarBehaviours",[sY])]),pR=x([aE({name:"groups",overrides:()=>({behaviours:kl([sY.config({})])})})]),pH=bm({name:"Toolbar",configFields:pI(),partFields:pR(),factory:(T,E,D,B)=>{let M=T.shell?{behaviours:[sY.config({})],components:[]}:{behaviours:[],components:E};return{uid:T.uid,dom:T.dom,components:M.components,behaviours:bu(T.toolbarBehaviours,M.behaviours),apis:{setGroups:(E,D)=>{(T.shell?A.some(E):om(E,T,"groups")).fold(()=>{throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},T=>{sY.set(T,D)})},refresh:b},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(T,E,D)=>{T.setGroups(E,D)}}}),pN=x([]);var pU,pL,pz,pP,pj,pW,pG,pJ=Object.freeze({__proto__:null,setup:b,isDocked:ep,getBehaviours:pN});let xE=T=>(xe(Nt(T,"position"),"fixed")?A.none():at(T)).orThunk(()=>{let E=Re("span");return st(T).bind(T=>{zo(T,E);let D=at(E);return Po(E),D})}),wE=T=>xE(T).map(Xt).getOrThunk(()=>Gt(0,0)),SE=(T,E)=>{let D=T.element;La(D,E.transitionClass),Pa(D,E.fadeOutClass),La(D,E.fadeInClass),E.onShow(T)},kE=(T,E)=>{let D=T.element;La(D,E.transitionClass),Pa(D,E.fadeInClass),La(D,E.fadeOutClass),E.onHide(T)},CE=(T,E)=>T.y>=E.y,OE=(T,E)=>T.bottom<=E.bottom,_E=(T,E,D)=>({location:"top",leftX:E,topY:D.bounds.y-T.y}),TE=(T,E,D)=>({location:"bottom",leftX:E,bottomY:T.bottom-D.bounds.bottom}),EE=T=>T.box.x-T.win.x,AE=(T,E,D)=>D.getInitialPos().map(D=>{let B=((T,E)=>{let D=E.optScrollEnv.fold(x(T.bounds.y),E=>E.scrollElmTop+(T.bounds.y-E.currentScrollTop));return Gt(T.bounds.x,D)})(D,E);return{box:Ko(B.left,B.top,Jt(T),Wt(T)),location:D.location}}),ME=(T,E,D,B,M)=>{let er=((T,E)=>{let D=E.optScrollEnv.fold(x(T.y),E=>T.y+E.currentScrollTop-E.scrollElmTop);return Gt(T.x,D)})(E,D),ec=Ko(er.left,er.top,E.width,E.height);B.setInitialPos({style:Vt(T),position:It(T,"position")||"static",bounds:ec,location:M.location})},DE=(T,E,D)=>D.getInitialPos().bind(B=>{var M;switch(D.clearInitialPos(),B.position){case"static":return A.some({morph:"static"});case"absolute":let er=xE(T).getOr(xt()),ec=Jo(er),eu=null!==(M=er.dom.scrollTop)&&void 0!==M?M:0;return A.some({morph:"absolute",positionCss:Vl("absolute",be(B.style,"left").map(T=>E.x-ec.x),be(B.style,"top").map(T=>E.y-ec.y+eu),be(B.style,"right").map(T=>ec.right-E.right),be(B.style,"bottom").map(T=>ec.bottom-E.bottom))});default:return A.none()}}),BE=T=>{switch(T.location){case"top":return A.some({morph:"fixed",positionCss:Vl("fixed",A.some(T.leftX),A.some(T.topY),A.none(),A.none())});case"bottom":return A.some({morph:"fixed",positionCss:Vl("fixed",A.some(T.leftX),A.none(),A.none(),A.some(T.bottomY))});default:return A.none()}},FE=(T,E,D)=>{let B=T.element;return xe(Nt(B,"position"),"fixed")?AE(B,E,D).filter(({box:T})=>Y(D.getModes(),D=>{switch(D){case"bottom":return OE(T,E.bounds);case"top":return CE(T,E.bounds)}})).bind(({box:T})=>DE(B,T,D)).orThunk(()=>E.optScrollEnv.bind(T=>AE(B,E,D)).bind(({box:T,location:D})=>{let B=en(),M=EE({win:B,box:T}),er="top"===D?_E(B,M,E):TE(B,M,E);return BE(er)})):((T,E,D)=>{let B=Jo(T),M=en(),er=((T,E,D)=>{let B=E.win,M=E.box,er=EE(E);return re(T,T=>{switch(T){case"bottom":return OE(M,D.bounds)?A.none():A.some(TE(B,er,D));case"top":return CE(M,D.bounds)?A.none():A.some(_E(B,er,D));default:return A.none()}}).getOr({location:"no-dock"})})(D.getModes(),{win:M,box:B},E);return"top"===er.location||"bottom"===er.location?(ME(T,B,E,D,er),BE(er)):A.none()})(B,E,D)},IE=(T,E,D)=>{D.setDocked(!1),L(["left","right","top","bottom","position"],E=>Ht(T.element,E)),E.onUndocked(T)},RE=(T,E,D,B)=>{let M="fixed"===B.position;D.setDocked(M),zl(T.element,B),(M?E.onDocked:E.onUndocked)(T)},NE=(T,E,D,B,M=!1)=>{E.contextual.each(E=>{E.lazyContext(T).each(er=>{var ec;let eu=(ec=B.bounds,er.y<ec.bottom&&er.bottom>ec.y);eu!==D.isVisible()&&(D.setVisible(eu),M&&!eu?(Wa(T.element,[E.fadeOutClass]),E.onHide(T)):(eu?SE:kE)(T,E))})})},VE=(T,E,D,B,M)=>{NE(T,E,D,B,!0),RE(T,E,D,M.positionCss)},zE=(T,E,D)=>{T.getSystem().isConnected()&&((T,E,D)=>{let B=E.lazyViewport(T);NE(T,E,D,B),FE(T,B,D).each(M=>{((T,E,D,B,M)=>{switch(M.morph){case"static":return IE(T,E,D);case"absolute":return RE(T,E,D,M.positionCss);case"fixed":VE(T,E,D,B,M)}})(T,E,D,B,M)})})(T,E,D)},HE=(T,E,D)=>{D.isDocked()&&((T,E,D)=>{let B=T.element;D.setDocked(!1);let M=E.lazyViewport(T);((T,E,D)=>{let B=T.element;return AE(B,E,D).bind(({box:T})=>DE(B,T,D))})(T,M,D).each(B=>{switch(B.morph){case"static":IE(T,E,D);break;case"absolute":RE(T,E,D,B.positionCss)}}),D.setVisible(!0),E.contextual.each(E=>{ja(B,[E.fadeInClass,E.fadeOutClass,E.transitionClass]),E.onShow(T)}),zE(T,E,D)})(T,E,D)},LE=T=>(E,D,B)=>{let M=D.lazyViewport(E);((T,E,D,B)=>{let M=Jo(T),er=en(),ec=B(er,EE({win:er,box:M}),E);return"bottom"===ec.location||"top"===ec.location?(((T,E,D,B,M)=>{B.getInitialPos().fold(()=>ME(T,E,D,B,M),()=>b)})(T,M,E,D,ec),BE(ec)):A.none()})(E.element,M,B,T).each(T=>{VE(E,D,B,M,T)})},p$=LE(_E),pX=LE(TE);var pq=Object.freeze({__proto__:null,refresh:zE,reset:HE,isDocked:(T,E,D)=>D.isDocked(),getModes:(T,E,D)=>D.getModes(),setModes:(T,E,D,B)=>D.setModes(B),forceDockToTop:p$,forceDockToBottom:pX}),pK=Object.freeze({__proto__:null,events:(T,E)=>Hr([Yr(t9(),(D,B)=>{T.contextual.each(T=>{Ua(D.element,T.transitionClass)&&(ja(D.element,[T.transitionClass,T.fadeInClass]),(E.isVisible()?T.onShown:T.onHidden)(D)),B.stop()})}),Ur(oI(),(D,B)=>{zE(D,T,E)}),Ur(oj(),(D,B)=>{zE(D,T,E)}),Ur(oR(),(D,B)=>{HE(D,T,E)})])}),pY=[vs("contextual",[rs("fadeInClass"),rs("fadeOutClass"),rs("transitionClass"),is("lazyContext"),Di("onShow"),Di("onShown"),Di("onHide"),Di("onHidden")]),Os("lazyViewport",()=>({bounds:en(),optScrollEnv:A.none()})),_s("modes",["top","bottom"],tH),Di("onDocked"),Di("onUndocked")];let pZ=Ol({fields:pY,name:"docking",active:pK,apis:pq,state:Object.freeze({__proto__:null,init:T=>{let E=Es(!1),D=Es(!0),B=Ql(),M=Es(T.modes);return _a({isDocked:E.get,setDocked:E.set,getInitialPos:B.get,setInitialPos:B.set,clearInitialPos:B.clear,isVisible:D.get,setVisible:D.set,getModes:M.get,setModes:M.set,readState:()=>`docked:  ${E.get()}, visible: ${D.get()}, modes: ${M.get().join(",")}`})}})}),pQ=x(la("toolbar-height-change")),p0={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},p1="tox-tinymce--toolbar-sticky-on",p2="tox-tinymce--toolbar-sticky-off",JE=(T,E)=>R(pZ.getModes(T),E),ZE=T=>{let E=T.element;rt(E).each(D=>{let B="padding-"+pZ.getModes(T)[0];if(pZ.isDocked(T)){let T=Jt(D);Dt(E,"width",T+"px"),Dt(D,B,jt(E)+(parseInt(It(E,"margin-top"),10)||0)+(parseInt(It(E,"margin-bottom"),10)||0)+"px")}else Ht(E,"width"),Ht(D,B)})},QE=(T,E)=>{E?(Pa(T,p0.fadeOutClass),Wa(T,[p0.transitionClass,p0.fadeInClass])):(Pa(T,p0.fadeInClass),Wa(T,[p0.fadeOutClass,p0.transitionClass]))},eA=(T,E)=>{let D=Fe(T.getContainer());E?(La(D,p1),Pa(D,p2)):(La(D,p2),Pa(D,p1))},tA=(T,E)=>{let D=Ql(),B=E.getSink,s=T=>{B().each(E=>T(E.element))},r=E=>{T.inline||ZE(E),eA(T,pZ.isDocked(E)),E.getSystem().broadcastOn([rX()],{}),B().each(T=>T.getSystem().broadcastOn([rX()],{}))},M=T.inline?[]:[nK.config({channels:{[pQ()]:{onReceive:ZE}}})];return[s1.config({}),pZ.config({contextual:{lazyContext:E=>{let D=jt(E.element),B=T.inline?T.getContentAreaContainer():T.getContainer();return A.from(B).map(B=>{let M=Jo(Fe(B));return jw(T,E.element).fold(()=>{let T=M.height-D,B=M.y+(JE(E,"top")?0:D);return Ko(M.x,B,M.width,T)},T=>{let B=Qo(M,Gw(T)),er=JE(E,"top")?B.y:B.y+D;return Ko(B.x,er,B.width,B.height-D)})})},onShow:()=>{s(T=>QE(T,!0))},onShown:T=>{s(T=>ja(T,[p0.transitionClass,p0.fadeInClass])),D.get().each(E=>{((T,E)=>{let D=et(E);Il(D).filter(T=>!Ze(E,T)).filter(E=>Ze(E,Fe(D.dom.body))||Qe(T,E)).each(()=>Dl(E))})(T.element,E),D.clear()})},onHide:T=>{Rl(T.element).orThunk(()=>B().toOptional().bind(T=>Rl(T.element))).fold(D.clear,D.set),s(T=>QE(T,!1))},onHidden:()=>{s(T=>ja(T,[p0.transitionClass]))},...p0},lazyViewport:E=>jw(T,E.element).fold(()=>{let D=en(),B=lI(T),M=D.y+(JE(E,"top")?B:0),er=D.height-(JE(E,"bottom")?B:0);return{bounds:Ko(D.x,M,D.width,er),optScrollEnv:A.none()}},T=>({bounds:Gw(T),optScrollEnv:A.some({currentScrollTop:T.element.dom.scrollTop,scrollElmTop:Xt(T.element).top})})),modes:[E.header.getDockingMode()],onDocked:r,onUndocked:r}),...M]};var p3=Object.freeze({__proto__:null,setup:(T,E,D)=>{T.inline||(E.header.isPositionedAtTop()||T.on("ResizeEditor",()=>{D().each(pZ.reset)}),T.on("ResizeWindow ResizeEditor",()=>{D().each(ZE)}),T.on("SkinLoaded",()=>{D().each(T=>{pZ.isDocked(T)?pZ.reset(T):pZ.refresh(T)})}),T.on("FullscreenStateChanged",()=>{D().each(pZ.reset)})),T.on("AfterScrollIntoView",T=>{D().each(E=>{pZ.refresh(E);let D=E.element;Ig(D)&&((T,E)=>{let D=et(E),B=nt(E).dom.innerHeight,M=Uo(D),er=Fe(T.elm),ec=Zo(er),eu=Wt(er),eg=ec.y,ep=eg+eu,eh=Xt(E),ey=Wt(E),ex=eh.top,eO=ex+ey,eD=2>Math.abs(ex-M.top),eI=2>Math.abs(eO-(M.top+B));if(eD&&eg<eO)Wo(M.left,eg-ey,D);else if(eI&&ep>ex){let T=eg-B+eu+ey;Wo(M.left,T,D)}})(T,D)})}),T.on("PostRender",()=>{eA(T,!1)})},isDocked:T=>T().map(pZ.isDocked).getOr(!1),getBehaviours:tA});let p5=Dn([cO,ns("items",Fn([tM([c_,ds("items",tH)]),tH]))].concat(c3)),p9=[ps("text"),ps("tooltip"),ps("icon"),xs("search",!1,Fn([tN,Dn([ps("placeholder")])],T=>er(T)?T?A.some({placeholder:A.none()}):A.none():A.some(T))),is("fetch"),Os("onSetup",()=>b)],p4=Dn([cO,...p9]),aA=T=>qn("menubutton",p4,T),p6=Dn([cO,cG,cW,cj,cX,cH,cz,ks("presets","normal",["normal","color","listpreview"]),Cv(1),cU,cL]);var p8=fm({factory:(T,E)=>{let D={focus:sq.focusIn,setMenus:(T,D)=>{let B=H(D,T=>{let D={type:"menubutton",text:T.text,fetch:E=>{E(T.getItems())}},B=aA(D).mapError(T=>Kn(T)).getOrDie();return t_(B,"tox-mbtn",E.backstage,A.some("menuitem"))});sY.set(T,B)}};return{uid:T.uid,dom:T.dom,components:[],behaviours:kl([sY.config({}),Jp("menubar-events",[oX(E=>{T.onSetup(E)}),Ur(tK(),(T,E)=>{pi(T.element,".tox-mbtn--active").each(D=>{hi(E.event.target,".tox-mbtn").each(E=>{Ze(D,E)||T.getSystem().getByDom(D).each(D=>{T.getSystem().getByDom(E).each(T=>{uH.expand(T),uH.close(D),s1.focus(T)})})})})}),Ur(oz(),(T,E)=>{E.event.prevFocus.bind(E=>T.getSystem().getByDom(E).toOptional()).each(D=>{E.event.newFocus.bind(E=>T.getSystem().getByDom(E).toOptional()).each(T=>{uH.isOpen(D)&&(uH.expand(T),uH.close(D))})})})]),sq.config({mode:"flow",selector:".tox-mbtn",onEscape:E=>(T.onEscape(E),A.some(!0))}),uJ.config({})]),apis:D,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[os("dom"),os("uid"),os("onEscape"),os("backstage"),ys("onSetup",b)],apis:{focus:(T,E)=>{T.focus(E)},setMenus:(T,E,D)=>{T.setMenus(E,D)}}});let p7="container",ht=[hu("slotBehaviours",[])],uA=T=>"<alloy.field."+T+">",mA=(T,E)=>{let o=E=>am(T),n=(E,D)=>(B,M)=>om(B,T,M).map(T=>E(T,M)).getOr(D),s=(T,E)=>"true"!==Ot(T.element,"aria-hidden"),D=n(s,!1),B=n((T,E)=>{if(s(T)){let D=T.element;Dt(D,"display","none"),kt(D,"aria-hidden","true"),Ir(T,oP(),{name:E,visible:!1})}}),i=(T,E)=>{L(E,E=>B(T,E))},M=n((T,E)=>{if(!s(T)){let D=T.element;Ht(D,"display"),Et(D,"aria-hidden"),Ir(T,oP(),{name:E,visible:!0})}});return{uid:T.uid,dom:T.dom,components:E,behaviours:fu(T.slotBehaviours),apis:{getSlotNames:o,getSlot:(E,D)=>om(E,T,D),isShowing:D,hideSlot:B,hideAllSlots:T=>i(T,o()),showSlot:M}}},hr=ce({getSlotNames:(T,E)=>T.getSlotNames(E),getSlot:(T,E,D)=>T.getSlot(E,D),isShowing:(T,E,D)=>T.isShowing(E,D),hideSlot:(T,E,D)=>T.hideSlot(E,D),hideAllSlots:(T,E)=>T.hideAllSlots(E),showSlot:(T,E,D)=>T.showSlot(E,D)},T=>Ca(T)),hc={...hr,sketch:T=>{let E=(()=>{let T=[];return{slot:(E,D)=>(T.push(E),Ju(p7,uA(E),D)),record:x(T)}})(),D=T(E),B=E.record(),M=H(B,T=>aC({name:T,pname:uA(T)}));return mm(p7,ht,M,mA,D)}},hd=Dn([cW,cG,Os("onShow",b),Os("onHide",b),cz]),fA=T=>({element:()=>T.element.dom}),bA=(T,E)=>{let D=H(eI(E),T=>{let D=E[T],B=Xn(qn("sidebar",hd,D));return{name:T,getApi:fA,onSetup:B.onSetup,onShow:B.onShow,onHide:B.onHide}});return H(D,E=>{let B=Es(b);return T.slot(E.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:ly([Ty(E,B),Ey(E,B),Ur(oP(),(T,E)=>{let B=E.event,M=G(D,T=>T.name===B.name);M.each(E=>{(B.visible?E.onShow:E.onHide)(E.getApi(T))})})])})})},vA=T=>hc.sketch(E=>({dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:bA(E,T),slotBehaviours:ly([oX(T=>hc.hideAllSlots(T))])})),yA=(T,E)=>{kt(T,"role",E)},xA=T=>aP.getCurrent(T).bind(T=>gZ.isGrowing(T)||gZ.hasGrown(T)?aP.getCurrent(T).bind(T=>G(hc.getSlotNames(T),E=>hc.isShowing(T,E))):A.none()),hm=la("FixSizeEvent"),hh=la("AutoSizeEvent");var hf=Object.freeze({__proto__:null,block:(T,E,D,B)=>{kt(T.element,"aria-busy",!0);let M=E.getRoot(T).getOr(T),er=kl([sq.config({mode:"special",onTab:()=>A.some(!0),onShiftTab:()=>A.some(!0)}),s1.config({})]),ec=B(M,er),eu=M.getSystem().build(ec);sY.append(M,Sa(eu)),eu.hasConfigured(sq)&&E.focus&&sq.focusIn(eu),D.isBlocked()||E.onBlock(T),D.blockWith(()=>sY.remove(M,eu))},unblock:(T,E,D)=>{Et(T.element,"aria-busy"),D.isBlocked()&&E.onUnblock(T),D.clear()},isBlocked:(T,E,D)=>D.isBlocked()}),hb=[Os("getRoot",A.none),Cs("focus",!0),Di("onBlock"),Di("onUnblock")];let hv=Ol({fields:hb,name:"blocking",apis:hf,state:Object.freeze({__proto__:null,init:()=>{let T=Jl(T=>T.destroy());return _a({readState:T.isSet,blockWith:E=>{T.set({destroy:E})},clear:T.clear,isBlocked:T.isSet})}})}),_A=T=>{let E=Ie(T),D=it(E),B=(T=>{let E=void 0!==T.dom.attributes?T.dom.attributes:[];return j(E,(T,E)=>"class"===E.name?T:{...T,[E.name]:E.value},{})})(E),M=Array.prototype.slice.call(E.dom.classList,0),er=0===D.length?{}:{innerHtml:ea(E)};return{tag:Ue(E),classes:M,attributes:B,...er}},TA=T=>aP.getCurrent(T).each(T=>Dl(T.element)),EA=(T,E,D)=>{let B=Es(!1),M=Ql(),r=D=>{!B.get()||"focusin"===D.type&&(D.composed?oe(D.composedPath()):A.from(D.target)).map(Fe).filter(eL).exists(T=>Ua(T,"mce-pastebin"))||(D.preventDefault(),TA(E()),T.editorManager.setActive(T))};T.inline||T.on("PreInit",()=>{T.dom.bind(T.getWin(),"focusin",r),T.on("BeforeExecCommand",T=>{"mcefocus"===T.command.toLowerCase()&&!0!==T.value&&r(T)})});let a=M=>{M!==B.get()&&(B.set(M),((T,E,D,B)=>{let M=E.element;if(((T,E)=>{let D="tabindex",B=`data-mce-${D}`;A.from(T.iframeElement).map(Fe).each(T=>{E?(_t(T,D).each(E=>kt(T,B,E)),kt(T,D,-1)):(Et(T,D),_t(T,B).each(E=>{kt(T,D,E),Et(T,B)}))})})(T,D),D)hv.block(E,(T,E)=>({dom:{tag:"div",attributes:{"aria-label":B.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:_A('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]})),Ht(M,"display"),Et(M,"aria-hidden"),T.hasFocus()&&TA(E);else{let D=aP.getCurrent(E).exists(T=>Fl(T.element));hv.unblock(E),Dt(M,"display","none"),kt(M,"aria-hidden","true"),D&&T.focus()}})(T,E(),M,D.providers),((T,E)=>{T.dispatch("AfterProgressState",{state:E})})(T,M))};T.on("ProgressState",E=>{if(M.on(clearTimeout),eg(E.time)){let D=iU.setEditorTimeout(T,()=>a(E.state),E.time);M.set(D)}else a(E.state),M.clear()})},AA=(T,E,D)=>({within:T,extra:E,withinWidth:D}),MA=(T,E,D)=>{let B=j(T,(T,E)=>((T,E)=>{let B=D(T);return A.some({element:T,start:E,finish:E+B,width:B})})(E,T.len).fold(x(T),E=>({len:E.finish,list:T.list.concat([E])})),{len:0,list:[]}).list,M=U(B,T=>T.finish<=E),er=W(M,(T,E)=>T+E.width,0);return{within:M,extra:B.slice(M.length),withinWidth:er}},DA=T=>H(T,T=>T.element),BA=(T,E)=>{let D=H(E,T=>Sa(T));pH.setGroups(T,D)},FA=(T,E,D)=>{let B=E.builtGroups.get();if(0===B.length)return;let M=nm(T,E,"primary"),er=uC.getCoupled(T,"overflowGroup");Dt(M.element,"visibility","hidden");let ec=B.concat([er]),eu=re(ec,T=>Rl(T.element).bind(E=>T.getSystem().getByDom(E).toOptional()));D([]),BA(M,ec);let eg=((T,E,D,B)=>{let M=((T,E,D)=>{let B=MA(E,T,D);return 0===B.extra.length?A.some(B):A.none()})(T,E,D).getOrThunk(()=>MA(E,T-D(B),D)),er=M.within,ec=M.extra,eu=M.withinWidth;return 1===ec.length&&ec[0].width<=D(B)?((T,E,D)=>{let B=DA(T.concat(E));return AA(B,[],D)})(er,ec,eu):ec.length>=1?((T,E,D,B)=>{let M=DA(T).concat([D]);return AA(M,DA(E),B)})(er,ec,B,eu):AA(DA(er),[],eu)})(Jt(M.element),E.builtGroups.get(),T=>Jt(T.element),er);0===eg.extra.length?(sY.remove(M,er),D([])):(BA(M,eg.within),D(eg.extra)),Ht(M.element,"visibility"),Lt(M.element),eu.each(s1.focus)},hy=x([hu("splitToolbarBehaviours",[uC]),es("builtGroups",()=>Es([]))]),hA=x([Ai(["overflowToggledClass"]),fs("getOverflowBounds"),os("lazySink"),es("overflowGroups",()=>Es([])),Di("onOpened"),Di("onClosed")].concat(hy())),hS=x([aC({factory:pH,schema:pI(),name:"primary"}),a_({schema:pI(),name:"overflow"}),a_({name:"overflow-button"}),a_({name:"overflow-group"})]),hC=x((T,E)=>{((T,E)=>{let D=eX.max(T,E,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);Dt(T,"max-width",D+"px")})(T,Math.floor(E))}),h_=x([Ai(["toggledClass"]),os("lazySink"),is("fetch"),fs("getBounds"),vs("fireDismissalEventInstead",[ys("event",oU())]),wc(),Di("onToggled")]),hE=x([a_({name:"button",overrides:T=>({dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:kl([s9.config({toggleClass:T.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1,onToggled:T.onToggled})])})}),a_({factory:pH,schema:pI(),name:"toolbar",overrides:T=>({toolbarBehaviours:kl([sq.config({mode:"cyclic",onEscape:E=>(om(E,T,"button").each(s1.focus),A.none())})])})})]),hD=Ql(),PA=(T,E)=>{let D=uC.getCoupled(T,"toolbarSandbox");rJ.isOpen(D)?rJ.close(D):rJ.open(D,E.toolbar())},UA=(T,E,D,B)=>{let M=D.getBounds.map(T=>T()),er=D.lazySink(T).getOrDie();rz.positionWithinBounds(er,E,{anchor:{type:"hotspot",hotspot:T,layouts:B,overrides:{maxWidthFunction:hC()}}},M)},WA=(T,E,D,B,M)=>{pH.setGroups(E,M),UA(T,E,D,B),s9.on(T)},hF=bm({name:"FloatingToolbarButton",factory:(T,E,D,B)=>({...iL.sketch({...B.button(),action:T=>{PA(T,B)},buttonBehaviours:bu({dump:B.button().buttonBehaviours},[uC.config({others:{toolbarSandbox:E=>((T,E,D)=>{let B=bi();return{dom:{tag:"div",attributes:{id:B.id}},behaviours:kl([sq.config({mode:"special",onEscape:T=>(rJ.close(T),A.some(!0))}),rJ.config({onOpen:(M,er)=>{let ec=hD.get().getOr(!1);D.fetch().get(M=>{WA(T,er,D,E.layouts,M),B.link(T.element),ec||sq.focusIn(er)})},onClose:()=>{s9.off(T),hD.get().getOr(!1)||s1.focus(T),B.unlink(T.element)},isPartOf:(E,D,B)=>vi(D,B)||vi(T,B),getAttachPoint:()=>D.lazySink(T).getOrDie()}),nK.config({channels:{...Qd({isExtraPart:ep,...D.fireDismissalEventInstead.map(T=>({fireEventInstead:{event:T.event}})).getOr({})}),...tu({doReposition:()=>{rJ.getState(uC.getCoupled(T,"toolbarSandbox")).each(B=>{UA(T,B,D,E.layouts)})}})}})])}})(E,D,T)}})])}),apis:{setGroups:(E,B)=>{rJ.getState(uC.getCoupled(E,"toolbarSandbox")).each(M=>{WA(E,M,T,D.layouts,B)})},reposition:E=>{rJ.getState(uC.getCoupled(E,"toolbarSandbox")).each(B=>{UA(E,B,T,D.layouts)})},toggle:T=>{PA(T,B)},toggleWithoutFocusing:T=>{hD.set(!0),PA(T,B),hD.clear()},getToolbar:T=>rJ.getState(uC.getCoupled(T,"toolbarSandbox")),isOpen:T=>rJ.isOpen(uC.getCoupled(T,"toolbarSandbox"))}}),configFields:h_(),partFields:hE(),apis:{setGroups:(T,E,D)=>{T.setGroups(E,D)},reposition:(T,E)=>{T.reposition(E)},toggle:(T,E)=>{T.toggle(E)},toggleWithoutFocusing:(T,E)=>{T.toggleWithoutFocusing(E)},getToolbar:(T,E)=>T.getToolbar(E),isOpen:(T,E)=>T.isOpen(E)}}),hM=x([os("items"),Ai(["itemSelector"]),hu("tgroupBehaviours",[sq])]),hI=x([aD({name:"items",unit:"item"})]),hR=bm({name:"ToolbarGroup",configFields:hM(),partFields:hI(),factory:(T,E,D,B)=>({uid:T.uid,dom:T.dom,components:E,behaviours:bu(T.tgroupBehaviours,[sq.config({mode:"flow",selector:T.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}})}),XA=T=>H(T,T=>Sa(T)),YA=(T,E,D)=>{FA(T,D,B=>{D.overflowGroups.set(B),E.getOpt(T).each(T=>{hF.setGroups(T,XA(B))})})},hH=bm({name:"SplitFloatingToolbar",configFields:hA(),partFields:hS(),factory:(T,E,D,B)=>{let M=jh(hF.sketch({fetch:()=>fw(E=>{E(XA(T.overflowGroups.get()))}),layouts:{onLtr:()=>[rl,sl],onRtl:()=>[sl,rl],onBottomLtr:()=>[il,al],onBottomRtl:()=>[al,il]},getBounds:D.getOverflowBounds,lazySink:T.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:T.markers.overflowToggledClass},parts:{button:B["overflow-button"](),toolbar:B.overflow()},onToggled:(E,D)=>T[D?"onOpened":"onClosed"](E)}));return{uid:T.uid,dom:T.dom,components:E,behaviours:bu(T.splitToolbarBehaviours,[uC.config({others:{overflowGroup:()=>hR.sketch({...B["overflow-group"](),items:[M.asSpec()]})}})]),apis:{setGroups:(E,D)=>{T.builtGroups.set(H(D,E.getSystem().build)),YA(E,M,T)},refresh:E=>YA(E,M,T),toggle:T=>{M.getOpt(T).each(T=>{hF.toggle(T)})},toggleWithoutFocusing:T=>{M.getOpt(T).each(hF.toggleWithoutFocusing)},isOpen:T=>M.getOpt(T).map(hF.isOpen).getOr(!1),reposition:T=>{M.getOpt(T).each(T=>{hF.reposition(T)})},getOverflow:T=>M.getOpt(T).bind(hF.getToolbar)},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(T,E,D)=>{T.setGroups(E,D)},refresh:(T,E)=>{T.refresh(E)},reposition:(T,E)=>{T.reposition(E)},toggle:(T,E)=>{T.toggle(E)},toggleWithoutFocusing:(T,E)=>{T.toggle(E)},isOpen:(T,E)=>T.isOpen(E),getOverflow:(T,E)=>T.getOverflow(E)}}),hN=x([Ai(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Di("onOpened"),Di("onClosed")].concat(hy())),hU=x([aC({factory:pH,schema:pI(),name:"primary"}),aC({factory:pH,schema:pI(),name:"overflow",overrides:T=>({toolbarBehaviours:kl([gZ.config({dimension:{property:"height"},closedClass:T.markers.closedClass,openClass:T.markers.openClass,shrinkingClass:T.markers.shrinkingClass,growingClass:T.markers.growingClass,onShrunk:E=>{om(E,T,"overflow-button").each(T=>{s9.off(T),s1.focus(T)}),T.onClosed(E)},onGrown:E=>{sq.focusIn(E),T.onOpened(E)},onStartGrow:E=>{om(E,T,"overflow-button").each(s9.on)}}),sq.config({mode:"acyclic",onEscape:E=>(om(E,T,"overflow-button").each(s1.focus),A.some(!0))})])})}),a_({name:"overflow-button",overrides:T=>({buttonBehaviours:kl([s9.config({toggleClass:T.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])})}),a_({name:"overflow-group"})]),QA=(T,E)=>{om(T,E,"overflow-button").bind(()=>om(T,E,"overflow")).each(D=>{eM(T,E),gZ.toggleGrow(D)})},eM=(T,E)=>{om(T,E,"overflow").each(D=>{FA(T,E,T=>{let E=H(T,T=>Sa(T));pH.setGroups(D,E)}),om(T,E,"overflow-button").each(T=>{gZ.hasGrown(D)&&s9.on(T)}),gZ.refresh(D)})},hL=bm({name:"SplitSlidingToolbar",configFields:hN(),partFields:hU(),factory:(T,E,D,B)=>{let M="alloy.toolbar.toggle";return{uid:T.uid,dom:T.dom,components:E,behaviours:bu(T.splitToolbarBehaviours,[uC.config({others:{overflowGroup:T=>hR.sketch({...B["overflow-group"](),items:[iL.sketch({...B["overflow-button"](),action:E=>{Fr(T,M)}})]})}}),Jp("toolbar-toggle-events",[Ur(M,E=>{QA(E,T)})])]),apis:{setGroups:(E,D)=>{((E,D)=>{let B=H(D,E.getSystem().build);T.builtGroups.set(B)})(E,D),eM(E,T)},refresh:E=>eM(E,T),toggle:E=>QA(E,T),isOpen:E=>om(E,T,"overflow").map(gZ.hasGrown).getOr(!1)},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(T,E,D)=>{T.setGroups(E,D)},refresh:(T,E)=>{T.refresh(E)},toggle:(T,E)=>{T.toggle(E)},isOpen:(T,E)=>T.isOpen(E)}}),oM=T=>{let E=T.title.fold(()=>({}),T=>({attributes:{title:T}}));return{dom:{tag:"div",classes:["tox-toolbar__group"],...E},components:[hR.parts.items({})],items:T.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled]), .tox-number-input:not([disabled])"},tgroupBehaviours:kl([uJ.config({}),s1.config({})])}},nM=T=>hR.sketch(oM(T)),sM=(T,E)=>{let D=oX(E=>{let D=H(T.initGroups,nM);pH.setGroups(E,D)});return kl([Oy(T.providers.isDisabled),Sy(),sq.config({mode:E,onEscape:T.onEscape,selector:".tox-toolbar__group"}),Jp("toolbar-events",[D])])},rM=T=>{let E=T.cyclicKeying?"cyclic":"acyclic";return{uid:T.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":oM({title:A.none(),items:[]}),"overflow-button":T_({name:"more",icon:A.some("more-drawer"),enabled:!0,tooltip:A.some("Reveal or hide additional toolbar items"),primary:!1,buttonType:A.none(),borderless:!1},A.none(),T.providers)},splitToolbarBehaviours:sM(T,E)}},aM=T=>{let E=rM(T),D=hH.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return hH.sketch({...E,lazySink:T.getSink,getOverflowBounds:()=>{let E=T.moreDrawerData.lazyHeader().element,D=Zo(E),B=ot(E),M=Zo(B),er=Math.max(B.dom.scrollHeight,M.height);return Ko(D.x+4,M.y,D.width-8,er)},parts:{...E.parts,overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:T.attributes}}},components:[D],markers:{overflowToggledClass:"tox-tbtn--enabled"},onOpened:E=>T.onToggled(E,!0),onClosed:E=>T.onToggled(E,!1)})},iM=T=>{let E=hL.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),D=hL.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),B=rM(T);return hL.sketch({...B,components:[E,D],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:E=>{E.getSystem().broadcastOn([pQ()],{type:"opened"}),T.onToggled(E,!0)},onClosed:E=>{E.getSystem().broadcastOn([pQ()],{type:"closed"}),T.onToggled(E,!1)}})},lM=T=>{let E=T.cyclicKeying?"cyclic":"acyclic";return pH.sketch({uid:T.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(T.type===i0.scrolling?["tox-toolbar--scrolling"]:[])},components:[pH.parts.groups({})],toolbarBehaviours:sM(T,E)})},hz=[cj,cW,ps("tooltip"),ks("buttonType","secondary",["primary","secondary"]),Cs("borderless",!1),is("onAction")],hP={button:[...hz,cF,as("type",["button"])],togglebutton:[...hz,Cs("active",!1),as("type",["togglebutton"])]},hj=[as("type",["group"]),_s("buttons",[],Jn("type",hP))],hW=Jn("type",{...hP,group:hj}),hG=Dn([_s("buttons",[],hW),is("onShow"),is("onHide")]),pM=(T,E)=>((T,E)=>{var D,B;let M="togglebutton"===T.type,er=T.icon.map(T=>fO(T,E.icons)).map(jh),ec={...T,name:M?T.text.getOr(T.icon.getOr("")):null!==(D=T.text)&&void 0!==D?D:T.icon.getOr(""),primary:"primary"===T.buttonType,buttonType:A.from(T.buttonType),tooltip:T.tooltip,icon:T.icon,enabled:!0,borderless:T.borderless},eu=E_(null!==(B=T.buttonType)&&void 0!==B?B:"secondary"),eg=M?T.text.map(E.translate):A.some(E.translate(T.text)),ep=eg.map(ti),eh=ec.tooltip.or(eg).map(T=>({"aria-label":E.translate(T),title:E.translate(T)})).getOr({}),ey=er.map(T=>T.asSpec()),ex=we([ey,ep]),eO=T.icon.isSome()&&ep.isSome(),eD={tag:"button",classes:eu.concat(...T.icon.isSome()&&!eO?["tox-button--icon"]:[]).concat(...eO?["tox-button--icon-and-text"]:[]).concat(...T.borderless?["tox-button--naked"]:[]).concat(..."togglebutton"===T.type&&T.active?["tox-button--enabled"]:[]),attributes:eh},eI=__(ec,A.some(D=>{let n=T=>{er.map(B=>B.getOpt(D).each(D=>{sY.set(D,[fO(T,E.icons)])}))};return M?T.onAction({setIcon:n,setActive:T=>{let E=D.element;T?(La(E,"tox-button--enabled"),kt(E,"aria-pressed",!0)):(Pa(E,"tox-button--enabled"),Et(E,"aria-pressed"))},isActive:()=>Ua(D.element,"tox-button--enabled")}):"button"===T.type?T.onAction({setIcon:n}):void 0}),[],eD,ex,E);return iL.sketch(eI)})(T,E),hJ=Do().deviceType,h$=hJ.isPhone(),hX=hJ.isTablet();var hq=bm({name:"silver.View",configFields:[os("viewConfig")],partFields:[aE({factory:{sketch:T=>{let E=!1,D=H(T.buttons,D=>{var B;return"group"===D.type?(E=!0,B=T.providers,{dom:{tag:"div",classes:["tox-view__toolbar__group"]},components:H(D.buttons,T=>pM(T,B))}):pM(D,T.providers)});return{uid:T.uid,dom:{tag:"div",classes:[E?"tox-view__toolbar":"tox-view__header",...h$||hX?["tox-view--mobile","tox-view--scrolling"]:[]]},behaviours:kl([s1.config({}),sq.config({mode:"flow",selector:"button, .tox-button",focusInside:iZ.OnEnterOrSpaceMode})]),components:E?D:[uL.sketch({dom:{tag:"div",classes:["tox-view__header-start"]},components:[]}),uL.sketch({dom:{tag:"div",classes:["tox-view__header-end"]},components:D})]}}},schema:[os("buttons"),os("providers")],name:"header"}),aE({factory:{sketch:T=>({uid:T.uid,dom:{tag:"div",classes:["tox-view__pane"]}})},schema:[],name:"pane"})],factory:(T,E,D,B)=>({uid:T.uid,dom:T.dom,components:E,apis:{getPane:E=>aH.getPart(E,T,"pane"),getOnShow:E=>T.viewConfig.onShow,getOnHide:E=>T.viewConfig.onHide}}),apis:{getPane:(T,E)=>T.getPane(E),getOnShow:(T,E)=>T.getOnShow(E),getOnHide:(T,E)=>T.getOnHide(E)}});let yM=(T,E,D)=>pe(E,(E,B)=>{let M=Xn(qn("view",hG,E));return T.slot(B,hq.sketch({dom:{tag:"div",classes:["tox-view"]},viewConfig:M,components:[...M.buttons.length>0?[hq.parts.header({buttons:M.buttons,providers:D})]:[],hq.parts.pane({})]}))}),xM=(T,E)=>hc.sketch(D=>({dom:{tag:"div",classes:["tox-view-wrap__slot-container"]},components:yM(D,T,E),slotBehaviours:ly([oX(T=>hc.hideAllSlots(T))])})),wM=T=>G(hc.getSlotNames(T),E=>hc.isShowing(T,E)),SM=(T,E,D)=>{hc.getSlot(T,E).each(T=>{hq.getPane(T).each(E=>{D(T)({getContainer:x(E.element.dom)})})})};var hK=fm({factory:(T,E)=>({uid:T.uid,dom:{tag:"div",classes:["tox-view-wrap"],attributes:{"aria-hidden":"true"},styles:{display:"none"}},components:[],behaviours:kl([sY.config({}),aP.config({find:T=>{let E=sY.contents(T);return oe(E)}})]),apis:{setViews:(T,D)=>{sY.set(T,[xM(D,E.backstage.shared.providers)])},whichView:T=>aP.getCurrent(T).bind(wM),toggleView:(T,E,D,B)=>aP.getCurrent(T).exists(M=>{let er=wM(M),ec=er.exists(T=>B===T),eu=hc.getSlot(M,B).isSome();return eu&&(hc.hideAllSlots(M),ec?((T=>{let E=T.element;Dt(E,"display","none"),kt(E,"aria-hidden","true")})(T),E()):(D(),(T=>{let E=T.element;Ht(E,"display"),Et(E,"aria-hidden")})(T),hc.showSlot(M,B),SM(M,B,hq.getOnShow)),er.each(T=>SM(M,T,hq.getOnHide))),eu})}}),name:"silver.ViewWrapper",configFields:[os("backstage")],apis:{setViews:(T,E,D)=>T.setViews(E,D),toggleView:(T,E,D,B,M)=>T.toggleView(E,D,B,M),whichView:(T,E)=>T.whichView(E)}});let hY=aI.optional({factory:p8,name:"menubar",schema:[os("backstage")]}),hZ=aI.optional({factory:{sketch:T=>pD.sketch({uid:T.uid,dom:T.dom,listBehaviours:kl([sq.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:()=>lM({type:T.type,uid:la("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:T.providers,onEscape:()=>(T.onEscape(),A.some(!0))}),setupItem:(T,E,D,B)=>{pH.setGroups(E,D)},shell:!0})},name:"multiple-toolbar",schema:[os("dom"),os("onEscape")]}),hQ=aI.optional({factory:{sketch:T=>{let E=T.type===i0.sliding?iM:T.type===i0.floating?aM:lM;return E({type:T.type,uid:T.uid,onEscape:()=>(T.onEscape(),A.some(!0)),onToggled:(E,D)=>T.onToolbarToggled(D),cyclicKeying:!1,initGroups:[],getSink:T.getSink,providers:T.providers,moreDrawerData:{lazyToolbar:T.lazyToolbar,lazyMoreButton:T.lazyMoreButton,lazyHeader:T.lazyHeader},attributes:T.attributes})}},name:"toolbar",schema:[os("dom"),os("onEscape"),os("getSink")]}),h0=aI.optional({factory:{sketch:T=>{let E=T.editor,D=T.sticky?tA:pN;return{uid:T.uid,dom:T.dom,components:T.components,behaviours:kl(D(E,T.sharedBackstage))}}},name:"header",schema:[os("dom")]}),h1=aI.optional({factory:{sketch:T=>({uid:T.uid,dom:T.dom,components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/tinymce-self-hosted-premium-features/?utm_source=TinyMCE&utm_medium=SPAP&utm_campaign=SPAP&utm_id=editorreferral",rel:"noopener",target:"_blank","aria-hidden":"true"},classes:["tox-promotion-link"],innerHtml:"⚡️Upgrade"}}]})},name:"promotion",schema:[os("dom")]}),h2=aI.optional({name:"socket",schema:[os("dom")]}),h3=aI.optional({factory:{sketch:T=>({uid:T.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"presentation"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:kl([uJ.config({}),s1.config({}),gZ.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:T=>{aP.getCurrent(T).each(hc.hideAllSlots),Fr(T,hh)},onGrown:T=>{Fr(T,hh)},onStartGrow:T=>{Ir(T,hm,{width:Nt(T.element,"width").getOr("")})},onStartShrink:T=>{Ir(T,hm,{width:Jt(T.element)+"px"})}}),sY.config({}),aP.config({find:T=>{let E=sY.contents(T);return oe(E)}})])}],behaviours:kl([BC(0),Jp("sidebar-sliding-events",[Ur(hm,(T,E)=>{Dt(T.element,"width",E.event.width)}),Ur(hh,(T,E)=>{Ht(T.element,"width")})])])})},name:"sidebar",schema:[os("dom")]}),h5=aI.optional({factory:{sketch:T=>({uid:T.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:kl([sY.config({}),hv.config({focus:!1}),aP.config({find:T=>oe(T.components())})]),components:[]})},name:"throbber",schema:[os("dom")]}),h9=aI.optional({factory:hK,name:"viewWrapper",schema:[os("backstage")]}),h4=aI.optional({factory:{sketch:T=>({uid:T.uid,dom:{tag:"div",classes:["tox-editor-container"]},components:T.components})},name:"editorContainer",schema:[]});var h6=bm({name:"OuterContainer",factory:(T,D,B)=>{let M=!1,er={getSocket:E=>aH.getPart(E,T,"socket"),setSidebar:(D,B,M)=>{aH.getPart(D,T,"sidebar").each(T=>((T,D,B)=>{aP.getCurrent(T).each(M=>{sY.set(M,[vA(D)]);let er=null==B?void 0:B.toLowerCase();E(er)&&ve(D,er)&&aP.getCurrent(M).each(E=>{hc.showSlot(E,er),gZ.immediateGrow(M),Ht(M.element,"width"),yA(T.element,"region")})})})(T,B,M))},toggleSidebar:(E,D)=>{aH.getPart(E,T,"sidebar").each(T=>((T,E)=>{aP.getCurrent(T).each(D=>{aP.getCurrent(D).each(B=>{gZ.hasGrown(D)?hc.isShowing(B,E)?(gZ.shrink(D),yA(T.element,"presentation")):(hc.hideAllSlots(B),hc.showSlot(B,E),yA(T.element,"region")):(hc.hideAllSlots(B),hc.showSlot(B,E),gZ.grow(D),yA(T.element,"region"))})})})(T,D))},whichSidebar:E=>aH.getPart(E,T,"sidebar").bind(xA).getOrNull(),getHeader:E=>aH.getPart(E,T,"header"),getToolbar:E=>aH.getPart(E,T,"toolbar"),setToolbar:(E,D)=>{aH.getPart(E,T,"toolbar").each(T=>{let E=H(D,nM);T.getApis().setGroups(T,E)})},setToolbars:(E,D)=>{aH.getPart(E,T,"multiple-toolbar").each(T=>{let E=H(D,T=>H(T,nM));pD.setItems(T,E)})},refreshToolbar:E=>{aH.getPart(E,T,"toolbar").each(T=>T.getApis().refresh(T))},toggleToolbarDrawer:E=>{aH.getPart(E,T,"toolbar").each(T=>{ke(T.getApis().toggle,E=>E(T))})},toggleToolbarDrawerWithoutFocusing:E=>{aH.getPart(E,T,"toolbar").each(T=>{ke(T.getApis().toggleWithoutFocusing,E=>E(T))})},isToolbarDrawerToggled:E=>aH.getPart(E,T,"toolbar").bind(T=>A.from(T.getApis().isOpen).map(E=>E(T))).getOr(!1),getThrobber:E=>aH.getPart(E,T,"throbber"),focusToolbar:E=>{aH.getPart(E,T,"toolbar").orThunk(()=>aH.getPart(E,T,"multiple-toolbar")).each(T=>{sq.focusIn(T)})},setMenubar:(E,D)=>{aH.getPart(E,T,"menubar").each(T=>{p8.setMenus(T,D)})},focusMenubar:E=>{aH.getPart(E,T,"menubar").each(T=>{p8.focus(T)})},setViews:(E,D)=>{aH.getPart(E,T,"viewWrapper").each(T=>{hK.setViews(T,D)})},toggleView:(E,D)=>aH.getPart(E,T,"viewWrapper").exists(T=>hK.toggleView(T,()=>er.showMainView(E),()=>er.hideMainView(E),D)),whichView:E=>aH.getPart(E,T,"viewWrapper").bind(hK.whichView).getOrNull(),hideMainView:E=>{(M=er.isToolbarDrawerToggled(E))&&er.toggleToolbarDrawer(E),aH.getPart(E,T,"editorContainer").each(T=>{let E=T.element;Dt(E,"display","none"),kt(E,"aria-hidden","true")})},showMainView:E=>{M&&er.toggleToolbarDrawer(E),aH.getPart(E,T,"editorContainer").each(T=>{let E=T.element;Ht(E,"display"),Et(E,"aria-hidden")})}};return{uid:T.uid,dom:T.dom,components:D,apis:er,behaviours:T.behaviours}},configFields:[os("dom"),os("behaviours")],partFields:[h0,hY,hQ,hZ,h2,h3,h1,h5,h9,h4],apis:{getSocket:(T,E)=>T.getSocket(E),setSidebar:(T,E,D,B)=>{T.setSidebar(E,D,B)},toggleSidebar:(T,E,D)=>{T.toggleSidebar(E,D)},whichSidebar:(T,E)=>T.whichSidebar(E),getHeader:(T,E)=>T.getHeader(E),getToolbar:(T,E)=>T.getToolbar(E),setToolbar:(T,E,D)=>{T.setToolbar(E,D)},setToolbars:(T,E,D)=>{T.setToolbars(E,D)},refreshToolbar:(T,E)=>T.refreshToolbar(E),toggleToolbarDrawer:(T,E)=>{T.toggleToolbarDrawer(E)},toggleToolbarDrawerWithoutFocusing:(T,E)=>{T.toggleToolbarDrawerWithoutFocusing(E)},isToolbarDrawerToggled:(T,E)=>T.isToolbarDrawerToggled(E),getThrobber:(T,E)=>T.getThrobber(E),setMenubar:(T,E,D)=>{T.setMenubar(E,D)},focusMenubar:(T,E)=>{T.focusMenubar(E)},focusToolbar:(T,E)=>{T.focusToolbar(E)},setViews:(T,E,D)=>{T.setViews(E,D)},toggleView:(T,E,D)=>T.toggleView(E,D),whichView:(T,E)=>T.whichView(E)}});let h8={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template inserttemplate codesample inserttable accordion | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents footnotes | mergetags | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontfamily fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"aidialog aishortcuts | spellchecker spellcheckerlanguage | autocorrect capitalization | a11ycheck code typography wordcount addtemplate"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},NM=T=>T.split(" "),VM=(T,D)=>{let B={...h8,...D.menus},M=eI(D.menus).length>0,er=void 0===D.menubar||!0===D.menubar?NM("file edit view insert format tools table help"):NM(!1===D.menubar?"":D.menubar),ec=U(er,T=>{let E=ve(h8,T);return M?E||be(D.menus,T).exists(T=>ve(T,"items")):E}),eu=H(ec,E=>{let M=B[E];return((T,E,D)=>{let B=lw(D).split(/[ ,]/);return{text:T.title,getItems:()=>X(T.items,T=>{let D=T.toLowerCase();return 0===D.trim().length||N(B,T=>T===D)?[]:"separator"===D||"|"===D?[{type:"separator"}]:E.menuItems[D]?[E.menuItems[D]]:[]})}})({title:M.title,items:NM(M.items)},D,T)});return U(eu,T=>T.getItems().length>0&&N(T.getItems(),T=>E(T)||"separator"!==T.type))},zM=T=>{let t=()=>{T._skinLoaded=!0,(T=>{T.dispatch("SkinLoaded")})(T)};return()=>{T.initialized?t():T.on("init",t)}},HM=(T,E,D)=>(T.on("remove",()=>D.unload(E)),D.load(E)),LM=(T,E)=>HM(T,E+"/skin.min.css",T.ui.styleSheetLoader),PM=(T,E)=>bt(Fe(T.getElement())).isSome()?HM(T,E+"/skin.shadowdom.min.css",i2.DOM.styleSheetLoader):Promise.resolve(),UM=(T,D)=>{let B=Jf(D);return B&&D.contentCSS.push(B+(T?"/content.inline":"/content")+".min.css"),!Yf(D)&&E(B)?Promise.all([LM(D,B),PM(D,B)]).then(zM(D),()=>((T,E)=>{T.dispatch("SkinLoadError",E)})(D,{message:"Skin could not be loaded"})):Promise.resolve(zM(D)())},h7=k(UM,!1),fn=k(UM,!0),GM=(T,E,D)=>{let n=(T,B,M,er)=>{let ec=E.shared.providers.translate(T.title);if("separator"===T.type)return A.some({type:"separator",text:ec});if("submenu"===T.type){let E=X(T.getStyleItems(),T=>s(T,B,er));return 0===B&&E.length<=0?A.none():A.some({type:"nestedmenuitem",text:ec,enabled:E.length>0,getSubmenuItems:()=>X(T.getStyleItems(),T=>s(T,B,er))})}return A.some({type:"togglemenuitem",text:ec,icon:T.icon,active:T.isSelected(er),enabled:!M,onAction:D.onAction(T),...T.getStylePreview().fold(()=>({}),T=>({meta:{style:T}}))})},s=(T,E,B)=>{let M="formatter"===T.type&&D.isInvalid(T);return 0===E?M?[]:n(T,E,!1,B).toArray():n(T,E,M,B).toArray()},r=T=>{let E=D.getCurrentValue(),B=D.shouldHide?0:1;return X(T,T=>s(T,B,E))};return{validateItems:r,getFetch:(T,E)=>(D,B)=>{let M=E(),er=r(M);B(CO(er,l2.CLOSE_ON_EXECUTE,T,{isHorizontalMenu:!1,search:A.none()}))}}},$M=(T,E,D)=>{let B=D.dataset,M="basic"===B.type?()=>H(B.data,T=>FT(T,D.isSelectedFor,D.getPreviewFor)):B.getData;return{items:GM(0,E,D),getStyleItems:M}},qM=(T,E,D)=>{let{items:B,getStyleItems:M}=$M(0,E,D),er=yx(T,"NodeChange",E=>{let B=E.getComponent();D.updateText(B),a$.set(E.getComponent(),!T.selection.isEditable())});return xO({text:D.icon.isSome()?A.none():D.text,icon:D.icon,tooltip:A.from(D.tooltip),role:A.none(),fetch:B.getFetch(E,M),onSetup:er,getApi:T=>({getComponent:x(T)}),columns:1,presets:"normal",classes:D.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",E.shared)};(yS=yC||(yC={}))[yS.SemiColon=0]="SemiColon",yS[yS.Space=1]="Space";let YM=(T,E,D)=>{var B;let M=(B=T.options.get(E),H(D===yC.SemiColon?B.replace(/;$/,"").split(";"):B.split(" "),T=>{let E=T,D=T,B=T.split("=");return B.length>1&&(E=B[0],D=B[1]),{title:E,format:D}}));return{type:"basic",data:M}},fr=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],JM=T=>({tooltip:"Align",text:A.none(),icon:A.some("align-left"),isSelectedFor:E=>()=>T.formatter.match(E),getCurrentValue:A.none,getPreviewFor:T=>A.none,onAction:E=>()=>G(fr,T=>T.format===E.format).each(E=>T.execCommand(E.command)),updateText:E=>{let D=G(fr,E=>T.formatter.match(E.format)).fold(x("left"),T=>T.title.toLowerCase());Ir(E,gP,{icon:`align-${D}`})},dataset:{type:"basic",data:fr},shouldHide:!1,isInvalid:E=>!T.formatter.canApply(E.format)}),ZM=(T,E)=>{let D=E(),B=H(D,T=>T.format);return A.from(T.formatter.closest(B)).bind(T=>G(D,E=>E.format===T)).orThunk(()=>Ce(T.formatter.match("p"),{title:"Paragraph",format:"p"}))},QM=T=>{let E="Paragraph",D=YM(T,"block_formats",yC.SemiColon);return{tooltip:"Blocks",text:A.some(E),icon:A.none(),isSelectedFor:E=>()=>T.formatter.match(E),getCurrentValue:A.none,getPreviewFor:E=>()=>{let D=T.formatter.get(E);return D?A.some({tag:D.length>0&&(D[0].inline||D[0].block)||"div",styles:T.dom.parseStyle(T.formatter.getCssText(E))}):A.none()},onAction:xx(T),updateText:B=>{let M=ZM(T,()=>D.data).fold(x(E),T=>T.title);Ir(B,gz,{text:M})},dataset:D,shouldHide:!1,isInvalid:E=>!T.formatter.canApply(E.format)}},fa=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],tD=T=>{let E=T.split(/\s*,\s*/);return H(E,T=>T.replace(/^['"]+|['"]+$/g,""))},oD=T=>{let E="System Font",o=()=>{let o=T=>T?tD(T)[0]:"",B=T.queryCommandValue("FontName"),M=D.data,er=B?B.toLowerCase():"",ec=G(M,T=>{let E=T.format;return E.toLowerCase()===er||o(E).toLowerCase()===o(er).toLowerCase()}).orThunk(()=>Ce(0===er.indexOf("-apple-system")&&(()=>{let T=tD(er.toLowerCase());return Y(fa,E=>T.indexOf(E.toLowerCase())>-1)})(),{title:E,format:er}));return{matchOpt:ec,font:B}},D=YM(T,"font_family_formats",yC.SemiColon);return{tooltip:"Fonts",text:A.some(E),icon:A.none(),isSelectedFor:T=>E=>E.exists(E=>E.format===T),getCurrentValue:()=>{let{matchOpt:T}=o();return T},getPreviewFor:T=>()=>A.some({tag:"div",styles:-1===T.indexOf("dings")?{"font-family":T}:{}}),onAction:E=>()=>{T.undoManager.transact(()=>{T.focus(),T.execCommand("FontName",!1,E.format)})},updateText:T=>{let{matchOpt:E,font:D}=o(),B=E.fold(x(D),T=>T.title);Ir(T,gz,{text:B})},dataset:D,shouldHide:!1,isInvalid:ep}},fi={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},fd=(()=>{let T="[0-9]+",E="[eE][+-]?"+T,o=T=>`(?:${T})?`,D=["Infinity",T+"\\."+o(T)+o(E),"\\."+T+o(E),T+o(E)].join("|");return RegExp(`^([+-]?(?:${D}))(.*)$`)})(),rD=(T,E)=>A.from(fd.exec(T)).bind(T=>{let D=Number(T[1]),B=T[2];return N(E,T=>N(fi[T],T=>B===T))?A.some({value:D,unit:B}):A.none()}),fp={tab:x(9),escape:x(27),enter:x(13),backspace:x(8),delete:x(46),left:x(37),up:x(38),right:x(39),down:x(40),space:x(32),home:x(36),end:x(35),pageUp:x(33),pageDown:x(34)},ff={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},fb={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},cD=(T,E)=>/[0-9.]+px$/.test(T)?((T,E)=>{let D=Math.pow(10,E);return Math.round(T*D)/D})(72*parseInt(T,10)/96,E||0)+"pt":be(fb,T).getOr(T),dD=T=>be(ff,T).getOr(""),uD=T=>{let t=()=>{let E=A.none(),B=D.data,M=T.queryCommandValue("FontSize");if(M)for(let T=3;E.isNone()&&T>=0;T--){let D=cD(M,T),er=dD(D);E=G(B,T=>T.format===M||T.format===D||T.format===er)}return{matchOpt:E,size:M}},E=x(A.none),D=YM(T,"font_size_formats",yC.Space);return{tooltip:"Font sizes",text:A.some("12pt"),icon:A.none(),isSelectedFor:T=>E=>E.exists(E=>E.format===T),getPreviewFor:E,getCurrentValue:()=>{let{matchOpt:T}=t();return T},onAction:E=>()=>{T.undoManager.transact(()=>{T.focus(),T.execCommand("FontSize",!1,E.format)})},updateText:T=>{let{matchOpt:E,size:D}=t(),B=E.fold(x(D),T=>T.title);Ir(T,gz,{text:B})},dataset:D,shouldHide:!1,isInvalid:ep}},mD=(T,E)=>{let D="Paragraph";return{tooltip:"Formats",text:A.some(D),icon:A.none(),isSelectedFor:E=>()=>T.formatter.match(E),getCurrentValue:A.none,getPreviewFor:E=>()=>{let D=T.formatter.get(E);return void 0!==D?A.some({tag:D.length>0&&(D[0].inline||D[0].block)||"div",styles:T.dom.parseStyle(T.formatter.getCssText(E))}):A.none()},onAction:xx(T),updateText:E=>{let n=T=>ET(T)?X(T.items,n):AT(T)?[{title:T.title,format:T.format}]:[],B=X(BT(T),n),M=ZM(T,x(B)).fold(x(D),T=>T.title);Ir(E,gz,{text:M})},shouldHide:lf(T),isInvalid:E=>!T.formatter.canApply(E.format),dataset:E}},fv=x([os("toggleClass"),os("fetch"),Fi("onExecute"),ys("getHotspot",A.some),ys("getAnchorOverrides",x({})),wc(),Fi("onItemExecute"),us("lazySink"),os("dom"),Di("onOpen"),hu("splitDropdownBehaviours",[uC,sq,s1]),ys("matchWidth",!1),ys("useMinWidth",!1),ys("eventOrder",{}),us("role")].concat(Ew())),fy=aC({factory:iL,schema:[os("dom")],name:"arrow",defaults:()=>({buttonBehaviours:kl([s1.revoke()])}),overrides:T=>({dom:{tag:"span",attributes:{role:"presentation"}},action:E=>{E.getSystem().getByUid(T.uid).each(Rr)},buttonBehaviours:kl([s9.config({toggleOnExecute:!1,toggleClass:T.toggleClass})])})}),fS=aC({factory:iL,schema:[os("dom")],name:"button",defaults:()=>({buttonBehaviours:kl([s1.revoke()])}),overrides:T=>({dom:{tag:"span",attributes:{role:"presentation"}},action:E=>{E.getSystem().getByUid(T.uid).each(D=>{T.onExecute(D,E)})}})}),fC=x([fy,fS,aE({factory:{sketch:T=>({uid:T.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:T.text}})},schema:[os("text")],name:"aria-descriptor"}),a_({schema:[Ei()],name:"menu",defaults:T=>({onExecute:(E,D)=>{E.getSystem().getByUid(T.uid).each(B=>{T.onItemExecute(B,E,D)})}})}),uM()]),f_=bm({name:"SplitDropdown",configFields:fv(),partFields:fC(),factory:(T,E,D,B)=>{let s=T=>{aP.getCurrent(T).each(T=>{aK.highlightFirst(T),sq.focusIn(T)})},r=E=>{kw(T,w,E,B,s,iQ.HighlightMenuAndItem).get(b)},a=E=>{let D=nm(E,T,"button");return Rr(D),A.some(!0)},M={...Hr([oX((E,D)=>{om(E,T,"aria-descriptor").each(T=>{let D=la("aria");kt(T.element,"id",D),kt(E.element,"aria-describedby",D)})})]),...mh(A.some(r))};return{uid:T.uid,dom:T.dom,components:E,apis:{repositionMenus:T=>{s9.isOn(T)&&Tw(T)}},eventOrder:{...T.eventOrder,[of()]:["disabling","toggling","alloy.base.behaviour"]},events:M,behaviours:bu(T.splitDropdownBehaviours,[uC.config({others:{sandbox:E=>{let D=nm(E,T,"arrow");return _w(T,E,{onOpen:()=>{s9.on(D),s9.on(E)},onClose:()=>{s9.off(D),s9.off(E)}})}}}),sq.config({mode:"special",onSpace:a,onEnter:a,onDown:T=>(r(T),A.some(!0))}),s1.config({}),s9.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:T.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:(T,E)=>T.repositionMenus(E)}}),vD=T=>({isEnabled:()=>!a$.isDisabled(T),setEnabled:E=>a$.set(T,!E),setText:E=>Ir(T,gz,{text:E}),setIcon:E=>Ir(T,gP,{icon:E})}),yD=T=>({setActive:E=>{s9.set(T,E)},isActive:()=>s9.isOn(T),isEnabled:()=>!a$.isDisabled(T),setEnabled:E=>a$.set(T,!E),setText:E=>Ir(T,gz,{text:E}),setIcon:E=>Ir(T,gP,{icon:E})}),xD=(T,E)=>T.map(T=>({"aria-label":E.translate(T),title:E.translate(T)})).getOr({}),fT=la("focus-button"),SD=(T,E,D,B,M)=>{let er=E.map(T=>jh(bO(T,"tox-tbtn",M))),ec=T.map(T=>jh(fO(T,M.icons)));return{dom:{tag:"button",classes:["tox-tbtn"].concat(E.isSome()?["tox-tbtn--select"]:[]),attributes:xD(D,M)},components:we([ec.map(T=>T.asSpec()),er.map(T=>T.asSpec())]),eventOrder:{[tJ()]:["focusing","alloy.base.behaviour",gU],[oH()]:[gU,"toolbar-group-button-events"]},buttonBehaviours:kl([Oy(M.isDisabled),Sy(),Jp(gU,[oX((T,E)=>gO(T)),Ur(gz,(T,E)=>{er.bind(E=>E.getOpt(T)).each(T=>{sY.set(T,[ti(M.translate(E.event.text))])})}),Ur(gP,(T,E)=>{ec.bind(E=>E.getOpt(T)).each(T=>{sY.set(T,[fO(E.event.icon,M.icons)])})}),Ur(tJ(),(T,E)=>{E.event.prevent(),Fr(T,fT)})])].concat(B.getOr([])))}},kD=(T,E,D)=>{var B,M;let er=Es(b),ec=SD(T.icon,T.text,T.tooltip,A.none(),D);return iL.sketch({dom:ec.dom,components:ec.components,eventOrder:gL,buttonBehaviours:{...kl([Jp("toolbar-button-events",[(B={onAction:T.onAction,getApi:E.getApi},oY((T,E)=>{_y(B,T)(E=>{Ir(T,gN,{buttonApi:E}),B.onAction(E)})})),Ty(E,er),Ey(E,er)]),Oy(()=>!T.enabled||D.isDisabled()),Sy()].concat(E.toolbarButtonBehaviours)),[gU]:null===(M=ec.buttonBehaviours)||void 0===M?void 0:M[gU]}})},CD=(T,E,D)=>kD(T,{toolbarButtonBehaviours:D.length>0?[Jp("toolbarButtonWith",D)]:[],getApi:vD,onSetup:T.onSetup},E),OD=(T,E,D)=>kD(T,{toolbarButtonBehaviours:[sY.config({}),s9.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(D.length>0?[Jp("toolbarToggleButtonWith",D)]:[]),getApi:yD,onSetup:T.onSetup},E),_D=(T,E,D)=>B=>fw(T=>E.fetch(T)).map(M=>A.from(Hw(tw(Zx(la("menu-value"),M,D=>{E.onItemAction(T(B),D)},E.columns,E.presets,l2.CLOSE_ON_EXECUTE,E.select.getOr(ep),D),{movement:ew(E.columns,E.presets),menuBehaviours:ly("auto"!==E.columns?[]:[oX((T,D)=>{iy(T,4,_b(E.presets)).each(({numRows:E,numColumns:D})=>{sq.setGridSize(T,E,D)})})])})))),fE=[{name:"history",items:["undo","redo"]},{name:"ai",items:["aidialog","aishortcuts"]},{name:"styles",items:["styles"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],ED=(T,E)=>(D,B,M)=>{let er=T(D).mapError(T=>Kn(T)).getOrDie();return E(er,B,M)},fD={button:ED(Fv,(T,E)=>CD(T,E.shared.providers,[])),togglebutton:ED(Nv,(T,E)=>OD(T,E.shared.providers,[])),menubutton:ED(aA,(T,E)=>t_(T,"tox-tbtn",E,A.none(),!1)),splitbutton:ED(T=>qn("SplitButton",p6,T),(T,E)=>((T,E)=>{let o=T=>({isEnabled:()=>!a$.isDisabled(T),setEnabled:E=>a$.set(T,!E),setIconFill:(E,D)=>{pi(T.element,`svg path[class="${E}"], rect[class="${E}"]`).each(T=>{kt(T,"fill",D)})},setActive:E=>{kt(T.element,"aria-pressed",E),pi(T.element,"span").each(D=>{T.getSystem().getByDom(D).each(T=>s9.set(T,E))})},isActive:()=>pi(T.element,"span").exists(E=>T.getSystem().getByDom(E).exists(s9.isOn)),setText:E=>pi(T.element,"span").each(D=>T.getSystem().getByDom(D).each(T=>Ir(T,gz,{text:E}))),setIcon:E=>pi(T.element,"span").each(D=>T.getSystem().getByDom(D).each(T=>Ir(T,gP,{icon:E})))}),D=Es(b),B={getApi:o,onSetup:T.onSetup};return f_.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:{"aria-pressed":!1,...xD(T.tooltip,E.providers)}},onExecute:E=>{let D=o(E);D.isEnabled()&&T.onAction(D)},onItemExecute:(T,E,D)=>{},splitDropdownBehaviours:kl([Cy(E.providers.isDisabled),Sy(),Jp("split-dropdown-events",[oX((T,E)=>gO(T)),Ur(fT,s1.focus),Ty(B,D),Ey(B,D)]),u8.config({})]),eventOrder:{[oH()]:["alloy.base.behaviour","split-dropdown-events"]},toggleClass:"tox-tbtn--enabled",lazySink:E.getSink,fetch:_D(o,T,E.providers),parts:{menu:Bb(0,T.columns,T.presets)},components:[f_.parts.button(SD(T.icon,T.text,A.none(),A.some([s9.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),E.providers)),f_.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Jh("chevron-down",E.providers.icons)},buttonBehaviours:kl([Cy(E.providers.isDisabled),Sy(),Zh()])}),f_.parts["aria-descriptor"]({text:E.providers.translate("To open the popup, press Shift+Enter")})]})})(T,E.shared)),grouptoolbarbutton:ED(T=>qn("GroupToolbarButton",p5,T),(T,E,D)=>{let B=D.ui.registry.getAll().buttons,M={[n8]:E.shared.header.isPositionedAtTop()?iY.TopToBottom:iY.BottomToTop};if(lA(D)===i0.floating)return((T,E,D,B)=>{let M=E.shared,er=Es(b),ec={toolbarButtonBehaviours:[],getApi:vD,onSetup:T.onSetup},eu=[Jp("toolbar-group-button-events",[Ty(ec,er),Ey(ec,er)])];return hF.sketch({lazySink:M.getSink,fetch:()=>fw(E=>{E(H(D(T.items),nM))}),markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:SD(T.icon,T.text,T.tooltip,A.some(eu),M.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:B}}}})})(T,E,T=>DD(D,{buttons:B,toolbar:T,allowToolbarGroups:!1},E,A.none()),M);throw Error("Toolbar groups are only supported when using floating toolbar mode")})},fM={styles:(T,E)=>{let D={type:"advanced",...E.styles};return qM(T,E,mD(T,D))},fontsize:(T,E)=>qM(T,E,uD(T)),fontsizeinput:(T,E)=>((T,E,D)=>{let B=A.none(),M=yx(T,"NodeChange SwitchMode",E=>{let M=E.getComponent();B=A.some(M),D.updateInputValue(M),a$.set(M,!T.selection.isEditable())}),r=T=>({getComponent:x(T)}),er=Es(b),ec=la("custom-number-input-events"),l=(T,E,M)=>{let er=B.map(T=>r5.getValue(T)).getOr(""),ec=D.getNewValue(er,T),eu=er.length-`${ec}`.length,eg=B.map(T=>T.element.dom.selectionStart-eu),ep=B.map(T=>T.element.dom.selectionEnd-eu);D.onAction(ec,M),B.each(T=>{r5.setValue(T,ec),E&&(eg.each(E=>T.element.dom.selectionStart=E),ep.each(E=>T.element.dom.selectionEnd=E))})},c=(T,E)=>l((T,E)=>T-E,T,E),d=(T,E)=>l((T,E)=>T+E,T,E),u=T=>rt(T.element).fold(A.none,T=>(Dl(T),A.some(!0))),m=T=>Fl(T.element)?(ct(T.element).each(T=>Dl(T)),A.some(!0)):A.none(),g=(D,B,M,ec)=>{let eu=E.shared.providers.translate(M),eg=la("altExecuting"),ep=yx(T,"NodeChange SwitchMode",E=>{a$.set(E.getComponent(),!T.selection.isEditable())}),u=T=>{a$.isDisabled(T)||D(!0)};return iL.sketch({dom:{tag:"button",attributes:{title:eu,"aria-label":eu},classes:ec.concat(B)},components:[hO(B,E.shared.providers.icons)],buttonBehaviours:kl([a$.config({}),Jp(eg,[Ty({onSetup:ep,getApi:r},er),Ey({getApi:r},er),Ur(tQ(),(T,E)=>{E.event.raw.keyCode!==fp.space()&&E.event.raw.keyCode!==fp.enter()||a$.isDisabled(T)||D(!1)}),Ur(t3(),u),Ur(tW(),u)])]),eventOrder:{[tQ()]:[eg,"keying"],[t3()]:[eg,"alloy.base.behaviour"],[tW()]:[eg,"alloy.base.behaviour"]}})},eu=jh(g(T=>c(!1,T),"minus","Decrease font size",["highlight-on-focus"])),eg=jh(g(T=>d(!1,T),"plus","Increase font size",["highlight-on-focus"])),ep=jh({dom:{tag:"div",classes:["tox-input-wrapper","highlight-on-focus"]},components:[cv.sketch({inputBehaviours:kl([a$.config({}),Jp(ec,[Ty({onSetup:M,getApi:r},er),Ey({getApi:r},er)]),Jp("input-update-display-text",[Ur(gz,(T,E)=>{r5.setValue(T,E.event.text)}),Ur(tZ(),T=>{D.onAction(r5.getValue(T))}),Ur(t2(),T=>{D.onAction(r5.getValue(T))})]),sq.config({mode:"special",onEnter:T=>(l(w,!0,!0),A.some(!0)),onEscape:u,onUp:T=>(d(!0,!1),A.some(!0)),onDown:T=>(c(!0,!1),A.some(!0)),onLeft:(T,E)=>(E.cut(),A.none()),onRight:(T,E)=>(E.cut(),A.none())})])})],behaviours:kl([s1.config({}),sq.config({mode:"special",onEnter:m,onSpace:m,onEscape:u}),Jp("input-wrapper-events",[Ur(tK(),T=>{L([eu,eg],E=>{let D=Fe(E.get(T).element.dom);Fl(D)&&Bl(D)})})])])});return{dom:{tag:"div",classes:["tox-number-input"]},components:[eu.asSpec(),ep.asSpec(),eg.asSpec()],behaviours:kl([s1.config({}),sq.config({mode:"flow",focusInside:iZ.OnEnterOrSpaceMode,cycles:!1,selector:"button, .tox-input-wrapper",onEscape:T=>Fl(T.element)?A.none():(Dl(T.element),A.some(!0))})])}})(T,E,(T=>{let t=()=>T.queryCommandValue("FontSize");return{updateInputValue:T=>Ir(T,gz,{text:t()}),onAction:(E,D)=>T.execCommand("FontSize",!1,E,{skip_focus:!D}),getNewValue:(E,D)=>{var B;rD(E,["unsupportedLength","empty"]);let M=rD(E,["unsupportedLength","empty"]).or(rD(t(),["unsupportedLength","empty"])),er=M.map(T=>T.value).getOr(16),ec=lL(T),eu=M.map(T=>T.unit).filter(T=>""!==T).getOr(ec),eg=D(er,(null!==(B=({em:{step:.1},cm:{step:.1},in:{step:.1},pc:{step:.1},ch:{step:.1},rem:{step:.1}})[eu])&&void 0!==B?B:{step:1}).step);return`${eg>=0?eg:er}${eu}`}}})(T)),fontfamily:(T,E)=>qM(T,E,oD(T)),blocks:(T,E)=>qM(T,E,QM(T)),align:(T,E)=>qM(T,E,JM(T))},DD=(T,D,B,M)=>{let er=(T=>{let D=T.toolbar,B=T.buttons;return!1===D?[]:void 0===D||!0===D?(T=>{let E=H(fE,E=>{let D=U(E.items,E=>ve(T,E)||ve(fM,E));return{name:E.name,items:D}});return U(E,T=>T.items.length>0)})(B):E(D)?(T=>{let E=T.split("|");return H(E,T=>({items:T.trim().split(" ")}))})(D):f(D,T=>ve(T,"name")&&ve(T,"items"))?D:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])})(D),ec=H(er,E=>{let er=X(E.items,E=>{var er,ec;return 0===E.trim().length?[]:(er=D.buttons,ec=D.allowToolbarGroups,be(er,E.toLowerCase()).orThunk(()=>M.bind(T=>re(T,T=>be(er,T+E.toLowerCase())))).fold(()=>be(fM,E.toLowerCase()).map(E=>E(T,B)),D=>"grouptoolbarbutton"!==D.type||ec?be(fD,D.type).fold(()=>(console.error("skipping button defined by",D),A.none()),E=>A.some(E(D,B,T))):(console.warn(`Ignoring the '${E}' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.`),A.none()))).toArray()});return{title:A.from(T.translate(E.name)),items:er}});return U(ec,T=>T.items.length>0)},BD=(T,D,B,M)=>{let er=D.mainUi.outerContainer,ec=B.toolbar,eu=B.buttons;if(f(ec,E)){let E=ec.map(E=>{let D={toolbar:E,buttons:eu,allowToolbarGroups:B.allowToolbarGroups};return DD(T,D,M,A.none())});h6.setToolbars(er,E)}else h6.setToolbar(er,DD(T,B,M,A.none()))},fI=Do(),fR=fI.os.isiOS()&&fI.os.version.major<=12;var fH=Object.freeze({__proto__:null,render:async(T,E,D,B,er)=>{var ec;let{mainUi:eu,uiMotherships:eg}=E,ep=Es(0),eh=eu.outerContainer;await h7(T);let ey=Fe(er.targetNode),ex=ft(eJ(ey));Rd(ey,eu.mothership),lb(T)&&Rd(E.mainUi.mothership.element,E.popupUi.mothership),Id(ex,E.dialogUi.mothership),T.on("PostRender",()=>{h6.setSidebar(eh,D.sidebar,lY(T)),BD(T,E,D,B),ep.set(T.getWin().innerWidth),h6.setMenubar(eh,VM(T,D)),h6.setViews(eh,D.views),((T,E)=>{let{uiMotherships:D}=E,B=T.dom,M=T.getWin(),er=T.getDoc().documentElement,ec=Es(Gt(M.innerWidth,M.innerHeight)),eu=Es(Gt(er.offsetWidth,er.offsetHeight)),l=()=>{let E=ec.get();E.left===M.innerWidth&&E.top===M.innerHeight||(ec.set(Gt(M.innerWidth,M.innerHeight)),gx(T))},c=()=>{let E=T.getDoc().documentElement,D=eu.get();D.left===E.offsetWidth&&D.top===E.offsetHeight||(eu.set(Gt(E.offsetWidth,E.offsetHeight)),gx(T))},d=E=>{((T,E)=>{T.dispatch("ScrollContent",E)})(T,E)};B.bind(M,"resize",l),B.bind(M,"scroll",d);let eg=oc(Fe(T.getBody()),"load",c);T.on("hide",()=>{L(D,T=>{Dt(T.element,"display","none")})}),T.on("show",()=>{L(D,T=>{Ht(T.element,"display")})}),T.on("NodeChange",c),T.on("remove",()=>{eg.unbind(),B.unbind(M,"resize",l),B.unbind(M,"scroll",d),M=null})})(T,E)});let eO=h6.getSocket(eh).getOrDie("Could not find expected socket element");if(fR){let E;Bt(eO.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});let D=(ec=()=>{T.dispatch("ScrollContent")},E=null,{cancel:()=>{M(E)||(clearTimeout(E),E=null)},throttle:(...T)=>{M(E)&&(E=setTimeout(()=>{E=null,ec.apply(null,T)},20))}}),B=tc(eO.element,"scroll",D.throttle);T.on("remove",B.unbind)}wy(T,E),T.addCommand("ToggleSidebar",(E,D)=>{h6.toggleSidebar(eh,D),T.dispatch("ToggleSidebar")}),T.addQueryValueHandler("ToggleSidebar",()=>{var T;return null!==(T=h6.whichSidebar(eh))&&void 0!==T?T:""}),T.addCommand("ToggleView",(E,D)=>{if(h6.toggleView(eh,D)){let E=eh.element;eu.mothership.broadcastOn([r$()],{target:E}),L(eg,T=>{T.broadcastOn([r$()],{target:E})}),M(h6.whichView(eh))&&(T.focus(),T.nodeChanged(),h6.refreshToolbar(eh))}}),T.addQueryValueHandler("ToggleView",()=>{var T;return null!==(T=h6.whichView(eh))&&void 0!==T?T:""});let eD=lA(T);return eD!==i0.sliding&&eD!==i0.floating||T.on("ResizeWindow ResizeEditor ResizeContent",()=>{let D=T.getWin().innerWidth;D!==ep.get()&&(h6.refreshToolbar(E.mainUi.outerContainer),ep.set(D))}),{iframeContainer:eO.element.dom,editorContainer:eh.element.dom,api:{setEnabled:T=>{xy(E,!T)},isEnabled:()=>!a$.isDisabled(eh)}}}});let ND=T=>/^[0-9\.]+(|px)$/i.test(""+T)?A.some(parseInt(""+T,10)):A.none(),VD=T=>eg(T)?T+"px":T,zD=(T,E,D)=>{let B=E.filter(E=>T<E),M=D.filter(E=>T>E);return B.or(M).getOr(T)},HD=T=>{let E=i6(T),D=i8(T),B=lo(T);return ND(E).map(T=>zD(T,D,B))},{ToolbarLocation:fN,ToolbarMode:fU}=l0,UD=(T,E,D,B,M)=>{let{mainUi:er,uiMotherships:ec}=D,eu=i2.DOM,eg=sb(T),ep=ib(T),eh=lo(T).or(HD(T)),ey=B.shared.header,ex=ey.isPositionedAtTop,eO=lA(T),eD=eO===fU.sliding||eO===fU.floating,eI=Es(!1),f=()=>eI.get()&&!T.removed,b=T=>eD?T.fold(x(0),T=>T.components().length>1?Wt(T.components()[1].element):0):0,v=()=>{L(ec,T=>{T.broadcastOn([rX()],{})})},y=D=>{if(!f())return;eg||M.on(T=>{let D=eh.getOrThunk(()=>{let T=ND(It(xt(),"margin-left")).getOr(0);return Jt(xt())-Xt(E).left+T});Dt(T.element,"max-width",D+"px")});let B=eg?A.none():(()=>{if(eg)return A.none();if(Xt(er.outerContainer.element).left+Zt(er.outerContainer.element)>=window.innerWidth-40||Nt(er.outerContainer.element,"width").isSome()){Dt(er.outerContainer.element,"position","absolute"),Dt(er.outerContainer.element,"left","0px"),Ht(er.outerContainer.element,"width");let T=Zt(er.outerContainer.element);return A.some(T)}return A.none()})();eD&&h6.refreshToolbar(er.outerContainer),eg||M.on(D=>{var M;let ec=h6.getToolbar(er.outerContainer),eu=b(ec),eg=Jo(E),{top:ep,left:eh}=(M=er.outerContainer.element,lb(T)?xE(M):A.none()).fold(()=>({top:ex()?Math.max(eg.y-Wt(D.element)+eu,0):eg.bottom,left:eg.x}),T=>{var E;let B=Jo(T),M=null!==(E=T.dom.scrollTop)&&void 0!==E?E:0,er=Ze(T,xt()),ec=er?Math.max(eg.y-Wt(D.element)+eu,0):eg.y-B.y+M-Wt(D.element)+eu;return{top:ex()?ec:eg.bottom,left:er?eg.x:eg.x-B.x}}),ey=B.map(T=>{let E=Uo(),D=window.innerWidth-(eh-E.left);return{width:Math.max(Math.min(T,D),150)+"px"}}).getOr({});Bt(er.outerContainer.element,{position:"absolute",left:Math.round(eh)+"px",top:Math.round(ep)+"px",...ey})}),ep&&M.on(D),v()},w=()=>!(eg||!ep||!f())&&M.get().exists(D=>{let B=ey.getDockingMode(),ec=(D=>{switch(lE(T)){case fN.auto:let B=h6.getToolbar(er.outerContainer),M=b(B),ec=Wt(D.element)-M,eu=Jo(E);if(eu.y>ec)return"top";{let T=ot(E),D=Math.max(T.dom.scrollHeight,Wt(T));return eu.bottom<D-ec||en().bottom<eu.bottom-ec?"bottom":"top"}case fN.bottom:return"bottom";case fN.top:default:return"top"}})(D);return ec!==B&&(M.on(T=>{pZ.setModes(T,[ec]),ey.setDockingMode(ec);let E=ex()?iY.TopToBottom:iY.BottomToTop;kt(T.element,n8,E)}),!0)});return{isVisible:f,isPositionedAtTop:ex,show:()=>{eI.set(!0),Dt(er.outerContainer.element,"display","flex"),eu.addClass(T.getBody(),"mce-edit-focus"),L(ec,T=>{Ht(T.element,"display")}),w(),lb(T)?y(T=>pZ.isDocked(T)?pZ.reset(T):pZ.refresh(T)):y(pZ.refresh)},hide:()=>{eI.set(!1),Dt(er.outerContainer.element,"display","none"),eu.removeClass(T.getBody(),"mce-edit-focus"),L(ec,T=>{Dt(T.element,"display","none")})},update:y,updateMode:()=>{w()&&y(pZ.reset)},repositionPopups:v}},WD=(T,E)=>{let D=Jo(T);return{pos:E?D.y:D.bottom,bounds:D}};var fL=Object.freeze({__proto__:null,render:async(T,E,D,B,M)=>{let{mainUi:er}=E,ec=Ql(),eu=Fe(M.targetNode),eg=UD(T,eu,E,B,ec),ep=lB(T);await fn(T);let d=()=>{if(ec.isSet())return void eg.show();ec.set(h6.getHeader(er.outerContainer).getOrDie());let M=rb(T);lb(T)?(Rd(eu,er.mothership),Rd(eu,E.popupUi.mothership)):Id(M,er.mothership),Id(M,E.dialogUi.mothership),BD(T,E,D,B),h6.setMenubar(er.outerContainer,VM(T,D)),eg.show(),((T,E,D,B)=>{let M=Es(WD(E,D.isPositionedAtTop())),r=B=>{let{pos:er,bounds:ec}=WD(E,D.isPositionedAtTop()),{pos:eu,bounds:eg}=M.get(),ep=ec.height!==eg.height||ec.width!==eg.width;M.set({pos:er,bounds:ec}),ep&&gx(T,B),D.isVisible()&&(eu!==er?D.update(pZ.reset):ep&&(D.updateMode(),D.repositionPopups()))};B||(T.on("activate",D.show),T.on("deactivate",D.hide)),T.on("SkinLoaded ResizeWindow",()=>D.update(pZ.reset)),T.on("NodeChange keydown",T=>{requestAnimationFrame(()=>r(T))});let er=0,ec=PC(()=>D.update(pZ.refresh),33);T.on("ScrollWindow",()=>{let T=Uo().left;T!==er&&(er=T,ec.throttle()),D.updateMode()}),lb(T)&&T.on("ElementScroll",T=>{D.update(pZ.refresh)});let eu=Zl();eu.set(oc(Fe(T.getBody()),"load",T=>r(T.raw))),T.on("remove",()=>{eu.clear()})})(T,eu,eg,ep),T.nodeChanged()};T.on("show",d),T.on("hide",eg.hide),ep||(T.on("focus",d),T.on("blur",eg.hide)),T.on("init",()=>{(T.hasFocus()||ep)&&d()}),wy(T,E);let eh={show:d,hide:eg.hide,setEnabled:T=>{xy(E,!T)},isEnabled:()=>!a$.isDisabled(er.outerContainer)};return{editorContainer:er.outerContainer.element.dom,api:eh}}});let fz="contexttoolbar-hide",$D=(T,E)=>Ur(gN,(D,B)=>{var M;let er=(M=T.get(D),{hide:()=>Fr(M,ow()),getValue:()=>r5.getValue(M)});E.onAction(er,B.event.buttonApi)}),qD=(T,E)=>{let D=T.label.fold(()=>({}),T=>({"aria-label":T})),B=jh(cv.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:T.initValue(),inputAttributes:D,selectOnFocus:!0,inputBehaviours:kl([sq.config({mode:"special",onEnter:T=>M.findPrimary(T).map(T=>(Rr(T),!0)),onLeft:(T,E)=>(E.cut(),A.none()),onRight:(T,E)=>(E.cut(),A.none())})])})),M=((T,E,D)=>{let B=H(E,E=>jh("contextformtogglebutton"===E.type?((T,E,D)=>{let{primary:B,...M}=E.original,er=Xn(Nv({...M,type:"togglebutton",onAction:b}));return OD(er,D,[$D(T,E)])})(T,E,D):((T,E,D)=>{let{primary:B,...M}=E.original,er=Xn(Fv({...M,type:"button",onAction:b}));return CD(er,D,[$D(T,E)])})(T,E,D)));return{asSpecs:()=>H(B,T=>T.asSpec()),findPrimary:T=>re(E,(E,D)=>E.primary?A.from(B[D]).bind(E=>E.getOpt(T)).filter(C(a$.isDisabled)):A.none())}})(B,T.commands,E);return[{title:A.none(),items:[B.asSpec()]},{title:A.none(),items:M.asSpecs()}]},XD=(T,E,D)=>E.bottom-T.y>=D&&T.bottom-E.y>=D,YD=T=>{let E=(T=>{let E=T.getBoundingClientRect();if(E.height<=0&&E.width<=0){let D=ut(Fe(T.startContainer),T.startOffset).element;return(ez(D)?st(D):A.some(D)).filter(eL).map(T=>T.dom.getBoundingClientRect()).getOr(E)}return E})(T.selection.getRng());if(T.inline){let T=Uo();return Ko(T.left+E.left,T.top+E.top,E.width,E.height)}{let D=Zo(Fe(T.getBody()));return Ko(D.x+E.left,D.y+E.top,E.width,E.height)}},KD=(T,E,D,B=0)=>{let M=Go(window),er=Jo(Fe(T.getContentAreaContainer())),ec=Kf(T)||Qf(T)||tb(T),{x:eu,width:eg}=((T,E,D)=>{let B=Math.max(T.x+D,E.x);return{x:B,width:Math.min(T.right-D,E.right)-B}})(er,M,B);if(T.inline&&!ec)return Ko(eu,M.y,eg,M.height);{let ec=E.header.isPositionedAtTop(),{y:ep,bottom:eh}=((T,E,D,B,M,er)=>{let ec=Fe(T.getContainer()),eu=pi(ec,".tox-editor-header").getOr(ec),eg=Jo(eu),ep=eg.y>=E.bottom,eh=B&&!ep;if(T.inline&&eh)return{y:Math.max(eg.bottom+er,D.y),bottom:D.bottom};if(T.inline&&!eh)return{y:D.y,bottom:Math.min(eg.y-er,D.bottom)};let ey="line"===M?Jo(ec):E;return eh?{y:Math.max(eg.bottom+er,D.y),bottom:Math.min(ey.bottom-er,D.bottom)}:{y:Math.max(ey.y+er,D.y),bottom:Math.min(eg.y-er,D.bottom)}})(T,er,M,ec,D,B);return Ko(eu,ep,eg,eh-ep)}},fP={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},fj={maxHeightFunction:n4(),maxWidthFunction:hC()},QD=T=>"node"===T,eB=(T,E,D,B,M)=>{let er=YD(T),ec=B.lastElement().exists(T=>Ze(D,T));return((T,E)=>{let D=T.selection.getRng(),B=ut(Fe(D.startContainer),D.startOffset);return D.startContainer===D.endContainer&&D.startOffset===D.endOffset-1&&Ze(B.element,E)})(T,D)?ec?gT:lT:ec?((T,D,M)=>{let ec=Nt(T,"position");Dt(T,"position",D);let eu=XD(er,Jo(E),-20)&&!B.isReposition()?hT:gT;return ec.each(E=>Dt(T,"position",E)),eu})(E,B.getMode()):("fixed"===B.getMode()?M.y+Uo().top:M.y)+(Wt(E)+12)<=er.y?lT:cT},tB=(T,E,D,B)=>{let s=E=>(B,M,er,ec,eu)=>({...eB(T,ec,E,D,eu)({...B,y:eu.y,height:eu.height},M,er,ec,eu),alwaysFit:!0}),r=T=>QD(B)?[s(T)]:[];return E?{onLtr:T=>[cl,sl,rl,al,il,ll].concat(r(T)),onRtl:T=>[cl,rl,sl,il,al,ll].concat(r(T))}:{onLtr:T=>[ll,cl,al,sl,il,rl].concat(r(T)),onRtl:T=>[ll,cl,il,rl,al,sl].concat(r(T))}},oB=(T,E)=>{let D=U(E,E=>E.predicate(T.dom)),{pass:B,fail:M}=P(D,T=>"contexttoolbar"===T.type);return{contextToolbars:B,contextForms:M}},nB=(T,E)=>{let D={},B=[],M=[],er={},ec={},eu=eI(T);return L(eu,eu=>{let eg=T[eu];"contextform"===eg.type?((T,eu)=>{let eg=Xn(qn("ContextForm",du,eu));D[T]=eg,eg.launch.map(D=>{er["form:"+T]={...eu.launch,type:"contextformtogglebutton"===D.type?"togglebutton":"button",onAction:()=>{E(eg)}}}),"editor"===eg.scope?M.push(eg):B.push(eg),ec[T]=eg})(eu,eg):"contexttoolbar"===eg.type&&((T,E)=>{qn("ContextToolbar",dm,E).each(D=>{"editor"===E.scope?M.push(D):B.push(D),ec[T]=D})})(eu,eg)}),{forms:D,inNodeScope:B,inEditorScope:M,lookupTable:ec,formNavigators:er}},fW=la("forward-slide"),fG=la("backward-slide"),fJ=la("change-slide-event"),f$="tox-pop--resizing",fX="tox-pop--transition",cB=(T,E,D,B)=>{let M=B.backstage,er=M.shared,ec=Do().deviceType.isTouch,eu=Ql(),eg=Ql(),ep=Ql(),eh=ri((T=>{let E=Es([]);return iN.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:T=>{E.set([]),iN.getContent(T).each(T=>{Ht(T.element,"visibility")}),Pa(T.element,f$),Ht(T.element,"width")},inlineBehaviours:kl([Jp("context-toolbar-events",[Yr(t9(),(T,E)=>{"width"===E.event.raw.propertyName&&(Pa(T.element,f$),Ht(T.element,"width"))}),Ur(fJ,(T,E)=>{let D=T.element;Ht(D,"width");let B=Jt(D);iN.setContent(T,E.event.contents),La(D,f$);let M=Jt(D);Dt(D,"width",B+"px"),iN.getContent(T).each(T=>{E.event.focus.bind(T=>(Dl(T),Rl(D))).orThunk(()=>(sq.focusIn(T),Il(eJ(D))))}),setTimeout(()=>{Dt(T.element,"width",M+"px")},0)}),Ur(fW,(T,D)=>{iN.getContent(T).each(D=>{E.set(E.get().concat([{bar:D,focus:Il(eJ(T.element))}]))}),Ir(T,fJ,{contents:D.event.forwardContents,focus:A.none()})}),Ur(fG,(T,D)=>{ne(E.get()).each(D=>{E.set(E.get().slice(0,E.get().length-1)),Ir(T,fJ,{contents:Sa(D.bar),focus:D.focus})})})]),sq.config({mode:"special",onEscape:D=>ne(E.get()).fold(()=>T.onEscape(),T=>(Fr(D,fG),A.some(!0)))})]),lazySink:()=>tx.value(T.sink)})})({sink:D,onEscape:()=>(T.focus(),A.some(!0))})),u=()=>{let E=ep.get().getOr("node"),D=QD(E)?1:0;return KD(T,er,E,D)},m=()=>!(T.removed||ec()&&M.isContextMenuOpen()),g=()=>{if(m()){let E=u(),D=xe(ep.get(),"node")?eu.get().filter(T=>yt(T)&&je(T)).map(Zo).getOrThunk(()=>YD(T)):YD(T);return E.height<=0||!XD(D,E,.01)}return!0},p=()=>{eu.clear(),eg.clear(),ep.clear(),iN.hide(eh)},h=()=>{if(iN.isOpen(eh)){let T=eh.element;Ht(T,"display"),g()?Dt(T,"display","none"):(eg.set(0),iN.reposition(eh))}},f=E=>({dom:{tag:"div",classes:["tox-pop__dialog"]},components:[E],behaviours:kl([sq.config({mode:"acyclic"}),Jp("pop-dialog-wrap-events",[oX(E=>{T.shortcuts.add("ctrl+F9","focus statusbar",()=>sq.focusIn(E))}),oq(E=>{T.shortcuts.remove("ctrl+F9")})])])}),ey=Qt(()=>nB(E,T=>{let E=y([T]);Ir(eh,fW,{forwardContents:f(E)})})),y=E=>{let{buttons:D}=T.ui.registry.getAll(),M={...D,...ey().formNavigators},ec=lA(T)===i0.scrolling?i0.scrolling:i0.default,eu=q(H(E,E=>"contexttoolbar"===E.type?DD(T,{buttons:M,toolbar:E.items,allowToolbarGroups:!1},B.backstage,A.some(["form:"])):qD(E,er.providers)));return lM({type:ec,uid:la("context-toolbar"),initGroups:eu,onEscape:A.none,cyclicKeying:!0,providers:er.providers})},x=(E,B)=>{if(eO.cancel(),!m())return;let M=y(E),ey=E[0].position,ex=((E,B)=>{var M,ep;let eh="node"===E?er.anchors.node(B):er.anchors.cursor(),ey=(M=ec(),ep={lastElement:eu.get,isReposition:()=>xe(eg.get(),0),getMode:()=>rz.getMode(D)},"line"===E?{bubble:gc(12,0,fP),layouts:{onLtr:()=>[dl],onRtl:()=>[ul]},overrides:fj}:{bubble:gc(0,12,fP,1/12),layouts:tB(T,M,ep,E),overrides:fj});return tw(eh,ey)})(ey,B);ep.set(ey),eg.set(1);let eD=eh.element;Ht(eD,"display"),xe(Se(B,eu.get(),Ze),!0)||(Pa(eD,fX),rz.reset(D,eh)),iN.showWithinBounds(eh,f(M),{anchor:ex,transition:{classes:[fX],mode:"placement"}},()=>A.some(u())),B.fold(eu.clear,eu.set),g()&&Dt(eD,"display","none")},ex=!1,eO=PC(()=>{!T.hasFocus()||T.removed||ex||(Ua(eh.element,fX)?eO.throttle():((T,E)=>{let D=Fe(E.getBody()),n=T=>Ze(T,D),B=Fe(E.selection.getNode());return n(B)||Qe(D,B)?((T,E,D)=>{let B=oB(T,E);if(B.contextForms.length>0)return A.some({elem:T,toolbars:[B.contextForms[0]]});{let E=oB(T,D);if(E.contextForms.length>0)return A.some({elem:T,toolbars:[E.contextForms[0]]});if(B.contextToolbars.length>0||E.contextToolbars.length>0){let D=(T=>{if(T.length<=1)return T;{let t=E=>N(T,T=>T.position===E),o=E=>U(T,T=>T.position===E),E=t("selection"),D=t("node");if(E||D){if(D&&E){let T=o("node"),E=H(o("selection"),T=>({...T,position:"node"}));return T.concat(E)}return o(E?"selection":"node")}return o("line")}})(B.contextToolbars.concat(E.contextToolbars));return A.some({elem:T,toolbars:D})}return A.none()}})(B,T.inNodeScope,T.inEditorScope).orThunk(()=>n(B)?A.none():Fs(B,E=>{if(eL(E)){let{contextToolbars:D,contextForms:B}=oB(E,T.inNodeScope),M=B.length>0?B:(T=>{if(T.length<=1)return T;{let t=E=>G(T,T=>T.position===E);return t("selection").orThunk(()=>t("node")).orThunk(()=>t("line")).map(T=>T.position).fold(()=>[],E=>U(T,T=>T.position===E))}})(D);return M.length>0?A.some({elem:E,toolbars:M}):A.none()}return A.none()},n)):A.none()})(ey(),T).fold(p,T=>{x(T.toolbars,A.some(T.elem))}))},17);T.on("init",()=>{T.on("remove",p),T.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",h),T.on("click keyup focus SetContent",eO.throttle),T.on(fz,p),T.on("contexttoolbar-show",E=>{let D=ey();be(D.lookupTable,E.toolbarKey).each(D=>{x([D],Ce(E.target!==T,E.target)),iN.getContent(eh).each(sq.focusIn)})}),T.on("focusout",E=>{iU.setEditorTimeout(T,()=>{Rl(D.element).isNone()&&Rl(eh.element).isNone()&&p()},0)}),T.on("SwitchMode",()=>{T.mode.isReadOnly()&&p()}),T.on("AfterProgressState",E=>{E.state?p():T.hasFocus()&&eO.throttle()}),T.on("dragstart",()=>{ex=!0}),T.on("dragend drop",()=>{ex=!1}),T.on("NodeChange",T=>{Rl(eh.element).fold(eO.throttle,b)})})},dB=(T,E)=>{let o=()=>{let D=E.getOptions(T),B=E.getCurrent(T).map(E.hash),M=Ql();return H(D,D=>({type:"togglemenuitem",text:E.display(D),onSetup:er=>{let a=T=>{T&&(M.on(T=>T.setActive(!1)),M.set(er)),er.setActive(T)};a(xe(B,E.hash(D)));let ec=E.watcher(T,D,a);return()=>{M.clear(),ec()}},onAction:()=>E.setCurrent(T,D)}))};T.ui.registry.addMenuButton(E.name,{tooltip:E.text,icon:E.icon,fetch:T=>T(o()),onSetup:E.onToolbarSetup}),T.ui.registry.addNestedMenuItem(E.name,{type:"nestedmenuitem",text:E.text,getSubmenuItems:o,onSetup:E.onMenuSetup})},uB=T=>{dB(T,{name:"lineheight",text:"Line height",icon:"line-height",getOptions:Zf,hash:T=>rD(T,["fixed","relative","empty"]).map(({value:T,unit:E})=>T+E).getOr(T),display:w,watcher:(T,E,D)=>T.formatter.formatChanged("lineheight",D,!1,{value:E}).unbind,getCurrent:T=>A.from(T.queryCommandValue("LineHeight")),setCurrent:(T,E)=>T.execCommand("LineHeight",!1,E),onToolbarSetup:bx(T),onMenuSetup:bx(T)}),A.from(lv(T)).map(E=>({name:"language",text:"Language",icon:"language",getOptions:x(E),hash:T=>ec(T.customCode)?T.code:`${T.code}/${T.customCode}`,display:T=>T.title,watcher:(T,E,D)=>{var B;return T.formatter.formatChanged("lang",D,!1,{value:E.code,customValue:null!==(B=E.customCode)&&void 0!==B?B:null}).unbind},getCurrent:T=>{let E=Fe(T.selection.getNode());return Is(E,T=>A.some(T).filter(eL).bind(T=>_t(T,"lang").map(E=>({code:E,customCode:_t(T,"data-mce-lang").getOrUndefined(),title:""}))))},setCurrent:(T,E)=>T.execCommand("Lang",!1,E),onToolbarSetup:E=>{let D=Zl();return E.setActive(T.formatter.match("lang",{},void 0,!0)),D.set(T.formatter.formatChanged("lang",E.setActive,!0)),fx(D.clear,bx(T)(E))},onMenuSetup:bx(T)})).each(E=>dB(T,E))},mB=T=>yx(T,"NodeChange",E=>{E.setEnabled(T.queryCommandState("outdent")&&T.selection.isEditable())}),gB=(T,E)=>D=>{D.setActive(E.get());let n=T=>{E.set(T.state),D.setActive(T.state)};return T.on("PastePlainTextToggle",n),fx(()=>T.off("PastePlainTextToggle",n),bx(T)(D))},pB=(T,E)=>()=>{T.execCommand("mceToggleFormat",!1,E)},hB=T=>{(T=>{gp.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(E,D)=>{T.ui.registry.addToggleButton(E.name,{tooltip:E.text,icon:E.icon,onSetup:vx(T,E.name),onAction:pB(T,E.name)})});for(let E=1;E<=6;E++){let D="h"+E;T.ui.registry.addToggleButton(D,{text:D.toUpperCase(),tooltip:"Heading "+E,onSetup:vx(T,D),onAction:pB(T,D)})}})(T),gp.each([{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"print",text:"Print",action:"mcePrint",icon:"print"}],E=>{T.ui.registry.addButton(E.name,{tooltip:E.text,icon:E.icon,onAction:wx(T,E.action)})}),gp.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],E=>{T.ui.registry.addButton(E.name,{tooltip:E.text,icon:E.icon,onSetup:bx(T),onAction:wx(T,E.action)})}),gp.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],E=>{T.ui.registry.addToggleButton(E.name,{tooltip:E.text,icon:E.icon,onAction:wx(T,E.action),onSetup:vx(T,E.name)})}),gp.each([{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"},{name:"print",text:"Print...",action:"mcePrint",icon:"print",shortcut:"Meta+P"}],E=>{T.ui.registry.addMenuItem(E.name,{text:E.text,icon:E.icon,shortcut:E.shortcut,onAction:wx(T,E.action)})}),gp.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],E=>{T.ui.registry.addMenuItem(E.name,{text:E.text,icon:E.icon,shortcut:E.shortcut,onSetup:bx(T),onAction:wx(T,E.action)})}),T.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onSetup:bx(T),onAction:pB(T,"code")})},fB=(T,E)=>yx(T,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",D=>{D.setEnabled(!T.mode.isReadOnly()&&T.undoManager[E]())}),bB=T=>yx(T,"VisualAid",E=>{E.setActive(T.hasVisual)}),vB=(T,E)=>{L([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],E=>{T.ui.registry.addToggleButton(E.name,{tooltip:E.text,icon:E.icon,onAction:wx(T,E.cmd),onSetup:vx(T,E.name)})}),T.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onSetup:bx(T),onAction:wx(T,"JustifyNone")}),hB(T),((T,E)=>{let D=$M(0,E,JM(T));T.ui.registry.addNestedMenuItem("align",{text:E.shared.providers.translate("Align"),onSetup:bx(T),getSubmenuItems:()=>D.items.validateItems(D.getStyleItems())})})(T,E),((T,E)=>{let D=$M(0,E,oD(T));T.ui.registry.addNestedMenuItem("fontfamily",{text:E.shared.providers.translate("Fonts"),onSetup:bx(T),getSubmenuItems:()=>D.items.validateItems(D.getStyleItems())})})(T,E),((T,E)=>{let D={type:"advanced",...E.styles},B=$M(0,E,mD(T,D));T.ui.registry.addNestedMenuItem("styles",{text:"Formats",onSetup:bx(T),getSubmenuItems:()=>B.items.validateItems(B.getStyleItems())})})(T,E),((T,E)=>{let D=$M(0,E,QM(T));T.ui.registry.addNestedMenuItem("blocks",{text:"Blocks",onSetup:bx(T),getSubmenuItems:()=>D.items.validateItems(D.getStyleItems())})})(T,E),((T,E)=>{let D=$M(0,E,uD(T));T.ui.registry.addNestedMenuItem("fontsize",{text:"Font sizes",onSetup:bx(T),getSubmenuItems:()=>D.items.validateItems(D.getStyleItems())})})(T,E),T.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:fB(T,"hasUndo"),onAction:wx(T,"undo")}),T.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:fB(T,"hasRedo"),onAction:wx(T,"redo")}),T.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",enabled:!1,onSetup:fB(T,"hasUndo"),onAction:wx(T,"undo")}),T.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",enabled:!1,onSetup:fB(T,"hasRedo"),onAction:wx(T,"redo")}),(T=>{T.addCommand("mceApplyTextcolor",(E,D)=>{((T,E,D)=>{T.undoManager.transact(()=>{T.focus(),T.formatter.apply(E,{value:D}),T.nodeChanged()})})(T,E,D)}),T.addCommand("mceRemoveTextcolor",E=>{((T,E)=>{T.undoManager.transact(()=>{T.focus(),T.formatter.remove(E,{value:null},void 0,!0),T.nodeChanged()})})(T,E)});let E=ur(T),D=ua(T),B=Es(E),M=Es(D);Yx(T,"forecolor","forecolor","Text color",B),Yx(T,"backcolor","hilitecolor","Background color",M),Kx(T,"forecolor","forecolor","Text color",B),Kx(T,"backcolor","hilitecolor","Background color",M)})(T),(T=>{T.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:wx(T,"mceToggleVisualAid")})})(T),(T=>{T.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:bB(T),onAction:wx(T,"mceToggleVisualAid")})})(T),T.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:mB(T),onAction:wx(T,"outdent")}),T.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onSetup:bx(T),onAction:wx(T,"indent")}),uB(T),(T=>{let E=Es(lK(T)),o=()=>T.execCommand("mceTogglePlainTextPaste");T.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:o,onSetup:gB(T,E)}),T.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:o,onSetup:gB(T,E)})})(T)},yB=T=>E(T)?T.split(/[ ,]/):T,xB=T=>E=>E.options.get(T),fq=xB("contextmenu_never_use_native"),fK=xB("contextmenu_avoid_overlap"),kB=T=>{let E=T.ui.registry.getAll().contextMenus,D=T.options.get("contextmenu");return T.options.isSet("contextmenu")?D:U(D,T=>ve(E,T))},CB=(T,E)=>({type:"makeshift",x:T,y:E}),OB=T=>"longpress"===T.type||0===T.type.indexOf("touch"),_B=(T,E)=>"contextmenu"===E.type||"longpress"===E.type?T.inline?(T=>{if(OB(T)){let E=T.touches[0];return CB(E.pageX,E.pageY)}return CB(T.pageX,T.pageY)})(E):((T,E)=>{var D,B;let M=i2.DOM.getPos(T);return D=M.x,B=M.y,CB(E.x+D,E.y+B)})(T.getContentAreaContainer(),(T=>{if(OB(T)){let E=T.touches[0];return CB(E.clientX,E.clientY)}return CB(T.clientX,T.clientY)})(E)):TB(T),TB=T=>({type:"selection",root:Fe(T.selection.getNode())}),EB=(T,E,D)=>{switch(D){case"node":return{type:"node",node:A.some(Fe(T.selection.getNode())),root:Fe(T.getBody())};case"point":return _B(T,E);case"selection":return TB(T)}},AB=(T,E,D,B,M,er)=>{let ec=D(),eu=EB(T,E,er);CO(ec,l2.CLOSE_ON_EXECUTE,B,{isHorizontalMenu:!1,search:A.none()}).map(T=>{E.preventDefault(),iN.showMenuAt(M,{anchor:eu},{menu:{markers:Ab("normal")},data:T})})},fY={onLtr:()=>[cl,sl,rl,al,il,ll,lT,cT,iT,rT,aT,sT],onRtl:()=>[cl,rl,sl,il,al,ll,lT,cT,aT,sT,iT,rT]},fZ={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},BB=(T,E,D,B,M,er)=>{let ec=Do(),eu=ec.os.isiOS(),eg=ec.os.isMacOS(),ep=ec.os.isAndroid(),eh=ec.deviceType.isTouch(),u=()=>{let ec=D();((T,E,D,B,M,er,ec)=>{let eu=((T,E,D)=>{let B=EB(T,E,D);return{bubble:gc(0,"point"===D?12:0,fZ),layouts:fY,overrides:{maxWidthFunction:hC(),maxHeightFunction:n4()},...B}})(T,E,er);CO(D,l2.CLOSE_ON_EXECUTE,B,{isHorizontalMenu:!0,search:A.none()}).map(D=>{E.preventDefault();let eg=ec?iQ.HighlightMenuAndItem:iQ.HighlightNone;iN.showMenuWithinBounds(M,{anchor:eu},{menu:{markers:Ab("normal"),highlightOnOpen:eg},data:D,type:"horizontal"},()=>A.some(KD(T,B.shared,"node"===er?"node":"selection"))),T.dispatch(fz)})})(T,E,ec,B,M,er,!(ep||eu||eg&&eh))};if((eg||eu)&&"node"!==er){let o=()=>{(T=>{let E=T.selection.getRng(),o=()=>{iU.setEditorTimeout(T,()=>{T.selection.setRng(E)},10),r()};T.once("touchend",o);let n=T=>{T.preventDefault(),T.stopImmediatePropagation()};T.on("mousedown",n,!0);let s=()=>r();T.once("longpresscancel",s);let r=()=>{T.off("touchend",o),T.off("longpresscancel",s),T.off("mousedown",n)}})(T),u()};((T,E)=>{let D=T.selection;if(D.isCollapsed()||E.touches.length<1)return!1;{let B=E.touches[0],M=D.getRng();return Jc(T.getWin(),rS.domRange(M)).exists(T=>T.left<=B.clientX&&T.right>=B.clientX&&T.top<=B.clientY&&T.bottom>=B.clientY)}})(T,E)?o():(T.once("selectionchange",o),T.once("touchend",()=>T.off("selectionchange",o)))}else u()},FB=T=>E(T)?"|"===T:"separator"===T.type,fQ={type:"separator"},RB=T=>{let t=T=>({text:T.text,icon:T.icon,enabled:T.enabled,shortcut:T.shortcut});if(E(T))return T;switch(T.type){case"separator":return fQ;case"submenu":return{type:"nestedmenuitem",...t(T),getSubmenuItems:()=>{let D=T.getSubmenuItems();return E(D)?D:H(D,RB)}};default:return{type:"menuitem",...t(T),onAction:v(T.onAction)}}},NB=(T,E)=>{if(0===E.length)return T;let D=ne(T).filter(T=>!FB(T)).fold(()=>[],T=>[fQ]);return T.concat(D).concat(E).concat([fQ])},VB=(T,E)=>!("longpress"===E.type||ve(E,"touches"))&&(2!==E.button||E.target===T.getBody()&&""===E.pointerType),zB=(T,E)=>VB(T,E)?T.selection.getStart(!0):E.target,HB=(T,D,M)=>{let er=Do().deviceType.isTouch,ec=ri(iN.sketch({dom:{tag:"div"},lazySink:D,onEscape:()=>T.focus(),onShow:()=>M.setContextMenuState(!0),onHide:()=>M.setContextMenuState(!1),fireDismissalEventInstead:{},inlineBehaviours:kl([Jp("dismissContextMenu",[Ur(oU(),(E,D)=>{rJ.close(E),T.focus()})])])})),a=()=>iN.hide(ec),i=D=>{if(fq(T)&&D.preventDefault(),D.ctrlKey&&!fq(T)||0===kB(T).length)return;let eu=((T,E)=>{let D=fK(T),B=VB(T,E)?"selection":"point";if(De(D)){let M=zB(T,E);return $w(Fe(M),D)?"node":B}return B})(T,D);(er()?BB:AB)(T,D,()=>{let M=zB(T,D),er=T.ui.registry.getAll(),ec=kB(T);return((T,D,M)=>{let er=j(D,(D,er)=>be(T,er.toLowerCase()).map(T=>{let er=T.update(M);if(E(er)&&De(eH(er)))return NB(D,er.split(" "));if(B(er)&&er.length>0){let T=H(er,RB);return NB(D,T)}return D}).getOrThunk(()=>D.concat([er])),[]);return er.length>0&&FB(er[er.length-1])&&er.pop(),er})(er.contextMenus,ec,M)},M,ec,eu)};T.on("init",()=>{let E="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(er()?"":" ResizeWindow");T.on(E,a),T.on("longpress contextmenu",i)})},f0=As([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),PB=T=>E=>E.translate(-T.left,-T.top),UB=T=>E=>E.translate(T.left,T.top),WB=T=>(E,D)=>j(T,(T,E)=>E(T),Gt(E,D)),jB=(T,E,D)=>T.fold(WB([UB(D),PB(E)]),WB([PB(E)]),WB([])),GB=(T,E,D)=>T.fold(WB([UB(D)]),WB([]),WB([UB(E)])),$B=(T,E,D)=>T.fold(WB([]),WB([PB(D)]),WB([UB(E),PB(D)])),qB=(T,E,D)=>{let B=T.fold((T,E)=>({position:A.some("absolute"),left:A.some(T+"px"),top:A.some(E+"px")}),(T,E)=>({position:A.some("absolute"),left:A.some(T-D.left+"px"),top:A.some(E-D.top+"px")}),(T,E)=>({position:A.some("fixed"),left:A.some(T+"px"),top:A.some(E+"px")}));return{right:A.none(),bottom:A.none(),...B}},XB=(T,E,D,B)=>{let s=(T,M)=>(er,ec)=>{let eu=T(E,D,B);return M(er.getOr(eu.left),ec.getOr(eu.top))};return T.fold(s($B,f1),s(GB,f2),s(jB,f3))},f1=f0.offset,f2=f0.absolute,f3=f0.fixed,ZB=(T,E)=>{let D=Ot(T,E);return ec(D)?NaN:parseInt(D,10)},QB=(T,E,D,B,M,er)=>{let ec=((T,E)=>{let D=T.element,B=ZB(D,E.leftAttr),M=ZB(D,E.topAttr);return isNaN(B)||isNaN(M)?A.none():A.some(Gt(B,M))})(T,E).fold(()=>D,T=>f3(T.left+B.left,T.top+B.top)),eu=E.mustSnap?tF(T,E,ec,M,er):oF(T,E,ec,M,er),eg=jB(ec,M,er);return((T,E,D)=>{let B=T.element;kt(B,E.leftAttr,D.left+"px"),kt(B,E.topAttr,D.top+"px")})(T,E,eg),eu.fold(()=>({coord:f3(eg.left,eg.top),extra:A.none()}),T=>({coord:T.output,extra:T.extra}))},eF=(T,E,D,B)=>re(T,T=>{let M=T.sensor,er=((T,E,D,B,M,er)=>{let ec=GB(T,M,er),eu=GB(E,M,er);return Math.abs(ec.left-eu.left)<=D&&Math.abs(ec.top-eu.top)<=B})(E,M,T.range.left,T.range.top,D,B);return er?A.some({output:XB(T.output,E,D,B),extra:T.extra}):A.none()}),tF=(T,E,D,B,M)=>{let er=E.getSnapPoints(T);return eF(er,D,B,M).orThunk(()=>{let T=j(er,(T,E)=>{let er=E.sensor,ec=((T,E,D,B,M,er)=>{let ec=GB(T,M,er),eu=GB(E,M,er),eg=Math.abs(ec.left-eu.left),ep=Math.abs(ec.top-eu.top);return Gt(eg,ep)})(D,er,E.range.left,E.range.top,B,M);return T.deltas.fold(()=>({deltas:A.some(ec),snap:A.some(E)}),D=>(ec.left+ec.top)/2<=(D.left+D.top)/2?{deltas:A.some(ec),snap:A.some(E)}:T)},{deltas:A.none(),snap:A.none()});return T.snap.map(T=>({output:XB(T.output,D,B,M),extra:T.extra}))})},oF=(T,E,D,B,M)=>{let er=E.getSnapPoints(T);return eF(er,D,B,M)};var f5=Object.freeze({__proto__:null,snapTo:(T,E,D,B)=>{let M=E.getTarget(T.element);if(E.repositionTarget){let E=et(T.element),D=Uo(E),er=wE(M),ec={coord:XB(B.output,B.output,D,er),extra:B.extra},eu=qB(ec.coord,0,er);Ft(M,eu)}}});let f9="data-initial-z-index",rF=(T,E)=>{T.getSystem().addToGui(E),(T=>{st(T.element).filter(eL).each(E=>{Nt(E,"z-index").each(T=>{kt(E,f9,T)}),Dt(E,"z-index",It(T.element,"z-index"))})})(E)},aF=T=>{(T=>{st(T.element).filter(eL).each(T=>{_t(T,f9).fold(()=>Ht(T,"z-index"),E=>Dt(T,"z-index",E)),Et(T,f9)})})(T),T.getSystem().removeFromGui(T)},iF=(T,E,D)=>T.getSystem().build(uL.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[E]},events:D}));var f4=vs("snaps",[os("getSnapPoints"),Di("onSensor"),os("leftAttr"),os("topAttr"),ys("lazyViewport",en),ys("mustSnap",!1)]);let f6=[ys("useFixed",ep),os("blockerClass"),ys("getTarget",w),ys("onDrag",b),ys("repositionTarget",!0),ys("onDrop",b),Os("getBounds",en),f4],dF=T=>{var E,D,B,M,er;return(E=Nt(T,"left"),D=Nt(T,"top"),B=Nt(T,"position"),E.isSome()&&D.isSome()&&B.isSome()?A.some((M=E.getOrDie(),er=D.getOrDie(),("fixed"===B.getOrDie()?f3:f1)(parseInt(M,10),parseInt(er,10)))):A.none()).getOrThunk(()=>{let E=Xt(T);return f2(E.left,E.top)})},uF=(T,E)=>({bounds:T.getBounds(),height:jt(E.element),width:Zt(E.element)}),mF=(T,E,D,B,M)=>{let er=D.update(B,M),ec=D.getStartData().getOrThunk(()=>uF(E,T));er.each(D=>{((T,E,D,B)=>{let M=E.getTarget(T.element);if(E.repositionTarget){let er=et(T.element),ec=Uo(er),eu=wE(M),eg=dF(M),ep=((T,E,D,B,M)=>{let er=M.bounds,ec=GB(E,D,B),eu=Yi(ec.left,er.x,er.x+er.width-M.width),eg=Yi(ec.top,er.y,er.y+er.height-M.height),ep=f2(eu,eg);return E.fold(()=>{let T=$B(ep,D,B);return f1(T.left,T.top)},x(ep),()=>{let T=jB(ep,D,B);return f3(T.left,T.top)})})(0,E.snaps.fold(()=>{var T,E;let D=(T=B.left,E=B.top,eg.fold((D,B)=>f1(D+T,B+E),(D,B)=>f2(D+T,B+E),(D,B)=>f3(D+T,B+E))),M=jB(D,ec,eu);return f3(M.left,M.top)},E=>{let D=QB(T,E,eg,B,ec,eu);return D.extra.each(D=>{E.onSensor(T,D)}),D.coord}),ec,eu,D),eh=qB(ep,0,eu);Ft(M,eh)}E.onDrag(T,M,B)})(T,E,ec,D)})},gF=(T,E,D,B)=>{E.each(aF),D.snaps.each(E=>{((T,E)=>{let D=T.element;Et(D,E.leftAttr),Et(D,E.topAttr)})(T,E)});let M=D.getTarget(T.element);B.reset(),D.onDrop(T,M)},pF=T=>(E,D)=>{let n=T=>{D.setStartData(uF(E,T))};return Hr([Ur(oI(),T=>{D.getStartData().each(()=>n(T))}),...T(E,D,n)])};var f8=Object.freeze({__proto__:null,getData:T=>A.from(Gt(T.x,T.y)),getDelta:(T,E)=>Gt(E.left-T.left,E.top-T.top)});let fF=(T,E,D)=>[Ur(tJ(),(B,M)=>{if(0!==M.event.raw.button)return;M.stop();let r=()=>gF(B,A.some(eu),T,E),er=qw(r,200),ec={drop:r,delayDrop:er.schedule,forceDrop:r,move:D=>{er.cancel(),mF(B,T,E,f8,D)}},eu=iF(B,T.blockerClass,Hr([Ur(tJ(),ec.forceDrop),Ur(tq(),ec.drop),Ur(t$(),(T,E)=>{ec.move(E.event)}),Ur(tX(),ec.delayDrop)]));D(B),rF(B,eu)})],f7=[...f6,Ri("dragger",{handlers:pF(fF)})];var bo=Object.freeze({__proto__:null,getData:T=>{let E=T.raw.touches;return 1===E.length?(T=>{let E=T[0];return A.some(Gt(E.clientX,E.clientY))})(E):A.none()},getDelta:(T,E)=>Gt(E.left-T.left,E.top-T.top)});let yF=(T,E,D)=>{let B=Ql(),s=D=>{gF(D,B.get(),T,E),B.clear()};return[Ur(tP(),(M,er)=>{var ec;er.stop();let i=()=>s(M),eu=iF(M,T.blockerClass,(ec={drop:i,delayDrop:b,forceDrop:i,move:D=>{mF(M,T,E,bo,D)}},Hr([Ur(tP(),ec.forceDrop),Ur(tW(),ec.drop),Ur(tG(),ec.drop),Ur(tj(),(T,E)=>{ec.move(E.event)})])));B.set(eu),D(M),rF(M,eu)}),Ur(tj(),(D,B)=>{B.stop(),mF(D,T,E,bo,B.event)}),Ur(tW(),(T,E)=>{E.stop(),s(T)}),Ur(tG(),s)]},bn=[...f6,Ri("dragger",{handlers:pF(yF)})],br=[...f6,Ri("dragger",{handlers:pF((T,E,D)=>[...fF(T,E,D),...yF(T,E,D)])})];var bd=Object.freeze({__proto__:null,mouse:f7,touch:bn,mouseOrTouch:br}),bg=Object.freeze({__proto__:null,init:()=>{let T=A.none(),E=A.none(),D=x({});return _a({readState:D,reset:()=>{T=A.none(),E=A.none()},update:(E,D)=>E.getData(D).bind(D=>((E,D)=>{let B=T.map(T=>E.getDelta(T,D));return T=A.some(D),B})(E,D)),getStartData:()=>E,setStartData:T=>{E=A.some(T)}})}});let bp=Tl({branchKey:"mode",branches:bd,name:"dragging",active:{events:(T,E)=>T.dragger.handlers(T,E)},extra:{snap:T=>({sensor:T.sensor,range:T.range,output:T.output,extra:A.from(T.extra)})},state:bg,apis:f5}),_F=(T,E,D,B,M,er)=>T.fold(()=>bp.snap({sensor:f2(D-20,B-20),range:Gt(M,er),output:f2(A.some(D),A.some(B)),extra:{td:E}}),T=>{let M=D-20,er=B-20,ec=T.element.dom.getBoundingClientRect();return bp.snap({sensor:f2(M,er),range:Gt(40,40),output:f2(A.some(D-ec.width/2),A.some(B-ec.height/2)),extra:{td:E}})}),TF=(T,E,D)=>({getSnapPoints:T,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:(T,B)=>{let M=B.td;E.get().exists(T=>Ze(T,M))||(E.set(M),D(M))},mustSnap:!0}),EF=T=>jh(iL.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:kl([bp.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:T}),u8.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}})),AF=(T,E)=>{let D=Es([]),B=Es([]),M=Es(!1),er=Ql(),ec=Ql(),i=T=>{let D=Zo(T);return _F(ep.getOpt(E),T,D.x,D.y,D.width,D.height)},l=T=>{let D=Zo(T);return _F(eh.getOpt(E),T,D.right,D.bottom,D.width,D.height)},eu=TF(()=>H(D.get(),T=>i(T)),er,E=>{ec.get().each(D=>{T.dispatch("TableSelectorChange",{start:E,finish:D})})}),eg=TF(()=>H(B.get(),T=>l(T)),ec,E=>{er.get().each(D=>{T.dispatch("TableSelectorChange",{start:D,finish:E})})}),ep=EF(eu),eh=EF(eg),ey=ri(ep.asSpec()),ex=ri(eh.asSpec()),h=(E,D,B,M)=>{let er=B(D);bp.snapTo(E,er),((E,D,B,er)=>{let ec=D.dom.getBoundingClientRect();Ht(E.element,"display");let eu=nt(Fe(T.getBody())).dom.innerHeight,eg=ec[M]<0,ep=ec[M]>eu;(eg||ep)&&Dt(E.element,"display","none")})(E,D)},f=T=>h(ey,T,i,"top"),b=T=>h(ex,T,l,"bottom");Do().deviceType.isTouch()&&(T.on("TableSelectionChange",T=>{M.get()||(Ad(E,ey),Ad(E,ex),M.set(!0)),er.set(T.start),ec.set(T.finish),T.otherCells.each(E=>{D.set(E.upOrLeftCells),B.set(E.downOrRightCells),f(T.start),b(T.finish)})}),T.on("ResizeEditor ResizeWindow ScrollContent",()=>{er.get().each(f),ec.get().each(b)}),T.on("TableSelectionClear",()=>{M.get()&&(Bd(ey),Bd(ex),M.set(!1)),er.clear(),ec.clear()}))},MF=(T,E,D)=>{var B;let M=null!==(B=E.delimiter)&&void 0!==B?B:"›";return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:kl([sq.config({mode:"flow",selector:"div[role=button]"}),a$.config({disabled:D.isDisabled}),Sy(),uJ.config({}),sY.config({}),Jp("elementPathEvents",[oX((E,B)=>{T.shortcuts.add("alt+F11","focus statusbar elementpath",()=>sq.focusIn(E)),T.on("NodeChange",B=>{let er=(E=>{var D;let B=[],M=E.length;for(;M-- >0;){let er=E[M];if(1===er.nodeType&&"BR"!==(D=er).nodeName&&!D.getAttribute("data-mce-bogus")&&"bookmark"!==D.getAttribute("data-mce-type")){let E=hx(T,er);if(E.isDefaultPrevented()||B.push({name:E.name,element:er}),E.isPropagationStopped())break}}return B})(B.parents),ec=er.length>0?j(er,(E,B,er)=>{var ec,eu;let eg=(ec=B.name,eu=B.element,iL.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{"data-index":er,"aria-level":er+1}},components:[ti(ec)],action:E=>{T.focus(),T.selection.select(eu),T.nodeChanged()},buttonBehaviours:kl([ky(D.isDisabled),Sy()])}));return 0===er?E.concat([eg]):E.concat([{dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0}},components:[ti(` ${M} `)]},eg])},[]):[];sY.set(E,ec)})})])]),components:[]}};(yO=yE||(yE={}))[yO.None=0]="None",yO[yO.Both=1]="Both",yO[yO.Vertical=2]="Vertical";let BF=(T,E,D)=>{let B=Fe(T.getContainer()),M=((T,E,D,B,M)=>{let er={height:zD(B+E.top,i7(T),lr(T))};return D===yE.Both&&(er.width=zD(M+E.left,i8(T),lo(T))),er})(T,E,D,Wt(B),Jt(B));le(M,(T,E)=>{eg(T)&&Dt(B,E,VD(T))}),(T=>{T.dispatch("ResizeEditor")})(T)},FF=(T,E,D,B)=>{let M=Gt(20*D,20*B);return BF(T,M,E),A.some(!0)},IF=(T,E)=>{let o=()=>{let D=[],B=lQ(T),M=l$(T),er=lX(T)||T.hasPlugin("wordcount");return M&&D.push(MF(T,{},E)),B&&D.push((()=>{let T=Iy("Alt+0");return{dom:{tag:"div",classes:["tox-statusbar__help-text"]},components:[ti(iz.translate(["Press {0} for help",T]))]}})()),er&&D.push((()=>{let D=[];return T.hasPlugin("wordcount")&&D.push(((T,E)=>{let o=(T,D,B)=>sY.set(T,[ti(E.translate(["{0} "+B,D[B]]))]);return iL.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:kl([ky(E.isDisabled),Sy(),uJ.config({}),sY.config({}),r5.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Jp("wordcount-events",[oY(T=>{let E=r5.getValue(T),D="words"===E.mode?"characters":"words";r5.setValue(T,{mode:D,count:E.count}),o(T,E.count,D)}),oX(E=>{T.on("wordCountUpdate",T=>{let{mode:D}=r5.getValue(E);r5.setValue(E,{mode:D,count:T.wordCount}),o(E,T.wordCount,D)})})])]),eventOrder:{[of()]:["disabling","alloy.base.behaviour","wordcount-events"]}})})(T,E)),lX(T)&&D.push({dom:{tag:"span",classes:["tox-statusbar__branding"]},components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/powered-by-tiny?utm_campaign=editor_referral&utm_medium=poweredby&utm_source=tinymce&utm_content=v6",rel:"noopener",target:"_blank","aria-label":iz.translate(["Powered by {0}","Tiny"])},innerHtml:'<svg width="50px" height="16px" viewBox="0 0 50 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.143 0c2.608.015 5.186 2.178 5.186 5.331 0 0 .077 3.812-.084 4.87-.361 2.41-2.164 4.074-4.65 4.496-1.453.284-2.523.49-3.212.623-.373.071-.634.122-.785.152-.184.038-.997.145-1.35.145-2.732 0-5.21-2.04-5.248-5.33 0 0 0-3.514.03-4.442.093-2.4 1.758-4.342 4.926-4.963 0 0 3.875-.752 4.036-.782.368-.07.775-.1 1.15-.1Zm1.826 2.8L5.83 3.989v2.393l-2.455.475v5.968l6.137-1.189V9.243l2.456-.476V2.8ZM5.83 6.382l3.682-.713v3.574l-3.682.713V6.382Zm27.173-1.64-.084-1.066h-2.226v9.132h2.456V7.743c-.008-1.151.998-2.064 2.149-2.072 1.15-.008 1.987.92 1.995 2.072v5.065h2.455V7.359c-.015-2.18-1.657-3.929-3.837-3.913a3.993 3.993 0 0 0-2.908 1.296Zm-6.3-4.266L29.16 0v2.387l-2.456.475V.476Zm0 3.2v9.132h2.456V3.676h-2.456Zm18.179 11.787L49.11 3.676H46.58l-1.612 4.527-.46 1.382-.384-1.382-1.611-4.527H39.98l3.3 9.132L42.15 16l2.732-.537ZM22.867 9.738c0 .752.568 1.075.921 1.075.353 0 .668-.047.998-.154l.537 1.765c-.23.154-.92.537-2.225.537-1.305 0-2.655-.997-2.686-2.686a136.877 136.877 0 0 1 0-4.374H18.8V3.676h1.612v-1.98l2.455-.476v2.456h2.302V5.9h-2.302v3.837Z"/>\n</svg>\n'.trim()},behaviours:kl([s1.config({})])}]}),{dom:{tag:"div",classes:["tox-statusbar__right-container"]},components:D}})()),D.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container",...(()=>{let T="tox-statusbar__text-container--flex-start",E="tox-statusbar__text-container--flex-end";if(B){let D="tox-statusbar__text-container-3-cols";return er||M?er&&!M?[D,E]:[D,T]:[D,"tox-statusbar__text-container--space-around"]}return[er&&!M?E:T]})()]},components:D}]:[]};return{dom:{tag:"div",classes:["tox-statusbar"]},components:(()=>{let D=o(),B=((T,E)=>{let D=(T=>{let E=lq(T);return!1===E?yE.None:"both"===E?yE.Both:yE.Vertical})(T);if(D===yE.None)return A.none();let B=D===yE.Both?"Press the arrow keys to resize the editor.":"Press the Up and Down arrow keys to resize the editor.";return A.some(ef("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:E.translate("Resize"),"aria-label":E.translate(B)},behaviours:[bp.config({mode:"mouse",repositionTarget:!1,onDrag:(E,B,M)=>BF(T,M,D),blockerClass:"tox-blocker"}),sq.config({mode:"special",onLeft:()=>FF(T,D,-1,0),onRight:()=>FF(T,D,1,0),onUp:()=>FF(T,D,0,-1),onDown:()=>FF(T,D,0,1)}),uJ.config({}),s1.config({})]},E.icons))})(T,E);return D.concat(B.toArray())})()}},RF=(T,E)=>E.get().getOrDie(`UI for ${T} has not been rendered`),NF=(T,E)=>{let D=T.inline,B=D?fL:fH,M=ib(T)?p3:pJ,er=(()=>{let T=Ql(),E=Ql(),D=Ql();return{dialogUi:T,popupUi:E,mainUi:D,getUiMotherships:()=>{let D=T.get().map(T=>T.mothership),B=E.get().map(T=>T.mothership);return D.fold(()=>B.toArray(),T=>B.fold(()=>[T],E=>Ze(T.element,E.element)?[T]:[T,E]))},lazyGetInOuterOrDie:(T,E)=>()=>D.get().bind(T=>E(T.outerContainer)).getOrDie(`Could not find ${T} element in OuterContainer`)}})(),ec=Ql(),eu=Ql(),eg=Ql(),ep=Do().deviceType.isTouch()?["tox-platform-touch"]:[],eh=ob(T),ey=lA(T),ex=jh({dom:{tag:"div",classes:["tox-anchorbar"]}}),eO=jh({dom:{tag:"div",classes:["tox-bottom-anchorbar"]}}),p=()=>er.mainUi.get().map(T=>T.outerContainer).bind(h6.getHeader),eD=er.lazyGetInOuterOrDie("anchor bar",ex.getOpt),eR=er.lazyGetInOuterOrDie("bottom anchor bar",eO.getOpt),eH=er.lazyGetInOuterOrDie("toolbar",h6.getToolbar),eN=er.lazyGetInOuterOrDie("throbber",h6.getThrobber),eU=((T,E,D,B)=>{let M=Es(!1),er=(T=>{let E=Es(ob(T)?"bottom":"top");return{isPositionedAtTop:()=>"top"===E.get(),getDockingMode:E.get,setDockingMode:E.set}})(E),ec={icons:()=>E.ui.registry.getAll().icons,menuItems:()=>E.ui.registry.getAll().menuItems,translate:iz.translate,isDisabled:()=>E.mode.isReadOnly()||!E.ui.isEnabled(),getOption:E.options.get},eu=rE(E),eg=(T=>{let t=E=>()=>T.formatter.match(E),o=E=>()=>{let D=T.formatter.get(E);return void 0!==D?A.some({tag:D.length>0&&(D[0].inline||D[0].block)||"div",styles:T.dom.parseStyle(T.formatter.getCssText(E))}):A.none()},E=Es([]),D=Es([]),B=Es(!1);return T.on("PreInit",D=>{let B=BT(T),M=IT(T,B,t,o);E.set(M)}),T.on("addStyleModifications",E=>{let M=IT(T,E.items,t,o);D.set(M),B.set(E.replace)}),{getData:()=>{let T=B.get()?[]:E.get(),M=D.get();return T.concat(M)}}})(E),ep={colorPicker:kT(E),hasCustomColors:CT(E),getColors:OT(E),getColorCols:_T(E)},eh={isDraggableModal:TT(E)},ey={shared:{providers:ec,anchors:ST(E,D,B,er.isPositionedAtTop),header:er},urlinput:eu,styles:eg,colorinput:ep,dialog:eh,isContextMenuOpen:()=>M.get(),setContextMenuState:T=>M.set(T)},ex={...ey,shared:{...ey.shared,interpreter:T=>K_(T,{},ex),getSink:T.popup}},eO={...ey,shared:{...ey.shared,interpreter:T=>K_(T,{},eO),getSink:T.dialog}};return{popup:ex,dialog:eO}})({popup:()=>tx.fromOption(er.popupUi.get().map(T=>T.sink),"(popup) UI has not been rendered"),dialog:()=>tx.fromOption(er.dialogUi.get().map(T=>T.sink),"UI has not been rendered")},T,eD,eR),x=()=>{let E=(()=>{let E={attributes:{[n8]:eh?iY.BottomToTop:iY.TopToBottom}},D=h6.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:eU.popup,onEscape:()=>{T.focus()}}),B=h6.parts.toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:eU.popup.shared.getSink,providers:eU.popup.shared.providers,onEscape:()=>{T.focus()},onToolbarToggled:E=>{((T,E)=>{T.dispatch("ToggleToolbarDrawer",{state:E})})(T,E)},type:ey,lazyToolbar:eH,lazyHeader:()=>p().getOrDie("Could not find header element"),...E}),M=h6.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:eU.popup.shared.providers,onEscape:()=>{T.focus()},type:ey}),er=tb(T),ec=Qf(T),eu=Kf(T),eg=lZ(T),ep=h6.parts.promotion({dom:{tag:"div",classes:["tox-promotion"]}}),eO=er||ec||eu,eD=eg?[ep,D]:[D];return h6.parts.header({dom:{tag:"div",classes:["tox-editor-header"].concat(eO?[]:["tox-editor-header--empty"]),...E},components:q([eu?eD:[],er?[M]:ec?[B]:[],sb(T)?[]:[ex.asSpec()]]),sticky:ib(T),editor:T,sharedBackstage:eU.popup.shared})})(),B={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[h6.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),h6.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}})]},M=h6.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:eU.popup}),er=h6.parts.viewWrapper({backstage:eU.popup}),eu=lJ(T)&&!D?A.some(IF(T,eU.popup.shared.providers)):A.none(),eg=q([eh?[]:[E],D?[]:[B],eh?[E]:[]]),eD=h6.parts.editorContainer({components:q([eg,D?[]:[eO.asSpec(),...eu.toArray()]])}),eI=ab(T),eR={role:"application",...iz.isRtl()?{dir:"rtl"}:{},...eI?{"aria-hidden":"true"}:{}},eN=ri(h6.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(D?["tox-tinymce-inline"]:[]).concat(eh?["tox-tinymce--toolbar-bottom"]:[]).concat(ep),styles:{visibility:"hidden",...eI?{opacity:"0",border:"0"}:{}},attributes:eR},components:[eD,...D?[]:[er],M],behaviours:kl([Sy(),a$.config({disableClass:"tox-tinymce--disabled"}),sq.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),eL=nS(eN);return ec.set(eL),{mothership:eL,outerContainer:eN}},w=E=>{let D=VD((T=>{let E=(T=>{let E=i4(T),D=i7(T),B=lr(T);return ND(E).map(T=>zD(T,D,B))})(T);return E.getOr(i4(T))})(T)),B=VD(HD(T).getOr(i6(T)));return T.inline||(zt("div","width",B)&&Dt(E.element,"width",B),zt("div","height",D)?Dt(E.element,"height",D):Dt(E.element,"height","400px")),D};return{popups:{backstage:eU.popup,getMothership:()=>RF("popups",eg)},dialogs:{backstage:eU.dialog,getMothership:()=>RF("dialogs",eu)},renderUI:()=>{let D=x(),ec=(()=>{let E=rb(T),D=Ze(xt(),E)&&"grid"===It(E,"display"),B={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(ep),attributes:{...iz.isRtl()?{dir:"rtl"}:{}}},behaviours:kl([rz.config({useFixed:()=>M.isDocked(p)})])},er={dom:{styles:{width:document.body.clientWidth+"px"}},events:Hr([Ur(oR(),T=>{Dt(T.element,"width",document.body.clientWidth+"px")})])},ec=ri(tw(B,D?er:{})),eg=nS(ec);return eu.set(eg),{sink:ec,mothership:eg}})(),eh=lb(T)?(()=>{let T={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-silver-popup-sink","tox-tinymce-aux"].concat(ep),attributes:{...iz.isRtl()?{dir:"rtl"}:{}}},behaviours:kl([rz.config({useFixed:()=>M.isDocked(p),getBounds:()=>E.getPopupSinkBounds()})])},D=ri(T),B=nS(D);return eg.set(B),{sink:D,mothership:B}})():(eg.set(ec.mothership),ec);return er.dialogUi.set(ec),er.popupUi.set(eh),er.mainUi.set(D),(E=>{var D;let{mainUi:er,popupUi:ec,uiMotherships:eu}=E;ce(lS(T),(E,D)=>{T.ui.registry.addGroupToolbarButton(D,E)});let{buttons:eg,menuItems:ep,contextToolbars:eh,sidebars:ex,views:eO}=T.ui.registry.getAll(),eD=eb(T),eR={menuItems:ep,menus:cb(T),menubar:lR(T),toolbar:eD.getOrThunk(()=>lH(T)),allowToolbarGroups:ey===i0.floating,buttons:eg,sidebar:ex,views:eO};D=er.outerContainer,T.addShortcut("alt+F9","focus menubar",()=>{h6.focusMenubar(D)}),T.addShortcut("alt+F10","focus toolbar",()=>{h6.focusToolbar(D)}),T.addCommand("ToggleToolbarDrawer",(T,E)=>{(null==E?void 0:E.skipFocus)?h6.toggleToolbarDrawerWithoutFocusing(D):h6.toggleToolbarDrawer(D)}),T.addQueryStateHandler("ToggleToolbarDrawer",()=>h6.isToolbarDrawerToggled(D)),((T,E,D)=>{let n=(T,B)=>{L([E,...D],E=>{E.broadcastEvent(T,B)})},s=(T,B)=>{L([E,...D],E=>{E.broadcastOn([T],B)})},r=T=>s(r$(),{target:T.target}),B=$o(),M=tc(B,"touchstart",r),er=tc(B,"touchmove",T=>n(oO(),T)),ec=tc(B,"touchend",T=>n(oC(),T)),eu=tc(B,"mousedown",r),eg=tc(B,"mouseup",T=>{0===T.raw.button&&s(rq(),{target:T.target})}),m=T=>s(r$(),{target:Fe(T.target)}),g=T=>{0===T.button&&s(rq(),{target:Fe(T.target)})},p=()=>{L(T.editorManager.get(),E=>{T!==E&&E.dispatch("DismissPopups",{relatedTarget:T})})},h=T=>n(oI(),Bo(T)),f=T=>{s(rX(),{}),n(oR(),Bo(T))},ep=eJ(Fe(T.getElement())),eh=oc(ep,"scroll",D=>{requestAnimationFrame(()=>{if(null!=T.getContainer()){let B=jw(T,E.element).map(T=>[T.element,...T.others]).getOr([]);N(B,T=>Ze(T,D.target))&&(T.dispatch("ElementScroll",{target:D.target.dom}),n(oj(),D))}})}),y=()=>s(rX(),{}),x=E=>{E.state&&s(r$(),{target:Fe(T.getContainer())})},w=T=>{s(r$(),{target:Fe(T.relatedTarget.getContainer())})};T.on("PostRender",()=>{T.on("click",m),T.on("tap",m),T.on("mouseup",g),T.on("mousedown",p),T.on("ScrollWindow",h),T.on("ResizeWindow",f),T.on("ResizeEditor",y),T.on("AfterProgressState",x),T.on("DismissPopups",w)}),T.on("remove",()=>{T.off("click",m),T.off("tap",m),T.off("mouseup",g),T.off("mousedown",p),T.off("ScrollWindow",h),T.off("ResizeWindow",f),T.off("ResizeEditor",y),T.off("AfterProgressState",x),T.off("DismissPopups",w),eu.unbind(),M.unbind(),er.unbind(),ec.unbind(),eg.unbind(),eh.unbind()}),T.on("detach",()=>{L([E,...D],Vd),L([E,...D],T=>T.destroy())})})(T,er.mothership,eu),M.setup(T,eU.popup.shared,p),vB(T,eU.popup),HB(T,eU.popup.shared.getSink,eU.popup),(T=>{let{sidebars:E}=T.ui.registry.getAll();L(eI(E),D=>{let B=E[D],s=()=>xe(A.from(T.queryCommandValue("ToggleSidebar")),D);T.ui.registry.addToggleButton(D,{icon:B.icon,tooltip:B.tooltip,onAction:E=>{T.execCommand("ToggleSidebar",!1,D),E.setActive(s())},onSetup:E=>{E.setActive(s());let o=()=>E.setActive(s());return T.on("ToggleSidebar",o),()=>{T.off("ToggleSidebar",o)}}})})})(T),EA(T,eN,eU.popup.shared),cB(T,eh,ec.sink,{backstage:eU.popup}),AF(T,ec.sink);let eH={targetNode:T.getElement(),height:w(er.outerContainer)};return B.render(T,E,eR,eU.popup,eH)})({popupUi:eh,dialogUi:ec,mainUi:D,uiMotherships:er.getUiMotherships()})}}},bf=x([os("lazySink"),us("dragBlockClass"),Os("getBounds",en),ys("useTabstopAt",eh),ys("firstTabstop",0),ys("eventOrder",{}),hu("modalBehaviours",[sq]),Bi("onExecute"),Ii("onEscape")]),bb={sketch:w},bv=x([aE({name:"draghandle",overrides:(T,E)=>({behaviours:kl([bp.config({mode:"mouse",getTarget:T=>mi(T,'[role="dialog"]').getOr(T),blockerClass:T.dragBlockClass.getOrDie(Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(E,null,2)).message),getBounds:T.getDragBounds})])})}),aC({schema:[os("dom")],name:"title"}),aC({factory:bb,schema:[os("dom")],name:"close"}),aC({factory:bb,schema:[os("dom")],name:"body"}),aE({factory:bb,schema:[os("dom")],name:"footer"}),a_({factory:{sketch:(T,E)=>({...T,dom:E.dom,components:E.components})},schema:[ys("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),ys("components",[])],name:"blocker"})]),by=bm({name:"ModalDialog",configFields:bf(),partFields:bv(),factory:(T,E,D,B)=>{let M=Ql(),er=la("modal-events"),ec={...T.eventOrder,[oH()]:[er].concat(T.eventOrder["alloy.system.attached"]||[])};return{uid:T.uid,dom:T.dom,components:E,apis:{show:E=>{M.set(E);let D=T.lazySink(E).getOrDie(),er=B.blocker(),ec=D.getSystem().build({...er,components:er.components.concat([Sa(E)]),behaviours:kl([s1.config({}),Jp("dialog-blocker-events",[Yr(tY(),()=>{hv.isBlocked(E)||sq.focusIn(E)})])])});Ad(D,ec),sq.focusIn(E)},hide:T=>{M.clear(),st(T.element).each(E=>{T.getSystem().getByDom(E).each(T=>{Bd(T)})})},getBody:E=>nm(E,T,"body"),getFooter:E=>om(E,T,"footer"),setIdle:T=>{hv.unblock(T)},setBusy:(T,E)=>{hv.block(T,E)}},eventOrder:ec,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:bu(T.modalBehaviours,[sY.config({}),sq.config({mode:"cyclic",onEnter:T.onExecute,onEscape:T.onEscape,useTabstopAt:T.useTabstopAt,firstTabstop:T.firstTabstop}),hv.config({getRoot:M.get}),Jp(er,[oX(E=>{((T,E)=>{let D=_t(T,"id").fold(()=>{let T=la("dialog-label");return kt(E,"id",T),T},w);kt(T,"aria-labelledby",D)})(E.element,nm(E,T,"title").element)})])])}},apis:{show:(T,E)=>{T.show(E)},hide:(T,E)=>{T.hide(E)},getBody:(T,E)=>T.getBody(E),getFooter:(T,E)=>T.getFooter(E),setBusy:(T,E,D)=>{T.setBusy(E,D)},setIdle:(T,E)=>{T.setIdle(E)}}}),bS=Dn([cO,c_].concat(dS)),bC=[Ev("button"),cW,ks("align","end",["start","end"]),cZ,cY,hs("buttonType",["primary","secondary"])],bE=[...bC,cF],bD=[as("type",["submit","cancel","custom"]),...bE],bF=[as("type",["menu"]),cj,cG,cW,ds("items",bS),...bC],bM=[...bC,as("type",["togglebutton"]),rs("tooltip"),cW,cj,Cs("active",!1)],bI=Jn("type",{submit:bD,cancel:bD,custom:bD,menu:bF,togglebutton:bM}),bR=[cO,cF,as("level",["info","warn","error","success"]),cI,ys("url","")],bH=Dn(bR),bN=[cO,cF,cY,Ev("button"),cW,cK,hs("buttonType",["primary","secondary","toolbar"]),cZ],bU=Dn(bN),bL=[cO,c_],bz=bL.concat([cJ]),bP=bL.concat([cE,cY]),bj=Dn(bP),bW=bz.concat([Cv("auto")]),bG=Dn(bW),bJ=tM([cR,cF,cI]),b$=bz.concat([Ss("storageKey","default")]),bX=Dn(b$),bq=Dn(bz),bK=bL.concat([Ss("tag","textarea"),rs("scriptId"),rs("scriptUrl"),xs("settings",void 0,tL)]),bY=bL.concat([Ss("tag","textarea"),is("init")]),bZ=Gn(T=>qn("customeditor.old",Mn(bY),T).orThunk(()=>qn("customeditor.new",Mn(bK),T))),bQ=Dn(bz),b0=Bn(tC),vI=T=>[cO,ss("columns"),T],b1=[cO,rs("html"),ks("presets","presentation",["presentation","document"])],b2=Dn(b1),b3=bz.concat([Cs("border",!1),Cs("sandboxed",!0),Cs("streamContent",!1),Cs("transparent",!0)]),b5=Dn(b3),b9=Dn(bL.concat([ps("height")])),b4=Dn([rs("url"),gs("zoom"),gs("cachedWidth"),gs("cachedHeight")]),b6=bz.concat([ps("inputMode"),ps("placeholder"),Cs("maximized",!1),cY]),b8=Dn(b6),AI=T=>[cO,cE,T,ks("align","start",["start","center","end"])],b7=[cF,cR],vo=[cF,ds("items",Zn(0,()=>vr))],vr=Fn([Dn(b7),Dn(vo)]),va=bz.concat([ds("items",vr),cY]),vl=Dn(va),vc=bz.concat([cs("items",[cF,cR]),ws("size",1),cY]),vd=Dn(vc),vu=bz.concat([Cs("constrain",!0),cY]),vg=Dn(vu),vp=Dn([rs("width"),rs("height")]),vh=bL.concat([cE,ws("min",0),ws("max",0)]),vf=Dn(vh),vb=[cO,ds("header",tH),ds("cells",Bn(tH))],vv=Dn(vb),vy=bz.concat([ps("placeholder"),Cs("maximized",!1),cY]),vw=Dn(vy),vS=[as("type",["directory","leaf"]),cM,rs("id"),ms("menu",p4)],vO=Dn(vS),vC=vS.concat([ds("children",Zn(0,()=>jn("type",{directory:vE,leaf:vO})))]),vE=Dn(vC),vF=jn("type",{directory:vE,leaf:vO}),vM=[cO,ds("items",vF),fs("onLeafAction"),fs("onToggleExpand"),_s("defaultExpandedIds",[],tH),ps("defaultSelectedId")],vH=Dn(vM),vN=bz.concat([ks("filetype","file",["image","media","file"]),cY]),vV=Dn(vN),vU=Dn([cR,cQ]),aR=T=>gn("items","items",{tag:"required",process:{}},Bn(Gn(E=>qn(`Checking item of ${T}`,vL,E).fold(T=>tx.error(Kn(T)),T=>tx.value(T))))),vL=En(()=>jn("type",{alertbanner:bH,bar:Dn([cO,aR("bar")]),button:bU,checkbox:bj,colorinput:bX,colorpicker:bq,dropzone:bQ,grid:Dn(vI(aR("grid"))),iframe:b5,input:b8,listbox:vl,selectbox:vd,sizeinput:vg,slider:vf,textarea:vw,urlinput:vV,customeditor:bZ,htmlpanel:b2,imagepreview:b9,collection:bG,label:Dn(AI(aR("label"))),table:vv,tree:vH,panel:vP})),vz=[cO,ys("classes",[]),ds("items",vL)],vP=Dn(vz),vj=[Ev("tab"),cM,ds("items",vL)],vW=[cO,cs("tabs",vj)],vG=Dn(vW),vJ=Dn([rs("title"),ns("body",jn("type",{panel:vP,tabpanel:vG})),Ss("size","normal"),_s("buttons",[],bI),ys("initialData",{}),Os("onAction",b),Os("onChange",b),Os("onSubmit",b),Os("onClose",b),Os("onCancel",b),Os("onTabChange",b)]),v$=Dn([as("type",["cancel","custom"]),...bE]),vX=Dn([rs("title"),rs("url"),gs("height"),gs("width"),bs("buttons",v$),Os("onAction",b),Os("onCancel",b),Os("onClose",b),Os("onMessage",b)]),vR=T=>D(T)?[T].concat(X(fe(T),vR)):B(T)?X(T,vR):[],yR=T=>E(T.type)&&E(T.name),vq={checkbox:tN,colorinput:tH,colorpicker:tH,dropzone:b0,input:tH,iframe:tH,imagepreview:b4,selectbox:tH,sizeinput:vp,slider:tR,listbox:tH,size:vp,textarea:tH,urlinput:vU,customeditor:tH,collection:bJ,togglemenuitem:tN},wR=T=>{let E=U(vR(T),yR),D=X(E,T=>A.from(vq[T.type]).fold(()=>[],E=>[ns(T.name,E)]));return Dn(D)},SR=T=>{var E;return{internalDialog:Xn(qn("dialog",vJ,T)),dataValidator:wR(T),initialData:null!==(E=T.initialData)&&void 0!==E?E:{}}},vK={open:(T,E)=>{let D=SR(E);return T(D.internalDialog,D.initialData,D.dataValidator)},openUrl:(T,E)=>T(Xn(qn("dialog",vX,E))),redial:T=>SR(T)};var vY=Object.freeze({__proto__:null,events:(T,E)=>{let o=(D,B)=>{T.updateState.each(T=>{let M=T(D,B);E.set(M)}),T.renderComponents.each(M=>{let er=M(B,E.get());(T.reuseDom?Wp:Up)(D,er)})};return Hr([Ur(oh(),(E,D)=>{if(!D.universal){let B=T.channel;R(D.channels,B)&&o(E,D.data)}}),oX((E,D)=>{T.initialData.each(T=>{o(E,T)})})])}}),vZ=Object.freeze({__proto__:null,getState:(T,E,D)=>D}),vQ=[os("channel"),us("renderComponents"),us("updateState"),us("initialData"),Cs("reuseDom",!0)];let v0=Ol({fields:vQ,name:"reflecting",active:vY,apis:vZ,state:Object.freeze({__proto__:null,init:()=>{let T=Es(A.none());return{readState:()=>T.get().getOr("none"),get:T.get,set:T.set,clear:()=>T.set(A.none())}}})}),ER=T=>{let E=[],D={};return le(T,(T,B)=>{T.fold(()=>{E.push(B)},T=>{D[B]=T})}),E.length>0?tx.error(E):tx.value(D)},AR=(T,E,D)=>{let B=jh(m4.sketch(B=>({dom:{tag:"div",classes:["tox-form"].concat(T.classes)},components:H(T.items,T=>X_(B,T,E,D))})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[B.asSpec()]}],behaviours:kl([sq.config({mode:"acyclic",useTabstopAt:C(XC)}),aP.config({find:B.getOpt}),IC(B,{postprocess:T=>ER(T).fold(T=>(console.error(T),{}),w)}),Jp("dialog-body-panel",[Ur(tY(),(T,E)=>{T.getSystem().broadcastOn([gC],{newFocus:A.some(E.event.target)})})])])}},v1=fm({name:"TabButton",configFields:[ys("uid",void 0),os("value"),gn("dom","dom",xn(()=>({attributes:{role:"tab",id:la("aria"),"aria-selected":"false"}})),tI()),us("action"),ys("domModification",{}),hu("tabButtonBehaviours",[s1,sq,r5]),os("view")],factory:(T,E)=>({uid:T.uid,dom:T.dom,components:T.components,events:mh(T.action),behaviours:bu(T.tabButtonBehaviours,[s1.config({}),sq.config({mode:"execution",useSpace:!0,useEnter:!0}),r5.config({store:{mode:"memory",initialValue:T.value}})]),domModification:T.domModification})}),v2=x([os("tabs"),os("dom"),ys("clickToDismiss",!1),hu("tabbarBehaviours",[aK,sq]),Ai(["tabClass","selectedClass"])]),v3=aD({factory:v1,name:"tabs",unit:"tab",overrides:T=>{let t=(T,E)=>{aK.dehighlight(T,E),Ir(T,oG(),{tabbar:T,button:E})},o=(T,E)=>{aK.highlight(T,E),Ir(T,oW(),{tabbar:T,button:E})};return{action:E=>{let D=E.getSystem().getByUid(T.uid).getOrDie(),B=aK.isHighlighted(D,E);(B&&T.clickToDismiss?t:B?b:o)(D,E)},domModification:{classes:[T.markers.tabClass]}}}}),v5=x([v3]),v9=bm({name:"Tabbar",configFields:v2(),partFields:v5(),factory:(T,E,D,B)=>({uid:T.uid,dom:T.dom,components:E,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:bu(T.tabbarBehaviours,[aK.config({highlightClass:T.markers.selectedClass,itemClass:T.markers.tabClass,onHighlight:(T,E)=>{kt(E.element,"aria-selected","true")},onDehighlight:(T,E)=>{kt(E.element,"aria-selected","false")}}),sq.config({mode:"flow",getInitial:T=>aK.getHighlighted(T).map(T=>T.element),selector:"."+T.markers.tabClass,executeOnMove:!0})])})}),v4=fm({name:"Tabview",configFields:[hu("tabviewBehaviours",[sY])],factory:(T,E)=>({uid:T.uid,dom:T.dom,behaviours:bu(T.tabviewBehaviours,[sY.config({})]),domModification:{attributes:{role:"tabpanel"}}})}),v6=x([ys("selectFirst",!0),Di("onChangeTab"),Di("onDismissTab"),ys("tabs",[]),hu("tabSectionBehaviours",[])]),v8=aC({factory:v9,schema:[os("dom"),ls("markers",[os("tabClass"),os("selectedClass")])],name:"tabbar",defaults:T=>({tabs:T.tabs})}),v7=aC({factory:v4,name:"tabview"}),yo=x([v8,v7]),yr=bm({name:"TabSection",configFields:v6(),partFields:yo(),factory:(T,E,D,B)=>{let s=(E,D)=>{om(E,T,"tabbar").each(T=>{D(T).each(Rr)})};return{uid:T.uid,dom:T.dom,components:E,behaviours:fu(T.tabSectionBehaviours),events:Hr(q([T.selectFirst?[oX((T,E)=>{s(T,aK.getFirst)})]:[],[Ur(oW(),(E,D)=>{(E=>{let D=r5.getValue(E);om(E,T,"tabview").each(B=>{G(T.tabs,T=>T.value===D).each(D=>{let M=D.view();_t(E.element,"id").each(T=>{kt(B.element,"aria-labelledby",T)}),sY.set(B,M),T.onChangeTab(B,E,M)})})})(D.event.button)}),Ur(oG(),(E,D)=>{let B=D.event.button;T.onDismissTab(E,B)})]])),apis:{getViewItems:E=>om(E,T,"tabview").map(T=>sY.contents(T)).getOr([]),showTab:(T,E)=>{s(T,T=>{let D=aK.getCandidates(T);return G(D,T=>r5.getValue(T)===E).filter(E=>!aK.isHighlighted(T,E))})}}}},apis:{getViewItems:(T,E)=>T.getViewItems(E),showTab:(T,E,D)=>{T.showTab(E,D)}}}),PR=(T,E)=>{Dt(T,"height",E+"px"),Dt(T,"flex-basis",E+"px")},UR=(T,E,D)=>{mi(T,'[role="dialog"]').each(T=>{pi(T,'[role="tablist"]').each(B=>{D.get().map(D=>(Dt(E,"height","0"),Dt(E,"flex-basis","0"),Math.min(D,((T,E,D)=>{let B;let M=ot(T).dom,er=mi(T,".tox-dialog-wrap").getOr(T);B="fixed"===It(er,"position")?Math.max(M.clientHeight,window.innerHeight):Math.max(M.offsetHeight,M.scrollHeight);let ec=Wt(E),eu=E.dom.offsetLeft>=D.dom.offsetLeft+Jt(D)?Math.max(Wt(D),ec):ec,eg=parseInt(It(T,"margin-top"),10)||0,ep=parseInt(It(T,"margin-bottom"),10)||0;return B-(Wt(T)+eg+ep-eu)})(T,E,B)))).each(T=>{PR(E,T)})})})},WR=T=>pi(T,'[role="tabpanel"]'),yi="send-data-to-section",yl="send-data-to-view",$R=(T,E,D)=>{let B=Es({}),s=T=>{let E=r5.getValue(T),D=ER(E).getOr({}),M=B.get(),er=tw(M,D);B.set(er)},r=T=>{let E=B.get();r5.setValue(T,E)},M=Es(null),er=H(T.tabs,T=>({value:T.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"]},components:[ti(D.shared.providers.translate(T.title))],view:()=>[m4.sketch(B=>({dom:{tag:"div",classes:["tox-form"]},components:H(T.items,T=>X_(B,T,E,D)),formBehaviours:kl([sq.config({mode:"acyclic",useTabstopAt:C(XC)}),Jp("TabView.form.events",[oX(r),oq(s)]),nK.config({channels:Ds([{key:yi,value:{onReceive:s}},{key:yl,value:{onReceive:r}}])})])}))]})),ec=(T=>{let E=Ql(),D=[oX(D=>{let B=D.element;WR(B).each(M=>{Dt(M,"visibility","hidden"),D.getSystem().getByDom(M).toOptional().each(D=>{let B=H(T,(E,B)=>{sY.set(D,T[B].view());let er=M.dom.getBoundingClientRect();return sY.set(D,[]),er.height}),er=oe(ee(B,(T,E)=>T>E?-1:T<E?1:0));er.fold(E.clear,E.set)}),UR(B,M,E),Ht(M,"visibility"),((T,E)=>{oe(T).each(T=>yr.showTab(E,T.value))})(T,D),requestAnimationFrame(()=>{UR(B,M,E)})})}),Ur(oR(),T=>{let D=T.element;WR(D).each(T=>{UR(D,T,E)})}),Ur(u2,(T,D)=>{let B=T.element;WR(B).each(T=>{let D=Il(eJ(T));Dt(T,"visibility","hidden");let M=Nt(T,"height").map(T=>parseInt(T,10));Ht(T,"height"),Ht(T,"flex-basis");let er=T.dom.getBoundingClientRect().height;M.forall(T=>er>T)?(E.set(er),UR(B,T,E)):M.each(E=>{PR(T,E)}),Ht(T,"visibility"),D.each(Dl)})})];return{extraEvents:D,selectFirst:!1}})(er);return yr.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:(T,E,D)=>{let B=r5.getValue(E);Ir(T,u1,{name:B,oldName:M.get()}),M.set(B)},tabs:er,components:[yr.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[v9.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:kl([uJ.config({})])}),yr.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:ec.selectFirst,tabSectionBehaviours:kl([Jp("tabpanel",ec.extraEvents),sq.config({mode:"acyclic"}),aP.config({find:T=>oe(yr.getViewItems(T))}),RC(A.none(),T=>(T.getSystem().broadcastOn([yi],{}),B.get()),(T,E)=>{B.set(E),T.getSystem().broadcastOn([yl],{})})])})},qR=(T,E,D,B,M)=>({dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:{...D.map(T=>({id:T})).getOr({}),...M?{"aria-live":"polite"}:{}}},components:[],behaviours:kl([BC(0),v0.config({channel:`${gy}-${E}`,updateState:(T,E)=>A.some({isTabPanel:()=>"tabpanel"===E.body.type}),renderComponents:T=>{let E=T.body;return"tabpanel"===E.type?[$R(E,T.initialData,B)]:[AR(E,T.initialData,B)]},initialData:T})])});function XR(T){return(XR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(T){return typeof T}:function(T){return T&&"function"==typeof Symbol&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T})(T)}function YR(T,E){return(YR=Object.setPrototypeOf||function(T,E){return T.__proto__=E,T})(T,E)}function KR(T,E,D){return(KR=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}()?function(T,E,D){var B=[null];B.push.apply(B,E);var M=new(Function.bind.apply(T,B));return D&&YR(M,D.prototype),M}:Reflect.construct).apply(null,arguments)}function JR(T){return function(T){if(Array.isArray(T))return ZR(T)}(T)||function(T){if("undefined"!=typeof Symbol&&null!=T[Symbol.iterator]||null!=T["@@iterator"])return Array.from(T)}(T)||function(T,E){if(T){if("string"==typeof T)return ZR(T,E);var D=Object.prototype.toString.call(T).slice(8,-1);return"Object"===D&&T.constructor&&(D=T.constructor.name),"Map"===D||"Set"===D?Array.from(T):"Arguments"===D||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D)?ZR(T,E):void 0}}(T)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ZR(T,E){(null==E||E>T.length)&&(E=T.length);for(var D=0,B=Array(E);D<E;D++)B[D]=T[D];return B}var yc=Object.hasOwnProperty,yd=Object.setPrototypeOf,yu=Object.isFrozen,ym=Object.getPrototypeOf,yp=Object.getOwnPropertyDescriptor,yh=Object.freeze,yf=Object.seal,yb=Object.create,yv="undefined"!=typeof Reflect&&Reflect,yy=yv.apply,yw=yv.construct;yy||(yy=function(T,E,D){return T.apply(E,D)}),yh||(yh=function(T){return T}),yf||(yf=function(T){return T}),yw||(yw=function(T,E){return KR(T,JR(E))});var yS,yO,yC,yE,yI,yH=wN(Array.prototype.forEach),yN=wN(Array.prototype.pop),yV=wN(Array.prototype.push),yU=wN(String.prototype.toLowerCase),yL=wN(String.prototype.match),yz=wN(String.prototype.replace),yP=wN(String.prototype.indexOf),yj=wN(String.prototype.trim),yW=wN(RegExp.prototype.test),yG=(yI=TypeError,function(){for(var T=arguments.length,E=Array(T),D=0;D<T;D++)E[D]=arguments[D];return yw(yI,E)});function wN(T){return function(E){for(var D=arguments.length,B=Array(D>1?D-1:0),M=1;M<D;M++)B[M-1]=arguments[M];return yy(T,E,B)}}function SN(T,E){yd&&yd(T,null);for(var D=E.length;D--;){var B=E[D];if("string"==typeof B){var M=yU(B);M!==B&&(yu(E)||(E[D]=M),B=M)}T[B]=!0}return T}function kN(T){var E,D=yb(null);for(E in T)yy(yc,T,[E])&&(D[E]=T[E]);return D}function CN(T,E){for(;null!==T;){var D=yp(T,E);if(D){if(D.get)return wN(D.get);if("function"==typeof D.value)return wN(D.value)}T=ym(T)}return function(T){return console.warn("fallback value for",T),null}}var yJ=yh(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),y$=yh(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),yX=yh(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),yq=yh(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),yK=yh(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),yY=yh(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),yZ=yh(["#text"]),yQ=yh(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),y0=yh(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),y1=yh(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),y2=yh(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),y3=yf(/\{\{[\w\W]*|[\w\W]*\}\}/gm),y5=yf(/<%[\w\W]*|[\w\W]*%>/gm),y9=yf(/^data-[\-\w.\u00B7-\uFFFF]/),y4=yf(/^aria-[\-\w]+$/),y6=yf(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),y8=yf(/^(?:\w+script|data):/i),y7=yf(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),xo=yf(/^html$/i),xr=function e(){var T=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,o=function(T){return e(T)};if(o.version="2.3.8",o.removed=[],!T||!T.document||9!==T.document.nodeType)return o.isSupported=!1,o;var E=T.document,D=T.document,B=T.DocumentFragment,M=T.HTMLTemplateElement,er=T.Node,ec=T.Element,eu=T.NodeFilter,eg=T.NamedNodeMap,ep=void 0===eg?T.NamedNodeMap||T.MozNamedAttrMap:eg,eh=T.HTMLFormElement,ey=T.DOMParser,ex=T.trustedTypes,eO=ec.prototype,eD=CN(eO,"cloneNode"),eI=CN(eO,"nextSibling"),eR=CN(eO,"childNodes"),eH=CN(eO,"parentNode");if("function"==typeof M){var eN=D.createElement("template");eN.content&&eN.content.ownerDocument&&(D=eN.content.ownerDocument)}var eU=function(T,E){if("object"!==XR(T)||"function"!=typeof T.createPolicy)return null;var D=null,B="data-tt-policy-suffix";E.currentScript&&E.currentScript.hasAttribute(B)&&(D=E.currentScript.getAttribute(B));var M="dompurify"+(D?"#"+D:"");try{return T.createPolicy(M,{createHTML:function(T){return T}})}catch(T){return console.warn("TrustedTypes policy "+M+" could not be created."),null}}(ex,E),eL=eU?eU.createHTML(""):"",ez=D,eP=ez.implementation,ej=ez.createNodeIterator,eW=ez.createDocumentFragment,eG=ez.getElementsByTagName,eJ=E.importNode,e$={};try{e$=kN(D).documentMode?D.documentMode:{}}catch(T){}var eX={};o.isSupported="function"==typeof eH&&eP&&void 0!==eP.createHTMLDocument&&9!==e$;var eq,eK,eY=y6,eZ=null,eQ=SN({},[].concat(JR(yJ),JR(y$),JR(yX),JR(yK),JR(yZ))),e0=null,e1=SN({},[].concat(JR(yQ),JR(y0),JR(y1),JR(y2))),e2=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),e3=null,e5=null,e9=!0,e4=!0,e6=!1,e8=!1,e7=!1,tn=!1,tr=!1,th=!1,tf=!1,tv=!1,ty=!0,tx=!0,tw=!1,tO={},tC=null,tM=SN({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),tI=null,tR=SN({},["audio","video","img","source","image","track"]),tH=null,tN=SN({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),tU="http://www.w3.org/1998/Math/MathML",tL="http://www.w3.org/2000/svg",tz="http://www.w3.org/1999/xhtml",tP=tz,tj=!1,tW=["application/xhtml+xml","text/html"],tG=null,tJ=D.createElement("form"),we=function(T){return T instanceof RegExp||T instanceof Function},Se=function(T){tG&&tG===T||(T&&"object"===XR(T)||(T={}),eZ="ALLOWED_TAGS"in(T=kN(T))?SN({},T.ALLOWED_TAGS):eQ,e0="ALLOWED_ATTR"in T?SN({},T.ALLOWED_ATTR):e1,tH="ADD_URI_SAFE_ATTR"in T?SN(kN(tN),T.ADD_URI_SAFE_ATTR):tN,tI="ADD_DATA_URI_TAGS"in T?SN(kN(tR),T.ADD_DATA_URI_TAGS):tR,tC="FORBID_CONTENTS"in T?SN({},T.FORBID_CONTENTS):tM,e3="FORBID_TAGS"in T?SN({},T.FORBID_TAGS):{},e5="FORBID_ATTR"in T?SN({},T.FORBID_ATTR):{},tO="USE_PROFILES"in T&&T.USE_PROFILES,e9=!1!==T.ALLOW_ARIA_ATTR,e4=!1!==T.ALLOW_DATA_ATTR,e6=T.ALLOW_UNKNOWN_PROTOCOLS||!1,e8=T.SAFE_FOR_TEMPLATES||!1,e7=T.WHOLE_DOCUMENT||!1,th=T.RETURN_DOM||!1,tf=T.RETURN_DOM_FRAGMENT||!1,tv=T.RETURN_TRUSTED_TYPE||!1,tr=T.FORCE_BODY||!1,ty=!1!==T.SANITIZE_DOM,tx=!1!==T.KEEP_CONTENT,tw=T.IN_PLACE||!1,eY=T.ALLOWED_URI_REGEXP||eY,tP=T.NAMESPACE||tz,T.CUSTOM_ELEMENT_HANDLING&&we(T.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(e2.tagNameCheck=T.CUSTOM_ELEMENT_HANDLING.tagNameCheck),T.CUSTOM_ELEMENT_HANDLING&&we(T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(e2.attributeNameCheck=T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),T.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(e2.allowCustomizedBuiltInElements=T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),eK="application/xhtml+xml"===(eq=eq=-1===tW.indexOf(T.PARSER_MEDIA_TYPE)?"text/html":T.PARSER_MEDIA_TYPE)?function(T){return T}:yU,e8&&(e4=!1),tf&&(th=!0),tO&&(eZ=SN({},JR(yZ)),e0=[],!0===tO.html&&(SN(eZ,yJ),SN(e0,yQ)),!0===tO.svg&&(SN(eZ,y$),SN(e0,y0),SN(e0,y2)),!0===tO.svgFilters&&(SN(eZ,yX),SN(e0,y0),SN(e0,y2)),!0===tO.mathMl&&(SN(eZ,yK),SN(e0,y1),SN(e0,y2))),T.ADD_TAGS&&(eZ===eQ&&(eZ=kN(eZ)),SN(eZ,T.ADD_TAGS)),T.ADD_ATTR&&(e0===e1&&(e0=kN(e0)),SN(e0,T.ADD_ATTR)),T.ADD_URI_SAFE_ATTR&&SN(tH,T.ADD_URI_SAFE_ATTR),T.FORBID_CONTENTS&&(tC===tM&&(tC=kN(tC)),SN(tC,T.FORBID_CONTENTS)),tx&&(eZ["#text"]=!0),e7&&SN(eZ,["html","head","body"]),eZ.table&&(SN(eZ,["tbody"]),delete e3.tbody),yh&&yh(T),tG=T)},t$=SN({},["mi","mo","mn","ms","mtext"]),tX=SN({},["foreignobject","desc","title","annotation-xml"]),tq=SN({},["title","style","font","a","script"]),tK=SN({},y$);SN(tK,yX),SN(tK,yq);var tY=SN({},yK);SN(tY,yY);var Ee=function(T){yV(o.removed,{element:T});try{T.parentNode.removeChild(T)}catch(E){try{T.outerHTML=eL}catch(E){T.remove()}}},Ae=function(T,E){try{yV(o.removed,{attribute:E.getAttributeNode(T),from:E})}catch(T){yV(o.removed,{attribute:null,from:E})}if(E.removeAttribute(T),"is"===T&&!e0[T]){if(th||tf)try{Ee(E)}catch(T){}else try{E.setAttribute(T,"")}catch(T){}}},Me=function(T){if(tr)T="<remove></remove>"+T;else{var E,B,M=yL(T,/^[\r\n\t ]+/);B=M&&M[0]}"application/xhtml+xml"===eq&&(T='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+T+"</body></html>");var er=eU?eU.createHTML(T):T;if(tP===tz)try{E=(new ey).parseFromString(er,eq)}catch(T){}if(!E||!E.documentElement){E=eP.createDocument(tP,"template",null);try{E.documentElement.innerHTML=tj?"":er}catch(T){}}var ec=E.body||E.documentElement;return T&&B&&ec.insertBefore(D.createTextNode(B),ec.childNodes[0]||null),tP===tz?eG.call(E,e7?"html":"body")[0]:e7?E.documentElement:ec},De=function(T){return ej.call(T.ownerDocument||T,T,eu.SHOW_ELEMENT|eu.SHOW_COMMENT|eu.SHOW_TEXT,null,!1)},Be=function(T){return"object"===XR(er)?T instanceof er:T&&"object"===XR(T)&&"number"==typeof T.nodeType&&"string"==typeof T.nodeName},Fe=function(T,E,D){eX[T]&&yH(eX[T],function(T){T.call(o,E,D,tG)})},Ie=function(T){if(Fe("beforeSanitizeElements",T,null),T instanceof eh&&("string"!=typeof T.nodeName||"string"!=typeof T.textContent||"function"!=typeof T.removeChild||!(T.attributes instanceof ep)||"function"!=typeof T.removeAttribute||"function"!=typeof T.setAttribute||"string"!=typeof T.namespaceURI||"function"!=typeof T.insertBefore)||yW(/[\u0080-\uFFFF]/,T.nodeName))return Ee(T),!0;var E,D,B,M,er=eK(T.nodeName);if(Fe("uponSanitizeElement",T,{tagName:er,allowedTags:eZ}),T.hasChildNodes()&&!Be(T.firstElementChild)&&(!Be(T.content)||!Be(T.content.firstElementChild))&&yW(/<[/\w]/g,T.innerHTML)&&yW(/<[/\w]/g,T.textContent)||"select"===er&&yW(/<template/i,T.innerHTML))return Ee(T),!0;if(!eZ[er]||e3[er]){if(!e3[er]&&Ne(er)&&(e2.tagNameCheck instanceof RegExp&&yW(e2.tagNameCheck,er)||e2.tagNameCheck instanceof Function&&e2.tagNameCheck(er)))return!1;if(tx&&!tC[er]){var eu=eH(T)||T.parentNode,eg=eR(T)||T.childNodes;if(eg&&eu)for(var ey=eg.length-1;ey>=0;--ey)eu.insertBefore(eD(eg[ey],!0),eI(T))}return Ee(T),!0}return!(T instanceof ec)||((E=eH(T))&&E.tagName||(E={namespaceURI:tz,tagName:"template"}),D=yU(T.tagName),B=yU(E.tagName),T.namespaceURI===tL?E.namespaceURI===tz?"svg"===D:E.namespaceURI===tU?"svg"===D&&("annotation-xml"===B||t$[B]):tK[D]:T.namespaceURI===tU?E.namespaceURI===tz?"math"===D:E.namespaceURI===tL?"math"===D&&tX[B]:tY[D]:T.namespaceURI===tz&&(E.namespaceURI!==tL||tX[B])&&(E.namespaceURI!==tU||t$[B])&&!tY[D]&&(tq[D]||!tK[D]))?("noscript"===er||"noembed"===er)&&yW(/<\/no(script|embed)/i,T.innerHTML)?(Ee(T),!0):(e8&&3===T.nodeType&&(M=yz(M=T.textContent,y3," "),M=yz(M,y5," "),T.textContent!==M&&(yV(o.removed,{element:T.cloneNode()}),T.textContent=M)),Fe("afterSanitizeElements",T,null),!1):(Ee(T),!0)},Re=function(T,E,B){if(ty&&("id"===E||"name"===E)&&(B in D||B in tJ))return!1;if(e4&&!e5[E]&&yW(y9,E));else if(e9&&yW(y4,E));else if(!e0[E]||e5[E]){if(!(Ne(T)&&(e2.tagNameCheck instanceof RegExp&&yW(e2.tagNameCheck,T)||e2.tagNameCheck instanceof Function&&e2.tagNameCheck(T))&&(e2.attributeNameCheck instanceof RegExp&&yW(e2.attributeNameCheck,E)||e2.attributeNameCheck instanceof Function&&e2.attributeNameCheck(E))||"is"===E&&e2.allowCustomizedBuiltInElements&&(e2.tagNameCheck instanceof RegExp&&yW(e2.tagNameCheck,B)||e2.tagNameCheck instanceof Function&&e2.tagNameCheck(B))))return!1}else if(tH[E]);else if(yW(eY,yz(B,y7,"")));else if("src"!==E&&"xlink:href"!==E&&"href"!==E||"script"===T||0!==yP(B,"data:")||!tI[T]){if(e6&&!yW(y8,yz(B,y7,"")));else if(B)return!1}return!0},Ne=function(T){return T.indexOf("-")>0},Ve=function(T){Fe("beforeSanitizeAttributes",T,null);var E,D,B,M,er=T.attributes;if(er){var ec={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:e0};for(M=er.length;M--;){var eu=E=er[M],eg=eu.name,ep=eu.namespaceURI;D="value"===eg?E.value:yj(E.value),B=eK(eg);var eh=D;if(ec.attrName=B,ec.attrValue=D,ec.keepAttr=!0,ec.forceKeepAttr=void 0,Fe("uponSanitizeAttribute",T,ec),D=ec.attrValue,!ec.forceKeepAttr){if(ec.keepAttr){if(yW(/\/>/i,D))Ae(eg,T);else if(e8&&(D=yz(D,y3," "),D=yz(D,y5," ")),Re(eK(T.nodeName),B,D)){if(D!==eh)try{ep?T.setAttributeNS(ep,eg,D):T.setAttribute(eg,D)}catch(E){Ae(eg,T)}}else Ae(eg,T)}else Ae(eg,T)}}Fe("afterSanitizeAttributes",T,null)}},ze=function e(T){var E,D=De(T);for(Fe("beforeSanitizeShadowDOM",T,null);E=D.nextNode();)Fe("uponSanitizeShadowNode",E,null),Ie(E)||(E.content instanceof B&&e(E.content),Ve(E));Fe("afterSanitizeShadowDOM",T,null)};return o.sanitize=function(D,M){if((tj=!D)&&(D="<!-->"),"string"!=typeof D&&!Be(D)){if("function"!=typeof D.toString)throw yG("toString is not a function");if("string"!=typeof(D=D.toString()))throw yG("dirty is not a string, aborting")}if(!o.isSupported){if("object"===XR(T.toStaticHTML)||"function"==typeof T.toStaticHTML){if("string"==typeof D)return T.toStaticHTML(D);if(Be(D))return T.toStaticHTML(D.outerHTML)}return D}if(tn||Se(M),o.removed=[],"string"==typeof D&&(tw=!1),tw){if(D.nodeName){var ec,eu,eg,ep,eh,ey=eK(D.nodeName);if(!eZ[ey]||e3[ey])throw yG("root node is forbidden and cannot be sanitized in-place")}}else if(D instanceof er)1===(eu=(ec=Me("<!---->")).ownerDocument.importNode(D,!0)).nodeType&&"BODY"===eu.nodeName||"HTML"===eu.nodeName?ec=eu:ec.appendChild(eu);else{if(!th&&!e8&&!e7&&-1===D.indexOf("<"))return eU&&tv?eU.createHTML(D):D;if(!(ec=Me(D)))return th?null:tv?eL:""}ec&&tr&&Ee(ec.firstChild);for(var ex=De(tw?D:ec);eg=ex.nextNode();)3===eg.nodeType&&eg===ep||Ie(eg)||(eg.content instanceof B&&ze(eg.content),Ve(eg),ep=eg);if(ep=null,tw)return D;if(th){if(tf)for(eh=eW.call(ec.ownerDocument);ec.firstChild;)eh.appendChild(ec.firstChild);else eh=ec;return e0.shadowroot&&(eh=eJ.call(E,eh,!0)),eh}var eO=e7?ec.outerHTML:ec.innerHTML;return e7&&eZ["!doctype"]&&ec.ownerDocument&&ec.ownerDocument.doctype&&ec.ownerDocument.doctype.name&&yW(xo,ec.ownerDocument.doctype.name)&&(eO="<!DOCTYPE "+ec.ownerDocument.doctype.name+">\n"+eO),e8&&(eO=yz(eO,y3," "),eO=yz(eO,y5," ")),eU&&tv?eU.createHTML(eO):eO},o.setConfig=function(T){Se(T),tn=!0},o.clearConfig=function(){tG=null,tn=!1},o.isValidAttribute=function(T,E,D){return tG||Se({}),Re(eK(T),eK(E),D)},o.addHook=function(T,E){"function"==typeof E&&(eX[T]=eX[T]||[],yV(eX[T],E))},o.removeHook=function(T){if(eX[T])return yN(eX[T])},o.removeHooks=function(T){eX[T]&&(eX[T]=[])},o.removeAllHooks=function(){eX={}},o}();let $N=T=>xr().sanitize(T),xi=i5.deviceType.isTouch(),XN=(T,E)=>({dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[T,E]}),YN=(T,E)=>by.parts.close(iL.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":E.translate("Close")}},action:T,buttonBehaviours:kl([uJ.config({})])})),KN=()=>by.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}}),JN=(T,E)=>by.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:_A(`<p>${$N(E.translate(T))}</p>`)}]}]}),ZN=T=>by.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:T}),QN=(T,E)=>[uL.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:T}),uL.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:E})],eV=T=>{let E="tox-dialog",D=E+"-wrap",B=D+"__backdrop",M=E+"__disable-scroll";return by.sketch({lazySink:T.lazySink,onEscape:E=>(T.onEscape(E),A.some(!0)),useTabstopAt:T=>!XC(T),firstTabstop:T.firstTabstop,dom:{tag:"div",classes:[E].concat(T.extraClasses),styles:{position:"relative",...T.extraStyles}},components:[T.header,T.body,...T.footer.toArray()],parts:{blocker:{dom:_A(`<div class="${D}"></div>`),components:[{dom:{tag:"div",classes:xi?[B,B+"--opaque"]:[B]}}]}},dragBlockClass:D,modalBehaviours:kl([s1.config({}),Jp("dialog-events",T.dialogEvents.concat([Yr(tY(),(T,E)=>{hv.isBlocked(T)||sq.focusIn(T)}),Ur(oz(),(T,E)=>{T.getSystem().broadcastOn([gC],{newFocus:E.event.newFocus})})])),Jp("scroll-lock",[oX(()=>{La(xt(),M)}),oq(()=>{Pa(xt(),M)})]),...T.extraBehaviours]),eventOrder:{[of()]:["dialog-events"],[oH()]:["scroll-lock","dialog-events","alloy.base.behaviour"],[oN()]:["alloy.base.behaviour","dialog-events","scroll-lock"],...T.eventOrder}})},tV=T=>iL.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":T.translate("Close"),title:T.translate("Close")}},buttonBehaviours:kl([uJ.config({})]),components:[ef("close",{tag:"span",classes:["tox-icon"]},T.icons)],action:T=>{Fr(T,uK)}}),oV=(T,E,D,B)=>({dom:{tag:"div",classes:["tox-dialog__title"],attributes:{...D.map(T=>({id:T})).getOr({})}},components:[],behaviours:kl([v0.config({channel:`${gv}-${E}`,initialData:T,renderComponents:T=>[ti(B.translate(T.title))]})])}),nV=()=>({dom:_A('<div class="tox-dialog__draghandle"></div>')}),sV=(T,E,D)=>((T,E,D)=>{let B=by.parts.title(oV(T,E,A.none(),D)),M=by.parts.draghandle(nV()),er=by.parts.close(tV(D)),ec=[B].concat(T.draggable?[M]:[]).concat([er]);return uL.sketch({dom:_A('<div class="tox-dialog__header"></div>'),components:ec})})({title:D.shared.providers.translate(T),draggable:D.dialog.isDraggableModal()},E,D.shared.providers),rV=(T,E,D,B)=>({dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":D.translate(T)},styles:{left:"0px",right:"0px",bottom:"0px",top:`${B.getOr(0)}px`,position:"absolute"}},behaviours:E,components:[{dom:_A('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),aV=(T,E,D)=>({onClose:()=>D.closeWindow(),onBlock:D=>{let B=pi(T().element,".tox-dialog__header").map(T=>Wt(T));by.setBusy(T(),(T,M)=>rV(D.message,M,E,B))},onUnblock:()=>{by.setIdle(T())}}),iV=(T,E,D,B)=>ri(eV({...T,firstTabstop:1,lazySink:B.shared.getSink,extraBehaviours:[v0.config({channel:`${gb}-${T.id}`,updateState:(T,E)=>A.some(E),initialData:E}),VC({}),...T.extraBehaviours],onEscape:T=>{Fr(T,uK)},dialogEvents:D,eventOrder:{[oh()]:[v0.name(),nK.name()],[oH()]:["scroll-lock",v0.name(),"messages","dialog-events","alloy.base.behaviour"],[oN()]:["alloy.base.behaviour","dialog-events","messages",v0.name(),"scroll-lock"]}})),lV=(T,E={})=>H(T,T=>"menu"===T.type?(T=>{let D=H(T.items,T=>{let D=be(E,T.name).getOr(Es(!1));return{...T,storage:D}});return{...T,items:D}})(T):T),cV=T=>j(T,(T,E)=>"menu"===E.type?j(E.items,(T,E)=>(T[E.name]=E.storage,T),T):T,{}),dV=(T,E)=>[$r(tY(),qC),T(uq,(T,D,B,M)=>{Il(eJ(M.element)).fold(b,Bl),E.onClose(),D.onClose()}),T(uK,(T,E,D,B)=>{E.onCancel(T),Fr(B,uq)}),Ur(u0,(T,D)=>E.onUnblock()),Ur(uQ,(T,D)=>E.onBlock(D.event))],uV=(T,E,D)=>{let n=(E,D)=>Ur(E,(E,B)=>{s(E,(M,er)=>{D(T(),M,B.event,E)})}),s=(T,E)=>{v0.getState(T).get().each(D=>{E(D.internalDialog,T)})};return[...dV(n,E),n(uZ,(T,E)=>E.onSubmit(T)),n(uX,(T,E,D)=>{E.onChange(T,{name:D.name})}),n(uY,(T,E,B,M)=>{let r=()=>M.getSystem().isConnected()?sq.focusIn(M):void 0,a=T=>Tt(T,"disabled")||_t(T,"aria-disabled").exists(T=>"true"===T),er=eJ(M.element),ec=Il(er);E.onAction(T,{name:B.name,value:B.value}),Il(er).fold(r,T=>{a(T)||ec.exists(E=>Qe(T,E)&&a(E))?r():D().toOptional().filter(E=>!Qe(E.element,T)).each(r)})}),n(u1,(T,E,D)=>{E.onTabChange(T,{newTabName:D.name,oldTabName:D.oldName})}),oq(E=>{let D=T();r5.setValue(E,D.getData())})]},mV=(T,E)=>{let D=E.map(T=>T.footerButtons).getOr([]),B=P(D,T=>"start"===T.align),s=(T,E)=>uL.sketch({dom:{tag:"div",classes:[`tox-dialog__footer-${T}`]},components:H(E,T=>T.memento.asSpec())});return[s("start",B.pass),s("end",B.fail)]},gV=(T,E,D)=>({dom:_A('<div class="tox-dialog__footer"></div>'),components:[],behaviours:kl([v0.config({channel:`${gw}-${E}`,initialData:T,updateState:(T,E)=>{let B=H(E.buttons,T=>{let E=jh(B_(T,T.type,D));return{name:T.name,align:T.align,memento:E}});return A.some({lookupByName:E=>G(B,T=>T.name===E).bind(E=>E.memento.getOpt(T)),footerButtons:B})},renderComponents:mV})])}),pV=(T,E,D)=>by.parts.footer(gV(T,E,D)),hV=(T,E)=>{if(T.getRoot().getSystem().isConnected()){let D=aP.getCurrent(T.getFormWrapper()).getOr(T.getFormWrapper());return m4.getField(D,E).orThunk(()=>{let D=T.getFooter().bind(T=>v0.getState(T).get());return D.bind(T=>T.lookupByName(E))})}return A.none()},fV=(T,D,B)=>{let n=E=>{let D=T.getRoot();D.getSystem().isConnected()&&E(D)},M={getData:()=>{let E=T.getRoot(),D=E.getSystem().isConnected()?T.getFormWrapper():E;return{...r5.getValue(D),...ce(B,T=>T.get())}},setData:E=>{n(D=>{let er=M.getData(),ec=tw(er,E),eu=((T,E)=>{let D=T.getRoot();return v0.getState(D).get().map(T=>Xn(qn("data",T.dataValidator,E))).getOr(E)})(T,ec),eg=T.getFormWrapper();r5.setValue(eg,eu),le(B,(T,E)=>{ve(ec,E)&&T.set(ec[E])})})},setEnabled:(E,D)=>{hV(T,E).each(D?a$.enable:a$.disable)},focus:E=>{hV(T,E).each(s1.focus)},block:T=>{if(!E(T))throw Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");n(E=>{Ir(E,uQ,{message:T})})},unblock:()=>{n(T=>{Fr(T,u0)})},showTab:E=>{n(D=>{let B=T.getBody();v0.getState(B).get().exists(T=>T.isTabPanel())&&aP.getCurrent(B).each(T=>{yr.showTab(T,E)})})},redial:E=>{n(er=>{let ec=T.getId(),eu=D(E),eg=lV(eu.internalDialog.buttons,B);er.getSystem().broadcastOn([`${gb}-${ec}`],eu),er.getSystem().broadcastOn([`${gv}-${ec}`],eu.internalDialog),er.getSystem().broadcastOn([`${gy}-${ec}`],eu.internalDialog),er.getSystem().broadcastOn([`${gw}-${ec}`],{...eu.internalDialog,buttons:eg}),M.setData(eu.initialData)})},close:()=>{n(T=>{Fr(T,uq)})},toggleFullscreen:T.toggleFullscreen};return M},bV=(T,E,D,B=!1)=>{var M,er;let ec=la("dialog"),eu=la("dialog-label"),eg=la("dialog-content"),ep=T.internalDialog,eh="medium"===ep.size?A.some("tox-dialog--width-md"):A.none(),ey=jh((M={title:ep.title,draggable:!0},er=D.shared.providers,uL.sketch({dom:_A('<div class="tox-dialog__header"></div>'),components:[oV(M,ec,A.some(eu),er),nV(),tV(er)],containerBehaviours:kl([bp.config({mode:"mouse",blockerClass:"blocker",getTarget:T=>hi(T,'[role="dialog"]').getOrDie(),snaps:{getSnapPoints:()=>[],leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),ex=jh(qR({body:ep.body,initialData:ep.initialData},ec,A.some(eg),D,B)),eO=lV(ep.buttons),eD=cV(eO),eI=Ce(0!==eO.length,jh(gV({buttons:eO},ec,D))),eR=uV(()=>eU,{onBlock:T=>{hv.block(eN,(E,B)=>{let M=ey.getOpt(eN).map(T=>Wt(T.element));return rV(T.message,B,D.shared.providers,M)})},onUnblock:()=>{hv.unblock(eN)},onClose:()=>E.closeWindow()},D.shared.getSink),eH="tox-dialog-inline",eN=ri({dom:{tag:"div",classes:["tox-dialog",eH,...eh.toArray()],attributes:{role:"dialog","aria-labelledby":eu}},eventOrder:{[oh()]:[v0.name(),nK.name()],[of()]:["execute-on-form"],[oH()]:["reflecting","execute-on-form"]},behaviours:kl([sq.config({mode:"cyclic",onEscape:T=>(Fr(T,uq),A.some(!0)),useTabstopAt:T=>!XC(T)&&("button"!==Ue(T)||"disabled"!==Ot(T,"disabled")),firstTabstop:1}),v0.config({channel:`${gb}-${ec}`,updateState:(T,E)=>A.some(E),initialData:T}),s1.config({}),Jp("execute-on-form",eR.concat([Yr(tY(),(T,E)=>{sq.focusIn(T)}),Ur(oz(),(T,E)=>{T.getSystem().broadcastOn([gC],{newFocus:E.event.newFocus})})])),hv.config({getRoot:()=>A.some(eN)}),sY.config({}),VC({})]),components:[ey.asSpec(),ex.asSpec(),...eI.map(T=>T.asSpec()).toArray()]}),eU=fV({getId:x(ec),getRoot:x(eN),getFooter:()=>eI.map(T=>T.get(eN)),getBody:()=>ex.get(eN),getFormWrapper:()=>{let T=ex.get(eN);return aP.getCurrent(T).getOr(T)},toggleFullscreen:()=>{let T="tox-dialog--fullscreen",E=Fe(eN.element.dom);Ga(E,[T])?(ja(E,[T]),Wa(E,[eH])):(ja(E,[eH]),Wa(E,[T]))}},E.redial,eD);return{dialog:eN,instanceApi:eU}};var xu=tinymce.util.Tools.resolve("tinymce.util.URI");let xm=["insertContent","setContent","execCommand","close","block","unblock"],xV=T=>D(T)&&-1!==xm.indexOf(T.mceAction),wV=(T,B,M,ec)=>{let eu=la("dialog"),eg=sV(T.title,eu,ec),ep=(T=>{let E={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[GC(A.none(),{dom:{tag:"iframe",attributes:{src:T.url}},behaviours:kl([uJ.config({}),s1.config({})])})]}],behaviours:kl([sq.config({mode:"acyclic",useTabstopAt:C(XC)})])};return by.parts.body(E)})(T),eh=T.buttons.bind(T=>0===T.length?A.none():A.some(pV({buttons:T},eu,ec))),ey=((T,E)=>{let o=(T,E)=>Ur(T,(T,D)=>{n(T,(B,M)=>{E(eU,B,D.event,T)})}),n=(T,E)=>{v0.getState(T).get().each(D=>{E(D,T)})};return[...dV(o,E),o(uY,(T,E,D)=>{E.onAction(T,{name:D.name})})]})(0,aV(()=>eN,ec.shared.providers,B)),ex={...T.height.fold(()=>({}),T=>({height:T+"px","max-height":T+"px"})),...T.width.fold(()=>({}),T=>({width:T+"px","max-width":T+"px"}))},eO=T.width.isNone()&&T.height.isNone()?["tox-dialog--width-lg"]:[],eD=new xu(T.url,{base_uri:new xu(window.location.href)}),eI=`${eD.protocol}://${eD.host}${eD.port?":"+eD.port:""}`,eR=Zl(),eH=[Jp("messages",[oX(()=>{let E=tc(Fe(window),"message",E=>{if(eD.isSameOrigin(new xu(E.raw.origin))){let B=E.raw.data;xV(B)?((T,E,D)=>{switch(D.mceAction){case"insertContent":T.insertContent(D.content);break;case"setContent":T.setContent(D.content);break;case"execCommand":let B=!!er(D.ui)&&D.ui;T.execCommand(D.cmd,B,D.value);break;case"close":E.close();break;case"block":E.block(D.message);break;case"unblock":E.unblock()}})(M,eU,B):!xV(B)&&D(B)&&ve(B,"mceAction")&&T.onMessage(eU,B)}});eR.set(E)}),oq(eR.clear)]),nK.config({channels:{[gA]:{onReceive:(T,E)=>{pi(T.element,"iframe").each(T=>{let D=T.dom.contentWindow;g(D)&&D.postMessage(E,eI)})}}}})],eN=iV({id:eu,header:eg,body:ep,footer:eh,extraClasses:eO,extraBehaviours:eH,extraStyles:ex},T,ey,ec),eU=(T=>{let t=E=>{T.getSystem().isConnected()&&E(T)};return{block:T=>{if(!E(T))throw Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(E=>{Ir(E,uQ,{message:T})})},unblock:()=>{t(T=>{Fr(T,u0)})},close:()=>{t(T=>{Fr(T,uq)})},sendMessage:T=>{t(E=>{E.getSystem().broadcastOn([gA],T)})}}})(eN);return{dialog:eN,instanceApi:eU}},SV=(T,E)=>Xn(qn("data",E,T)),kV=T=>$w(T,".tox-alert-dialog")||$w(T,".tox-confirm-dialog"),CV=(T,E,D)=>E&&D?[]:[pZ.config({contextual:{lazyContext:()=>A.some(Jo(Fe(T.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"],lazyViewport:E=>jw(T,E.element).map(T=>({bounds:Gw(T),optScrollEnv:A.some({currentScrollTop:T.element.dom.scrollTop,scrollElmTop:Xt(T.element).top})})).getOrThunk(()=>({bounds:en(),optScrollEnv:A.none()}))})],OV=T=>{let E=T.editor,D=ib(E),B=(T=>{let E=T.shared;return{open:(D,B)=>{let s=()=>{by.hide(eu),B()},M=jh(B_({name:"close-alert",text:"OK",primary:!0,buttonType:A.some("primary"),align:"end",enabled:!0,icon:A.none()},"cancel",T)),er=KN(),ec=YN(s,E.providers),eu=ri(eV({lazySink:()=>E.getSink(),header:XN(er,ec),body:JN(D,E.providers),footer:A.some(ZN(QN([],[M.asSpec()]))),onEscape:s,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Ur(uK,s)],eventOrder:{}}));by.show(eu);let eg=M.get(eu);s1.focus(eg)}}})(T.backstages.dialog),M=(T=>{let E=T.shared;return{open:(D,B)=>{let s=T=>{by.hide(eg),B(T)},M=jh(B_({name:"yes",text:"Yes",primary:!0,buttonType:A.some("primary"),align:"end",enabled:!0,icon:A.none()},"submit",T)),er=B_({name:"no",text:"No",primary:!1,buttonType:A.some("secondary"),align:"end",enabled:!0,icon:A.none()},"cancel",T),ec=KN(),eu=YN(()=>s(!1),E.providers),eg=ri(eV({lazySink:()=>E.getSink(),header:XN(ec,eu),body:JN(D,E.providers),footer:A.some(ZN(QN([],[er,M.asSpec()]))),onEscape:()=>s(!1),extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Ur(uK,()=>s(!1)),Ur(uZ,()=>s(!0))],eventOrder:{}}));by.show(eg);let ep=M.get(eg);s1.focus(ep)}}})(T.backstages.dialog),r=(E,D)=>vK.open((E,B,M)=>{let er=((T,E,D)=>{let B=la("dialog"),M=T.internalDialog,er=sV(M.title,B,D),ec=((T,E,D)=>{let B=qR(T,E,A.none(),D,!1);return by.parts.body(B)})({body:M.body,initialData:M.initialData},B,D),eu=lV(M.buttons),eg=cV(eu),ep=Ce(0!==eu.length,pV({buttons:eu},B,D)),eh=uV(()=>eD,aV(()=>ex,D.shared.providers,E),D.shared.getSink),ey=(T=>{switch(T){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}})(M.size),ex=iV({id:B,header:er,body:ec,footer:ep,extraClasses:ey,extraBehaviours:[],extraStyles:{}},T,eh,D),eO={getId:x(B),getRoot:x(ex),getBody:()=>by.getBody(ex),getFooter:()=>by.getFooter(ex),getFormWrapper:()=>{let T=by.getBody(ex);return aP.getCurrent(T).getOr(T)},toggleFullscreen:()=>{let T="tox-dialog--fullscreen",E=Fe(ex.element.dom);Ua(E,T)?(Pa(E,T),Wa(E,ey)):(ja(E,ey),La(E,T))}},eD=fV(eO,E.redial,eg);return{dialog:ex,instanceApi:eD}})({dataValidator:M,initialData:B,internalDialog:E},{redial:vK.redial,closeWindow:()=>{by.hide(er.dialog),D(er.instanceApi)}},T.backstages.dialog);return by.show(er.dialog),er.instanceApi.setData(B),er.instanceApi},E),a=(B,M,er,ec)=>vK.open((B,eu,eg)=>{let ep=SV(eu,eg),eh=Ql(),ey=T.backstages.popup.shared.header.isPositionedAtTop(),m=()=>eh.on(T=>{iN.reposition(T),pZ.refresh(T)}),ex=bV({dataValidator:eg,initialData:ep,internalDialog:B},{redial:vK.redial,closeWindow:()=>{eh.on(iN.hide),E.off("ResizeEditor",m),eh.clear(),er(ex.instanceApi)}},T.backstages.popup,ec.ariaAttrs),eO=ri(iN.sketch({lazySink:T.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:ec.persistent?{event:"doNotDismissYet"}:{},...ey?{}:{fireRepositionEventInstead:{}},inlineBehaviours:kl([Jp("window-manager-inline-events",[Ur(oU(),(T,E)=>{Fr(ex.dialog,uK)})]),...CV(E,D,ey)]),isExtraPart:(T,E)=>kV(E)}));return eh.set(eO),iN.showWithinBounds(eO,Sa(ex.dialog),{anchor:M},()=>{let T=E.inline?xt():Fe(E.getContainer()),D=Jo(T);return A.some(D)}),D&&ey||(pZ.refresh(eO),E.on("ResizeEditor",m)),ex.instanceApi.setData(ep),sq.focusIn(ex.dialog),ex.instanceApi},B),i=(D,B,M,er)=>vK.open((D,ec,eu)=>{let eg=SV(ec,eu),ep=Ql(),eh=T.backstages.popup.shared.header.isPositionedAtTop(),u=()=>ep.on(T=>{iN.reposition(T),pZ.refresh(T)}),ey=bV({dataValidator:eu,initialData:eg,internalDialog:D},{redial:vK.redial,closeWindow:()=>{ep.on(iN.hide),E.off("ResizeEditor ScrollWindow ElementScroll",u),ep.clear(),M(ey.instanceApi)}},T.backstages.popup,er.ariaAttrs),ex=ri(iN.sketch({lazySink:T.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:er.persistent?{event:"doNotDismissYet"}:{},...eh?{}:{fireRepositionEventInstead:{}},inlineBehaviours:kl([Jp("window-manager-inline-events",[Ur(oU(),(T,E)=>{Fr(ey.dialog,uK)})]),pZ.config({contextual:{lazyContext:()=>A.some(Jo(Fe(E.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top","bottom"],lazyViewport:T=>jw(E,T.element).map(T=>({bounds:Gw(T),optScrollEnv:A.some({currentScrollTop:T.element.dom.scrollTop,scrollElmTop:Xt(T.element).top})})).getOrThunk(()=>({bounds:en(),optScrollEnv:A.none()}))})]),isExtraPart:(T,E)=>kV(E)}));return ep.set(ex),iN.showWithinBounds(ex,Sa(ey.dialog),{anchor:B},()=>T.backstages.popup.shared.getSink().toOptional().bind(T=>{let D=jw(E,T.element).map(T=>Gw(T)).getOr(en()),B=Jo(Fe(E.getContentAreaContainer())),M=Qo(B,D);return A.some(Ko(M.x,M.y,M.width,M.height-15))})),pZ.refresh(ex),E.on("ResizeEditor ScrollWindow ElementScroll",u),ey.instanceApi.setData(eg),sq.focusIn(ey.dialog),ey.instanceApi},D);return{open:(E,D,B)=>{if(!ec(D)){if("toolbar"===D.inline)return a(E,T.backstages.popup.shared.anchors.inlineDialog(),B,D);if("bottom"===D.inline)return i(E,T.backstages.popup.shared.anchors.inlineBottomDialog(),B,D);if("cursor"===D.inline)return a(E,T.backstages.popup.shared.anchors.cursor(),B,D)}return r(E,B)},openUrl:(D,B)=>vK.openUrl(D=>{let M=wV(D,{closeWindow:()=>{by.hide(M.dialog),B(M.instanceApi)}},E,T.backstages.dialog);return by.show(M.dialog),M.instanceApi},D),alert:(T,E)=>{B.open(T,E)},close:T=>{T.close()},confirm:(T,E)=>{M.open(T,E)}}};ty.add("silver",T=>{uf(T),(T=>{let D=T.options.register,o=T=>f(T,E)?{value:Bx(T),valid:!0}:{valid:!1,message:"Must be an array of strings."},n=T=>eg(T)&&T>0?{value:T,valid:!0}:{valid:!1,message:"Must be a positive number."};D("color_map",{processor:o,default:["#BFEDD2","Light Green","#FBEEB8","Light Yellow","#F8CAC6","Light Red","#ECCAFA","Light Purple","#C2E0F4","Light Blue","#2DC26B","Green","#F1C40F","Yellow","#E03E2D","Red","#B96AD9","Purple","#3598DB","Blue","#169179","Dark Turquoise","#E67E23","Orange","#BA372A","Dark Red","#843FA1","Dark Purple","#236FA1","Dark Blue","#ECF0F1","Light Gray","#CED4D9","Medium Gray","#95A5A6","Gray","#7E8C8D","Dark Gray","#34495E","Navy Blue","#000000","Black","#ffffff","White"]}),D("color_map_background",{processor:o}),D("color_map_foreground",{processor:o}),D("color_cols",{processor:n,default:Nx(T)}),D("color_cols_foreground",{processor:n,default:Vx(T,d8)}),D("color_cols_background",{processor:n,default:Vx(T,d7)}),D("custom_colors",{processor:"boolean",default:!0}),D("color_default_foreground",{processor:"string",default:uo}),D("color_default_background",{processor:"string",default:uo})})(T),(T=>{let D=T.options.register;D("contextmenu_avoid_overlap",{processor:"string",default:""}),D("contextmenu_never_use_native",{processor:"boolean",default:!1}),D("contextmenu",{processor:T=>!1===T?{value:[],valid:!0}:E(T)||f(T,E)?{value:yB(T),valid:!0}:{valid:!1,message:"Must be false or a string."},default:"link linkchecker image editimage table spellchecker configurepermanentpen"})})(T);let t=()=>en(),{dialogs:D,popups:B,renderUI:M}=NF(T,{getPopupSinkBounds:()=>t()});Lw(T,B.backstage.shared);let er=OV({editor:T,backstages:{popup:B.backstage,dialog:D.backstage}});return{renderUI:async()=>{let E=await M();return jw(T,B.getMothership().element).each(T=>{t=()=>Gw(T)}),E},getWindowManagerImpl:x(er),getNotificationManagerImpl:()=>((T,E,D)=>{let B=E.backstage.shared,s=()=>{let E=Jo(Fe(T.getContentAreaContainer())),D=en(),B=Yi(D.x,E.x,E.right),M=Yi(D.y,E.y,E.bottom),er=Math.max(E.right,D.right),ec=Math.max(E.bottom,D.bottom);return A.some(Ko(B,M,er-B,ec-M))};return{open:(E,M)=>{let a=()=>{M(),iN.hide(ec)},er=ri(iG.sketch({text:E.text,level:R(["success","error","warning","warn","info"],E.type)?E.type:void 0,progress:!0===E.progressBar,icon:E.icon,closeButton:E.closeButton,onAction:a,iconProvider:B.providers.icons,translationProvider:B.providers.translate})),ec=ri(iN.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:B.getSink,fireDismissalEventInstead:{},...B.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}}}));D.add(ec),eg(E.timeout)&&E.timeout>0&&iU.setEditorTimeout(T,()=>{a()},E.timeout);let eu={close:a,reposition:()=>{let E=Sa(er),D={maxHeightFunction:n4()},M=T.notificationManager.getNotifications();if(M[0]===eu){let T={...B.anchors.banner(),overrides:D};iN.showWithinBounds(ec,E,{anchor:T},s)}else I(M,eu).each(T=>{let B=M[T-1].getEl(),er={type:"node",root:xt(),node:A.some(Fe(B)),overrides:D,layouts:{onRtl:()=>[cl],onLtr:()=>[cl]}};iN.showWithinBounds(ec,E,{anchor:er},s)})},text:T=>{iG.updateText(er,T)},settings:E,getEl:()=>er.element.dom,progressBar:{value:T=>{iG.updateProgress(er,T)}}};return eu},close:T=>{T.close()},getArgs:T=>T.settings}})(T,{backstage:B.backstage},B.getMothership())}})}();