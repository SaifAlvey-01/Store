!function(){"use strict";let T=Object.getPrototypeOf,t=(T,E,B)=>{var M;return!!B(T,E.prototype)||(null===(M=T.constructor)||void 0===M?void 0:M.name)===E.name},o=T=>E=>(T=>{let E=typeof T;return null===T?"null":"object"===E&&Array.isArray(T)?"array":"object"===E&&t(T,String,(T,E)=>E.isPrototypeOf(T))?"string":E})(E)===T,n=T=>E=>typeof E===T,s=T=>E=>T===E,E=o("string"),B=o("object"),i=E=>{var M;return M=Object,B(E)&&t(E,M,(E,B)=>T(E)===B)},M=o("array"),D=s(null),er=n("boolean"),ea=s(void 0),m=T=>null==T,g=T=>!m(T),es=n("function"),eu=n("number"),f=(T,E)=>{if(M(T)){for(let B=0,M=T.length;B<M;++B)if(!E(T[B]))return!1;return!0}return!1},b=()=>{},v=T=>()=>T(),y=(T,E)=>(...B)=>T(E.apply(null,B)),x=T=>()=>T,w=T=>T,S=(T,E)=>T===E;function k(T,...E){return(...B)=>{let M=E.concat(B);return T.apply(null,M)}}let C=T=>E=>!T(E),O=T=>()=>{throw Error(T)},_=T=>T(),eg=x(!1),ep=x(!0);let A=class A{constructor(T,E){this.tag=T,this.value=E}static some(T){return new A(!0,T)}static none(){return A.singletonNone}fold(T,E){return this.tag?E(this.value):T()}isSome(){return this.tag}isNone(){return!this.tag}map(T){return this.tag?A.some(T(this.value)):A.none()}bind(T){return this.tag?T(this.value):A.none()}exists(T){return this.tag&&T(this.value)}forall(T){return!this.tag||T(this.value)}filter(T){return!this.tag||T(this.value)?this:A.none()}getOr(T){return this.tag?this.value:T}or(T){return this.tag?this:T}getOrThunk(T){return this.tag?this.value:T()}orThunk(T){return this.tag?this:T()}getOrDie(T){if(this.tag)return this.value;throw Error(null!=T?T:"Called getOrDie on None")}static from(T){return g(T)?A.some(T):A.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(T){this.tag&&T(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};A.singletonNone=new A(!1);let eh=Array.prototype.slice,ef=Array.prototype.indexOf,ex=Array.prototype.push,I=(T,E)=>ef.call(T,E),F=(T,E)=>{let B=I(T,E);return -1===B?A.none():A.some(B)},R=(T,E)=>I(T,E)>-1,N=(T,E)=>{for(let B=0,M=T.length;B<M;B++)if(E(T[B],B))return!0;return!1},V=(T,E)=>{let B=[];for(let M=0;M<T;M++)B.push(E(M));return B},z=(T,E)=>{let B=[];for(let M=0;M<T.length;M+=E){let D=eh.call(T,M,M+E);B.push(D)}return B},L=(T,E)=>{let B=T.length,M=Array(B);for(let D=0;D<B;D++){let B=T[D];M[D]=E(B,D)}return M},H=(T,E)=>{for(let B=0,M=T.length;B<M;B++)E(T[B],B)},P=(T,E)=>{let B=[],M=[];for(let D=0,er=T.length;D<er;D++){let er=T[D];(E(er,D)?B:M).push(er)}return{pass:B,fail:M}},U=(T,E)=>{let B=[];for(let M=0,D=T.length;M<D;M++){let D=T[M];E(D,M)&&B.push(D)}return B},W=(T,E,B)=>(((T,E)=>{for(let B=T.length-1;B>=0;B--)E(T[B],B)})(T,(T,M)=>{B=E(B,T,M)}),B),j=(T,E,B)=>(H(T,(T,M)=>{B=E(B,T,M)}),B),G=(T,E)=>((T,E,B)=>{for(let M=0,D=T.length;M<D;M++){let D=T[M];if(E(D,M))return A.some(D);if(B(D,M))break}return A.none()})(T,E,eg),$=(T,E)=>{for(let B=0,M=T.length;B<M;B++)if(E(T[B],B))return A.some(B);return A.none()},q=T=>{let E=[];for(let B=0,D=T.length;B<D;++B){if(!M(T[B]))throw Error("Arr.flatten item "+B+" was not an array, input: "+T);ex.apply(E,T[B])}return E},Y=(T,E)=>q(L(T,E)),X=(T,E)=>{for(let B=0,M=T.length;B<M;++B)if(!0!==E(T[B],B))return!1;return!0},K=T=>{let E=eh.call(T,0);return E.reverse(),E},J=(T,E)=>U(T,T=>!R(E,T)),Z=(T,E)=>{let B={};for(let M=0,D=T.length;M<D;M++){let D=T[M];B[String(D)]=E(D,M)}return B},Q=T=>[T],ee=(T,E)=>{let B=eh.call(T,0);return B.sort(E),B},te=(T,E)=>E>=0&&E<T.length?A.some(T[E]):A.none(),oe=T=>te(T,0),ne=T=>te(T,T.length-1),eC=es(Array.from)?Array.from:T=>eh.call(T),re=(T,E)=>{for(let B=0;B<T.length;B++){let M=E(T[B],B);if(M.isSome())return M}return A.none()},eO=Object.keys,eM=Object.hasOwnProperty,le=(T,E)=>{let B=eO(T);for(let M=0,D=B.length;M<D;M++){let D=B[M];E(T[D],D)}},ce=(T,E)=>de(T,(T,B)=>({k:B,v:E(T,B)})),de=(T,E)=>{let B={};return le(T,(T,M)=>{let D=E(T,M);B[D.k]=D.v}),B},ue=T=>(E,B)=>{T[B]=E},me=(T,E,B,M)=>{le(T,(T,D)=>{(E(T,D)?B:M)(T,D)})},ge=(T,E)=>{let B={};return me(T,E,ue(B),b),B},pe=(T,E)=>{let B=[];return le(T,(T,M)=>{B.push(E(T,M))}),B},he=(T,E)=>{let B=eO(T);for(let M=0,D=B.length;M<D;M++){let D=B[M],er=T[D];if(E(er,D,T))return A.some(er)}return A.none()},fe=T=>pe(T,w),be=(T,E)=>ve(T,E)?A.from(T[E]):A.none(),ve=(T,E)=>eM.call(T,E),ye=(T,E)=>ve(T,E)&&void 0!==T[E]&&null!==T[E],xe=(T,E,B=S)=>T.exists(T=>B(T,E)),we=T=>{let E=[],o=T=>{E.push(T)};for(let E=0;E<T.length;E++)T[E].each(o);return E},Se=(T,E,B)=>T.isSome()&&E.isSome()?A.some(B(T.getOrDie(),E.getOrDie())):A.none(),ke=(T,E)=>null!=T?A.some(E(T)):A.none(),Ce=(T,E)=>T?A.some(E):A.none(),Oe=(T,E,B)=>""===E||T.length>=E.length&&T.substr(B,B+E.length)===E,_e=(T,E)=>{var B;return Ee(T,E)?(B=E.length,T.substring(B)):T},Te=(T,E,B=0,M)=>{let D=T.indexOf(E,B);return -1!==D&&(!!ea(M)||D+E.length<=M)},Ee=(T,E)=>Oe(T,E,0),Ae=(T,E)=>Oe(T,E,T.length-E.length),eD=(o3=/^\s+|\s+$/g,T=>T.replace(o3,"")),De=T=>T.length>0,Be=T=>!De(T),Ie=T=>void 0!==T.style&&es(T.style.getPropertyValue),Fe=T=>{if(null==T)throw Error("Node cannot be null or undefined");return{dom:T}},Re=(T,E)=>{let B=(E||document).createElement("div");if(B.innerHTML=T,!B.hasChildNodes()||B.childNodes.length>1){let E="HTML does not have a single root node";throw console.error(E,T),Error(E)}return Fe(B.childNodes[0])},Ne=(T,E)=>{let B=(E||document).createElement(T);return Fe(B)},Ve=(T,E)=>{let B=(E||document).createTextNode(T);return Fe(B)},eI="undefined"!=typeof window?window:Function("return this;")(),He=(T,E)=>((T,E)=>{let B=null!=E?E:eI;for(let E=0;E<T.length&&null!=B;++E)B=B[T[E]];return B})(T.split("."),E),eL=Object.getPrototypeOf,Ue=T=>{let E=He("ownerDocument.defaultView",T);return B(T)&&(((T,E)=>{let B=He(T,E);if(null==B)throw Error(T+" not available on this browser");return B})("HTMLElement",E).prototype.isPrototypeOf(T)||/^HTML\w*Element$/.test(eL(T).constructor.name))},We=T=>T.dom.nodeName.toLowerCase(),je=T=>E=>E.dom.nodeType===T,Ge=T=>eV(T)&&Ue(T.dom),eV=je(1),eH=je(3),eN=je(9),eW=je(11),Ke=T=>E=>eV(E)&&We(E)===T,Je=(T,E)=>{let B=T.dom;if(1!==B.nodeType)return!1;if(void 0!==B.matches)return B.matches(E);if(void 0!==B.msMatchesSelector)return B.msMatchesSelector(E);if(void 0!==B.webkitMatchesSelector)return B.webkitMatchesSelector(E);if(void 0!==B.mozMatchesSelector)return B.mozMatchesSelector(E);throw Error("Browser lacks native selectors")},Ze=T=>1!==T.nodeType&&9!==T.nodeType&&11!==T.nodeType||0===T.childElementCount,Qe=(T,E)=>T.dom===E.dom,et=(T,E)=>{let B=T.dom,M=E.dom;return B!==M&&B.contains(M)},tt=T=>Fe(T.dom.ownerDocument),ot=T=>eN(T)?T:tt(T),nt=T=>Fe(ot(T).dom.documentElement),st=T=>Fe(ot(T).dom.defaultView),rt=T=>A.from(T.dom.parentNode).map(Fe),at=T=>A.from(T.dom.parentElement).map(Fe),it=T=>A.from(T.dom.offsetParent).map(Fe),lt=T=>L(T.dom.childNodes,Fe),ct=(T,E)=>{let B=T.dom.childNodes;return A.from(B[E]).map(Fe)},dt=T=>ct(T,0),ut=(T,E)=>({element:T,offset:E}),mt=(T,E)=>{let B=lt(T);return B.length>0&&E<B.length?ut(B[E],0):ut(T,E)},gt=T=>eW(T)&&g(T.dom.host),ez=es(Element.prototype.attachShadow)&&es(Node.prototype.getRootNode),eP=x(ez),eU=ez?T=>Fe(T.dom.getRootNode()):ot,bt=T=>gt(T)?T:Fe(ot(T).dom.body),vt=T=>{let E=eU(T);return gt(E)?A.some(E):A.none()},yt=T=>Fe(T.dom.host),xt=T=>{let E=eH(T)?T.dom.parentNode:T.dom;if(null==E||null===E.ownerDocument)return!1;let B=E.ownerDocument;return vt(Fe(E)).fold(()=>B.body.contains(E),T=>xt(yt(T)))},wt=()=>St(Fe(document)),St=T=>{let E=T.dom.body;if(null==E)throw Error("Body is not available yet");return Fe(E)},kt=(T,B,M)=>{if(!(E(M)||er(M)||eu(M)))throw console.error("Invalid call to Attribute.set. Key ",B,":: Value ",M,":: Element ",T),Error("Attribute value was not simple");T.setAttribute(B,M+"")},Ct=(T,E,B)=>{kt(T.dom,E,B)},Ot=(T,E)=>{let B=T.dom;le(E,(T,E)=>{kt(B,E,T)})},_t=(T,E)=>{let B=T.dom.getAttribute(E);return null===B?void 0:B},Tt=(T,E)=>A.from(_t(T,E)),Et=(T,E)=>{let B=T.dom;return!(!B||!B.hasAttribute)&&B.hasAttribute(E)},At=(T,E)=>{T.dom.removeAttribute(E)},Mt=(T,B,M)=>{if(!E(M))throw console.error("Invalid call to CSS.set. Property ",B,":: Value ",M,":: Element ",T),Error("CSS value must be a string: "+M);Ie(T)&&T.style.setProperty(B,M)},Dt=(T,E)=>{Ie(T)&&T.style.removeProperty(E)},Bt=(T,E,B)=>{let M=T.dom;Mt(M,E,B)},It=(T,E)=>{let B=T.dom;le(E,(T,E)=>{Mt(B,E,T)})},Ft=(T,E)=>{let B=T.dom;le(E,(T,E)=>{T.fold(()=>{Dt(B,E)},T=>{Mt(B,E,T)})})},Rt=(T,E)=>{let B=T.dom,M=window.getComputedStyle(B).getPropertyValue(E);return""!==M||xt(T)?M:Nt(B,E)},Nt=(T,E)=>Ie(T)?T.style.getPropertyValue(E):"",Vt=(T,E)=>{let B=T.dom,M=Nt(B,E);return A.from(M).filter(T=>T.length>0)},zt=T=>{let E={},B=T.dom;if(Ie(B))for(let T=0;T<B.style.length;T++){let M=B.style.item(T);E[M]=B.style[M]}return E},Lt=(T,E,B)=>{let M=Ne(T);return Bt(M,E,B),Vt(M,E).isSome()},Ht=(T,E)=>{let B=T.dom;Dt(B,E),xe(Tt(T,"style").map(eD),"")&&At(T,"style")},Pt=T=>T.dom.offsetWidth,Ut=(T,E)=>{let o=B=>{let M=E(B);if(M<=0||null===M){let E=Rt(B,T);return parseFloat(E)||0}return M},n=(T,E)=>j(E,(E,B)=>{let M=Rt(T,B),D=void 0===M?0:parseInt(M,10);return isNaN(D)?E:E+D},0);return{set:(E,B)=>{if(!eu(B)&&!B.match(/^[0-9]+$/))throw Error(T+".set accepts only positive integer values. Value was "+B);let M=E.dom;Ie(M)&&(M.style[T]=B+"px")},get:o,getOuter:o,aggregate:n,max:(T,E,B)=>{let M=n(T,B);return E>M?E-M:0}}},eG=Ut("height",T=>{let E=T.dom;return xt(T)?E.getBoundingClientRect().height:E.offsetHeight}),jt=T=>eG.get(T),Gt=T=>eG.getOuter(T),$t=(T,E)=>({left:T,top:E,translate:(B,M)=>$t(T+B,E+M)}),Yt=(T,E)=>void 0!==T?T:void 0!==E?E:0,Xt=T=>{let E=T.dom.ownerDocument,B=E.body,M=E.defaultView,D=E.documentElement;if(B===T.dom)return $t(B.offsetLeft,B.offsetTop);let er=Yt(null==M?void 0:M.pageYOffset,D.scrollTop),ea=Yt(null==M?void 0:M.pageXOffset,D.scrollLeft),es=Yt(D.clientTop,B.clientTop),eu=Yt(D.clientLeft,B.clientLeft);return Kt(T).translate(ea-eu,er-es)},Kt=T=>{let E=T.dom,B=E.ownerDocument.body;return B===E?$t(B.offsetLeft,B.offsetTop):xt(T)?(T=>{let E=T.getBoundingClientRect();return $t(E.left,E.top)})(E):$t(0,0)},e$=Ut("width",T=>T.dom.offsetWidth),Zt=T=>e$.get(T),Qt=T=>e$.getOuter(T),eo=T=>{let E,B=!1;return(...M)=>(B||(B=!0,E=T.apply(null,M)),E)},to=()=>oo(0,0),oo=(T,E)=>({major:T,minor:E}),ej={nu:oo,detect:(T,E)=>{let B=String(E).toLowerCase();return 0===T.length?to():((T,E)=>{let B=((T,E)=>{for(let B=0;B<T.length;B++){let M=T[B];if(M.test(E))return M}})(T,E);if(!B)return{major:0,minor:0};let n=T=>Number(E.replace(B,"$"+T));return oo(n(1),n(2))})(T,B)},unknown:to},so=(T,E)=>{let B=String(E).toLowerCase();return G(T,T=>T.search(B))},eY=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ao=T=>E=>Te(E,T),eX=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:T=>Te(T,"edge/")&&Te(T,"chrome")&&Te(T,"safari")&&Te(T,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,eY],search:T=>Te(T,"chrome")&&!Te(T,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:T=>Te(T,"msie")||Te(T,"trident")},{name:"Opera",versionRegexes:[eY,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ao("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ao("firefox")},{name:"Safari",versionRegexes:[eY,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:T=>(Te(T,"safari")||Te(T,"mobile/"))&&Te(T,"applewebkit")}],eq=[{name:"Windows",search:ao("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:T=>Te(T,"iphone")||Te(T,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ao("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:ao("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ao("linux"),versionRegexes:[]},{name:"Solaris",search:ao("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ao("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ao("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],eK={browsers:x(eX),oses:x(eq)},eZ="Edge",eJ="Chromium",eQ="Opera",e0="Firefox",e1="Safari",fo=T=>{let E=T.current,B=T.version,n=T=>()=>E===T;return{current:E,version:B,isEdge:n(eZ),isChromium:n(eJ),isIE:n("IE"),isOpera:n(eQ),isFirefox:n(e0),isSafari:n(e1)}},bo=()=>fo({current:void 0,version:ej.unknown()}),e2=(x(eZ),x(eJ),x("IE"),x(eQ),x(e0),x(e1),"Windows"),e3="Android",e5="Linux",e9="macOS",e6="Solaris",e4="FreeBSD",e8="ChromeOS",_o=T=>{let E=T.current,B=T.version,n=T=>()=>E===T;return{current:E,version:B,isWindows:n(e2),isiOS:n("iOS"),isAndroid:n(e3),isMacOS:n(e9),isLinux:n(e5),isSolaris:n(e6),isFreeBSD:n(e4),isChromeOS:n(e8)}},To=()=>_o({current:void 0,version:ej.unknown()}),e7=(x(e2),x("iOS"),x(e3),x(e5),x(e9),x(e6),x(e4),x(e8),T=>window.matchMedia(T).matches),tr=eo(()=>((T,E,B)=>{let M=eK.browsers(),D=eK.oses(),er=E.bind(T=>re(T.brands,T=>{let E=T.brand.toLowerCase();return G(M,T=>{var B;return E===(null===(B=T.brand)||void 0===B?void 0:B.toLowerCase())}).map(E=>({current:E.name,version:ej.nu(parseInt(T.version,10),0)}))})).orThunk(()=>so(M,T).map(E=>{let B=ej.detect(E.versionRegexes,T);return{current:E.name,version:B}})).fold(bo,fo),ea=so(D,T).map(E=>{let B=ej.detect(E.versionRegexes,T);return{current:E.name,version:B}}).fold(To,_o),es=((T,E,B,M)=>{let D=T.isiOS()&&!0===/ipad/i.test(B),er=T.isiOS()&&!D,ea=T.isiOS()||T.isAndroid(),es=ea||M("(pointer:coarse)"),eu=D||!er&&ea&&M("(min-device-width:768px)"),eg=er||ea&&!eu,ep=E.isSafari()&&T.isiOS()&&!1===/safari/i.test(B),eh=!eg&&!eu&&!ep;return{isiPad:x(D),isiPhone:x(er),isTablet:x(eu),isPhone:x(eg),isTouch:x(es),isAndroid:T.isAndroid,isiOS:T.isiOS,isWebView:x(ep),isDesktop:x(eh)}})(ea,er,T,B);return{browser:er,os:ea,deviceType:es}})(navigator.userAgent,A.from(navigator.userAgentData),e7)),Bo=()=>tr(),Io=T=>{let E=Fe((T=>{if(eP()&&g(T.target)){let E=Fe(T.target);if(eV(E)&&g(E.dom.shadowRoot)&&T.composed&&T.composedPath){let E=T.composedPath();if(E)return oe(E)}}return A.from(T.target)})(T).getOr(T.target)),o=()=>T.stopPropagation(),n=()=>T.preventDefault(),B=y(n,o);return{target:E,x:T.clientX,y:T.clientY,stop:o,prevent:n,kill:B,raw:T}},Fo=(T,E,B,M,D)=>{let r=T=>{B(T)&&M(Io(T))};return T.dom.addEventListener(E,r,D),{unbind:k(Ro,T,E,r,D)}},Ro=(T,E,B,M)=>{T.dom.removeEventListener(E,B,M)},No=(T,E)=>{rt(T).each(B=>{B.dom.insertBefore(E.dom,T.dom)})},Vo=(T,E)=>{let B=A.from(T.dom.nextSibling).map(Fe);B.fold(()=>{rt(T).each(T=>{Lo(T,E)})},T=>{No(T,E)})},zo=(T,E)=>{dt(T).fold(()=>{Lo(T,E)},B=>{T.dom.insertBefore(E.dom,B.dom)})},Lo=(T,E)=>{T.dom.appendChild(E.dom)},Ho=(T,E)=>{H(E,E=>{Lo(T,E)})},Po=T=>{T.dom.textContent="",H(lt(T),T=>{Uo(T)})},Uo=T=>{let E=T.dom;null!==E.parentNode&&E.parentNode.removeChild(E)},Wo=T=>{let E=void 0!==T?T.dom:document,B=E.body.scrollLeft||E.documentElement.scrollLeft,M=E.body.scrollTop||E.documentElement.scrollTop;return $t(B,M)},jo=(T,E,B)=>{let M=(void 0!==B?B.dom:document).defaultView;M&&M.scrollTo(T,E)},Go=(T,E,B,M)=>({x:T,y:E,width:B,height:M,right:T+B,bottom:E+M}),$o=T=>{let E=void 0===T?window:T,B=E.document,M=Wo(Fe(B));return(T=>{let E=void 0===T?window:T;return Bo().browser.isFirefox()?A.none():A.from(E.visualViewport)})(E).fold(()=>{let T=E.document.documentElement,B=T.clientWidth,D=T.clientHeight;return Go(M.left,M.top,B,D)},T=>Go(Math.max(T.pageLeft,M.left),Math.max(T.pageTop,M.top),T.width,T.height))},qo=()=>Fe(document),Yo=(T,E)=>T.view(E).fold(x([]),E=>{let B=T.owner(E),M=Yo(T,B);return[E].concat(M)});var tl,tu,tg,tf,tx=Object.freeze({__proto__:null,view:T=>{var E;return(T.dom===document?A.none():A.from(null===(E=T.dom.defaultView)||void 0===E?void 0:E.frameElement)).map(Fe)},owner:T=>tt(T)});let Ko=T=>{let E=qo(),B=Wo(E),M=((T,E)=>{let B=E.owner(T),M=Yo(E,B);return A.some(M)})(T,tx);return M.fold(k(Xt,T),E=>{let M=Kt(T),D=W(E,(T,E)=>{let B=Kt(E);return{left:T.left+B.left,top:T.top+B.top}},{left:0,top:0});return $t(D.left+M.left+B.left,D.top+M.top+B.top)})},Jo=(T,E,B,M)=>({x:T,y:E,width:B,height:M,right:T+B,bottom:E+M}),Zo=T=>{let E=Xt(T),B=Qt(T),M=Gt(T);return Jo(E.left,E.top,B,M)},Qo=T=>{let E=Ko(T),B=Qt(T),M=Gt(T);return Jo(E.left,E.top,B,M)},en=(T,E)=>{let B=Math.max(T.x,E.x),M=Math.max(T.y,E.y),D=Math.min(T.right,E.right),er=Math.min(T.bottom,E.bottom);return Jo(B,M,D-B,er-M)},tn=()=>$o(window);var tO=tinymce.util.Tools.resolve("tinymce.ThemeManager");let nn=T=>{let t=E=>E(T),E=x(T),n=()=>B,B={tag:!0,inner:T,fold:(E,B)=>B(T),isValue:ep,isError:eg,map:E=>tE.value(E(T)),mapError:n,bind:t,exists:t,forall:t,getOr:E,or:n,getOrThunk:E,orThunk:n,getOrDie:E,each:E=>{E(T)},toOptional:()=>A.some(T)};return B},sn=T=>{let t=()=>E,E={tag:!1,inner:T,fold:(E,B)=>E(T),isValue:eg,isError:ep,map:t,mapError:E=>tE.error(E(T)),bind:t,exists:eg,forall:ep,getOr:w,or:w,getOrThunk:_,orThunk:_,getOrDie:O(String(T)),each:b,toOptional:A.none};return E},tE={value:nn,error:sn,fromOption:(T,E)=>T.fold(()=>sn(E),nn)};(o2=o5||(o5={}))[o2.Error=0]="Error",o2[o2.Value=1]="Value";let ln=(T,E,B)=>T.stype===o5.Error?E(T.serror):B(T.svalue),cn=T=>({stype:o5.Value,svalue:T}),dn=T=>({stype:o5.Error,serror:T}),pn=(T,E,B,M)=>({tag:"field",key:T,newKey:E,presence:B,prop:M}),hn=(T,E,B)=>{switch(T.tag){case"field":return E(T.key,T.newKey,T.presence,T.prop);case"custom":return B(T.newKey,T.instantiator)}},fn=T=>(...E)=>{if(0===E.length)throw Error("Can't merge zero objects");let B={};for(let M=0;M<E.length;M++){let D=E[M];for(let E in D)ve(D,E)&&(B[E]=T(B[E],D[E]))}return B},tM=fn((T,E)=>i(T)&&i(E)?tM(T,E):E),tD=fn((T,E)=>E),yn=T=>({tag:"defaultedThunk",process:T}),xn=T=>yn(x(T)),wn=T=>({tag:"mergeWithThunk",process:T}),Sn=T=>{var E;let B=(T=>{let E=[],B=[];return H(T,T=>{ln(T,T=>B.push(T),T=>E.push(T))}),{values:E,errors:B}})(T);return B.errors.length>0?(E=B.errors,y(dn,q)(E)):cn(B.values)},kn=T=>B(T)&&eO(T).length>100?" removed due to size":JSON.stringify(T,null,2),Cn=(T,E)=>dn([{path:T,getErrorInfo:E}]),On=T=>({extract:(E,B)=>{var M,D;return(M=T(B)).stype===o5.Error?(D=M.serror,Cn(E,x(D))):M},toString:x("val")}),tL=On(cn),Tn=(T,E,B,M)=>M(be(T,E).getOrThunk(()=>B(T))),En=(T,E,B,M,D)=>{var er;let r=T=>D.extract(E.concat([M]),T),a=T=>T.fold(()=>cn(A.none()),T=>{var B,er;return B=D.extract(E.concat([M]),T),er=A.some,B.stype===o5.Value?{stype:o5.Value,svalue:er(B.svalue)}:B});switch(T.tag){case"required":return be(B,M).fold(()=>Cn(E,()=>'Could not find valid *required* value for "'+M+'" in '+kn(B)),r);case"defaultedThunk":return Tn(B,M,T.process,r);case"option":return a(be(B,M));case"defaultedOptionThunk":return er=T.process,a(be(B,M).map(T=>!0===T?er(B):T));case"mergeWithThunk":return Tn(B,M,x({}),E=>{let M=tM(T.process(B),E);return r(M)})}},An=T=>({extract:(E,B)=>T().extract(E,B),toString:()=>T().toString()}),Mn=T=>eO(ge(T,g)),Dn=T=>{let E=Bn(T),B=W(T,(T,E)=>hn(E,E=>tM(T,{[E]:!0}),x(T)),{});return{extract:(T,M)=>{let D=er(M)?[]:Mn(M),ea=U(D,T=>!ye(B,T));return 0===ea.length?E.extract(T,M):Cn(T,()=>"There are unsupported fields: ["+ea.join(", ")+"] specified")},toString:E.toString}},Bn=T=>({extract:(E,B)=>((T,E,B)=>{let M={},D=[];for(let er of B)hn(er,(B,er,ea,es)=>{let eu=En(ea,T,E,B,es);ln(eu,T=>{D.push(...T)},T=>{M[er]=T})},(T,B)=>{M[T]=B(E)});return D.length>0?dn(D):cn(M)})(E,B,T),toString:()=>{let E=L(T,T=>hn(T,(T,E,B,M)=>T+" -> "+M.toString(),(T,E)=>"state("+T+")"));return"obj{\n"+E.join("\n")+"}"}}),In=T=>({extract:(E,B)=>{let M=L(B,(B,M)=>T.extract(E.concat(["["+M+"]"]),B));return Sn(M)},toString:()=>"array("+T.toString()+")"}),Fn=(T,E)=>{let B=void 0!==E?E:w;return{extract:(E,M)=>{let D=[];for(let er of T){let T=er.extract(E,M);if(T.stype===o5.Value)return{stype:o5.Value,svalue:B(T.svalue)};D.push(T)}return Sn(D)},toString:()=>"oneOf("+L(T,T=>T.toString()).join(", ")+")"}},Rn=(T,E)=>({extract:(B,M)=>{let D=eO(M),er=In(On(T)).extract(B,D);return er.stype===o5.Value?(T=>{let D=L(T,T=>pn(T,T,{tag:"required",process:{}},E));return Bn(D).extract(B,M)})(er.svalue):er},toString:()=>"setOf("+E.toString()+")"}),tV=y(In,Bn),tH=x(tL),zn=(T,E)=>On(B=>{let M=typeof B;return T(B)?cn(B):dn(`Expected type: ${E} but got: ${M}`)}),tN=zn(eu,"number"),tW=zn(E,"string"),tz=zn(er,"boolean"),tP=zn(es,"function"),Wn=T=>{if(Object(T)!==T)return!0;switch(({}).toString.call(T).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(T).every(E=>Wn(T[E]));default:return!1}},tU=On(T=>Wn(T)?cn(T):dn("Expected value to be acceptable for sending via postMessage")),Gn=(T,E)=>({extract:(B,M)=>be(M,T).fold(()=>Cn(B,()=>'Choice schema did not contain choice key: "'+T+'"'),T=>be(E,T).fold(()=>Cn(B,()=>'The chosen schema: "'+T+'" did not exist in branches: '+kn(E)),E=>E.extract(B.concat(["branch: "+T]),M))),toString:()=>"chooseOn("+T+"). Possible values: "+eO(E)}),$n=T=>On(E=>T(E).fold(dn,cn)),qn=(T,E)=>Rn(E=>T(E).fold(dn,cn),E),Yn=(T,E,B)=>{var M;return ln((M=E.extract([T],B)).stype===o5.Error?{stype:o5.Error,serror:{input:B,errors:M.serror}}:M,tE.error,tE.value)},Xn=T=>T.fold(T=>{throw Error(Jn(T))},w),Kn=(T,E,B)=>Xn(Yn(T,E,B)),Jn=T=>"Errors: \n"+(T=>{let E=T.length>10?T.slice(0,10).concat([{path:[],getErrorInfo:x("... (only showing first ten failures)")}]):T;return L(E,T=>"Failed path: ("+T.path.join(" > ")+")\n"+T.getErrorInfo())})(T.errors).join("\n")+"\n\nInput object: "+kn(T.input),Zn=(T,E)=>Gn(T,ce(E,Bn)),Qn=(T,E)=>((T,E)=>{let B=eo(E);return{extract:(T,E)=>B().extract(T,E),toString:()=>B().toString()}})(0,E),ts=(T,E)=>({tag:"custom",newKey:T,instantiator:E}),os=T=>$n(E=>R(T,E)?tE.value(E):tE.error(`Unsupported value: "${E}", choose one of "${T.join(", ")}".`)),ns=T=>pn(T,T,{tag:"required",process:{}},tH()),ss=(T,E)=>pn(T,T,{tag:"required",process:{}},E),rs=T=>ss(T,tN),as=T=>ss(T,tW),is=(T,E)=>pn(T,T,{tag:"required",process:{}},os(E)),ls=T=>ss(T,tP),cs=(T,E)=>pn(T,T,{tag:"required",process:{}},Bn(E)),ds=(T,E)=>pn(T,T,{tag:"required",process:{}},tV(E)),us=(T,E)=>pn(T,T,{tag:"required",process:{}},In(E)),ms=T=>pn(T,T,{tag:"option",process:{}},tH()),gs=(T,E)=>pn(T,T,{tag:"option",process:{}},E),ps=T=>gs(T,tN),hs=T=>gs(T,tW),fs=(T,E)=>gs(T,os(E)),bs=T=>gs(T,tP),vs=(T,E)=>gs(T,In(E)),ys=(T,E)=>gs(T,Bn(E)),xs=(T,E)=>pn(T,T,xn(E),tH()),ws=(T,E,B)=>pn(T,T,xn(E),B),Ss=(T,E)=>ws(T,E,tN),ks=(T,E)=>ws(T,E,tW),Cs=(T,E,B)=>ws(T,E,os(B)),Os=(T,E)=>ws(T,E,tz),_s=(T,E)=>ws(T,E,tP),Ts=(T,E,B)=>ws(T,E,In(B)),Es=(T,E,B)=>ws(T,E,Bn(B)),As=T=>{let E=T;return{get:()=>E,set:T=>{E=T}}},Ms=T=>{if(!M(T))throw Error("cases must be an array");if(0===T.length)throw Error("there must be at least one case");let E=[],B={};return H(T,(D,er)=>{let ea=eO(D);if(1!==ea.length)throw Error("one and only one name per case");let es=ea[0],eu=D[es];if(void 0!==B[es])throw Error("duplicate key detected:"+es);if("cata"===es)throw Error("cannot have a case named cata (sorry)");if(!M(eu))throw Error("case arguments must be an array");E.push(es),B[es]=(...B)=>{let M=B.length;if(M!==eu.length)throw Error("Wrong number of arguments to case "+es+". Expected "+eu.length+" ("+eu+"), got "+M);return{fold:(...E)=>{if(E.length!==T.length)throw Error("Wrong number of arguments to fold. Expected "+T.length+", got "+E.length);return E[er].apply(null,B)},match:T=>{let M=eO(T);if(E.length!==M.length)throw Error("Wrong number of arguments to match. Expected: "+E.join(",")+"\nActual: "+M.join(","));if(!X(E,T=>R(M,T)))throw Error("Not all branches were specified when using match. Specified: "+M.join(", ")+"\nRequired: "+E.join(", "));return T[es].apply(null,B)},log:T=>{console.log(T,{constructors:E,constructor:es,params:B})}}}}),B};Ms([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);let Ds=(T,E)=>({[T]:E}),Bs=T=>(T=>{let E={};return H(T,T=>{E[T.key]=T.value}),E})(T),Is=T=>es(T)?T:eg,Fs=(T,E,B)=>{let M=T.dom,D=Is(B);for(;M.parentNode;){M=M.parentNode;let T=Fe(M),B=E(T);if(B.isSome())return B;if(D(T))break}return A.none()},Rs=(T,E,B)=>{let M=E(T),D=Is(B);return M.orThunk(()=>D(T)?A.none():Fs(T,E,D))},Ns=(T,E)=>Qe(T.element,E.event.target),tG={can:ep,abort:eg,run:b},zs=T=>{if(!ye(T,"can")&&!ye(T,"abort")&&!ye(T,"run"))throw Error("EventHandler defined by: "+JSON.stringify(T,null,2)+" does not have can, abort, or run!");return{...tG,...T}},t$=x("touchstart"),tj=x("touchmove"),tY=x("touchend"),tX=x("touchcancel"),tq=x("mousedown"),tK=x("mousemove"),tZ=x("mouseout"),tJ=x("mouseup"),tQ=x("mouseover"),t0=x("focusin"),t1=x("focusout"),t2=x("keydown"),t3=x("keyup"),t5=x("input"),t9=x("change"),t6=x("click"),t4=x("transitioncancel"),t8=x("transitionend"),t7=x("transitionstart"),on=x("selectstart"),ar=T=>x("alloy."+T),or={tap:ar("tap")},od=ar("focus"),ou=ar("blur.post"),og=ar("paste.post"),of=ar("receive"),ox=ar("execute"),oC=ar("focus.item"),ok=or.tap,oO=ar("longpress"),oE=ar("sandbox.close"),oM=ar("typeahead.cancel"),oR=ar("system.init"),oL=ar("system.touchmove"),oV=ar("system.touchend"),oH=ar("system.scroll"),oN=ar("system.resize"),oW=ar("system.attached"),oz=ar("system.detached"),oP=ar("system.dismissRequested"),oU=ar("system.repositionRequested"),oG=ar("focusmanager.shifted"),o$=ar("slotcontainer.visibility"),oj=ar("system.external.element.scroll"),oY=ar("change.tab"),oX=ar("dismiss.tab"),oq=ar("highlight"),oK=ar("dehighlight"),Fr=(T,E)=>{zr(T,T.element,E,{})},Rr=(T,E,B)=>{zr(T,T.element,E,B)},Nr=T=>{Fr(T,ox())},Vr=(T,E,B)=>{zr(T,E,B,{})},zr=(T,E,B,M)=>{let D={target:E,...M};T.getSystem().triggerEvent(B,E,D)},Lr=(T,E,B,M)=>{T.getSystem().triggerEvent(B,E,M.event)},Hr=T=>Bs(T),Pr=(T,E)=>({key:T,value:zs({abort:E})}),Ur=T=>({key:T,value:zs({run:(T,E)=>{E.event.prevent()}})}),Wr=(T,E)=>({key:T,value:zs({run:E})}),jr=(T,E,B)=>({key:T,value:zs({run:(T,M)=>{E.apply(void 0,[T,M].concat(B))}})}),Gr=T=>E=>({key:T,value:zs({run:(T,B)=>{Ns(T,B)&&E(T,B)}})}),$r=(T,E,B)=>{var M;return M=E.partUids[B],Wr(T,(E,B)=>{E.getSystem().getByUid(M).each(E=>{Lr(E,E.element,T,B)})})},qr=(T,E)=>Wr(T,(T,B)=>{let M=B.event,D=T.getSystem().getByDom(M.target).getOrThunk(()=>Rs(M.target,E=>T.getSystem().getByDom(E).toOptional(),eg).getOr(T));E(T,D,B)}),Yr=T=>Wr(T,(T,E)=>{E.cut()}),Xr=T=>Wr(T,(T,E)=>{E.stop()}),Kr=(T,E)=>Gr(T)(E),oZ=Gr(oW()),oJ=Gr(oz()),oQ=Gr(oR()),o0=(o9=ox(),T=>Wr(o9,T)),ta=T=>T.dom.innerHTML,oa=(T,E)=>{let B=tt(T).dom,M=Fe(B.createDocumentFragment()),D=((T,E)=>{let B=(E||document).createElement("div");return B.innerHTML=T,lt(Fe(B))})(E,B);Ho(M,D),Po(T),Lo(T,M)},na=(T,E)=>Fe(T.dom.cloneNode(E)),sa=T=>(T=>{if(gt(T))return"#shadow-root";{let E=na(T,!1);return(T=>{let E=Ne("div"),B=Fe(T.dom.cloneNode(!0));return Lo(E,B),ta(E)})(E)}})(T),o1=Hr([{key:od(),value:zs({can:(T,E)=>{let B=E.event,M=B.originator,D=B.target;return!Qe(M,T.element)||!!Qe(M,D)||(console.warn(od()+" did not get interpreted by the desired target. \nOriginator: "+sa(M)+"\nTarget: "+sa(D)+"\nCheck the "+od()+" event handlers"),!1)}})}]);var o2,o3,o5,o9,o6=Object.freeze({__proto__:null,events:o1});let o4=0,ca=T=>{let E=(new Date).getTime();return T+"_"+Math.floor(1e9*Math.random())+ ++o4+String(E)},o8=x("alloy-id-"),o7=x("data-alloy-id"),no=o8(),nr=o7(),pa=(T,E)=>{Object.defineProperty(T.dom,nr,{value:E,writable:!0})},ha=T=>{let E=eV(T)?T.dom[nr]:null;return A.from(E)},fa=T=>ca(T),va=T=>{let t=E=>`The component must be in a context to execute: ${E}`+(T?"\n"+sa(T().element)+" is not in context.":""),o=T=>()=>{throw Error(t(T))},n=T=>()=>{console.warn(t(T))};return{debugInfo:x("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),build:o("build"),buildOrPatch:o("buildOrPatch"),addToWorld:o("addToWorld"),removeFromWorld:o("removeFromWorld"),addToGui:o("addToGui"),removeFromGui:o("removeFromGui"),getByUid:o("getByUid"),getByDom:o("getByDom"),isConnected:eg}},ng=va(),xa=T=>L(T,T=>Ae(T,"/*")?T.substring(0,T.length-2):T),wa=(T,E)=>{let B=T.toString(),M=B.indexOf(")")+1,D=B.indexOf("("),er=B.substring(D+1,M-1).split(/,\s*/);return T.toFunctionAnnotation=()=>({name:E,parameters:xa(er)}),T},nh=ca("alloy-premade"),ka=T=>(Object.defineProperty(T.element.dom,nh,{value:T.uid,writable:!0}),Ds(nh,T)),Ca=T=>be(T,nh),Oa=T=>((T,E)=>{let B=E.toString(),M=B.indexOf(")")+1,D=B.indexOf("("),er=B.substring(D+1,M-1).split(/,\s*/);return T.toFunctionAnnotation=()=>({name:"OVERRIDE",parameters:xa(er.slice(1))}),T})((E,...B)=>T(E.getApis(),E,...B),T),nf={init:()=>Ta({readState:x("No State required")})},Ta=T=>T,Ea=(T,E)=>{let B={};return le(T,(T,M)=>{le(T,(T,D)=>{let er=be(B,D).getOr([]);B[D]=er.concat([E(M,T)])})}),B},Aa=T=>({classes:ea(T.classes)?[]:T.classes,attributes:ea(T.attributes)?{}:T.attributes,styles:ea(T.styles)?{}:T.styles}),Ma=T=>T.cHandler,Da=(T,E)=>({name:T,handler:E}),Ba=(T,E)=>{let B={};return H(T,T=>{B[T.name()]=T.handlers(E)}),B},Ia=(T,E,B)=>{let M=E[B];return M?((T,E,B,M)=>{try{let D=ee(B,(B,D)=>{let er=B[E],ea=D[E],es=M.indexOf(er),eu=M.indexOf(ea);if(-1===es)throw Error("The ordering for "+T+" does not have an entry for "+er+".\nOrder specified: "+JSON.stringify(M,null,2));if(-1===eu)throw Error("The ordering for "+T+" does not have an entry for "+ea+".\nOrder specified: "+JSON.stringify(M,null,2));return es<eu?-1:eu<es?1:0});return tE.value(D)}catch(T){return tE.error([T])}})("Event: "+B,"name",T,M).map(T=>{var E;return E=L(T,T=>T.handler),{can:(...T)=>j(E,(E,B)=>E&&(0,B.can).apply(void 0,T),!0),abort:(...T)=>j(E,(E,B)=>E||(0,B.abort).apply(void 0,T),!1),run:(...T)=>{H(E,E=>{E.run.apply(void 0,T)})}}}):tE.error(["The event ("+B+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(L(T,T=>T.name),null,2)])},Fa=(T,E)=>((T,E)=>{var B,M;let D=(T=>{let E=[],B=[];return H(T,T=>{T.fold(T=>{E.push(T)},T=>{B.push(T)})}),{errors:E,values:B}})(T);return D.errors.length>0?(B=D.errors,tE.error(q(B))):0===(M=D.values).length?tE.value(E):tE.value(tM(E,tD.apply(void 0,M)))})(pe(T,(T,B)=>(1===T.length?tE.value(T[0].handler):Ia(T,E,B)).map(M=>{let D=(T=>{let E=es(T)?{can:ep,abort:eg,run:T}:T;return(T,B,...M)=>{let D=[T,B].concat(M);E.abort.apply(void 0,D)?B.stop():E.can.apply(void 0,D)&&E.run.apply(void 0,D)}})(M),er=T.length>1?U(E[B],E=>N(T,T=>T.name===E)).join(" > "):T[0].name;return Ds(B,{handler:D,purpose:er})})),{}),nb="alloy.base.behaviour",nx=Bn([pn("dom","dom",{tag:"required",process:{}},Bn([ns("tag"),xs("styles",{}),xs("classes",[]),xs("attributes",{}),ms("value"),ms("innerHtml")])),ns("components"),ns("uid"),xs("events",{}),xs("apis",{}),pn("eventOrder","eventOrder",wn(x({[ox()]:["disabling",nb,"toggling","typeaheadevents"],[od()]:[nb,"focusing","keying"],[oR()]:[nb,"disabling","toggling","representing"],[t5()]:[nb,"representing","streaming","invalidating"],[oz()]:[nb,"representing","item-events","tooltipping"],[tq()]:["focusing",nb,"item-type-events"],[t$()]:["focusing",nb,"item-type-events"],[tQ()]:["item-type-events","tooltipping"],[of()]:["receiving","reflecting","tooltipping"]})),tH()),ms("domModification")]),Va=T=>T.events,za=(T,E)=>{let B=_t(T,E);return void 0===B||""===B?[]:B.split(" ")},La=T=>void 0!==T.dom.classList,Ha=T=>za(T,"class"),Pa=(T,E)=>((T,E,B)=>{let M=za(T,E).concat([B]);return Ct(T,E,M.join(" ")),!0})(T,"class",E),Ua=(T,E)=>((T,E,B)=>{let M=U(za(T,E),T=>T!==B);return M.length>0?Ct(T,E,M.join(" ")):At(T,E),!1})(T,"class",E),Wa=(T,E)=>{La(T)?T.dom.classList.add(E):Pa(T,E)},ja=T=>{0===(La(T)?T.dom.classList:Ha(T)).length&&At(T,"class")},Ga=(T,E)=>{La(T)?T.dom.classList.remove(E):Ua(T,E),ja(T)},$a=(T,E)=>La(T)&&T.dom.classList.contains(E),qa=(T,E)=>{H(E,E=>{Wa(T,E)})},Ya=(T,E)=>{H(E,E=>{Ga(T,E)})},Xa=T=>La(T)?(T=>{let E=T.dom.classList,B=Array(E.length);for(let T=0;T<E.length;T++){let M=E.item(T);null!==M&&(B[T]=M)}return B})(T):Ha(T),Ka=T=>T.dom.value,Ja=(T,E)=>{if(void 0===E)throw Error("Value.set was undefined");T.dom.value=E},Za=(T,E,B)=>{B.fold(()=>Lo(T,E),T=>{Qe(T,E)||(No(T,E),Uo(T))})},Qa=(T,E,B)=>{let M=L(E,B),D=lt(T);return H(D.slice(M.length),Uo),M},ei=(T,E,B,M)=>{let D=ct(T,E),er=M(B,D),ea=ct(T,E).map(T=>{if(D.exists(E=>!Qe(E,T))){let E=D.map(We).getOr("span"),B=Ne(E);return No(T,B),B}return T});return Za(T,er.element,ea),er},ti=(T,E)=>{let B=eO(T),M=eO(E),D=J(M,B),er=((T,B)=>{let M={},D={};return me(T,(T,B)=>!ve(E,B)||T!==E[B],ue(M),ue(D)),{t:M,f:D}})(T).t;return{toRemove:D,toSet:er}},oi=(T,E)=>{let B=E.filter(E=>We(E)===T.tag&&(!T.innerHtml.isSome()||!(T.domChildren.length>0))&&!ve(E.dom,nh)).bind(E=>((T,E)=>{try{let B=((T,E)=>{let{class:B,style:M,...D}=j(E.dom.attributes,(T,E)=>(T[E.name]=E.value,T),{}),{toSet:er,toRemove:ea}=ti(T.attributes,D),es=zt(E),{toSet:eu,toRemove:eg}=ti(T.styles,es),ep=Xa(E),eh=J(ep,T.classes),ef=J(T.classes,ep);return H(ea,T=>At(E,T)),Ot(E,er),qa(E,ef),Ya(E,eh),H(eg,T=>Ht(E,T)),It(E,eu),T.innerHtml.fold(()=>{let B=T.domChildren;Qa(E,B,(T,B)=>{let M=ct(E,B);return Za(E,T,M),T})},T=>{oa(E,T)}),(()=>{let B=T.value.getOrUndefined();B!==Ka(E)&&Ja(E,null!=B?B:"")})(),E})(T,E);return A.some(B)}catch(T){return A.none()}})(T,E)).getOrThunk(()=>(T=>{let E=Ne(T.tag);Ot(E,T.attributes),qa(E,T.classes),It(E,T.styles),T.innerHtml.each(T=>oa(E,T));let B=T.domChildren;return Ho(E,B),T.value.each(T=>{Ja(E,T)}),E})(T));return pa(B,T.uid),B},ni=T=>{let E=(T=>{let E=be(T,"behaviours").getOr({});return Y(eO(E),T=>{let B=E[T];return g(B)?[B.me]:[]})})(T);return((T,E)=>{let B=L(E,T=>ys(T.name(),[ns("config"),xs("state",nf)])),M=Yn("component.behaviours",Bn(B),T.behaviours).fold(E=>{throw Error(Jn(E)+"\nComplete spec:\n"+JSON.stringify(T,null,2))},w);return{list:E,data:ce(M,T=>{let E=T.map(T=>({config:T.config,state:T.state.init(T.config)}));return x(E)})}})(T,E)},si=(T,E)=>{let o=()=>ef,B=As(ng),M=Xn(Yn("custom.definition",nx,T)),D=ni(T),er=D.list,ea=D.data,eu=((T,E,B)=>{let M={...T.dom,uid:T.uid,domChildren:L(T.components,T=>T.element)},D=T.domModification.fold(()=>Aa({}),Aa),er=E.length>0?((T,E,B,M)=>{let D={...E};H(B,E=>{D[E.name()]=E.exhibit(T,M)});let er=Ea(D,(T,E)=>({name:T,modification:E})),a=T=>W(T,(T,E)=>({...E.modification,...T}),{}),ea=W(er.classes,(T,E)=>E.modification.concat(T),[]),es=a(er.attributes),eu=a(er.styles);return Aa({classes:ea,attributes:es,styles:eu})})(B,{"alloy.base.modification":D},E,M):D;return{...M,attributes:{...M.attributes,...er.attributes},styles:{...M.styles,...er.styles},classes:M.classes.concat(er.classes)}})(M,er,ea),eg=oi(eu,E),ep=((T,E,B)=>{let M={"alloy.base.behaviour":Va(T)};return((T,E,B,M)=>{let D=((T,E,B)=>{let M={...B,...Ba(E,T)};return Ea(M,Da)})(T,B,M);return Fa(D,E)})(B,T.eventOrder,E,M).getOrDie()})(M,er,ea),eh=As(M.components),ef={uid:T.uid,getSystem:B.get,config:E=>(es(ea[E.name()])?ea[E.name()]:()=>{throw Error("Could not find "+E.name()+" in "+JSON.stringify(T,null,2))})(),hasConfigured:T=>es(ea[T.name()]),spec:T,readState:T=>ea[T]().map(T=>T.state.readState()).getOr("not enabled"),getApis:()=>M.apis,connect:T=>{B.set(T)},disconnect:()=>{B.set(va(o))},element:eg,syncComponents:()=>{let T=lt(eg),E=Y(T,T=>B.get().getByDom(T).fold(()=>[],Q));eh.set(E)},components:eh.get,events:ep};return ef},ri=T=>{let E=Ve(T);return ai({element:E})},ai=T=>{let E=Kn("external.component",Dn([ns("element"),ms("uid")]),T),B=As(va()),M=E.uid.getOrThunk(()=>fa("external"));pa(E.element,M);let D={uid:M,getSystem:B.get,config:A.none,hasConfigured:eg,connect:T=>{B.set(T)},disconnect:()=>{B.set(va(()=>D))},getApis:()=>({}),element:E.element,spec:T,readState:x("No state"),syncComponents:b,components:x([]),events:{}};return ka(D)},li=(T,E)=>Ca(T).getOrThunk(()=>((T,E)=>{let{events:B,...M}=w(T),D=((T,E)=>{let B=be(T,"components").getOr([]);return E.fold(()=>L(B,ci),T=>L(B,(E,B)=>li(E,ct(T,B))))})(M,E),er={...M,events:{...o6,...B},components:D};return tE.value(si(er,E))})(ve(T,"uid")?T:{uid:fa(""),...T},E).getOrDie()),ci=T=>li(T,A.none());var mi=(T,E,B,M,D)=>T(B,M)?A.some(B):es(D)&&D(B)?A.none():E(B,M,D);let gi=(T,E,B)=>{let M=T.dom,D=es(B)?B:eg;for(;M.parentNode;){M=M.parentNode;let T=Fe(M);if(E(T))return A.some(T);if(D(T))break}return A.none()},pi=(T,E,B)=>mi((T,E)=>E(T),gi,T,E,B),hi=(T,E,B)=>pi(T,E,B).isSome(),fi=(T,E,B)=>gi(T,T=>Je(T,E),B),bi=(T,E)=>G(T.dom.childNodes,T=>Je(Fe(T),E)).map(Fe),vi=(T,E)=>((T,E)=>{let B=void 0===E?document:E.dom;return Ze(B)?A.none():A.from(B.querySelector(T)).map(Fe)})(E,T),yi=(T,E,B)=>mi((T,E)=>Je(T,E),fi,T,E,B),nw="aria-controls",wi=()=>{let T=ca(nw);return{id:T,link:E=>{Ct(E,nw,T)},unlink:T=>{At(T,nw)}}},Si=(T,E)=>hi(E,E=>Qe(E,T.element),eg)||pi(E,T=>{if(!eV(T))return!1;let E=_t(T,"id");return void 0!==E&&E.indexOf(nw)>-1}).bind(T=>{let E=_t(T,"id"),B=eU(T);return vi(B,`[${nw}="${E}"]`)}).exists(E=>Si(T,E));(lq=lQ||(lQ={}))[lq.STOP=0]="STOP",lq[lq.NORMAL=1]="NORMAL",lq[lq.LOGGING=2]="LOGGING";let nC=As({}),nO=["alloy/data/Fields","alloy/debugging/Debugging"],_i=(T,E,B)=>((T,E,B)=>{switch(be(nC.get(),T).orThunk(()=>{let E=eO(nC.get());return re(E,E=>T.indexOf(E)>-1?A.some(nC.get()[E]):A.none())}).getOr(lQ.NORMAL)){case lQ.NORMAL:return B(nB());case lQ.LOGGING:{let M=((T,E)=>{let B=[],M=(new Date).getTime();return{logEventCut:(T,E,M)=>{B.push({outcome:"cut",target:E,purpose:M})},logEventStopped:(T,E,M)=>{B.push({outcome:"stopped",target:E,purpose:M})},logNoParent:(T,E,M)=>{B.push({outcome:"no-parent",target:E,purpose:M})},logEventNoHandlers:(T,E)=>{B.push({outcome:"no-handlers-left",target:E})},logEventResponse:(T,E,M)=>{B.push({outcome:"response",purpose:M,target:E})},write:()=>{let D=(new Date).getTime();R(["mousemove","mouseover","mouseout",oR()],T)||console.log(T,{event:T,time:D-M,target:E.dom,sequence:L(B,T=>R(["cut","stopped","response"],T.outcome)?"{"+T.purpose+"} "+T.outcome+" at ("+sa(T.target)+")":T.outcome)})}}})(T,E),D=B(M);return M.write(),D}case lQ.STOP:return!0}})(T,E,B),nB=x({logEventCut:b,logEventStopped:b,logNoParent:b,logEventNoHandlers:b,logEventResponse:b,write:b}),nM=x([ns("menu"),ns("selectedMenu")]),nR=x([ns("item"),ns("selectedItem")]);x(Bn(nR().concat(nM())));let nL=x(Bn(nR())),nV=cs("initSize",[ns("numColumns"),ns("numRows")]),Bi=()=>cs("markers",[ns("backgroundMenu")].concat(nM()).concat(nR())),Ii=T=>cs("markers",L(T,ns)),Fi=(T,E,B)=>((()=>{let T=Error();if(void 0!==T.stack){let E=T.stack.split("\n");G(E,T=>T.indexOf("alloy")>0&&!N(nO,E=>T.indexOf(E)>-1)).getOr("unknown")}})(),pn(E,E,B,$n(T=>tE.value((...E)=>T.apply(void 0,E))))),Ri=T=>Fi(0,T,xn(b)),Ni=T=>Fi(0,T,xn(A.none)),Vi=T=>Fi(0,T,{tag:"required",process:{}}),zi=T=>Fi(0,T,{tag:"required",process:{}}),Li=(T,E)=>ts(T,x(E)),Hi=T=>ts(T,w),nH=x(nV),Ui=(T,E,B,M,D,er,ea,es=!1)=>({x:T,y:E,bubble:B,direction:M,placement:D,restriction:er,label:`${ea}-${D}`,alwaysFit:es}),nN=Ms([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),nW=nN.southeast,nz=nN.southwest,nP=nN.northeast,nU=nN.northwest,nG=nN.south,n$=nN.north,nj=nN.east,nY=nN.west,Zi=(T,E,B,M)=>{let D=T+E;return D>M?B:D<B?M:D},Qi=(T,E,B)=>Math.min(Math.max(T,E),B),el=(T,E)=>Z(["left","right","top","bottom"],B=>be(E,B).map(E=>((T,E)=>{switch(E){case 1:return T.x;case 0:return T.x+T.width;case 2:return T.y;case 3:return T.y+T.height}})(T,E))),nX="layout",ol=T=>T.x,nl=(T,E)=>T.x+T.width/2-E.width/2,sl=(T,E)=>T.x+T.width-E.width,rl=(T,E)=>T.y-E.height,al=T=>T.y+T.height,il=(T,E)=>T.y+T.height/2-E.height/2,ll=(T,E,B)=>Ui(ol(T),al(T),B.southeast(),nW(),"southeast",el(T,{left:1,top:3}),nX),cl=(T,E,B)=>Ui(sl(T,E),al(T),B.southwest(),nz(),"southwest",el(T,{right:0,top:3}),nX),dl=(T,E,B)=>Ui(ol(T),rl(T,E),B.northeast(),nP(),"northeast",el(T,{left:1,bottom:2}),nX),ul=(T,E,B)=>Ui(sl(T,E),rl(T,E),B.northwest(),nU(),"northwest",el(T,{right:0,bottom:2}),nX),ml=(T,E,B)=>Ui(nl(T,E),rl(T,E),B.north(),n$(),"north",el(T,{bottom:2}),nX),gl=(T,E,B)=>Ui(nl(T,E),al(T),B.south(),nG(),"south",el(T,{top:3}),nX),pl=(T,E,B)=>Ui(T.x+T.width,il(T,E),B.east(),nj(),"east",el(T,{left:0}),nX),hl=(T,E,B)=>Ui(T.x-E.width,il(T,E),B.west(),nY(),"west",el(T,{right:1}),nX),fl=()=>[ll,cl,dl,ul,gl,ml,pl,hl],bl=()=>[cl,ll,ul,dl,gl,ml,pl,hl],vl=()=>[dl,ul,ll,cl,ml,gl],yl=()=>[ul,dl,cl,ll,ml,gl],xl=()=>[ll,cl,dl,ul,gl,ml],wl=()=>[cl,ll,ul,dl,gl,ml];var nq=Object.freeze({__proto__:null,events:T=>Hr([Wr(of(),(E,B)=>{let M=T.channels,D=eO(M),er=B.universal?D:U(D,T=>R(B.channels,T));H(er,T=>{let D=M[T],er=D.schema,ea=Kn("channel["+T+"] data\nReceiver: "+sa(E.element),er,B.data);D.onReceive(E,ea)})})])}),nK=[ss("channels",qn(tE.value,Dn([Vi("onReceive"),xs("schema",tH())])))];let Cl=(T,E,B)=>oQ((M,D)=>{B(M,T,E)}),Ol=T=>({key:T,value:void 0}),_l=(T,E,B,M,D,er,ea)=>{let i=T=>ye(T,B)?T[B]():A.none(),es=ce(D,(T,E)=>((T,E,B)=>{let M=B.toString(),D=M.indexOf(")")+1,er=M.indexOf("("),ea=M.substring(er+1,D-1).split(/,\s*/);return T.toFunctionAnnotation=()=>({name:E,parameters:xa(ea.slice(0,1).concat(ea.slice(3)))}),T})((M,...D)=>{let er=[M].concat(D);return M.config({name:x(B)}).fold(()=>{throw Error("We could not find any behaviour configuration for: "+B+". Using API: "+E)},E=>{let B=Array.prototype.slice.call(er,1);return T.apply(void 0,[M,E.config,E.state].concat(B))})},E,T)),eu={...ce(er,(T,E)=>wa(T,E)),...es,revoke:k(Ol,B),config:E=>{let M=Kn(B+"-config",T,E);return{key:B,value:{config:M,me:eu,configAsRaw:eo(()=>Kn(B+"-config",T,E)),initialConfig:E,state:ea}}},schema:x(E),exhibit:(T,E)=>Se(i(T),be(M,"exhibit"),(T,B)=>B(E,T.config,T.state)).getOrThunk(()=>Aa({})),name:x(B),handlers:T=>i(T).map(T=>be(M,"events").getOr(()=>({}))(T.config,T.state)).getOr({})};return eu},Tl=T=>Bs(T),nZ=Dn([ns("fields"),ns("name"),xs("active",{}),xs("apis",{}),xs("state",nf),xs("extra",{})]),Al=T=>{let E=Kn("Creating behaviour: "+T.name,nZ,T);return((T,E,B,M,D,er)=>{let ea=Dn(T),es=ys(E,[gs("config",Dn(T))]);return _l(ea,es,E,B,M,D,er)})(E.fields,E.name,E.active,E.apis,E.extra,E.state)},nJ=Dn([ns("branchKey"),ns("branches"),ns("name"),xs("active",{}),xs("apis",{}),xs("state",nf),xs("extra",{})]),Dl=T=>{let E=Kn("Creating behaviour: "+T.name,nJ,T);return((T,E,B,M,D,er)=>{let ea=ys(E,[gs("config",T)]);return _l(T,ea,E,B,M,D,er)})(Zn(E.branchKey,E.branches),E.name,E.active,E.apis,E.extra,E.state)},nQ=x(void 0),n0=Al({fields:nK,name:"receiving",active:nq});var n1=Object.freeze({__proto__:null,exhibit:(T,E)=>Aa({classes:[],styles:E.useFixed()?{}:{position:"relative"}})});let Rl=(T,E=!1)=>T.dom.focus({preventScroll:E}),Nl=T=>T.dom.blur(),Vl=T=>{let E=eU(T).dom;return T.dom===E.activeElement},zl=(T=qo())=>A.from(T.dom.activeElement).map(Fe),Ll=T=>zl(eU(T)).filter(E=>T.dom.contains(E.dom)),Hl=(T,E)=>{let B=eU(E),M=zl(B).bind(T=>{let o=E=>Qe(T,E);return o(E)?A.some(E):((T,E)=>{let o=T=>{for(let B=0;B<T.childNodes.length;B++){let M=Fe(T.childNodes[B]);if(E(M))return A.some(M);let D=o(T.childNodes[B]);if(D.isSome())return D}return A.none()};return o(T.dom)})(E,o)}),D=T(E);return M.each(T=>{zl(B).filter(E=>Qe(E,T)).fold(()=>{Rl(T)},b)}),D},Pl=(T,E,B,M,D)=>{let r=T=>T+"px";return{position:T,left:E.map(r),top:B.map(r),right:M.map(r),bottom:D.map(r)}},Ul=(T,E)=>{Ft(T,{...E,position:A.some(E.position)})},n2=Ms([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),jl=(T,E,B,M,D,er)=>{let ea=E.rect,es=ea.x-B,eu=ea.y-M,eg=D-(es+ea.width),ep=er-(eu+ea.height),eh=A.some(es),ef=A.some(eu),ex=A.some(eg),eC=A.some(ep),eO=A.none();return E.direction.fold(()=>Pl(T,eh,ef,eO,eO),()=>Pl(T,eO,ef,ex,eO),()=>Pl(T,eh,eO,eO,eC),()=>Pl(T,eO,eO,ex,eC),()=>Pl(T,eh,ef,eO,eO),()=>Pl(T,eh,eO,eO,eC),()=>Pl(T,eh,ef,eO,eO),()=>Pl(T,eO,ef,ex,eO))},Gl=(T,E)=>T.fold(()=>{let T=E.rect;return Pl("absolute",A.some(T.x),A.some(T.y),A.none(),A.none())},(T,B,M,D)=>jl("absolute",E,T,B,M,D),(T,B,M,D)=>jl("fixed",E,T,B,M,D)),$l=(T,E)=>{let B=k(Ko,E),M=T.fold(B,B,()=>{let T=Wo();return Ko(E).translate(-T.left,-T.top)}),D=Qt(E),er=Gt(E);return Jo(M.left,M.top,D,er)},ql=(T,E)=>E.fold(()=>T.fold(tn,tn,Jo),E=>T.fold(x(E),x(E),()=>{let B=Yl(T,E.x,E.y);return Jo(B.left,B.top,E.width,E.height)})),Yl=(T,E,B)=>{let M=$t(E,B);return T.fold(x(M),x(M),()=>{let T=Wo();return M.translate(-T.left,-T.top)})};n2.none;let n3=n2.relative,n5=n2.fixed,n9="data-alloy-placement",Zl=T=>Tt(T,n9),n6=Ms([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),ec=(T,E,B,M)=>{let D=T.bubble,er=D.offset,ea=((T,E,B)=>{let n=(M,D)=>E[M].map(E=>{let er="top"===M||"bottom"===M,ea=er?B.top:B.left,es=("left"===M||"top"===M?Math.max:Math.min)(E,D)+ea;return er?Qi(es,T.y,T.bottom):Qi(es,T.x,T.right)}).getOr(D),M=n("left",T.x),D=n("top",T.y),er=n("right",T.right),ea=n("bottom",T.bottom);return Jo(M,D,er-M,ea-D)})(M,T.restriction,er),es=T.x+er.left,eu=T.y+er.top,eg=Jo(es,eu,E,B),{originInBounds:ep,sizeInBounds:eh,visibleW:ef,visibleH:ex}=((T,E)=>{let{x:B,y:M,right:D,bottom:er}=E,{x:ea,y:es,right:eu,bottom:eg,width:ep,height:eh}=T;return{originInBounds:ea>=B&&ea<=D&&es>=M&&es<=er,sizeInBounds:eu<=D&&eu>=B&&eg<=er&&eg>=M,visibleW:Math.min(ep,ea>=B?D-ea:eu-B),visibleH:Math.min(eh,es>=M?er-es:eg-M)}})(eg,ea),eC=ep&&eh,eO=eC?eg:((T,E)=>{let{x:B,y:M,right:D,bottom:er}=E,{x:ea,y:es,width:eu,height:eg}=T,ep=Math.max(B,D-eu),eh=Math.max(M,er-eg),ef=Qi(ea,B,ep),ex=Qi(es,M,eh),eC=Math.min(ef+eu,D)-ef,eO=Math.min(ex+eg,er)-ex;return Jo(ef,ex,eC,eO)})(eg,ea),eM=eO.width>0&&eO.height>0,{maxWidth:eD,maxHeight:eI}=((T,E,B)=>{let M=x(E.bottom-B.y),D=x(B.bottom-E.y),er=T.fold(D,D,M,M,D,M,D,D),ea=x(E.right-B.x),es=x(B.right-E.x),eu=T.fold(es,ea,es,ea,es,es,es,ea);return{maxWidth:eu,maxHeight:er}})(T.direction,eO,M),eL={rect:eO,maxHeight:eI,maxWidth:eD,direction:T.direction,placement:T.placement,classes:{on:D.classesOn,off:D.classesOff},layout:T.label,testY:eu};return eC||T.alwaysFit?n6.fit(eL):n6.nofit(eL,ef,ex,eM)},tc=T=>{let E=As(A.none()),o=()=>E.get().each(T);return{clear:()=>{o(),E.set(A.none())},isSet:()=>E.get().isSome(),get:()=>E.get(),set:T=>{o(),E.set(A.some(T))}}},oc=()=>tc(T=>T.unbind()),nc=()=>{let T=tc(b);return{...T,on:E=>T.get().each(E)}},rc=(T,E,B)=>Fo(T,E,ep,B,!1),ac=(T,E,B)=>Fo(T,E,ep,B,!0),n4=["top","bottom","right","left"],n8="data-alloy-transition-timer",dc=(T,B,M,D,er,ea)=>{let es=ea.exists(T=>{let E=D.mode;return"all"===E||T[E]!==er[E]});if(es||X(D.classes,E=>$a(T,E))){Bt(T,"position",M.position);let ea=$l(B,T),eu=Gl(B,{...er,rect:ea}),eg=Z(n4,T=>eu[T]);((T,E)=>{let o=T=>parseFloat(T).toFixed(3);return he(E,(E,B)=>!((T,E,B=S)=>Se(T,E,B).getOr(T.isNone()&&E.isNone()))(T[B].map(o),E.map(o))).isSome()})(M,eg)&&(Ft(T,eg),es&&(qa(T,D.classes),Tt(T,n8).each(E=>{clearTimeout(parseInt(E,10)),At(T,n8)}),((T,B)=>{let M;let D=oc(),er=oc(),a=E=>{var B;let M=null!==(B=E.raw.pseudoElement)&&void 0!==B?B:"";return Qe(E.target,T)&&Be(M)&&R(n4,E.raw.propertyName)},i=E=>{if(m(E)||a(E)){D.clear(),er.clear();let ea=null==E?void 0:E.raw.type;(m(ea)||ea===t8())&&(clearTimeout(M),At(T,n8),Ya(T,B.classes))}},ea=rc(T,t7(),E=>{a(E)&&(ea.unbind(),D.set(rc(T,t8(),i)),er.set(rc(T,t4(),i)))}),es=(T=>{let t=E=>{let B=Rt(T,E).split(/\s*,\s*/);return U(B,De)},o=T=>{if(E(T)&&/^[\d.]+/.test(T)){let E=parseFloat(T);return Ae(T,"ms")?E:1e3*E}return 0},B=t("transition-delay"),M=t("transition-duration");return j(M,(T,E,M)=>{let D=o(B[M])+o(E);return Math.max(T,D)},0)})(T);requestAnimationFrame(()=>{Ct(T,n8,M=setTimeout(i,es+17))})})(T,D)),Pt(T))}else Ya(T,D.classes)},uc=(T,E)=>{((T,E)=>{let B=eG.max(T,E,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);Bt(T,"max-height",B+"px")})(T,Math.floor(E))},n7=x((T,E)=>{uc(T,E),It(T,{"overflow-x":"hidden","overflow-y":"auto"})}),ro=x((T,E)=>{uc(T,E)}),pc=(T,E,B)=>void 0===T[E]?B:T[E],hc=(T,E,B,M)=>{let D=((T,E,B,M)=>{Ht(E,"max-height"),Ht(E,"max-width");let D={width:Qt(E),height:Gt(E)};return((T,E,B,M,D,er)=>{let ea=M.width,es=M.height,l=(E,eu,eg,ep,eh)=>{let ef=E(B,M,D,T,er),ex=ec(ef,ea,es,er);return ex.fold(x(ex),(T,E,B,M)=>(eh===M?B>ep||E>eg:!eh&&M)?ex:n6.nofit(eu,eg,ep,eh))};return j(E,(T,E)=>{let B=k(l,E);return T.fold(x(T),B)},n6.nofit({rect:B,maxHeight:M.height,maxWidth:M.width,direction:nW(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:B.y},-1,-1,!1)).fold(w,w)})(E,M.preference,T,D,B,M.bounds)})(T,E,B,M);return((T,E,B)=>{let M=Gl(B.origin,E);B.transition.each(D=>{dc(T,B.origin,M,D,E,B.lastPlacement)}),Ul(T,M)})(E,D,M),Ct(E,n9,D.placement),((T,E)=>{let B=E.classes;Ya(T,B.off),qa(T,B.on)})(E,D),((T,E,B)=>{(0,B.maxHeightFunction)(T,E.maxHeight)})(E,D,M),((T,E,B)=>{(0,B.maxWidthFunction)(T,E.maxWidth)})(E,D,M),{layout:D.layout,placement:D.placement}},rn=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],bc=(T,E,B,M=1)=>{let D=T*M,er=E*M,a=T=>be(B,T).getOr([]),i=(T,E,B)=>{let M=J(rn,B);return{offset:$t(T,E),classesOn:Y(B,a),classesOff:Y(M,a)}};return{southeast:()=>i(-T,E,["top","alignLeft"]),southwest:()=>i(T,E,["top","alignRight"]),south:()=>i(-T/2,E,["top","alignCentre"]),northeast:()=>i(-T,-E,["bottom","alignLeft"]),northwest:()=>i(T,-E,["bottom","alignRight"]),north:()=>i(-T/2,-E,["bottom","alignCentre"]),east:()=>i(T,-E/2,["valignCentre","left"]),west:()=>i(-T,-E/2,["valignCentre","right"]),insetNortheast:()=>i(D,er,["top","alignLeft","inset"]),insetNorthwest:()=>i(-D,er,["top","alignRight","inset"]),insetNorth:()=>i(-D/2,er,["top","alignCentre","inset"]),insetSoutheast:()=>i(D,-er,["bottom","alignLeft","inset"]),insetSouthwest:()=>i(-D,-er,["bottom","alignRight","inset"]),insetSouth:()=>i(-D/2,-er,["bottom","alignCentre","inset"]),insetEast:()=>i(-D,-er/2,["valignCentre","right","inset"]),insetWest:()=>i(D,-er/2,["valignCentre","left","inset"])}},vc=()=>bc(0,0,{}),xc=(T,E)=>B=>"rtl"===wc(B)?E:T,wc=T=>"rtl"===Rt(T,"direction")?"rtl":"ltr";(lK=l0||(l0={})).TopToBottom="toptobottom",lK.BottomToTop="bottomtotop";let rr="data-alloy-vertical-dir",Cc=T=>hi(T,T=>eV(T)&&_t(T,"data-alloy-vertical-dir")===l0.BottomToTop),Oc=()=>ys("layouts",[ns("onLtr"),ns("onRtl"),ms("onBottomLtr"),ms("onBottomRtl")]),_c=(T,E,B,M,D,er,ea)=>{let es=ea.map(Cc).getOr(!1),eu=E.layouts.map(E=>E.onLtr(T)),eg=E.layouts.map(E=>E.onRtl(T)),ep=es?E.layouts.bind(E=>E.onBottomLtr.map(E=>E(T))).or(eu).getOr(D):eu.getOr(B),eh=es?E.layouts.bind(E=>E.onBottomRtl.map(E=>E(T))).or(eg).getOr(er):eg.getOr(M);return xc(ep,eh)(T)};var ra=[ns("hotspot"),ms("bubble"),xs("overrides",{}),Oc(),Li("placement",(T,E,B)=>{let M=E.hotspot,D=$l(B,M.element),er=_c(T.element,E,xl(),wl(),vl(),yl(),A.some(E.hotspot.element));return A.some(w({anchorBox:D,bubble:E.bubble.getOr(vc()),overrides:E.overrides,layouts:er}))})],rh=[ns("x"),ns("y"),xs("height",0),xs("width",0),xs("bubble",vc()),xs("overrides",{}),Oc(),Li("placement",(T,E,B)=>{let M=Yl(B,E.x,E.y),D=Jo(M.left,M.top,E.width,E.height),er=_c(T.element,E,fl(),bl(),fl(),bl(),A.none());return A.some(w({anchorBox:D,bubble:E.bubble,overrides:E.overrides,layouts:er}))})];let rf=Ms([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Mc=T=>T.fold(w,(T,E,B)=>T.translate(-E,-B)),Dc=T=>T.fold(w,w),Bc=T=>j(T,(T,E)=>T.translate(E.left,E.top),$t(0,0)),Ic=T=>{let E=L(T,Dc);return Bc(E)},rb=rf.screen,rx=rf.absolute,Nc=(T,E,B)=>{let M=tt(T.element),D=Wo(M),er=((T,E,B)=>{let M=st(B.root).dom;return A.from(M.frameElement).map(Fe).filter(E=>{let B=tt(E),M=tt(T.element);return Qe(B,M)}).map(Xt)})(T,0,B).getOr(D);return rx(er,D.left,D.top)},Vc=(T,E,B,M)=>{let D=rb($t(T,E));return A.some({point:D,width:B,height:M})},zc=(T,E,B,M,D)=>T.map(T=>{var er;let ea=[E,T.point],es=M.fold(()=>Ic(ea),()=>Ic(ea),()=>(T=>{let E=L(T,Mc);return Bc(E)})(ea)),eu=(er=es.left,{x:er,y:es.top,width:T.width,height:T.height}),eg=B.showAbove?vl():xl(),ep=B.showAbove?yl():wl(),eh=_c(D,B,eg,ep,eg,ep,A.none());return w({anchorBox:eu,bubble:B.bubble.getOr(vc()),overrides:B.overrides,layouts:eh})});var ry=[ns("node"),ns("root"),ms("bubble"),Oc(),xs("overrides",{}),xs("showAbove",!1),Li("placement",(T,E,B)=>{let M=Nc(T,0,E);return E.node.filter(xt).bind(D=>{let er=D.dom.getBoundingClientRect(),ea=Vc(er.left,er.top,er.width,er.height),es=E.node.getOr(T.element);return zc(ea,M,E,B,es)})})];let Hc=(T,E,B,M)=>({start:T,soffset:E,finish:B,foffset:M}),rw=Ms([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),rT=(rw.before,rw.on,rw.after,T=>T.fold(w,w,w)),rO=Ms([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),r_={domRange:rO.domRange,relative:rO.relative,exact:rO.exact,exactFromRange:T=>rO.exact(T.start,T.soffset,T.finish,T.foffset),getWin:T=>{let E=T.match({domRange:T=>Fe(T.startContainer),relative:(T,E)=>rT(T),exact:(T,E,B,M)=>T});return st(E)},range:Hc},Gc=(T,E,B)=>{let M=T.document.createRange();return E.fold(T=>{M.setStartBefore(T.dom)},(T,E)=>{M.setStart(T.dom,E)},T=>{M.setStartAfter(T.dom)}),((T,E)=>{E.fold(E=>{T.setEndBefore(E.dom)},(E,B)=>{T.setEnd(E.dom,B)},E=>{T.setEndAfter(E.dom)})})(M,B),M},$c=(T,E,B,M,D)=>{let er=T.document.createRange();return er.setStart(E.dom,B),er.setEnd(M.dom,D),er},qc=T=>({left:T.left,top:T.top,right:T.right,bottom:T.bottom,width:T.width,height:T.height}),rB=Ms([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Xc=(T,E,B)=>E(Fe(B.startContainer),B.startOffset,Fe(B.endContainer),B.endOffset),Kc=(T,E)=>((T,E)=>{let B=E.match({domRange:T=>({ltr:x(T),rtl:A.none}),relative:(E,B)=>({ltr:eo(()=>Gc(T,E,B)),rtl:eo(()=>A.some(Gc(T,B,E)))}),exact:(E,B,M,D)=>({ltr:eo(()=>$c(T,E,B,M,D)),rtl:eo(()=>A.some($c(T,M,D,E,B)))})});return((T,E)=>{let B=E.ltr();return B.collapsed?E.rtl().filter(T=>!1===T.collapsed).map(T=>rB.rtl(Fe(T.endContainer),T.endOffset,Fe(T.startContainer),T.startOffset)).getOrThunk(()=>Xc(0,rB.ltr,B)):Xc(0,rB.ltr,B)})(0,B)})(T,E).match({ltr:(E,B,M,D)=>{let er=T.document.createRange();return er.setStart(E.dom,B),er.setEnd(M.dom,D),er},rtl:(E,B,M,D)=>{let er=T.document.createRange();return er.setStart(M.dom,D),er.setEnd(E.dom,B),er}});rB.ltr,rB.rtl;let Jc=(T,E,B)=>U(((T,E)=>{let B=es(E)?E:eg,M=T.dom,D=[];for(;null!==M.parentNode&&void 0!==M.parentNode;){let T=M.parentNode,E=Fe(T);if(D.push(E),!0===B(E))break;M=T}return D})(T,B),E),Zc=(T,E)=>((T,E)=>{let B=void 0===E?document:E.dom;return Ze(B)?[]:L(B.querySelectorAll(T),Fe)})(E,T),Qc=T=>{if(T.rangeCount>0){let E=T.getRangeAt(0),B=T.getRangeAt(T.rangeCount-1);return A.some(Hc(Fe(E.startContainer),E.startOffset,Fe(B.endContainer),B.endOffset))}return A.none()},ed=T=>{if(null===T.anchorNode||null===T.focusNode)return Qc(T);{let E=Fe(T.anchorNode),B=Fe(T.focusNode);return((T,E,B,M)=>{let D=((T,E,B,M)=>{let D=tt(T).dom.createRange();return D.setStart(T.dom,E),D.setEnd(B.dom,M),D})(T,E,B,M),er=Qe(T,B)&&E===M;return D.collapsed&&!er})(E,T.anchorOffset,B,T.focusOffset)?A.some(Hc(E,T.anchorOffset,B,T.focusOffset)):Qc(T)}},td=(T,E)=>(T=>{let E=T.getClientRects(),B=E.length>0?E[0]:T.getBoundingClientRect();return B.width>0||B.height>0?A.some(B).map(qc):A.none()})(Kc(T,E)),rF=((T,E)=>{let o=E=>T(E)?A.from(E.dom.nodeValue):A.none();return{get:E=>{if(!T(E))throw Error("Can only get text value of a text node");return o(E).getOr("")},getOption:o,set:(E,B)=>{if(!T(E))throw Error("Can only set raw text value of a text node");E.dom.nodeValue=B}}})(eH),nd=(T,E)=>({element:T,offset:E}),sd=(T,E)=>eH(T)?nd(T,E):((T,E)=>{let B=lt(T);if(0===B.length)return nd(T,E);if(E<B.length)return nd(B[E],0);{let T=B[B.length-1],E=eH(T)?rF.get(T).length:lt(T).length;return nd(T,E)}})(T,E),rd=T=>void 0!==T.foffset,ad=(T,E)=>E.getSelection.getOrThunk(()=>()=>A.from(T.getSelection()).filter(T=>T.rangeCount>0).bind(ed))().map(T=>{if(rd(T)){let E=sd(T.start,T.soffset),B=sd(T.finish,T.foffset);return r_.range(E.element,E.offset,B.element,B.offset)}return T});var rM=[ms("getSelection"),ns("root"),ms("bubble"),Oc(),xs("overrides",{}),xs("showAbove",!1),Li("placement",(T,E,B)=>{let M=st(E.root).dom,D=Nc(T,0,E),er=ad(M,E).bind(T=>{if(rd(T)){let E=(T=>{let E=T.getBoundingClientRect();return E.width>0||E.height>0?A.some(E).map(qc):A.none()})(Kc(M,r_.exactFromRange(T))).orThunk(()=>{let E=Ve("\uFEFF");No(T.start,E);let B=td(M,r_.exact(E,0,E,1));return Uo(E),B});return E.bind(T=>Vc(T.left,T.top,T.width,T.height))}{let E=ce(T,T=>T.dom.getBoundingClientRect()),B={left:Math.min(E.firstCell.left,E.lastCell.left),right:Math.max(E.firstCell.right,E.lastCell.right),top:Math.min(E.firstCell.top,E.lastCell.top),bottom:Math.max(E.firstCell.bottom,E.lastCell.bottom)};return Vc(B.left,B.top,B.right-B.left,B.bottom-B.top)}}),ea=ad(M,E).bind(T=>rd(T)?eV(T.start)?A.some(T.start):at(T.start):A.some(T.firstCell)).getOr(T.element);return zc(er,D,E,B,ea)})];let rD="link-layout",cd=T=>T.x+T.width,dd=(T,E)=>T.x-E.width,ud=(T,E)=>T.y-E.height+T.height,md=T=>T.y,gd=(T,E,B)=>Ui(cd(T),md(T),B.southeast(),nW(),"southeast",el(T,{left:0,top:2}),rD),pd=(T,E,B)=>Ui(dd(T,E),md(T),B.southwest(),nz(),"southwest",el(T,{right:1,top:2}),rD),hd=(T,E,B)=>Ui(cd(T),ud(T,E),B.northeast(),nP(),"northeast",el(T,{left:0,bottom:3}),rD),fd=(T,E,B)=>Ui(dd(T,E),ud(T,E),B.northwest(),nU(),"northwest",el(T,{right:1,bottom:3}),rD),bd=()=>[gd,pd,hd,fd],vd=()=>[pd,gd,fd,hd];var rI=Zn("type",{selection:rM,node:ry,hotspot:ra,submenu:[ns("item"),Oc(),xs("overrides",{}),Li("placement",(T,E,B)=>{let M=$l(B,E.item.element),D=_c(T.element,E,bd(),vd(),bd(),vd(),A.none());return A.some(w({anchorBox:M,bubble:vc(),overrides:E.overrides,layouts:D}))})],makeshift:rh});let rR=[us("classes",tW),Cs("mode","all",["all","layout","placement"])],rL=[xs("useFixed",eg),ms("getBounds")],rV=[ss("anchor",rI),ys("transition",rR)],Cd=(T,E,B,M,D,er)=>{let ea=Kn("placement.info",Bn(rV),D),es=ea.anchor,eu=M.element,eg=B.get(M.uid);Hl(()=>{Bt(eu,"position","fixed");let D=Vt(eu,"visibility");Bt(eu,"visibility","hidden");let ep=E.useFixed()?(()=>{let T=document.documentElement;return n5(0,0,T.clientWidth,T.clientHeight)})():(T=>{let E=Xt(T.element),B=T.element.dom.getBoundingClientRect();return n3(E.left,E.top,B.width,B.height)})(T);es.placement(T,es,ep).each(T=>{var D,es;let eu=er.orThunk(()=>E.getBounds.map(_)),eh=(D=ea.transition,((T,E,B,M,D,er,ea,es)=>{let eu=pc(ea,"maxHeightFunction",n7()),eg=pc(ea,"maxWidthFunction",b),ep=T.anchorBox,eh=T.origin,ef={bounds:ql(eh,er),origin:eh,preference:M,maxHeightFunction:eu,maxWidthFunction:eg,lastPlacement:D,transition:es};return hc(ep,E,B,ef)})({anchorBox:T.anchorBox,origin:ep},M.element,T.bubble,T.layouts,eg,eu,T.overrides,D));B.set(M.uid,eh)}),D.fold(()=>{Ht(eu,"visibility")},T=>{Bt(eu,"visibility",T)}),Vt(eu,"left").isNone()&&Vt(eu,"top").isNone()&&Vt(eu,"right").isNone()&&Vt(eu,"bottom").isNone()&&xe(Vt(eu,"position"),"fixed")&&Ht(eu,"position")},eu)};var rH=Object.freeze({__proto__:null,position:(T,E,B,M,D)=>{let er=A.none();Cd(T,E,B,M,D,er)},positionWithinBounds:Cd,getMode:(T,E,B)=>E.useFixed()?"fixed":"absolute",reset:(T,E,B,M)=>{let D=M.element;H(["position","left","right","top","bottom"],T=>Ht(D,T)),At(D,n9),B.clear(M.uid)}});let rN=Al({fields:rL,name:"positioning",active:n1,apis:rH,state:Object.freeze({__proto__:null,init:()=>{let T={};return Ta({readState:()=>T,clear:E=>{g(E)?delete T[E]:T={}},set:(E,B)=>{T[E]=B},get:E=>be(T,E)})}})}),Td=T=>T.getSystem().isConnected(),Ed=T=>{Fr(T,oz());let E=T.components();H(E,Ed)},Ad=T=>{let E=T.components();H(E,Ad),Fr(T,oW())},Md=(T,E)=>{T.getSystem().addToWorld(E),xt(T.element)&&Ad(E)},Dd=T=>{Ed(T),T.getSystem().removeFromWorld(T)},Bd=(T,E)=>{Lo(T.element,E.element)},Id=(T,E)=>{Fd(T,E,Lo)},Fd=(T,E,B)=>{T.getSystem().addToWorld(E),B(T.element,E.element),xt(T.element)&&Ad(E),T.syncComponents()},Rd=T=>{Ed(T),Uo(T.element),T.getSystem().removeFromWorld(T)},Nd=T=>{let E=rt(T.element).bind(E=>T.getSystem().getByDom(E).toOptional());Rd(T),E.each(T=>{T.syncComponents()})},Vd=T=>{let E=T.components();H(E,Rd),Po(T.element),T.syncComponents()},zd=(T,E)=>{Hd(T,E,Lo)},Ld=(T,E)=>{Hd(T,E,Vo)},Hd=(T,E,B)=>{B(T,E.element);let M=lt(E.element);H(M,T=>{E.getByDom(T).each(Ad)})},Pd=T=>{let E=lt(T.element);H(E,E=>{T.getByDom(E).each(Ed)}),Uo(T.element)},Ud=(T,E,B,M)=>{B.get().each(E=>{Vd(T)});let D=E.getAttachPoint(T);Id(D,T);let er=T.getSystem().build(M);return Id(T,er),B.set(er),er},Wd=(T,E,B,M)=>{let D=Ud(T,E,B,M);return E.onOpen(T,D),D},jd=(T,E,B)=>{B.get().each(M=>{Vd(T),Nd(T),E.onClose(T,M),B.clear()})},Gd=(T,E,B)=>B.isOpen(),$d=(T,E,B)=>{var M,D;let er=E.getAttachPoint(T);Bt(T.element,"position",rN.getMode(er)),M="visibility",D=E.cloakVisibilityAttr,Vt(T.element,M).fold(()=>{At(T.element,D)},E=>{Ct(T.element,D,E)}),Bt(T.element,M,"hidden")},qd=(T,E,B)=>{var M;M=T.element,N(["top","left","right","bottom"],T=>Vt(M,T).isSome())||Ht(T.element,"position"),((T,E,B)=>{Tt(T.element,B).fold(()=>Ht(T.element,E),B=>Bt(T.element,E,B))})(T,"visibility",E.cloakVisibilityAttr)};var rW=Object.freeze({__proto__:null,cloak:$d,decloak:qd,open:Wd,openWhileCloaked:(T,E,B,M,D)=>{$d(T,E),Wd(T,E,B,M),D(),qd(T,E)},close:jd,isOpen:Gd,isPartOf:(T,E,B,M)=>Gd(0,0,B)&&B.get().exists(B=>E.isPartOf(T,B,M)),getState:(T,E,B)=>B.get(),setContent:(T,E,B,M)=>B.get().map(()=>Ud(T,E,B,M))}),rz=Object.freeze({__proto__:null,events:(T,E)=>Hr([Wr(oE(),(B,M)=>{jd(B,T,E)})])}),rP=[Ri("onOpen"),Ri("onClose"),ns("isPartOf"),ns("getAttachPoint"),xs("cloakVisibilityAttr","data-precloak-visibility")],rU=Object.freeze({__proto__:null,init:()=>{let T=nc(),E=x("not-implemented");return Ta({readState:E,isOpen:T.isSet,clear:T.clear,set:T.set,get:T.get})}});let rG=Al({fields:rP,name:"sandboxing",active:rz,apis:rW,state:rU}),r$=x("dismiss.popups"),rj=x("reposition.popups"),rY=x("mouse.released"),rX=Dn([xs("isExtraPart",eg),ys("fireEventInstead",[xs("event",oP())])]),nu=T=>{let E=Kn("Dismissal",rX,T);return{[r$()]:{schema:Dn([ns("target")]),onReceive:(T,B)=>{rG.isOpen(T)&&(rG.isPartOf(T,B.target)||E.isExtraPart(T,B.target)||E.fireEventInstead.fold(()=>rG.close(T),E=>Fr(T,E.event)))}}}},rq=Dn([ys("fireEventInstead",[xs("event",oU())]),ls("doReposition")]),ru=T=>{let E=Kn("Reposition",rq,T);return{[rj()]:{onReceive:T=>{rG.isOpen(T)&&E.fireEventInstead.fold(()=>E.doReposition(T),E=>Fr(T,E.event))}}}},au=(T,E,B)=>{E.store.manager.onLoad(T,E,B)},iu=(T,E,B)=>{E.store.manager.onUnload(T,E,B)};var rK=Object.freeze({__proto__:null,onLoad:au,onUnload:iu,setValue:(T,E,B,M)=>{E.store.manager.setValue(T,E,B,M)},getValue:(T,E,B)=>E.store.manager.getValue(T,E,B),getState:(T,E,B)=>B}),rZ=Object.freeze({__proto__:null,events:(T,E)=>{let B=T.resetOnDom?[oZ((B,M)=>{au(B,T,E)}),oJ((B,M)=>{iu(B,T,E)})]:[Cl(T,E,au)];return Hr(B)}});let du=()=>{let T=As(null);return Ta({set:T.set,get:T.get,isNotSet:()=>null===T.get(),clear:()=>{T.set(null)},readState:()=>({mode:"memory",value:T.get()})})},uu=()=>{let T=As({}),E=As({});return Ta({readState:()=>({mode:"dataset",dataByValue:T.get(),dataByText:E.get()}),lookup:B=>be(T.get(),B).orThunk(()=>be(E.get(),B)),update:B=>{let M=T.get(),D=E.get(),er={},ea={};H(B,T=>{er[T.value]=T,be(T,"meta").each(E=>{be(E,"text").each(E=>{ea[E]=T})})}),T.set({...M,...er}),E.set({...D,...ea})},clear:()=>{T.set({}),E.set({})}})};var rJ=Object.freeze({__proto__:null,memory:du,dataset:uu,manual:()=>Ta({readState:b}),init:T=>T.store.manager.state(T)});let gu=(T,E,B,M)=>{let D=E.store;B.update([M]),D.setValue(T,M),E.onSetValue(T,M)};var rQ=[ms("initialValue"),ns("getFallbackEntry"),ns("getDataKey"),ns("setValue"),Li("manager",{setValue:gu,getValue:(T,E,B)=>{let M=E.store,D=M.getDataKey(T);return B.lookup(D).getOrThunk(()=>M.getFallbackEntry(D))},onLoad:(T,E,B)=>{E.store.initialValue.each(M=>{gu(T,E,B,M)})},onUnload:(T,E,B)=>{B.clear()},state:uu})],r0=[ns("getValue"),xs("setValue",b),ms("initialValue"),Li("manager",{setValue:(T,E,B,M)=>{E.store.setValue(T,M),E.onSetValue(T,M)},getValue:(T,E,B)=>E.store.getValue(T),onLoad:(T,E,B)=>{E.store.initialValue.each(B=>{E.store.setValue(T,B)})},onUnload:b,state:nf.init})],r1=[ws("store",{mode:"memory"},Zn("mode",{memory:[ms("initialValue"),Li("manager",{setValue:(T,E,B,M)=>{B.set(M),E.onSetValue(T,M)},getValue:(T,E,B)=>B.get(),onLoad:(T,E,B)=>{E.store.initialValue.each(T=>{B.isNotSet()&&B.set(T)})},onUnload:(T,E,B)=>{B.clear()},state:du})],manual:r0,dataset:rQ})),Ri("onSetValue"),xs("resetOnDom",!1)];let r2=Al({fields:r1,name:"representing",active:rZ,apis:rK,extra:{setValueFrom:(T,E)=>{let B=r2.getValue(E);r2.setValue(T,B)}},state:rJ}),yu=(T,E)=>Es(T,{},L(E,E=>{var B,M;return B=E.name(),M="Cannot configure "+E.name()+" for "+T,pn(B,B,{tag:"option",process:{}},On(T=>dn("The field: "+B+" is forbidden. "+M)))}).concat([ts("dump",w)])),xu=T=>T.dump,wu=(T,E)=>({...Tl(E),...T.dump}),r3="placeholder",r5=Ms([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),_u=T=>ve(T,"uiType"),Tu=(T,E,B,M)=>(_u(B)&&B.uiType===r3?T.exists(T=>T!==B.owner)?r5.single(!0,x(B)):be(M,B.name).fold(()=>{throw Error("Unknown placeholder component: "+B.name+"\nKnown: ["+eO(M)+"]\nNamespace: "+T.getOr("none")+"\nSpec: "+JSON.stringify(B,null,2))},T=>T.replace()):r5.single(!1,x(B))).fold((D,er)=>{let ea=_u(B)?er(E,B.config,B.validated):er(E),es=be(ea,"components").getOr([]),eu=Y(es,B=>Tu(T,E,B,M));return[{...ea,components:eu}]},(T,M)=>{if(_u(B)){let T=M(E,B.config,B.validated);return B.validated.preprocess.getOr(w)(T)}return M(E)}),r9=r5.single,r6=r5.multiple,r4=x(r3),r8=Ms([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),r7=xs("factory",{sketch:w}),ae=xs("schema",[]),an=ns("name"),aa=pn("pname","pname",yn(T=>"<alloy."+ca(T.name)+">"),tH()),ah=ts("schema",()=>[ms("preprocess")]),af=xs("defaults",x({})),ab=xs("overrides",x({})),ax=Bn([r7,ae,an,aa,af,ab]),ay=Bn([r7,ae,an,af,ab]),aw=Bn([r7,ae,an,aa,af,ab]),aS=Bn([r7,ah,an,ns("unit"),aa,af,ab]),Wu=T=>T.fold(A.some,A.none,A.some,A.some),ju=T=>{let t=T=>T.name;return T.fold(t,t,t,t)},Gu=(T,E)=>B=>{let M=Kn("Converting part type",E,B);return T(M)},aT=Gu(r8.required,ax),a_=Gu(r8.external,ay),aE=Gu(r8.optional,aw),aB=Gu(r8.group,aS),aD=x("entirety");var aI=Object.freeze({__proto__:null,required:aT,external:a_,optional:aE,group:aB,asNamedPart:Wu,name:ju,asCommon:T=>T.fold(w,w,w,w),original:aD});let Zu=(T,E,B,M)=>tM(E.defaults(T,B,M),B,{uid:T.partUids[E.name]},E.overrides(T,B,M)),Qu=(T,E)=>{let B={};return H(E,E=>{Wu(E).each(E=>{let M=em(T,E.pname);B[E.name]=B=>{let D=Kn("Part: "+E.name+" in "+T,Bn(E.schema),B);return{...M,config:B,validated:D}}})}),B},em=(T,E)=>({uiType:r4(),owner:T,name:E}),tm=(T,E,B)=>({uiType:r4(),owner:T,name:E,config:B,validated:{}}),om=T=>Y(T,T=>T.fold(A.none,A.some,A.none,A.none).map(T=>cs(T.name,T.schema.concat([Hi(aD())]))).toArray()),nm=T=>L(T,ju),sm=(T,E,B)=>((T,E,B)=>{let M={},D={};return H(B,T=>{T.fold(T=>{M[T.pname]=r9(!0,(E,B,M)=>T.factory.sketch(Zu(E,T,B,M)))},T=>{let B=E.parts[T.name];D[T.name]=x(T.factory.sketch(Zu(E,T,B[aD()]),B))},T=>{M[T.pname]=r9(!1,(E,B,M)=>T.factory.sketch(Zu(E,T,B,M)))},T=>{M[T.pname]=r6(!0,(E,B,M)=>{let D=E[T.name];return L(D,B=>T.factory.sketch(tM(T.defaults(E,B,M),B,T.overrides(E,B))))})})}),{internals:x(M),externals:x(D)}})(0,E,B),rm=(T,E,B)=>((T,E,B,M)=>{let D=ce(M,(T,E)=>{let B;return B=!1,{name:x(E),required:()=>T.fold((T,E)=>T,(T,E)=>T),used:()=>B,replace:()=>{if(B)throw Error("Trying to use the same placeholder more than once: "+E);return B=!0,T}}}),er=Y(B,B=>Tu(T,E,B,D));return le(D,B=>{if(!1===B.used()&&B.required())throw Error("Placeholder: "+B.name()+" was not found in components list\nNamespace: "+T.getOr("none")+"\nComponents: "+JSON.stringify(E.components,null,2))}),er})(A.some(T),E,E.components,B),am=(T,E,B)=>{let M=E.partUids[B];return T.getSystem().getByUid(M).toOptional()},im=(T,E,B)=>am(T,E,B).getOrDie("Could not find part: "+B),lm=(T,E,B)=>{let M={},D=E.partUids,er=T.getSystem();return H(B,T=>{M[T]=x(er.getByUid(D[T]))}),M},cm=(T,E)=>{let B=T.getSystem();return ce(E.partUids,(T,E)=>x(B.getByUid(T)))},dm=T=>eO(T.partUids),um=(T,E,B)=>{let M={},D=E.partUids,er=T.getSystem();return H(B,T=>{M[T]=x(er.getByUid(D[T]).getOrDie())}),M},mm=(T,E)=>{let B=nm(E);return Bs(L(B,E=>({key:E,value:T+"-"+E})))},gm=T=>pn("partUids","partUids",wn(E=>mm(E.uid,T)),tH());var aR=Object.freeze({__proto__:null,generate:Qu,generateOne:tm,schemas:om,names:nm,substitutes:sm,components:rm,defaultUids:mm,defaultUidsSchema:gm,getAllParts:cm,getAllPartNames:dm,getPart:am,getPartOrDie:im,getParts:lm,getPartsOrDie:um});let hm=(T,E,B,M,D)=>{let er=(M.length>0?[cs("parts",M)]:[]).concat([ns("uid"),xs("dom",{}),xs("components",[]),Hi("originalSpec"),xs("debug.sketcher",{})]).concat(D);return Kn(T+" [SpecSchema]",Dn(er.concat(E)),B)},fm=(T,E,B,M,D)=>{let er=bm(D),ea=om(B),es=gm(B),eu=hm(T,E,er,ea,[es]),eg=sm(0,eu,B);return M(eu,rm(T,eu,eg.internals()),er,eg.externals())},bm=T=>ve(T,"uid")?T:{...T,uid:fa("uid")},aL=Dn([ns("name"),ns("factory"),ns("configFields"),xs("apis",{}),xs("extraApis",{})]),aH=Dn([ns("name"),ns("factory"),ns("configFields"),ns("partFields"),xs("apis",{}),xs("extraApis",{})]),xm=T=>{let E=Kn("Sketcher for "+T.name,aL,T),B=ce(E.apis,Oa),M=ce(E.extraApis,(T,E)=>wa(T,E));return{name:E.name,configFields:E.configFields,sketch:T=>((T,E,B,M)=>{let D=bm(M);return B(hm(T,E,D,[],[]),D)})(E.name,E.configFields,E.factory,T),...B,...M}},wm=T=>{let E=Kn("Sketcher for "+T.name,aH,T),B=Qu(E.name,E.partFields),M=ce(E.apis,Oa),D=ce(E.extraApis,(T,E)=>wa(T,E));return{name:E.name,partFields:E.partFields,configFields:E.configFields,sketch:T=>fm(E.name,E.configFields,E.partFields,E.factory,T),parts:B,...M,...D}},Sm=T=>Ke("input")(T)&&"radio"!==_t(T,"type")||Ke("textarea")(T);var aN=Object.freeze({__proto__:null,getCurrent:(T,E,B)=>E.find(T)});let aW=[ns("find")],az=Al({fields:aW,name:"composing",apis:aN}),aP=["input","button","textarea","select"],Tm=(T,E,B)=>{(E.disabled()?Im:Fm)(T,E)},Em=(T,E)=>!0===E.useNative&&R(aP,We(T.element)),Am=T=>{Ct(T.element,"disabled","disabled")},Mm=T=>{At(T.element,"disabled")},Dm=T=>{Ct(T.element,"aria-disabled","true")},Bm=T=>{Ct(T.element,"aria-disabled","false")},Im=(T,E,B)=>{E.disableClass.each(E=>{Wa(T.element,E)}),(Em(T,E)?Am:Dm)(T),E.onDisabled(T)},Fm=(T,E,B)=>{E.disableClass.each(E=>{Ga(T.element,E)}),(Em(T,E)?Mm:Bm)(T),E.onEnabled(T)},Rm=(T,E)=>Em(T,E)?Et(T.element,"disabled"):"true"===_t(T.element,"aria-disabled");var aU=Object.freeze({__proto__:null,enable:Fm,disable:Im,isDisabled:Rm,onLoad:Tm,set:(T,E,B,M)=>{(M?Im:Fm)(T,E)}}),aG=Object.freeze({__proto__:null,exhibit:(T,E)=>Aa({classes:E.disabled()?E.disableClass.toArray():[]}),events:(T,E)=>Hr([Pr(ox(),(E,B)=>Rm(E,T)),Cl(T,E,Tm)])}),a$=[_s("disabled",eg),xs("useNative",!0),ms("disableClass"),Ri("onDisabled"),Ri("onEnabled")];let aj=Al({fields:a$,name:"disabling",active:aG,apis:aU}),Hm=(T,E,B,M)=>{let D=Zc(T.element,"."+E.highlightClass);H(D,B=>{N(M,T=>Qe(T.element,B))||(Ga(B,E.highlightClass),T.getSystem().getByDom(B).each(B=>{E.onDehighlight(T,B),Fr(B,oK())}))})},Pm=(T,E,B,M)=>{Hm(T,E,0,[M]),Um(T,E,B,M)||(Wa(M.element,E.highlightClass),E.onHighlight(T,M),Fr(M,oq()))},Um=(T,E,B,M)=>$a(M.element,E.highlightClass),Wm=(T,E,B)=>vi(T.element,"."+E.itemClass).bind(E=>T.getSystem().getByDom(E).toOptional()),jm=(T,E,B)=>{let M=Zc(T.element,"."+E.itemClass);return(M.length>0?A.some(M[M.length-1]):A.none()).bind(E=>T.getSystem().getByDom(E).toOptional())},Gm=(T,E,B,M)=>{let D=Zc(T.element,"."+E.itemClass);return $(D,T=>$a(T,E.highlightClass)).bind(E=>{let B=Zi(E,M,0,D.length-1);return T.getSystem().getByDom(D[B]).toOptional()})},$m=(T,E,B)=>{let M=Zc(T.element,"."+E.itemClass);return we(L(M,E=>T.getSystem().getByDom(E).toOptional()))};var aY=Object.freeze({__proto__:null,dehighlightAll:(T,E,B)=>Hm(T,E,0,[]),dehighlight:(T,E,B,M)=>{Um(T,E,B,M)&&(Ga(M.element,E.highlightClass),E.onDehighlight(T,M),Fr(M,oK()))},highlight:Pm,highlightFirst:(T,E,B)=>{Wm(T,E).each(M=>{Pm(T,E,B,M)})},highlightLast:(T,E,B)=>{jm(T,E).each(M=>{Pm(T,E,B,M)})},highlightAt:(T,E,B,M)=>{((T,E,B,M)=>{let D=Zc(T.element,"."+E.itemClass);return A.from(D[M]).fold(()=>tE.error(Error("No element found with index "+M)),T.getSystem().getByDom)})(T,E,0,M).fold(T=>{throw T},M=>{Pm(T,E,B,M)})},highlightBy:(T,E,B,M)=>{let D=$m(T,E);G(D,M).each(M=>{Pm(T,E,B,M)})},isHighlighted:Um,getHighlighted:(T,E,B)=>vi(T.element,"."+E.highlightClass).bind(E=>T.getSystem().getByDom(E).toOptional()),getFirst:Wm,getLast:jm,getPrevious:(T,E,B)=>Gm(T,E,0,-1),getNext:(T,E,B)=>Gm(T,E,0,1),getCandidates:$m}),aX=[ns("highlightClass"),ns("itemClass"),Ri("onHighlight"),Ri("onDehighlight")];let aq=Al({fields:aX,name:"highlighting",apis:aY}),aK=[9],aZ=[13],aJ=[27],aQ=[32],a0=[37],a1=[38],a2=[39],a3=[40],rg=(T,E,B)=>{let M=K(T.slice(0,E)),D=K(T.slice(E+1));return G(M.concat(D),B)},ag=(T,E,B)=>{let M=K(T.slice(0,E));return G(M,B)},ig=(T,E,B)=>{let M=T.slice(0,E),D=T.slice(E+1);return G(D.concat(M),B)},lg=(T,E,B)=>{let M=T.slice(E+1);return G(M,B)},cg=T=>E=>{let B=E.raw;return R(T,B.which)},dg=T=>E=>X(T,T=>T(E)),ug=T=>!0===T.raw.shiftKey,mg=T=>!0===T.raw.ctrlKey,a5=C(ug),pg=(T,E)=>({matches:T,classification:E}),hg=(T,E,B)=>{E.exists(T=>B.exists(E=>Qe(E,T)))||Rr(T,oG(),{prevFocus:E,newFocus:B})},fg=()=>{let e=T=>Ll(T.element);return{get:e,set:(T,E)=>{let B=e(T);T.getSystem().triggerFocus(E,T.element);let M=e(T);hg(T,B,M)}}},bg=()=>{let e=T=>aq.getHighlighted(T).map(T=>T.element);return{get:e,set:(T,E)=>{let B=e(T);T.getSystem().getByDom(E).fold(b,E=>{aq.highlight(T,E)});let M=e(T);hg(T,B,M)}}};(lZ=l1||(l1={})).OnFocusMode="onFocus",lZ.OnEnterOrSpaceMode="onEnterOrSpace",lZ.OnApiMode="onApi";let yg=(T,E,B,M,D)=>{let r=(T,E,B,M,D)=>{var er,ea;return(er=B(T,E,M,D),ea=E.event,G(er,T=>T.matches(ea)).map(T=>T.classification)).bind(B=>B(T,E,M,D))},er={schema:()=>T.concat([xs("focusManager",fg()),ws("focusInside","onFocus",$n(T=>R(["onFocus","onEnterOrSpace","onApi"],T)?tE.value(T):tE.error("Invalid value for focusInside"))),Li("handler",er),Li("state",E),Li("sendFocusIn",D)]),processKey:r,toEvents:(T,E)=>{let er=T.focusInside!==l1.OnFocusMode?A.none():D(T).map(B=>Wr(od(),(M,D)=>{B(M,T,E),D.stop()})),ea=[Wr(t2(),(M,er)=>{r(M,er,B,T,E).fold(()=>{((B,M)=>{let er=cg(aQ.concat(aZ))(M.event);T.focusInside===l1.OnEnterOrSpaceMode&&er&&Ns(B,M)&&D(T).each(D=>{D(B,T,E),M.stop()})})(M,er)},T=>{er.stop()})}),Wr(t3(),(B,D)=>{r(B,D,M,T,E).each(T=>{D.stop()})})];return Hr(er.toArray().concat(ea))}};return er},xg=T=>{let E=[ms("onEscape"),ms("onEnter"),xs("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),xs("firstTabstop",0),xs("useTabstopAt",ep),ms("visibilitySelector")].concat([T]),o=(T,E)=>{let B=T.visibilitySelector.bind(T=>yi(E,T)).getOr(E);return jt(B)>0},n=(T,E)=>E.focusManager.get(T).bind(T=>yi(T,E.selector)),s=(T,E,B)=>{((T,E)=>{let B=Zc(T.element,E.selector),M=U(B,T=>o(E,T));return A.from(M[E.firstTabstop])})(T,E).each(B=>{E.focusManager.set(T,B)})},r=(T,E,B,M)=>{let D=Zc(T.element,B.selector);return n(T,B).bind(E=>$(D,k(Qe,E)).bind(E=>M(D,E,T=>o(B,T)&&B.useTabstopAt(T)).fold(()=>B.cyclic?A.some(!0):A.none(),E=>(B.focusManager.set(T,E),A.some(!0)))))},a=(T,E,B)=>{let M=B.cyclic?rg:ag;return r(T,0,B,M)},i=(T,E,B)=>{let M=B.cyclic?ig:lg;return r(T,0,B,M)},B=x([pg(dg([ug,cg(aK)]),a),pg(cg(aK),i),pg(dg([a5,cg(aZ)]),(T,E,B)=>B.onEnter.bind(B=>B(T,E)))]),M=x([pg(cg(aJ),(T,E,B)=>B.onEscape.bind(B=>B(T,E))),pg(cg(aK),(T,E,B)=>n(T,B).filter(T=>!B.useTabstopAt(T)).bind(M=>(rt(M).bind(dt).exists(T=>Qe(T,M))?a:i)(T,E,B)))]);return yg(E,nf.init,B,M,()=>A.some(s))};var a9=xg(ts("cyclic",eg)),a6=xg(ts("cyclic",ep));let kg=(T,E,B)=>Sm(B)&&cg(aQ)(E.event)?A.none():(Vr(T,B,ox()),A.some(!0)),Cg=(T,E)=>A.some(!0),a4=[xs("execute",kg),xs("useSpace",!1),xs("useEnter",!0),xs("useControlEnter",!1),xs("useDown",!1)],_g=(T,E,B)=>B.execute(T,E,T.element);var a8=yg(a4,nf.init,(T,E,B,M)=>{let D=B.useSpace&&!Sm(T.element)?aQ:[],er=B.useEnter?aZ:[],ea=B.useDown?a3:[],es=D.concat(er).concat(ea);return[pg(cg(es),_g)].concat(B.useControlEnter?[pg(dg([mg,cg(aZ)]),_g)]:[])},(T,E,B,M)=>B.useSpace&&!Sm(T.element)?[pg(cg(aQ),Cg)]:[],()=>A.none());let Eg=()=>{let T=nc();return Ta({readState:()=>T.get().map(T=>({numRows:String(T.numRows),numColumns:String(T.numColumns)})).getOr({numRows:"?",numColumns:"?"}),setGridSize:(E,B)=>{T.set({numRows:E,numColumns:B})},getNumRows:()=>T.get().map(T=>T.numRows),getNumColumns:()=>T.get().map(T=>T.numColumns)})};var a7=Object.freeze({__proto__:null,flatgrid:Eg,init:T=>T.state(T)});let Mg=T=>(E,B,M,D)=>{let er=T(E.element);return Fg(er,E,B,M,D)},Dg=(T,E)=>{let B=xc(T,E);return Mg(B)},Bg=(T,E)=>{let B=xc(E,T);return Mg(B)},Ig=T=>(E,B,M,D)=>Fg(T,E,B,M,D),Fg=(T,E,B,M,D)=>M.focusManager.get(E).bind(B=>T(E.element,B,M,D)).map(T=>(M.focusManager.set(E,T),!0)),zg=T=>{var E;return!((E=T.dom).offsetWidth<=0)||!(E.offsetHeight<=0)},Lg=(T,E,B)=>{var M;let D=Zc(T,B);return $(M=U(D,zg),T=>Qe(T,E)).map(T=>({index:T,candidates:M}))},Hg=(T,E)=>$(T,T=>Qe(E,T)),Pg=(T,E,B,M)=>M(Math.floor(E/B),E%B).bind(E=>{let M=E.row*B+E.column;return M>=0&&M<T.length?A.some(T[M]):A.none()}),Ug=(T,E,B,M,D)=>Pg(T,E,M,(E,er)=>{let ea=E===B-1?T.length-E*M:M,es=Zi(er,D,0,ea-1);return A.some({row:E,column:es})}),Wg=(T,E,B,M,D)=>Pg(T,E,M,(E,er)=>{let ea=Zi(E,D,0,B-1),es=ea===B-1?T.length-ea*M:M,eu=Qi(er,0,es-1);return A.some({row:ea,column:eu})}),se=[ns("selector"),xs("execute",kg),Ni("onEscape"),xs("captureTab",!1),nH()],Gg=(T,E,B)=>{vi(T.element,E.selector).each(B=>{E.focusManager.set(T,B)})},$g=T=>(E,B,M,D)=>Lg(E,B,M.selector).bind(E=>T(E.candidates,E.index,D.getNumRows().getOr(M.initSize.numRows),D.getNumColumns().getOr(M.initSize.numColumns))),qg=(T,E,B)=>B.captureTab?A.some(!0):A.none(),sr=$g((T,E,B,M)=>Ug(T,E,B,M,-1)),sc=$g((T,E,B,M)=>Ug(T,E,B,M,1)),su=$g((T,E,B,M)=>Wg(T,E,B,M,-1)),sg=$g((T,E,B,M)=>Wg(T,E,B,M,1)),sp=x([pg(cg(a0),Dg(sr,sc)),pg(cg(a2),Bg(sr,sc)),pg(cg(a1),Ig(su)),pg(cg(a3),Ig(sg)),pg(dg([ug,cg(aK)]),qg),pg(dg([a5,cg(aK)]),qg),pg(cg(aQ.concat(aZ)),(T,E,B,M)=>B.focusManager.get(T).bind(T=>yi(T,B.selector)).bind(M=>B.execute(T,E,M)))]),sh=x([pg(cg(aJ),(T,E,B)=>B.onEscape(T,E)),pg(cg(aQ),Cg)]);var sf=yg(se,Eg,sp,sh,()=>A.some(Gg));let tp=(T,E,B,M,D)=>{let r=(T,E,B)=>D(T,E,M,0,B.length-1,B[E],E=>{var M;return"button"===We(M=B[E])&&"disabled"===_t(M,"disabled")?r(T,E,B):A.from(B[E])});return Lg(T,B,E).bind(T=>{let E=T.index,B=T.candidates;return r(E,E,B)})},op=(T,E,B,M)=>tp(T,E,B,M,(T,E,B,M,D,er,ea)=>{let es=Qi(E+B,M,D);return es===T?A.from(er):ea(es)}),np=(T,E,B,M)=>tp(T,E,B,M,(T,E,B,M,D,er,ea)=>{let es=Zi(E,B,M,D);return es===T?A.none():ea(es)}),sb=[ns("selector"),xs("getInitial",A.none),xs("execute",kg),Ni("onEscape"),xs("executeOnMove",!1),xs("allowVertical",!0),xs("allowHorizontal",!0),xs("cycles",!0)],rp=(T,E,B)=>B.focusManager.get(T).bind(T=>yi(T,B.selector)).bind(M=>B.execute(T,E,M)),ap=(T,E,B)=>{E.getInitial(T).orThunk(()=>vi(T.element,E.selector)).each(B=>{E.focusManager.set(T,B)})},ip=(T,E,B)=>(B.cycles?np:op)(T,B.selector,E,-1),lp=(T,E,B)=>(B.cycles?np:op)(T,B.selector,E,1),cp=T=>(E,B,M,D)=>T(E,B,M,D).bind(()=>M.executeOnMove?rp(E,B,M):A.some(!0)),sx=x([pg(cg(aQ),Cg),pg(cg(aJ),(T,E,B)=>B.onEscape(T,E))]);var sy=yg(sb,nf.init,(T,E,B,M)=>{let D=[...B.allowHorizontal?a0:[]].concat(B.allowVertical?a1:[]),er=[...B.allowHorizontal?a2:[]].concat(B.allowVertical?a3:[]);return[pg(cg(D),cp(Dg(ip,lp))),pg(cg(er),cp(Bg(ip,lp))),pg(cg(aZ),rp),pg(cg(aQ),rp)]},sx,()=>A.some(ap));let mp=(T,E,B)=>A.from(T[E]).bind(T=>A.from(T[B]).map(T=>({rowIndex:E,columnIndex:B,cell:T}))),gp=(T,E,B,M)=>{let D=T[E].length,er=Zi(B,M,0,D-1);return mp(T,E,er)},pp=(T,E,B,M)=>{let D=Zi(B,M,0,T.length-1),er=T[D].length,ea=Qi(E,0,er-1);return mp(T,D,ea)},hp=(T,E,B,M)=>{let D=T[E].length,er=Qi(B+M,0,D-1);return mp(T,E,er)},fp=(T,E,B,M)=>{let D=Qi(B+M,0,T.length-1),er=T[D].length,ea=Qi(E,0,er-1);return mp(T,D,ea)},sw=[cs("selectors",[ns("row"),ns("cell")]),xs("cycles",!0),xs("previousSelector",A.none),xs("execute",kg)],vp=(T,E,B)=>{E.previousSelector(T).orThunk(()=>{let B=E.selectors;return vi(T.element,B.cell)}).each(B=>{E.focusManager.set(T,B)})},yp=(T,E)=>(B,M,D)=>{let er=D.cycles?T:E;return yi(M,D.selectors.row).bind(T=>{let E=Zc(T,D.selectors.cell);return Hg(E,M).bind(E=>{let M=Zc(B,D.selectors.row);return Hg(M,T).bind(T=>{let B=L(M,T=>Zc(T,D.selectors.cell));return er(B,T,E).map(T=>T.cell)})})})},sA=yp((T,E,B)=>gp(T,E,B,-1),(T,E,B)=>hp(T,E,B,-1)),sO=yp((T,E,B)=>gp(T,E,B,1),(T,E,B)=>hp(T,E,B,1)),s_=yp((T,E,B)=>pp(T,B,E,-1),(T,E,B)=>fp(T,B,E,-1)),sM=yp((T,E,B)=>pp(T,B,E,1),(T,E,B)=>fp(T,B,E,1)),sD=x([pg(cg(a0),Dg(sA,sO)),pg(cg(a2),Bg(sA,sO)),pg(cg(a1),Ig(s_)),pg(cg(a3),Ig(sM)),pg(cg(aQ.concat(aZ)),(T,E,B)=>Ll(T.element).bind(M=>B.execute(T,E,M)))]),sR=x([pg(cg(aQ),Cg)]);var sL=yg(sw,nf.init,sD,sR,()=>A.some(vp));let sV=[ns("selector"),xs("execute",kg),xs("moveOnTab",!1)],Ep=(T,E,B)=>B.focusManager.get(T).bind(M=>B.execute(T,E,M)),Ap=(T,E,B)=>{vi(T.element,E.selector).each(B=>{E.focusManager.set(T,B)})},Mp=(T,E,B)=>np(T,B.selector,E,-1),Dp=(T,E,B)=>np(T,B.selector,E,1),sH=x([pg(cg(a1),Ig(Mp)),pg(cg(a3),Ig(Dp)),pg(dg([ug,cg(aK)]),(T,E,B,M)=>B.moveOnTab?Ig(Mp)(T,E,B,M):A.none()),pg(dg([a5,cg(aK)]),(T,E,B,M)=>B.moveOnTab?Ig(Dp)(T,E,B,M):A.none()),pg(cg(aZ),Ep),pg(cg(aQ),Ep)]),sN=x([pg(cg(aQ),Cg)]);var sW=yg(sV,nf.init,sH,sN,()=>A.some(Ap));let sz=[Ni("onSpace"),Ni("onEnter"),Ni("onShiftEnter"),Ni("onLeft"),Ni("onRight"),Ni("onTab"),Ni("onShiftTab"),Ni("onUp"),Ni("onDown"),Ni("onEscape"),xs("stopSpaceKeyup",!1),ms("focusIn")];var sP=yg(sz,nf.init,(T,E,B)=>[pg(cg(aQ),B.onSpace),pg(dg([a5,cg(aZ)]),B.onEnter),pg(dg([ug,cg(aZ)]),B.onShiftEnter),pg(dg([ug,cg(aK)]),B.onShiftTab),pg(dg([a5,cg(aK)]),B.onTab),pg(cg(a1),B.onUp),pg(cg(a3),B.onDown),pg(cg(a0),B.onLeft),pg(cg(a2),B.onRight),pg(cg(aQ),B.onSpace)],(T,E,B)=>[...B.stopSpaceKeyup?[pg(cg(aQ),Cg)]:[],pg(cg(aJ),B.onEscape)],T=>T.focusIn);let sU=a9.schema(),sG=a6.schema(),s$=sy.schema(),sj=sf.schema(),sY=sL.schema(),sX=a8.schema(),sq=sW.schema(),sK=sP.schema(),sZ=Dl({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:sU,cyclic:sG,flow:s$,flatgrid:sj,matrix:sY,execution:sX,menu:sq,special:sK}),name:"keying",active:{events:(T,E)=>T.handler.toEvents(T,E)},apis:{focusIn:(T,E,B)=>{E.sendFocusIn(E).fold(()=>{T.getSystem().triggerFocus(T.element,T.element)},M=>{M(T,E,B)})},setGridSize:(T,E,B,M,D)=>{ye(B,"setGridSize")?B.setGridSize(M,D):console.error("Layout does not support setGridSize")}},state:a7}),$p=(T,E)=>{Hl(()=>{((T,E,B)=>{let M=T.components();H(T.components(),T=>Uo(T.element)),Po(T.element),T.syncComponents();let D=B(E),er=J(M,D);H(er,E=>{Ed(E),T.getSystem().removeFromWorld(E)}),H(D,E=>{Td(E)?Bd(T,E):(T.getSystem().addToWorld(E),Bd(T,E),xt(T.element)&&Ad(E))}),T.syncComponents()})(T,E,()=>L(E,T.getSystem().build))},T.element)},qp=(T,E)=>{Hl(()=>{((B,M,D)=>{var er,ea;let es=B.components(),eu=Y(M,T=>Ca(T).toArray());H(es,T=>{R(eu,T)||Dd(T)});let eg=(er=T.element,ea=T.getSystem().buildOrPatch,Qa(er,E,(T,E)=>ei(er,E,T,ea))),ep=J(es,eg);H(ep,T=>{Td(T)&&Dd(T)}),H(eg,T=>{Td(T)||Md(B,T)}),B.syncComponents()})(T,E)},T.element)},Yp=(T,E,B,M)=>{Dd(E);let D=ei(T.element,B,M,T.getSystem().buildOrPatch);Md(T,D),T.syncComponents()},Xp=(T,E,B)=>{let M=T.getSystem().build(B);Fd(T,M,E)},Kp=(T,E,B,M)=>{Nd(E),Xp(T,(T,E)=>((T,E,B)=>{ct(T,B).fold(()=>{Lo(T,E)},T=>{No(T,E)})})(T,E,B),M)},Jp=(T,E)=>T.components(),Zp=(T,E,B,M,D)=>{let er=Jp(T);return A.from(er[M]).map(B=>(D.fold(()=>Nd(B),D=>{(E.reuseDom?Yp:Kp)(T,B,M,D)}),B))};var sJ=Object.freeze({__proto__:null,append:(T,E,B,M)=>{Xp(T,Lo,M)},prepend:(T,E,B,M)=>{Xp(T,zo,M)},remove:(T,E,B,M)=>{let D=Jp(T),er=G(D,T=>Qe(M.element,T.element));er.each(Nd)},replaceAt:Zp,replaceBy:(T,E,B,M,D)=>{let er=Jp(T);return $(er,M).bind(B=>Zp(T,E,0,B,D))},set:(T,E,B,M)=>(E.reuseDom?qp:$p)(T,M),contents:Jp});let sQ=Al({fields:[Os("reuseDom",!0)],name:"replacing",apis:sJ}),th=(T,E)=>{let B=((T,E)=>{let B=Hr(E);return Al({fields:[ns("enabled")],name:T,active:{events:x(B)}})})(T,E);return{key:T,value:{config:{},me:B,configAsRaw:x({}),initialConfig:{},state:nf}}},oh=(T,E)=>{E.ignore||(Rl(T.element),E.onFocus(T))};var s0=Object.freeze({__proto__:null,focus:oh,blur:(T,E)=>{E.ignore||Nl(T.element)},isFocused:T=>Vl(T.element)}),s1=Object.freeze({__proto__:null,exhibit:(T,E)=>{let B=E.ignore?{}:{attributes:{tabindex:"-1"}};return Aa(B)},events:T=>Hr([Wr(od(),(E,B)=>{oh(E,T),B.stop()})].concat(T.stopMousedown?[Wr(tq(),(T,E)=>{E.event.prevent()})]:[]))}),s2=[Ri("onFocus"),xs("stopMousedown",!1),xs("ignore",!1)];let s3=Al({fields:s2,name:"focusing",active:s1,apis:s0}),ih=(T,E,B,M)=>{let D=B.get();B.set(M),((T,E,B)=>{E.toggleClass.each(E=>{B.get()?Wa(T.element,E):Ga(T.element,E)})})(T,E,B),((T,E,B)=>{let M=E.aria;M.update(T,M,B.get())})(T,E,B),D!==M&&E.onToggled(T,M)},lh=(T,E,B)=>{ih(T,E,B,!B.get())},ch=(T,E,B)=>{ih(T,E,B,E.selected)};var s5=Object.freeze({__proto__:null,onLoad:ch,toggle:lh,isOn:(T,E,B)=>B.get(),on:(T,E,B)=>{ih(T,E,B,!0)},off:(T,E,B)=>{ih(T,E,B,!1)},set:ih}),s9=Object.freeze({__proto__:null,exhibit:()=>Aa({}),events:(T,E)=>{let B=o0(B=>{lh(B,T,E)}),M=Cl(T,E,ch);return Hr(q([T.toggleOnExecute?[B]:[],[M]]))}});let mh=(T,E,B)=>{Ct(T.element,"aria-expanded",B)};var s6=[xs("selected",!1),ms("toggleClass"),xs("toggleOnExecute",!0),Ri("onToggled"),ws("aria",{mode:"none"},Zn("mode",{pressed:[xs("syncWithExpanded",!1),Li("update",(T,E,B)=>{Ct(T.element,"aria-pressed",B),E.syncWithExpanded&&mh(T,0,B)})],checked:[Li("update",(T,E,B)=>{Ct(T.element,"aria-checked",B)})],expanded:[Li("update",mh)],selected:[Li("update",(T,E,B)=>{Ct(T.element,"aria-selected",B)})],none:[Li("update",b)]}))];let s4=Al({fields:s6,name:"toggling",active:s9,apis:s5,state:{init:()=>{let T=As(!1);return{get:()=>T.get(),set:E=>T.set(E),clear:()=>T.set(!1),readState:()=>T.get()}}}}),hh=()=>{let e=(T,E)=>{E.stop(),Nr(T)};return[Wr(t6(),e),Wr(ok(),e),Yr(t$()),Yr(tq())]},fh=T=>Hr(q([T.map(T=>o0((E,B)=>{T(E),B.stop()})).toArray(),hh()])),s8="alloy.item-hover",s7="alloy.item-focus",ie="alloy.item-toggled",xh=T=>{(Ll(T.element).isNone()||s3.isFocused(T))&&(s3.isFocused(T)||s3.focus(T),Rr(T,s8,{item:T}))},wh=T=>{Rr(T,s7,{item:T})},io=x(s8),ir=x(s7),ia=x(ie),Oh=T=>T.toggling.map(T=>T.exclusive?"menuitemradio":"menuitemcheckbox").getOr("menuitem"),ii=[ns("data"),ns("components"),ns("dom"),xs("hasSubmenu",!1),ms("toggling"),yu("itemBehaviours",[s4,s3,sZ,r2]),xs("ignoreFocus",!1),xs("domModification",{}),Li("builder",T=>({dom:T.dom,domModification:{...T.domModification,attributes:{role:Oh(T),...T.domModification.attributes,"aria-haspopup":T.hasSubmenu,...T.hasSubmenu?{"aria-expanded":!1}:{}}},behaviours:wu(T.itemBehaviours,[T.toggling.fold(s4.revoke,T=>s4.config({aria:{mode:"checked"},...ge(T,(T,E)=>"exclusive"!==E),onToggled:(E,B)=>{es(T.onToggled)&&T.onToggled(E,B),Rr(E,ie,{item:E,state:B})}})),s3.config({ignore:T.ignoreFocus,stopMousedown:T.ignoreFocus,onFocus:T=>{wh(T)}}),sZ.config({mode:"execution"}),r2.config({store:{mode:"memory",initialValue:T.data}}),th("item-type-events",[...hh(),Wr(tQ(),xh),Wr(oC(),s3.focus)])]),components:T.components,eventOrder:T.eventOrder})),xs("eventOrder",{})],ic=[ns("dom"),ns("components"),Li("builder",T=>({dom:T.dom,components:T.components,events:Hr([Xr(oC())])}))],id=x("item-widget"),ib=x([aT({name:"widget",overrides:T=>({behaviours:Tl([r2.config({store:{mode:"manual",getValue:E=>T.data,setValue:b}})])})})]),ix=[ns("uid"),ns("data"),ns("components"),ns("dom"),xs("autofocus",!1),xs("ignoreFocus",!1),yu("widgetBehaviours",[r2,s3,sZ]),xs("domModification",{}),gm(ib()),Li("builder",T=>{let E=sm(id(),T,ib()),B=rm(id(),T,E.internals()),n=E=>am(E,T,"widget").map(T=>(sZ.focusIn(T),T)),s=(E,B)=>(Sm(B.event.target)||T.autofocus&&B.setSource(E.element),A.none());return{dom:T.dom,components:B,domModification:T.domModification,events:Hr([o0((T,E)=>{n(T).each(T=>{E.stop()})}),Wr(tQ(),xh),Wr(oC(),(E,B)=>{T.autofocus?n(E):s3.focus(E)})]),behaviours:wu(T.widgetBehaviours,[r2.config({store:{mode:"memory",initialValue:T.data}}),s3.config({ignore:T.ignoreFocus,onFocus:T=>{wh(T)}}),sZ.config({mode:"special",focusIn:T.autofocus?T=>{n(T)}:nQ(),onLeft:s,onRight:s,onEscape:(E,B)=>s3.isFocused(E)||T.autofocus?(T.autofocus&&B.setSource(E.element),A.none()):(s3.focus(E),A.some(!0))})])}})],iy=Zn("type",{widget:ix,item:ii,separator:ic}),iw=x([aB({factory:{sketch:T=>{let E=Kn("menu.spec item",iy,T);return E.builder(E)}},name:"items",unit:"item",defaults:(T,E)=>ve(E,"uid")?E:{...E,uid:fa("item")},overrides:(T,E)=>({type:E.type,ignoreFocus:T.fakeFocus,domModification:{classes:[T.markers.item]}})})]),iS=x([ns("value"),ns("items"),ns("dom"),ns("components"),xs("eventOrder",{}),yu("menuBehaviours",[aq,r2,az,sZ]),ws("movement",{mode:"menu",moveOnTab:!0},Zn("mode",{grid:[nH(),Li("config",(T,E)=>({mode:"flatgrid",selector:"."+T.markers.item,initSize:{numColumns:E.initSize.numColumns,numRows:E.initSize.numRows},focusManager:T.focusManager}))],matrix:[Li("config",(T,E)=>({mode:"matrix",selectors:{row:E.rowSelector,cell:"."+T.markers.item},previousSelector:E.previousSelector,focusManager:T.focusManager})),ns("rowSelector"),xs("previousSelector",A.none)],menu:[xs("moveOnTab",!0),Li("config",(T,E)=>({mode:"menu",selector:"."+T.markers.item,moveOnTab:E.moveOnTab,focusManager:T.focusManager}))]})),ss("markers",nL()),xs("fakeFocus",!1),xs("focusManager",fg()),Ri("onHighlight"),Ri("onDehighlight")]),iT=x("alloy.menu-focus"),ik=wm({name:"Menu",configFields:iS(),partFields:iw(),factory:(T,E,B,M)=>({uid:T.uid,dom:T.dom,markers:T.markers,behaviours:wu(T.menuBehaviours,[aq.config({highlightClass:T.markers.selectedItem,itemClass:T.markers.item,onHighlight:T.onHighlight,onDehighlight:T.onDehighlight}),r2.config({store:{mode:"memory",initialValue:T.value}}),az.config({find:A.some}),sZ.config(T.movement.config(T,T.movement))]),events:Hr([Wr(ir(),(T,E)=>{let B=E.event;T.getSystem().getByDom(B.target).each(B=>{aq.highlight(T,B),E.stop(),Rr(T,iT(),{menu:T,item:B})})}),Wr(io(),(T,E)=>{let B=E.event.item;aq.highlight(T,B)}),Wr(ia(),(T,E)=>{let{item:B,state:M}=E.event;M&&"menuitemradio"===_t(B.element,"role")&&((T,E)=>{let B=Zc(T.element,'[role="menuitemradio"][aria-checked="true"]');H(B,B=>{Qe(B,E.element)||T.getSystem().getByDom(B).each(T=>{s4.off(T)})})})(T,B)})]),components:E,eventOrder:T.eventOrder,domModification:{attributes:{role:"menu"}}})}),Nh=(T,E,B,M)=>be(B,M).bind(M=>be(T,M).bind(M=>{let D=Nh(T,E,B,M);return A.some([M].concat(D))})).getOr([]),Vh=T=>"prepared"===T.type?A.some(T.menu):A.none(),zh=()=>{let T=As({}),E=As({}),B=As({}),M=nc(),D=As({}),r=T=>a(T).bind(Vh),a=T=>be(E.get(),T),i=E=>be(T.get(),E);return{setMenuBuilt:(T,B)=>{E.set({...E.get(),[T]:{type:"prepared",menu:B}})},setContents:(er,ea,es,eu)=>{M.set(er),T.set(es),E.set(ea),D.set(eu);let eg=((T,E)=>{let B={};le(T,(T,E)=>{H(T,T=>{B[T]=E})});let M=de(E,(T,E)=>({k:T,v:E})),D=ce(M,(T,D)=>[D].concat(Nh(B,E,M,D)));return ce(B,T=>be(D,T).getOr([T]))})(eu,es);B.set(eg)},expand:E=>be(T.get(),E).map(T=>{let M=be(B.get(),E).getOr([]);return[T].concat(M)}),refresh:T=>be(B.get(),T),collapse:T=>be(B.get(),T).bind(T=>T.length>1?A.some(T.slice(1)):A.none()),lookupMenu:a,lookupItem:i,otherMenus:T=>{let E=D.get();return J(eO(E),T)},getPrimary:()=>M.get().bind(r),getMenus:()=>E.get(),clear:()=>{T.set({}),E.set({}),B.set({}),M.clear()},isClear:()=>M.get().isNone(),getTriggeringPath:(E,D)=>{let er=U(i(E).toArray(),T=>r(T).isSome());return be(B.get(),E).bind(E=>{let B=K(er.concat(E));return(T=>{let E=[];for(let B=0;B<T.length;B++){let M=T[B];if(!M.isSome())return A.none();E.push(M.getOrDie())}return A.some(E)})(Y(B,(E,er)=>{var ea;return(ea=B.slice(0,er+1),r(E).bind(B=>he(T.get(),(T,B)=>T===E).bind(T=>D(T).map(T=>({triggeredMenu:B,triggeringItem:T,triggeringPath:ea}))))).fold(()=>xe(M.get(),E)?[]:[A.none()],T=>[A.some(T)])}))})}}},i_=ca("tiered-menu-item-highlight"),iB=ca("tiered-menu-item-dehighlight");(lJ=l2||(l2={}))[lJ.HighlightMenuAndItem=0]="HighlightMenuAndItem",lJ[lJ.HighlightJustMenu=1]="HighlightJustMenu",lJ[lJ.HighlightNone=2]="HighlightNone";let iR=x("collapse-item"),iL=xm({name:"TieredMenu",configFields:[zi("onExecute"),zi("onEscape"),Vi("onOpenMenu"),Vi("onOpenSubmenu"),Ri("onRepositionMenu"),Ri("onCollapseMenu"),xs("highlightOnOpen",l2.HighlightMenuAndItem),cs("data",[ns("primary"),ns("menus"),ns("expansions")]),xs("fakeFocus",!1),Ri("onHighlightItem"),Ri("onDehighlightItem"),Ri("onHover"),Bi(),ns("dom"),xs("navigateOnHover",!0),xs("stayInDom",!1),yu("tmenuBehaviours",[sZ,aq,az,sQ]),xs("eventOrder",{})],apis:{collapseMenu:(T,E)=>{T.collapseMenu(E)},highlightPrimary:(T,E)=>{T.highlightPrimary(E)},repositionMenus:(T,E)=>{T.repositionMenus(E)}},factory:(T,E)=>{var B;let M;let D=nc(),er=zh(),s=T=>r2.getValue(T).value,r=E=>ce(T.data.menus,(T,E)=>Y(T.items,T=>"separator"===T.type?[]:[T.data.value])),ea=aq.highlight,i=(E,B)=>{ea(E,B),aq.getHighlighted(B).orThunk(()=>aq.getFirst(B)).each(M=>{T.fakeFocus?aq.highlight(B,M):Vr(E,M.element,oC())})},l=(T,E)=>we(L(E,E=>T.lookupMenu(E).bind(T=>"prepared"===T.type?A.some(T.menu):A.none()))),c=(E,B,M)=>{let D=l(B,B.otherMenus(M));H(D,B=>{Ya(B.element,[T.markers.backgroundMenu]),T.stayInDom||sQ.remove(E,B)})},d=(E,B)=>{let M=D.get().getOrThunk(()=>{let B={},M=Zc(E.element,`.${T.markers.item}`),er=U(M,T=>"true"===_t(T,"aria-haspopup"));return H(er,T=>{E.getSystem().getByDom(T).each(T=>{let E=s(T);B[E]=T})}),D.set(B),B});le(M,(T,E)=>{let M=R(B,E);Ct(T.element,"aria-expanded",M)})},u=(E,B,M)=>A.from(M[0]).bind(D=>B.lookupMenu(D).bind(D=>{if("notbuilt"===D.type)return A.none();{let er=D.menu,ea=l(B,M.slice(1));return H(ea,E=>{Wa(E.element,T.markers.backgroundMenu)}),xt(er.element)||sQ.append(E,ka(er)),Ya(er.element,[T.markers.backgroundMenu]),i(E,er),c(E,B,M),A.some(er)}}));(B=M||(M={}))[B.HighlightSubmenu=0]="HighlightSubmenu",B[B.HighlightParent=1]="HighlightParent";let g=(E,B,D=M.HighlightSubmenu)=>{if(B.hasConfigured(aj)&&aj.isDisabled(B))return A.some(B);{let ea=s(B);return er.expand(ea).bind(ea=>(d(E,ea),A.from(ea[0]).bind(es=>er.lookupMenu(es).bind(eu=>{let eg=((T,E,B)=>{if("notbuilt"===B.type){let M=T.getSystem().build(B.nbMenu());return er.setMenuBuilt(E,M),M}return B.menu})(E,es,eu);return xt(eg.element)||sQ.append(E,ka(eg)),T.onOpenSubmenu(E,B,eg,K(ea)),D===M.HighlightSubmenu?(aq.highlightFirst(eg),u(E,er,ea)):(aq.dehighlightAll(eg),A.some(B))}))))}},p=(E,B)=>{let M=s(B);return er.collapse(M).bind(M=>(d(E,M),u(E,er,M).map(M=>(T.onCollapseMenu(E,B,M),M))))},h=E=>(B,M)=>yi(M.getSource(),`.${T.markers.item}`).bind(T=>B.getSystem().getByDom(T).toOptional().bind(T=>E(B,T).map(ep))),es=Hr([Wr(iT(),(T,E)=>{let B=E.event.item;er.lookupItem(s(B)).each(()=>{let B=E.event.menu;aq.highlight(T,B);let M=s(E.event.item);er.refresh(M).each(E=>c(T,er,E))})}),o0((E,B)=>{let D=B.event.target;E.getSystem().getByDom(D).each(B=>{0===s(B).indexOf("collapse-item")&&p(E,B),g(E,B,M.HighlightSubmenu).fold(()=>{T.onExecute(E,B)},b)})}),oZ((E,B)=>{(E=>{var B;let M=(B=T.data.primary,ce(T.data.menus,(M,D)=>{let r=()=>ik.sketch({...M,value:D,markers:T.markers,fakeFocus:T.fakeFocus,onHighlight:(T,E)=>{Rr(T,i_,{menuComp:T,itemComp:E})},onDehighlight:(T,E)=>{Rr(T,iB,{menuComp:T,itemComp:E})},focusManager:T.fakeFocus?bg():fg()});return D===B?{type:"prepared",menu:E.getSystem().build(r())}:{type:"notbuilt",nbMenu:r}})),D=r();return er.setContents(T.data.primary,M,T.data.expansions,D),er.getPrimary()})(E).each(B=>{sQ.append(E,ka(B)),T.onOpenMenu(E,B),T.highlightOnOpen===l2.HighlightMenuAndItem?i(E,B):T.highlightOnOpen===l2.HighlightJustMenu&&ea(E,B)})}),Wr(i_,(E,B)=>{T.onHighlightItem(E,B.event.menuComp,B.event.itemComp)}),Wr(iB,(E,B)=>{T.onDehighlightItem(E,B.event.menuComp,B.event.itemComp)}),...T.navigateOnHover?[Wr(io(),(E,B)=>{let D=B.event.item;((T,E)=>{let B=s(E);er.refresh(B).bind(E=>(d(T,E),u(T,er,E)))})(E,D),g(E,D,M.HighlightParent),T.onHover(E,D)})]:[]]),v=T=>aq.getHighlighted(T).bind(aq.getHighlighted);return{uid:T.uid,dom:T.dom,markers:T.markers,behaviours:wu(T.tmenuBehaviours,[sZ.config({mode:"special",onRight:h((T,E)=>Sm(E.element)?A.none():g(T,E,M.HighlightSubmenu)),onLeft:h((T,E)=>Sm(E.element)?A.none():p(T,E)),onEscape:h((E,B)=>p(E,B).orThunk(()=>T.onEscape(E,B).map(()=>E))),focusIn:(T,E)=>{er.getPrimary().each(E=>{Vr(T,E.element,oC())})}}),aq.config({highlightClass:T.markers.selectedMenu,itemClass:T.markers.menu}),az.config({find:T=>aq.getHighlighted(T)}),sQ.config({})]),eventOrder:T.eventOrder,apis:{collapseMenu:T=>{v(T).each(E=>{p(T,E)})},highlightPrimary:T=>{er.getPrimary().each(E=>{i(T,E)})},repositionMenus:E=>{let B=er.getPrimary().bind(T=>v(E).bind(T=>{let E=s(T),B=fe(er.getMenus()),M=we(L(B,Vh));return er.getTriggeringPath(E,T=>re(M,E=>{if(!E.getSystem().isConnected())return A.none();let B=aq.getCandidates(E);return G(B,E=>s(E)===T)}))}).map(E=>({primary:T,triggeringPath:E})));B.fold(()=>{A.from(E.components()[0]).filter(T=>"menu"===_t(T.element,"role")).each(B=>{T.onRepositionMenu(E,B,[])})},({primary:B,triggeringPath:M})=>{T.onRepositionMenu(E,B,M)})}},events:es}},extraApis:{tieredData:(T,E,B)=>({primary:T,menus:E,expansions:B}),singleData:(T,E)=>({primary:T,menus:Ds(T,E),expansions:{}}),collapseItem:T=>({value:ca(iR()),meta:{text:T}})}}),iH=xm({name:"InlineView",configFields:[ns("lazySink"),Ri("onShow"),Ri("onHide"),bs("onEscape"),yu("inlineBehaviours",[rG,r2,n0]),ys("fireDismissalEventInstead",[xs("event",oP())]),ys("fireRepositionEventInstead",[xs("event",oU())]),xs("getRelated",A.none),xs("isExtraPart",eg),xs("eventOrder",A.none)],factory:(T,E)=>{let o=(E,B,M,D)=>{let er=T.lazySink(E).getOrDie();rG.openWhileCloaked(E,B,()=>rN.positionWithinBounds(er,E,M,D())),r2.setValue(E,A.some({mode:"position",config:M,getBounds:D}))},n=(E,B,M,D)=>{let er=((T,E,B,M,D)=>{let r=()=>T.lazySink(E),er="horizontal"===M.type?{layouts:{onLtr:()=>xl(),onRtl:()=>wl()}}:{},i=T=>2===T.length?er:{};return iL.sketch({dom:{tag:"div"},data:M.data,markers:M.menu.markers,highlightOnOpen:M.menu.highlightOnOpen,fakeFocus:M.menu.fakeFocus,onEscape:()=>(rG.close(E),T.onEscape.map(T=>T(E)),A.some(!0)),onExecute:()=>A.some(!0),onOpenMenu:(T,E)=>{rN.positionWithinBounds(r().getOrDie(),E,B,D())},onOpenSubmenu:(T,E,B,M)=>{let D=r().getOrDie();rN.position(D,B,{anchor:{type:"submenu",item:E,...i(M)}})},onRepositionMenu:(T,E,M)=>{let er=r().getOrDie();rN.positionWithinBounds(er,E,B,D()),H(M,T=>{let E=i(T.triggeringPath);rN.position(er,T.triggeredMenu,{anchor:{type:"submenu",item:T.triggeringItem,...E}})})}})})(T,E,B,M,D);rG.open(E,er),r2.setValue(E,A.some({mode:"menu",menu:er}))},s=E=>{rG.isOpen(E)&&r2.getValue(E).each(B=>{switch(B.mode){case"menu":rG.getState(E).each(iL.repositionMenus);break;case"position":let M=T.lazySink(E).getOrDie();rN.positionWithinBounds(M,E,B.config,B.getBounds())}})},B={setContent:(T,E)=>{rG.setContent(T,E)},showAt:(T,E,B)=>{let M=A.none;o(T,E,B,M)},showWithinBounds:o,showMenuAt:(T,E,B)=>{n(T,E,B,A.none)},showMenuWithinBounds:n,hide:T=>{rG.isOpen(T)&&(r2.setValue(T,A.none()),rG.close(T))},getContent:T=>rG.getState(T),reposition:s,isOpen:rG.isOpen};return{uid:T.uid,dom:T.dom,behaviours:wu(T.inlineBehaviours,[rG.config({isPartOf:(E,B,M)=>Si(B,M)||T.getRelated(E).exists(T=>Si(T,M)),getAttachPoint:E=>T.lazySink(E).getOrDie(),onOpen:E=>{T.onShow(E)},onClose:E=>{T.onHide(E)}}),r2.config({store:{mode:"memory",initialValue:A.none()}}),n0.config({channels:{...nu({isExtraPart:E.isExtraPart,...T.fireDismissalEventInstead.map(T=>({fireEventInstead:{event:T.event}})).getOr({})}),...ru({...T.fireRepositionEventInstead.map(T=>({fireEventInstead:{event:T.event}})).getOr({}),doReposition:s})}})]),eventOrder:T.eventOrder,apis:B}},apis:{showAt:(T,E,B,M)=>{T.showAt(E,B,M)},showWithinBounds:(T,E,B,M,D)=>{T.showWithinBounds(E,B,M,D)},showMenuAt:(T,E,B,M)=>{T.showMenuAt(E,B,M)},showMenuWithinBounds:(T,E,B,M,D)=>{T.showMenuWithinBounds(E,B,M,D)},hide:(T,E)=>{T.hide(E)},isOpen:(T,E)=>T.isOpen(E),getContent:(T,E)=>T.getContent(E),setContent:(T,E,B)=>{T.setContent(E,B)},reposition:(T,E)=>{T.reposition(E)}}});var iN=tinymce.util.Tools.resolve("tinymce.util.Delay");let iW=xm({name:"Button",factory:T=>{let E=fh(T.action),B=T.dom.tag,n=E=>be(T.dom,"attributes").bind(T=>be(T,E));return{uid:T.uid,dom:T.dom,components:T.components,events:E,behaviours:wu(T.buttonBehaviours,[s3.config({}),sZ.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:"button"===B?{type:n("type").getOr("button"),...n("role").map(T=>({role:T})).getOr({})}:{role:T.role.getOr(n("role").getOr("button"))}},eventOrder:T.eventOrder}},configFields:[xs("uid",void 0),ns("dom"),xs("components",[]),yu("buttonBehaviours",[s3,sZ]),ms("action"),ms("role"),xs("eventOrder",{})]}),Yh=T=>{let E=Re(T),B=lt(E),M=(T=>{let E=void 0!==T.dom.attributes?T.dom.attributes:[];return j(E,(T,E)=>"class"===E.name?T:{...T,[E.name]:E.value},{})})(E),D=Array.prototype.slice.call(E.dom.classList,0),er=0===B.length?{}:{innerHtml:ta(E)};return{tag:We(E),classes:D,attributes:M,...er}},Xh=T=>{let E=void 0!==T.uid&&ye(T,"uid")?T.uid:fa("memento");return{get:T=>T.getSystem().getByUid(E).getOrDie(),getOpt:T=>T.getSystem().getByUid(E).toOptional(),asSpec:()=>({...T,uid:E})}},{entries:iz,setPrototypeOf:iP,isFrozen:iU,getPrototypeOf:iG,getOwnPropertyDescriptor:i$}=Object,{freeze:ij,seal:iY,create:iX}=Object,{apply:iq,construct:iK}="undefined"!=typeof Reflect&&Reflect;iq||(iq=function(T,E,B){return T.apply(E,B)}),ij||(ij=function(T){return T}),iY||(iY=function(T){return T}),iK||(iK=function(T,E){return new T(...E)});let iZ=yf(Array.prototype.forEach),iJ=yf(Array.prototype.pop),iQ=yf(Array.prototype.push),i0=yf(String.prototype.toLowerCase),i1=yf(String.prototype.toString),i2=yf(String.prototype.match),i3=yf(String.prototype.replace),i5=yf(String.prototype.indexOf),i9=yf(String.prototype.trim),i6=yf(RegExp.prototype.test),i4=(l3=TypeError,function(){for(var T=arguments.length,E=Array(T),B=0;B<T;B++)E[B]=arguments[B];return iK(l3,E)});function yf(T){return function(E){for(var B=arguments.length,M=Array(B>1?B-1:0),D=1;D<B;D++)M[D-1]=arguments[D];return iq(T,E,M)}}function xf(T,E,B){var M;B=null!==(M=B)&&void 0!==M?M:i0,iP&&iP(T,null);let D=E.length;for(;D--;){let M=E[D];if("string"==typeof M){let T=B(M);T!==M&&(iU(E)||(E[D]=T),M=T)}T[M]=!0}return T}function wf(T){let E=iX(null);for(let[B,M]of iz(T))E[B]=M;return E}function Sf(T,E){for(;null!==T;){let B=i$(T,E);if(B){if(B.get)return yf(B.get);if("function"==typeof B.value)return yf(B.value)}T=iG(T)}return function(T){return console.warn("fallback value for",T),null}}let i8=ij(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),i7=ij(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),lo=ij(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),lr=ij(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),la=ij(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),lc=ij(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ld=ij(["#text"]),lu=ij(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),lf=ij(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),lb=ij(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),lx=ij(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ly=iY(/\{\{[\w\W]*|[\w\W]*\}\}/gm),lT=iY(/<%[\w\W]*|[\w\W]*%>/gm),l_=iY(/\${[\w\W]*}/gm),lR=iY(/^data-[\-\w.\u00B7-\uFFFF]/),lL=iY(/^aria-[\-\w]+$/),lH=iY(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),lN=iY(/^(?:\w+script|data):/i),lW=iY(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),lz=iY(/^html$/i);var lP=Object.freeze({__proto__:null,MUSTACHE_EXPR:ly,ERB_EXPR:lT,TMPLIT_EXPR:l_,DATA_ATTR:lR,ARIA_ATTR:lL,IS_ALLOWED_URI:lH,IS_SCRIPT_OR_DATA:lN,ATTR_WHITESPACE:lW,DOCTYPE_NAME:lz});let jf=()=>"undefined"==typeof window?null:window;var lU=function e(){let T,E=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jf(),o=T=>e(T);if(o.version="3.0.5",o.removed=[],!E||!E.document||9!==E.document.nodeType)return o.isSupported=!1,o;let B=E.document,M=B.currentScript,{document:D}=E,{DocumentFragment:er,HTMLTemplateElement:ea,Node:es,Element:eu,NodeFilter:eg,NamedNodeMap:ep=E.NamedNodeMap||E.MozNamedAttrMap,HTMLFormElement:eh,DOMParser:ef,trustedTypes:ex}=E,eC=eu.prototype,eO=Sf(eC,"cloneNode"),eM=Sf(eC,"nextSibling"),eD=Sf(eC,"childNodes"),eI=Sf(eC,"parentNode");if("function"==typeof ea){let T=D.createElement("template");T.content&&T.content.ownerDocument&&(D=T.content.ownerDocument)}let eL,eV="",{implementation:eH,createNodeIterator:eN,createDocumentFragment:eW,getElementsByTagName:ez}=D,{importNode:eP}=B,eU={};o.isSupported="function"==typeof iz&&"function"==typeof eI&&eH&&void 0!==eH.createHTMLDocument;let{MUSTACHE_EXPR:eG,ERB_EXPR:e$,TMPLIT_EXPR:ej,DATA_ATTR:eY,ARIA_ATTR:eX,IS_SCRIPT_OR_DATA:eq,ATTR_WHITESPACE:eK}=lP,{IS_ALLOWED_URI:eZ}=lP,eJ=null,eQ=xf({},[...i8,...i7,...lo,...la,...ld]),e0=null,e1=xf({},[...lu,...lf,...lb,...lx]),e2=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),e3=null,e5=null,e9=!0,e6=!0,e4=!1,e8=!0,e7=!1,tr=!1,tl=!1,tu=!1,tg=!1,tf=!1,tx=!1,tO=!0,tE=!1,tM=!0,tD=!1,tL={},tV=null,tH=xf({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),tN=null,tW=xf({},["audio","video","img","source","image","track"]),tz=null,tP=xf({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),tU="http://www.w3.org/1998/Math/MathML",tG="http://www.w3.org/2000/svg",t$="http://www.w3.org/1999/xhtml",tj=t$,tY=!1,tX=null,tq=xf({},[tU,tG,t$],i1),tK=["application/xhtml+xml","text/html"],tZ,tJ=null,tQ=D.createElement("form"),ke=function(T){return T instanceof RegExp||T instanceof Function},Ce=function(E){if(!tJ||tJ!==E){if(E&&"object"==typeof E||(E={}),E=wf(E),tZ="application/xhtml+xml"===(T=T=-1===tK.indexOf(E.PARSER_MEDIA_TYPE)?"text/html":E.PARSER_MEDIA_TYPE)?i1:i0,eJ="ALLOWED_TAGS"in E?xf({},E.ALLOWED_TAGS,tZ):eQ,e0="ALLOWED_ATTR"in E?xf({},E.ALLOWED_ATTR,tZ):e1,tX="ALLOWED_NAMESPACES"in E?xf({},E.ALLOWED_NAMESPACES,i1):tq,tz="ADD_URI_SAFE_ATTR"in E?xf(wf(tP),E.ADD_URI_SAFE_ATTR,tZ):tP,tN="ADD_DATA_URI_TAGS"in E?xf(wf(tW),E.ADD_DATA_URI_TAGS,tZ):tW,tV="FORBID_CONTENTS"in E?xf({},E.FORBID_CONTENTS,tZ):tH,e3="FORBID_TAGS"in E?xf({},E.FORBID_TAGS,tZ):{},e5="FORBID_ATTR"in E?xf({},E.FORBID_ATTR,tZ):{},tL="USE_PROFILES"in E&&E.USE_PROFILES,e9=!1!==E.ALLOW_ARIA_ATTR,e6=!1!==E.ALLOW_DATA_ATTR,e4=E.ALLOW_UNKNOWN_PROTOCOLS||!1,e8=!1!==E.ALLOW_SELF_CLOSE_IN_ATTR,e7=E.SAFE_FOR_TEMPLATES||!1,tr=E.WHOLE_DOCUMENT||!1,tg=E.RETURN_DOM||!1,tf=E.RETURN_DOM_FRAGMENT||!1,tx=E.RETURN_TRUSTED_TYPE||!1,tu=E.FORCE_BODY||!1,tO=!1!==E.SANITIZE_DOM,tE=E.SANITIZE_NAMED_PROPS||!1,tM=!1!==E.KEEP_CONTENT,tD=E.IN_PLACE||!1,eZ=E.ALLOWED_URI_REGEXP||lH,tj=E.NAMESPACE||t$,e2=E.CUSTOM_ELEMENT_HANDLING||{},E.CUSTOM_ELEMENT_HANDLING&&ke(E.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(e2.tagNameCheck=E.CUSTOM_ELEMENT_HANDLING.tagNameCheck),E.CUSTOM_ELEMENT_HANDLING&&ke(E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(e2.attributeNameCheck=E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),E.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(e2.allowCustomizedBuiltInElements=E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),e7&&(e6=!1),tf&&(tg=!0),tL&&(eJ=xf({},[...ld]),e0=[],!0===tL.html&&(xf(eJ,i8),xf(e0,lu)),!0===tL.svg&&(xf(eJ,i7),xf(e0,lf),xf(e0,lx)),!0===tL.svgFilters&&(xf(eJ,lo),xf(e0,lf),xf(e0,lx)),!0===tL.mathMl&&(xf(eJ,la),xf(e0,lb),xf(e0,lx))),E.ADD_TAGS&&(eJ===eQ&&(eJ=wf(eJ)),xf(eJ,E.ADD_TAGS,tZ)),E.ADD_ATTR&&(e0===e1&&(e0=wf(e0)),xf(e0,E.ADD_ATTR,tZ)),E.ADD_URI_SAFE_ATTR&&xf(tz,E.ADD_URI_SAFE_ATTR,tZ),E.FORBID_CONTENTS&&(tV===tH&&(tV=wf(tV)),xf(tV,E.FORBID_CONTENTS,tZ)),tM&&(eJ["#text"]=!0),tr&&xf(eJ,["html","head","body"]),eJ.table&&(xf(eJ,["tbody"]),delete e3.tbody),E.TRUSTED_TYPES_POLICY){if("function"!=typeof E.TRUSTED_TYPES_POLICY.createHTML)throw i4('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof E.TRUSTED_TYPES_POLICY.createScriptURL)throw i4('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');eV=(eL=E.TRUSTED_TYPES_POLICY).createHTML("")}else void 0===eL&&(eL=function(T,E){if("object"!=typeof T||"function"!=typeof T.createPolicy)return null;let B=null,M="data-tt-policy-suffix";E&&E.hasAttribute(M)&&(B=E.getAttribute(M));let D="dompurify"+(B?"#"+B:"");try{return T.createPolicy(D,{createHTML:T=>T,createScriptURL:T=>T})}catch(T){return console.warn("TrustedTypes policy "+D+" could not be created."),null}}(ex,M)),null!==eL&&"string"==typeof eV&&(eV=eL.createHTML(""));ij&&ij(E),tJ=E}},t0=xf({},["mi","mo","mn","ms","mtext"]),t1=xf({},["foreignobject","desc","title","annotation-xml"]),t2=xf({},["title","style","font","a","script"]),t3=xf({},i7);xf(t3,lo),xf(t3,lr);let t5=xf({},la);xf(t5,lc);let Me=function(T){iQ(o.removed,{element:T});try{T.parentNode.removeChild(T)}catch(E){T.remove()}},De=function(T,E){try{iQ(o.removed,{attribute:E.getAttributeNode(T),from:E})}catch(T){iQ(o.removed,{attribute:null,from:E})}if(E.removeAttribute(T),"is"===T&&!e0[T]){if(tg||tf)try{Me(E)}catch(T){}else try{E.setAttribute(T,"")}catch(T){}}},Be=function(E){let B,M;if(tu)E="<remove></remove>"+E;else{let T=i2(E,/^[\r\n\t ]+/);M=T&&T[0]}"application/xhtml+xml"===T&&tj===t$&&(E='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+E+"</body></html>");let er=eL?eL.createHTML(E):E;if(tj===t$)try{B=(new ef).parseFromString(er,T)}catch(T){}if(!B||!B.documentElement){B=eH.createDocument(tj,"template",null);try{B.documentElement.innerHTML=tY?eV:er}catch(T){}}let ea=B.body||B.documentElement;return E&&M&&ea.insertBefore(D.createTextNode(M),ea.childNodes[0]||null),tj===t$?ez.call(B,tr?"html":"body")[0]:tr?B.documentElement:ea},Ie=function(T){return eN.call(T.ownerDocument||T,T,eg.SHOW_ELEMENT|eg.SHOW_COMMENT|eg.SHOW_TEXT,null,!1)},Fe=function(T){return"object"==typeof es?T instanceof es:T&&"object"==typeof T&&"number"==typeof T.nodeType&&"string"==typeof T.nodeName},Re=function(T,E,B){eU[T]&&iZ(eU[T],T=>{T.call(o,E,B,tJ)})},Ne=function(E){let B;if(Re("beforeSanitizeElements",E,null),E instanceof eh&&("string"!=typeof E.nodeName||"string"!=typeof E.textContent||"function"!=typeof E.removeChild||!(E.attributes instanceof ep)||"function"!=typeof E.removeAttribute||"function"!=typeof E.setAttribute||"string"!=typeof E.namespaceURI||"function"!=typeof E.insertBefore||"function"!=typeof E.hasChildNodes))return Me(E),!0;let M=tZ(E.nodeName);if(Re("uponSanitizeElement",E,{tagName:M,allowedTags:eJ}),E.hasChildNodes()&&!Fe(E.firstElementChild)&&(!Fe(E.content)||!Fe(E.content.firstElementChild))&&i6(/<[/\w]/g,E.innerHTML)&&i6(/<[/\w]/g,E.textContent))return Me(E),!0;if(!eJ[M]||e3[M]){if(!e3[M]&&ze(M)&&(e2.tagNameCheck instanceof RegExp&&i6(e2.tagNameCheck,M)||e2.tagNameCheck instanceof Function&&e2.tagNameCheck(M)))return!1;if(tM&&!tV[M]){let T=eI(E)||E.parentNode,B=eD(E)||E.childNodes;if(B&&T)for(let M=B.length-1;M>=0;--M)T.insertBefore(eO(B[M],!0),eM(E))}return Me(E),!0}return E instanceof eu&&!function(E){let B=eI(E);B&&B.tagName||(B={namespaceURI:tj,tagName:"template"});let M=i0(E.tagName),D=i0(B.tagName);return!!tX[E.namespaceURI]&&(E.namespaceURI===tG?B.namespaceURI===t$?"svg"===M:B.namespaceURI===tU?"svg"===M&&("annotation-xml"===D||t0[D]):!!t3[M]:E.namespaceURI===tU?B.namespaceURI===t$?"math"===M:B.namespaceURI===tG?"math"===M&&t1[D]:!!t5[M]:E.namespaceURI===t$?!(B.namespaceURI===tG&&!t1[D])&&!(B.namespaceURI===tU&&!t0[D])&&!t5[M]&&(t2[M]||!t3[M]):!("application/xhtml+xml"!==T||!tX[E.namespaceURI]))}(E)?(Me(E),!0):("noscript"===M||"noembed"===M||"noframes"===M)&&i6(/<\/no(script|embed|frames)/i,E.innerHTML)?(Me(E),!0):(e7&&3===E.nodeType&&(B=i3(B=E.textContent,eG," "),B=i3(B,e$," "),B=i3(B,ej," "),E.textContent!==B&&(iQ(o.removed,{element:E.cloneNode()}),E.textContent=B)),Re("afterSanitizeElements",E,null),!1)},Ve=function(T,E,B){if(tO&&("id"===E||"name"===E)&&(B in D||B in tQ))return!1;if(e6&&!e5[E]&&i6(eY,E));else if(e9&&i6(eX,E));else if(!e0[E]||e5[E]){if(!(ze(T)&&(e2.tagNameCheck instanceof RegExp&&i6(e2.tagNameCheck,T)||e2.tagNameCheck instanceof Function&&e2.tagNameCheck(T))&&(e2.attributeNameCheck instanceof RegExp&&i6(e2.attributeNameCheck,E)||e2.attributeNameCheck instanceof Function&&e2.attributeNameCheck(E))||"is"===E&&e2.allowCustomizedBuiltInElements&&(e2.tagNameCheck instanceof RegExp&&i6(e2.tagNameCheck,B)||e2.tagNameCheck instanceof Function&&e2.tagNameCheck(B))))return!1}else if(tz[E]);else if(i6(eZ,i3(B,eK,"")));else if("src"!==E&&"xlink:href"!==E&&"href"!==E||"script"===T||0!==i5(B,"data:")||!tN[T]){if(e4&&!i6(eq,i3(B,eK,"")));else if(B)return!1}return!0},ze=function(T){return T.indexOf("-")>0},Le=function(T){let E,B,M,D;Re("beforeSanitizeAttributes",T,null);let{attributes:er}=T;if(!er)return;let ea={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:e0};for(D=er.length;D--;){E=er[D];let{name:es,namespaceURI:eu}=E;B="value"===es?E.value:i9(E.value);let eg=B;if(M=tZ(es),ea.attrName=M,ea.attrValue=B,ea.keepAttr=!0,ea.forceKeepAttr=void 0,Re("uponSanitizeAttribute",T,ea),B=ea.attrValue,ea.forceKeepAttr)continue;if(!ea.keepAttr||!e8&&i6(/\/>/i,B)){De(es,T);continue}e7&&(B=i3(B,eG," "),B=i3(B,e$," "),B=i3(B,ej," "));let ep=tZ(T.nodeName);if(Ve(ep,M,B)){if(tE&&("id"===M||"name"===M)&&(De(es,T),B="user-content-"+B),eL&&"object"==typeof ex&&"function"==typeof ex.getAttributeType){if(eu);else switch(ex.getAttributeType(ep,M)){case"TrustedHTML":B=eL.createHTML(B);break;case"TrustedScriptURL":B=eL.createScriptURL(B)}}if(B!==eg)try{eu?T.setAttributeNS(eu,es,B):T.setAttribute(es,B)}catch(E){De(es,T)}}else De(es,T)}Re("afterSanitizeAttributes",T,null)},He=function e(T){let E;let B=Ie(T);for(Re("beforeSanitizeShadowDOM",T,null);E=B.nextNode();)Re("uponSanitizeShadowNode",E,null),Ne(E)||(E.content instanceof er&&e(E.content),Le(E));Re("afterSanitizeShadowDOM",T,null)};return o.sanitize=function(T){let E,M,D,ea,eu=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((tY=!T)&&(T="<!-->"),"string"!=typeof T&&!Fe(T)){if("function"!=typeof T.toString)throw i4("toString is not a function");if("string"!=typeof(T=T.toString()))throw i4("dirty is not a string, aborting")}if(!o.isSupported)return T;if(tl||Ce(eu),o.removed=[],"string"==typeof T&&(tD=!1),tD){if(T.nodeName){let E=tZ(T.nodeName);if(!eJ[E]||e3[E])throw i4("root node is forbidden and cannot be sanitized in-place")}}else if(T instanceof es)1===(M=(E=Be("<!---->")).ownerDocument.importNode(T,!0)).nodeType&&"BODY"===M.nodeName||"HTML"===M.nodeName?E=M:E.appendChild(M);else{if(!tg&&!e7&&!tr&&-1===T.indexOf("<"))return eL&&tx?eL.createHTML(T):T;if(!(E=Be(T)))return tg?null:tx?eV:""}E&&tu&&Me(E.firstChild);let eg=Ie(tD?T:E);for(;D=eg.nextNode();)Ne(D)||(D.content instanceof er&&He(D.content),Le(D));if(tD)return T;if(tg){if(tf)for(ea=eW.call(E.ownerDocument);E.firstChild;)ea.appendChild(E.firstChild);else ea=E;return(e0.shadowroot||e0.shadowrootmode)&&(ea=eP.call(B,ea,!0)),ea}let ep=tr?E.outerHTML:E.innerHTML;return tr&&eJ["!doctype"]&&E.ownerDocument&&E.ownerDocument.doctype&&E.ownerDocument.doctype.name&&i6(lz,E.ownerDocument.doctype.name)&&(ep="<!DOCTYPE "+E.ownerDocument.doctype.name+">\n"+ep),e7&&(ep=i3(ep,eG," "),ep=i3(ep,e$," "),ep=i3(ep,ej," ")),eL&&tx?eL.createHTML(ep):ep},o.setConfig=function(T){Ce(T),tl=!0},o.clearConfig=function(){tJ=null,tl=!1},o.isValidAttribute=function(T,E,B){tJ||Ce({});let M=tZ(T),D=tZ(E);return Ve(M,D,B)},o.addHook=function(T,E){"function"==typeof E&&(eU[T]=eU[T]||[],iQ(eU[T],E))},o.removeHook=function(T){if(eU[T])return iJ(eU[T])},o.removeHooks=function(T){eU[T]&&(eU[T]=[])},o.removeAllHooks=function(){eU={}},o}();let $f=T=>lU().sanitize(T);var lG=tinymce.util.Tools.resolve("tinymce.util.I18n");let l$={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},lj="temporary-placeholder",Kf=T=>()=>be(T,lj).getOr("!not found!"),Jf=(T,E)=>{let B=T.toLowerCase();if(lG.isRtl()){var M;let T=Ae(B,M="-rtl")?B:B+M;return ve(E,T)?T:B}return B},Zf=(T,E)=>be(E,Jf(T,E)),Qf=(T,E)=>{let B=E();return Zf(T,B).getOrThunk(Kf(B))},eb=()=>th("add-focusable",[oZ(T=>{bi(T.element,"svg").each(T=>Ct(T,"focusable","false"))})]),tb=(T,E,B,M)=>{var D,er;let ea=lG.isRtl()&&ve(l$,E)?["tox-icon--flip"]:[],es=be(B,Jf(E,B)).or(M).getOrThunk(Kf(B));return{dom:{tag:T.tag,attributes:null!==(D=T.attributes)&&void 0!==D?D:{},classes:T.classes.concat(ea),innerHtml:es},behaviours:Tl([...null!==(er=T.behaviours)&&void 0!==er?er:[],eb()])}},ob=(T,E,B,M=A.none())=>tb(E,T,B(),M),lY={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},lX=xm({name:"Notification",factory:T=>{let E=Xh({dom:Yh(`<p>${$f(T.translationProvider(T.text))}</p>`),behaviours:Tl([sQ.config({})])}),o=T=>({dom:{tag:"div",classes:["tox-bar"],styles:{width:`${T}%`}}}),n=T=>({dom:{tag:"div",classes:["tox-text"],innerHtml:`${T}%`}}),B=Xh({dom:{tag:"div",classes:T.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(0)]},n(0)],behaviours:Tl([sQ.config({})])}),M=q([T.icon.toArray(),T.level.toArray(),T.level.bind(T=>A.from(lY[T])).toArray()]),D=Xh(iW.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[ob("close",{tag:"span",classes:["tox-icon"],attributes:{"aria-label":T.translationProvider("Close")}},T.iconProvider)],action:E=>{T.onAction(E)}})),er=((T,E,B)=>{let M=B(),D=G(T,T=>ve(M,Jf(T,M)));return tb({tag:"div",classes:["tox-notification__icon"]},D.getOr(lj),M,A.none())})(M,0,T.iconProvider),ea=[er,{dom:{tag:"div",classes:["tox-notification__body"]},components:[E.asSpec()],behaviours:Tl([sQ.config({})])}];return{uid:T.uid,dom:{tag:"div",attributes:{role:"alert"},classes:T.level.map(T=>["tox-notification","tox-notification--in",`tox-notification--${T}`]).getOr(["tox-notification","tox-notification--in"])},behaviours:Tl([s3.config({}),th("notification-events",[Wr(t0(),T=>{D.getOpt(T).each(s3.focus)})])]),components:ea.concat(T.progress?[B.asSpec()]:[]).concat(T.closeButton?[D.asSpec()]:[]),apis:{updateProgress:(T,E)=>{T.getSystem().isConnected()&&B.getOpt(T).each(T=>{sQ.set(T,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(E)]},n(E)])})},updateText:(T,B)=>{if(T.getSystem().isConnected()){let M=E.get(T);sQ.set(M,[ri(B)])}}}}},configFields:[ms("level"),ns("progress"),ms("icon"),ns("onAction"),ns("text"),ns("iconProvider"),ns("translationProvider"),Os("closeButton",!0)],apis:{updateProgress:(T,E,B)=>{T.updateProgress(E,B)},updateText:(T,E,B)=>{T.updateText(E,B)}}});var lq,lK,lZ,lJ,lQ,l0,l1,l2,l3,l5,l9,l6=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),l4=tinymce.util.Tools.resolve("tinymce.EditorManager"),l8=tinymce.util.Tools.resolve("tinymce.Env");(hZ=l5||(l5={})).default="wrap",hZ.floating="floating",hZ.sliding="sliding",hZ.scrolling="scrolling",(hJ=l9||(l9={})).auto="auto",hJ.top="top",hJ.bottom="bottom";let db=T=>E=>E.options.get(T),ub=T=>E=>A.from(T(E)),mb=T=>{let B=l8.deviceType.isPhone(),D=l8.deviceType.isTablet()||B,ea=T.options.register,s=T=>E(T)||!1===T,a=T=>E(T)||eu(T);ea("skin",{processor:T=>E(T)||!1===T,default:"oxide"}),ea("skin_url",{processor:"string"}),ea("height",{processor:a,default:Math.max(T.getElement().offsetHeight,400)}),ea("width",{processor:a,default:l6.DOM.getStyle(T.getElement(),"width")}),ea("min_height",{processor:"number",default:100}),ea("min_width",{processor:"number"}),ea("max_height",{processor:"number"}),ea("max_width",{processor:"number"}),ea("style_formats",{processor:"object[]"}),ea("style_formats_merge",{processor:"boolean",default:!1}),ea("style_formats_autohide",{processor:"boolean",default:!1}),ea("line_height_formats",{processor:"string",default:"1 1.1 1.2 1.3 1.4 1.5 2"}),ea("font_family_formats",{processor:"string",default:"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"}),ea("font_size_formats",{processor:"string",default:"8pt 10pt 12pt 14pt 18pt 24pt 36pt"}),ea("font_size_input_default_unit",{processor:"string",default:"pt"}),ea("block_formats",{processor:"string",default:"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre"}),ea("content_langs",{processor:"object[]"}),ea("removed_menuitems",{processor:"string",default:""}),ea("menubar",{processor:T=>E(T)||er(T),default:!B}),ea("menu",{processor:"object",default:{}}),ea("toolbar",{processor:T=>er(T)||E(T)||M(T)?{value:T,valid:!0}:{valid:!1,message:"Must be a boolean, string or array."},default:!0}),V(9,T=>{ea("toolbar"+(T+1),{processor:"string"})}),ea("toolbar_mode",{processor:"string",default:D?"scrolling":"floating"}),ea("toolbar_groups",{processor:"object",default:{}}),ea("toolbar_location",{processor:"string",default:l9.auto}),ea("toolbar_persist",{processor:"boolean",default:!1}),ea("toolbar_sticky",{processor:"boolean",default:T.inline}),ea("toolbar_sticky_offset",{processor:"number",default:0}),ea("fixed_toolbar_container",{processor:"string",default:""}),ea("fixed_toolbar_container_target",{processor:"object"}),ea("ui_mode",{processor:"string",default:"combined"}),ea("file_picker_callback",{processor:"function"}),ea("file_picker_validator_handler",{processor:"function"}),ea("file_picker_types",{processor:"string"}),ea("typeahead_urls",{processor:"boolean",default:!0}),ea("anchor_top",{processor:s,default:"#top"}),ea("anchor_bottom",{processor:s,default:"#bottom"}),ea("draggable_modal",{processor:"boolean",default:!1}),ea("statusbar",{processor:"boolean",default:!0}),ea("elementpath",{processor:"boolean",default:!0}),ea("branding",{processor:"boolean",default:!0}),ea("promotion",{processor:"boolean",default:!0}),ea("resize",{processor:T=>"both"===T||er(T),default:!l8.deviceType.isTouch()}),ea("sidebar_show",{processor:"string"}),ea("help_accessibility",{processor:"boolean",default:T.hasPlugin("help")}),ea("default_font_stack",{processor:"string[]",default:[]})},l7=db("readonly"),co=db("height"),cr=db("width"),cc=ub(db("min_width")),cu=ub(db("min_height")),cf=ub(db("max_width")),cb=ub(db("max_height")),cx=ub(db("style_formats")),cy=db("style_formats_merge"),ck=db("style_formats_autohide"),c_=db("content_langs"),cD=db("removed_menuitems"),cI=db("toolbar_mode"),cR=db("toolbar_groups"),cL=db("toolbar_location"),cV=db("fixed_toolbar_container"),cH=db("fixed_toolbar_container_target"),cN=db("toolbar_persist"),cW=db("toolbar_sticky_offset"),cz=db("menubar"),cP=db("toolbar"),cU=db("file_picker_callback"),cG=db("file_picker_validator_handler"),c$=db("font_size_input_default_unit"),cj=db("file_picker_types"),cY=db("typeahead_urls"),cX=db("anchor_top"),cq=db("anchor_bottom"),cK=db("draggable_modal"),cZ=db("statusbar"),cJ=db("elementpath"),cQ=db("branding"),c0=db("resize"),c1=db("paste_as_text"),c2=db("sidebar_show"),c3=db("promotion"),c5=db("help_accessibility"),c9=db("default_font_stack"),Jb=T=>!1===T.options.get("skin"),Zb=T=>!1!==T.options.get("menubar"),Qb=T=>{let E=T.options.get("skin_url");if(Jb(T))return E;if(E)return T.documentBaseURI.toAbsolute(E);{let E=T.options.get("skin");return l4.baseURL+"/skins/ui/"+E}},ev=T=>A.from(T.options.get("skin_url")),tv=T=>T.options.get("line_height_formats").split(" "),ov=T=>{let B=cP(T),D=E(B),er=M(B)&&B.length>0;return!sv(T)&&(er||D||!0===B)},nv=T=>{let B=V(9,E=>T.options.get("toolbar"+(E+1))),M=U(B,E);return Ce(M.length>0,M)},sv=T=>nv(T).fold(()=>{let B=cP(T);return f(B,E)&&B.length>0},ep),rv=T=>cL(T)===l9.bottom,av=T=>{var E;if(!T.inline)return A.none();let B=null!==(E=cV(T))&&void 0!==E?E:"";if(B.length>0)return vi(wt(),B);let M=cH(T);return g(M)?A.some(Fe(M)):A.none()},iv=T=>T.inline&&av(T).isSome(),lv=T=>av(T).getOrThunk(()=>bt(eU(Fe(T.getElement())))),cv=T=>T.inline&&!Zb(T)&&!ov(T)&&!sv(T),dv=T=>(T.options.get("toolbar_sticky")||T.inline)&&!iv(T)&&!cv(T),uv=T=>!iv(T)&&"split"===T.options.get("ui_mode"),mv=T=>{let E=T.options.get("menu");return ce(E,T=>({...T,items:T.items}))};var c6=Object.freeze({__proto__:null,get ToolbarMode(){return l5},get ToolbarLocation(){return l9},register:mb,getSkinUrl:Qb,getSkinUrlOption:ev,isReadOnly:l7,isSkinDisabled:Jb,getHeightOption:co,getWidthOption:cr,getMinWidthOption:cc,getMinHeightOption:cu,getMaxWidthOption:cf,getMaxHeightOption:cb,getUserStyleFormats:cx,shouldMergeStyleFormats:cy,shouldAutoHideStyleFormats:ck,getLineHeightFormats:tv,getContentLanguages:c_,getRemovedMenuItems:cD,isMenubarEnabled:Zb,isMultipleToolbars:sv,isToolbarEnabled:ov,isToolbarPersist:cN,getMultipleToolbarsOption:nv,getUiContainer:lv,useFixedContainer:iv,isSplitUiMode:uv,getToolbarMode:cI,isDraggableModal:cK,isDistractionFree:cv,isStickyToolbar:dv,getStickyToolbarOffset:cW,getToolbarLocation:cL,isToolbarLocationBottom:rv,getToolbarGroups:cR,getMenus:mv,getMenubar:cz,getToolbar:cP,getFilePickerCallback:cU,getFilePickerTypes:cj,useTypeaheadUrls:cY,getAnchorTop:cX,getAnchorBottom:cq,getFilePickerValidatorHandler:cG,getFontSizeInputDefaultUnit:c$,useStatusBar:cZ,useElementPath:cJ,promotionEnabled:c3,useBranding:cQ,getResize:c0,getPasteAsText:c1,getSidebarShow:c2,useHelpAccessibility:c5,getDefaultFontStack:c9});let c4="[data-mce-autocompleter]",hv=T=>yi(T,c4);(hQ=h1||(h1={}))[hQ.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",hQ[hQ.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var c8=h1;let c7="tox-menu-nav__js",dr="tox-collection__item",da="tox-swatch",di={normal:c7,color:da},dp="tox-collection__item--enabled",dh="tox-collection__item-icon",df="tox-collection__item-label",dy="tox-collection__item-caret",dk="tox-collection__item--active",dO="tox-collection__item-container",d_="tox-collection__item-container--row",Av=T=>be(di,T).getOr(c7),Mv=T=>"color"===T?"tox-swatches":"tox-menu",Dv=T=>({backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:Mv(T),tieredMenu:"tox-tiered-menu"}),Bv=T=>{let E=Dv(T);return{backgroundMenu:E.backgroundMenu,selectedMenu:E.selectedMenu,menu:E.menu,selectedItem:E.selectedItem,item:Av(T)}},Iv=(T,E,B)=>{let M=Dv(B);return{tag:"div",classes:q([[M.menu,`tox-menu-${E}-column`],T?[M.hasIcons]:[]])}},dB=[ik.parts.items({})],Rv=(T,E,B)=>{let M=Dv(B);return{dom:{tag:"div",classes:q([[M.tieredMenu]])},markers:Bv(B)}},dI=x([ms("data"),xs("inputAttributes",{}),xs("inputStyles",{}),xs("tag","input"),xs("inputClasses",[]),Ri("onSetValue"),xs("styles",{}),xs("eventOrder",{}),yu("inputBehaviours",[r2,s3]),xs("selectOnFocus",!0)]),Vv=T=>Tl([s3.config({onFocus:T.selectOnFocus?T=>{let E=T.element,B=Ka(E);E.dom.setSelectionRange(0,B.length)}:b})]),zv=T=>({...Vv(T),...wu(T.inputBehaviours,[r2.config({store:{mode:"manual",...T.data.map(T=>({initialValue:T})).getOr({}),getValue:T=>Ka(T.element),setValue:(T,E)=>{Ka(T.element)!==E&&Ja(T.element,E)}},onSetValue:T.onSetValue})])}),Lv=T=>({tag:T.tag,attributes:{type:"text",...T.inputAttributes},styles:T.inputStyles,classes:T.inputClasses}),dR=xm({name:"Input",configFields:dI(),factory:(T,E)=>({uid:T.uid,dom:Lv(T),components:[],behaviours:zv(T),eventOrder:T.eventOrder})}),dL=ca("refetch-trigger-event"),dV=ca("redirect-menu-item-interaction"),dH="tox-menu__searcher",jv=T=>vi(T.element,`.${dH}`).bind(E=>T.getSystem().getByDom(E).toOptional()),$v=T=>({fetchPattern:r2.getValue(T),selectionStart:T.element.dom.selectionStart,selectionEnd:T.element.dom.selectionEnd}),qv=T=>{let t=(T,E)=>(E.cut(),A.none()),o=(T,E)=>{let B={interactionEvent:E.event,eventType:E.event.raw.type};return Rr(T,dV,B),A.some(!0)},E="searcher-events";return{dom:{tag:"div",classes:[dr]},components:[dR.sketch({inputClasses:[dH,"tox-textfield"],inputAttributes:{...T.placeholder.map(E=>({placeholder:T.i18n(E)})).getOr({}),type:"search","aria-autocomplete":"list"},inputBehaviours:Tl([th(E,[Wr(t5(),T=>{Fr(T,dL)}),Wr(t2(),(T,E)=>{"Escape"===E.event.raw.key&&E.stop()})]),sZ.config({mode:"special",onLeft:t,onRight:t,onSpace:t,onEnter:o,onEscape:o,onUp:o,onDown:o})]),eventOrder:{keydown:[E,sZ.name()]}})]}},dN="tox-collection--results__js",Xv=T=>{var E;return T.dom?{...T,dom:{...T.dom,attributes:{...null!==(E=T.dom.attributes)&&void 0!==E?E:{},id:ca("aria-item-search-result-id"),"aria-selected":"false"}}}:T},Kv=(T,E)=>B=>{let M=z(B,E);return L(M,E=>({dom:T,components:E}))},Jv=(T,E)=>{let B=[],M=[];return H(T,(T,D)=>{E(T,D)?(M.length>0&&B.push(M),M=[],(ve(T.dom,"innerHtml")||T.components&&T.components.length>0)&&M.push(T)):M.push(T)}),M.length>0&&B.push(M),L(B,T=>({dom:{tag:"div",classes:["tox-collection__group"]},components:T}))},Zv=(T,E,B)=>ik.parts.items({preprocess:M=>{let D=L(M,B);return"auto"!==T&&T>1?Kv({tag:"div",classes:["tox-collection__group"]},T)(D):Jv(D,(T,B)=>"separator"===E[B].type)}}),Qv=(T,E,B=!0)=>({dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===T?["tox-collection--list"]:["tox-collection--grid"])},components:[Zv(T,E,w)]}),ey=T=>N(T,T=>"icon"in T&&void 0!==T.icon),ty=T=>(console.error(Jn(T)),console.log(T),A.none()),oy=(T,E,B,M,D)=>{let er={dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[ik.parts.items({preprocess:T=>Jv(T,(T,E)=>"separator"===B[E].type)})]};return{value:T,dom:er.dom,components:er.components,items:B}},ny=(T,E,B,M,D)=>{if("color"===D.menuType){let E={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[ik.parts.items({preprocess:"auto"!==M?Kv({tag:"div",classes:["tox-swatches__row"]},M):w})]}]};return{value:T,dom:E.dom,components:E.components,items:B}}if("normal"===D.menuType&&"auto"===M){let E=Qv(M,B);return{value:T,dom:E.dom,components:E.components,items:B}}if("normal"===D.menuType||"searchable"===D.menuType){let E="searchable"!==D.menuType?Qv(M,B):"search-with-field"===D.searchMode.searchMode?((T,E,B)=>{let M=ca("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===T?["tox-collection--list"]:["tox-collection--grid"])},components:[qv({i18n:lG.translate,placeholder:B.placeholder}),{dom:{tag:"div",classes:[...1===T?["tox-collection--list"]:["tox-collection--grid"],dN],attributes:{id:M}},components:[Zv(T,E,Xv)]}]}})(M,B,D.searchMode):((T,E,B=!0)=>{let M=ca("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection",dN].concat(1===T?["tox-collection--list"]:["tox-collection--grid"]),attributes:{id:M}},components:[Zv(T,E,Xv)]}})(M,B);return{value:T,dom:E.dom,components:E.components,items:B}}if("listpreview"===D.menuType&&"auto"!==M){let E={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[ik.parts.items({preprocess:Kv({tag:"div",classes:["tox-collection__group"]},M)})]};return{value:T,dom:E.dom,components:E.components,items:B}}return{value:T,dom:Iv(E,M,D.menuType),components:dB,items:B}},dW=as("type"),dz=as("name"),dP=as("label"),dU=as("text"),dG=as("title"),d$=as("icon"),dj=as("value"),dY=ls("fetch"),dX=ls("getSubmenuItems"),dq=ls("onAction"),dK=ls("onItemAction"),dZ=_s("onSetup",()=>b),dJ=hs("name"),dQ=hs("text"),d0=hs("icon"),d1=hs("tooltip"),d2=hs("label"),d3=hs("shortcut"),d5=bs("select"),d9=Os("active",!1),d6=Os("borderless",!1),d4=Os("enabled",!0),d8=Os("primary",!1),Ty=T=>xs("columns",T),d7=xs("meta",{}),uo=_s("onAction",b),My=T=>ks("type",T),Dy=T=>pn("name","name",yn(()=>ca(`${T}-name`)),tW),un=Bn([dW,dQ]),ur=Bn([My("autocompleteitem"),d9,d4,d7,dj,dQ,d0]),ua=[d4,d1,d0,dQ,dZ],ui=Bn([dW,dq].concat(ua)),Ny=T=>Yn("toolbarbutton",ui,T),up=[d9].concat(ua),uh=Bn(up.concat([dW,dq])),Ly=T=>Yn("ToggleButton",uh,T),uf=[_s("predicate",eg),Cs("scope","node",["node","editor"]),Cs("position","selection",["node","selection","line"])],uy=ua.concat([My("contextformbutton"),d8,dq,ts("original",w)]),uS=up.concat([My("contextformbutton"),d8,dq,ts("original",w)]),uk=ua.concat([My("contextformbutton")]),uO=up.concat([My("contextformtogglebutton")]),u_=Zn("type",{contextformbutton:uy,contextformtogglebutton:uS}),uB=Bn([My("contextform"),_s("initValue",x("")),d2,us("commands",u_),gs("launch",Zn("type",{contextformbutton:uk,contextformtogglebutton:uO}))].concat(uf)),uM=Bn([My("contexttoolbar"),as("items")].concat(uf)),uR=[dW,as("src"),hs("alt"),Ts("classes",[],tW)],uL=Bn(uR),uH=[dW,dU,dJ,Ts("classes",["tox-collection__item-label"],tW)],uN=Bn(uH),uW=An(()=>Gn("type",{cardimage:uL,cardtext:uN,cardcontainer:uz})),uz=Bn([dW,ks("direction","horizontal"),ks("align","left"),ks("valign","middle"),us("items",uW)]),uP=[d4,dQ,d3,pn("value","value",yn(()=>ca("menuitem-value")),tH()),d7],uU=Bn([dW,d2,us("items",uW),dZ,uo].concat(uP)),uG=Bn([dW,d9,d0].concat(uP)),u$=[dW,as("fancytype"),uo],uj=[xs("initData",{})].concat(u$),uY=[bs("select"),Es("initData",{},[Os("allowCustomColors",!0),ks("storageKey","default"),vs("colors",tH())])].concat(u$),uX=Zn("fancytype",{inserttable:uj,colorswatch:uY}),uq=Bn([dW,dZ,uo,d0].concat(uP)),uK=Bn([dW,dX,dZ,d0].concat(uP)),uZ=Bn([dW,d0,d9,dZ,dq].concat(uP)),dx=(T,E,B)=>{let M=Zc(T.element,"."+B);if(M.length>0){let T=$(M,T=>{let B=T.dom.getBoundingClientRect().top,D=M[0].dom.getBoundingClientRect().top;return Math.abs(B-D)>E}).getOr(M.length);return A.some({numColumns:T,numRows:Math.ceil(M.length/T)})}return A.none()},ux=T=>Tl([th(ca("unnamed-events"),T)]),uJ=ca("tooltip.exclusive"),uQ=ca("tooltip.show"),u0=ca("tooltip.hide"),hx=(T,E,B)=>{T.getSystem().broadcastOn([uJ],{})};var u1=Object.freeze({__proto__:null,hideAllExclusive:hx,setComponents:(T,E,B,M)=>{B.getTooltip().each(T=>{T.getSystem().isConnected()&&sQ.set(T,M)})}}),u2=Object.freeze({__proto__:null,events:(T,E)=>{let o=B=>{E.getTooltip().each(M=>{Nd(M),T.onHide(B,M),E.clearTooltip()}),E.clearTimer()};return Hr(q([[Wr(uQ,B=>{E.resetTimer(()=>{(B=>{if(!E.isShowing()){hx(B);let M=T.lazySink(B).getOrDie(),D=B.getSystem().build({dom:T.tooltipDom,components:T.tooltipComponents,events:Hr("normal"===T.mode?[Wr(tQ(),T=>{Fr(B,uQ)}),Wr(tZ(),T=>{Fr(B,u0)})]:[]),behaviours:Tl([sQ.config({})])});E.setTooltip(D),Id(M,D),T.onShow(B,D),rN.position(M,D,{anchor:T.anchor(B)})}})(B)},T.delay)}),Wr(u0,B=>{E.resetTimer(()=>{o(B)},T.delay)}),Wr(of(),(T,E)=>{E.universal||R(E.channels,uJ)&&o(T)}),oJ(T=>{o(T)})],"normal"===T.mode?[Wr(t0(),T=>{Fr(T,uQ)}),Wr(ou(),T=>{Fr(T,u0)}),Wr(tQ(),T=>{Fr(T,uQ)}),Wr(tZ(),T=>{Fr(T,u0)})]:[Wr(oq(),(T,E)=>{Fr(T,uQ)}),Wr(oK(),T=>{Fr(T,u0)})]]))}}),u3=[ns("lazySink"),ns("tooltipDom"),xs("exclusive",!0),xs("tooltipComponents",[]),xs("delay",300),Cs("mode","normal",["normal","follow-highlight"]),xs("anchor",T=>({type:"hotspot",hotspot:T,layouts:{onLtr:x([gl,ml,ll,dl,cl,ul]),onRtl:x([gl,ml,ll,dl,cl,ul])}})),Ri("onHide"),Ri("onShow")],u5=Object.freeze({__proto__:null,init:()=>{let T=nc(),E=nc(),o=()=>{T.on(clearTimeout)},B=x("not-implemented");return Ta({getTooltip:E.get,isShowing:E.isSet,setTooltip:E.set,clearTooltip:E.clear,clearTimer:o,resetTimer:(E,B)=>{o(),T.set(setTimeout(E,B))},readState:B})}});let u9=Al({fields:u3,name:"tooltipping",active:u2,state:u5,apis:u1}),u6="silver.readonly",u4=Bn([ss("readonly",tz)]),kx=(T,E)=>{let B=T.mainUi.outerContainer.element,M=[T.mainUi.mothership,...T.uiMotherships];E&&H(M,T=>{T.broadcastOn([r$()],{target:B})}),H(M,T=>{T.broadcastOn([u6],{readonly:E})})},Cx=(T,E)=>{T.on("init",()=>{T.mode.isReadOnly()&&kx(E,!0)}),T.on("SwitchMode",()=>kx(E,T.mode.isReadOnly())),l7(T)&&T.mode.set("readonly")},Ox=()=>n0.config({channels:{[u6]:{schema:u4,onReceive:(T,E)=>{aj.set(T,E.readonly)}}}}),_x=T=>aj.config({disabled:T}),Tx=T=>aj.config({disabled:T,disableClass:"tox-tbtn--disabled"}),Ex=T=>aj.config({disabled:T,disableClass:"tox-tbtn--disabled",useNative:!1}),Ax=(T,E)=>{let B=T.getApi(E);return T=>{T(B)}},Mx=(T,E)=>oZ(B=>{Ax(T,B)(B=>{let M=T.onSetup(B);es(M)&&E.set(M)})}),Dx=(T,E)=>oJ(B=>Ax(T,B)(E.get())),Bx=(T,E)=>o0((B,M)=>{Ax(T,B)(T.onAction),T.triggersSubmenu||E!==c8.CLOSE_ON_EXECUTE||(B.getSystem().isConnected()&&Fr(B,oE()),M.stop())}),u8={[ox()]:["disabling","alloy.base.behaviour","toggling","item-events"]},Rx=(T,E,B,M)=>{let D=As(b);return{type:"item",dom:E.dom,components:we(E.optComponents),data:T.data,eventOrder:u8,hasSubmenu:T.triggersSubmenu,itemBehaviours:Tl([th("item-events",[Bx(T,B),Mx(T,D),Dx(T,D)]),aj.config({disabled:()=>!T.enabled||M.isDisabled(),disableClass:"tox-collection__item--state-disabled"}),Ox(),sQ.config({})].concat(T.itemBehaviours))}},Nx=T=>({value:T.value,meta:{text:T.text.getOr(""),...T.meta}}),Vx=T=>{let E=l8.os.isMacOS()||l8.os.isiOS(),B=E?{alt:"",ctrl:"",shift:"",meta:"",access:""}:{meta:"Ctrl",access:"Shift+Alt"},M=T.split("+"),D=L(M,T=>{let E=T.toLowerCase().trim();return ve(B,E)?B[E]:T});return E?D.join(""):D.join("+")},zx=(T,E,B=[dh])=>ob(T,{tag:"div",classes:B},E),Lx=T=>({dom:{tag:"div",classes:[df]},components:[ri(lG.translate(T))]}),Hx=(T,E)=>({dom:{tag:"div",classes:E,innerHtml:T}}),Px=(T,E)=>({dom:{tag:"div",classes:[df]},components:[{dom:{tag:T.tag,styles:T.styles},components:[ri(lG.translate(E))]}]}),Ux=T=>({dom:{tag:"div",classes:["tox-collection__item-accessory"]},components:[ri(Vx(T))]}),Wx=T=>zx("checkmark",T,["tox-collection__item-checkmark"]),jx=T=>{let E=T.map(T=>({attributes:{title:lG.translate(T),id:ca("menu-item")}})).getOr({});return{tag:"div",classes:[c7,dr],...E}},Gx=(T,E,B,M=A.none())=>"color"===T.presets?((T,E,B)=>{let M=T.ariaLabel,D=T.value,er=T.iconContent.map(T=>((T,E,B)=>{let M=E();return Zf(T,M).or(B).getOrThunk(Kf(M))})(T,E.icons,B));return{dom:(()=>{let T=er.getOr(""),B=M.map(T=>({title:E.translate(T)})).getOr({}),ea={tag:"div",attributes:B,classes:[da]};return"custom"===D?{...ea,tag:"button",classes:[...ea.classes,"tox-swatches__picker-btn"],innerHtml:T}:"remove"===D?{...ea,classes:[...ea.classes,"tox-swatch--remove"],innerHtml:T}:g(D)?{...ea,attributes:{...ea.attributes,"data-mce-color":D},styles:{"background-color":D},innerHtml:T}:ea})(),optComponents:[]}})(T,E,M):((T,E,B,M)=>{let D={tag:"div",classes:[dh]},er=B?T.iconContent.map(T=>ob(T,D,E.icons,M)).orThunk(()=>A.some({dom:D})):A.none(),ea=T.checkMark,es=A.from(T.meta).fold(()=>Lx,T=>ve(T,"style")?k(Px,T.style):Lx),eu=T.htmlContent.fold(()=>T.textContent.map(es),T=>A.some(Hx(T,[df])));return{dom:jx(T.ariaLabel),optComponents:[er,eu,T.shortcutContent.map(Ux),ea,T.caret]}})(T,E,B,M),$x=(T,E)=>be(T,"tooltipWorker").map(T=>[u9.config({lazySink:E.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:T=>({type:"submenu",item:T,overrides:{maxHeightFunction:ro}}),mode:"follow-highlight",onShow:(E,B)=>{T(T=>{u9.setComponents(E,[ai({element:Fe(T)})])})}})]).getOr([]),qx=(T,E)=>{var B;let M=(B=lG.translate(T),l6.DOM.encode(B));if(E.length>0){let T=RegExp(E.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return M.replace(T,T=>`<span class="tox-autocompleter-highlight">${T}</span>`)}return M},Yx=(T,E)=>L(T,T=>{switch(T.type){case"cardcontainer":return((T,E)=>{let B="vertical"===T.direction?"tox-collection__item-container--column":d_,M="left"===T.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right";return{dom:{tag:"div",classes:[dO,B,M,(()=>{switch(T.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}})()]},components:E}})(T,Yx(T.items,E));case"cardimage":var B;return B=T.src,{dom:{tag:"img",classes:T.classes,attributes:{src:B,alt:T.alt.getOr("")}}};case"cardtext":let M=T.name.exists(T=>R(E.cardText.highlightOn,T)),D=M?A.from(E.cardText.matchText).getOr(""):"";return Hx(qx(T.text,D),T.classes)}}),u7=Qu(id(),ib()),Kx=T=>({value:ew(T)}),mo=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,mn=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Qx=T=>mo.test(T)||mn.test(T),ew=T=>_e(T,"#").toUpperCase(),tw=T=>{let E=T.toString(16);return(1===E.length?"0"+E:E).toUpperCase()},ow=T=>{let E=tw(T.red)+tw(T.green)+tw(T.blue);return Kx(E)},mr=Math.min,ma=Math.max,mc=Math.round,mu=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,mf=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,lw=(T,E,B,M)=>({red:T,green:E,blue:B,alpha:M}),cw=T=>{let E=parseInt(T,10);return E.toString()===T&&E>=0&&E<=255},dw=T=>{let E,B,M;let D=(T.hue||0)%360,er=T.saturation/100,ea=T.value/100;if(er=ma(0,mr(er,1)),ea=ma(0,mr(ea,1)),0===er)return lw(E=B=M=mc(255*ea),B,M,1);let es=D/60,eu=ea*er,eg=eu*(1-Math.abs(es%2-1)),ep=ea-eu;switch(Math.floor(es)){case 0:E=eu,B=eg,M=0;break;case 1:E=eg,B=eu,M=0;break;case 2:E=0,B=eu,M=eg;break;case 3:E=0,B=eg,M=eu;break;case 4:E=eg,B=0,M=eu;break;case 5:E=eu,B=0,M=eg;break;default:E=B=M=0}return lw(E=mc(255*(E+ep)),B=mc(255*(B+ep)),M=mc(255*(M+ep)),1)},uw=T=>{let E=(T=>{let E=(T=>{let E=T.value.replace(mo,(T,E,B,M)=>E+E+B+B+M+M);return{value:E}})(T),B=mn.exec(E.value);return null===B?["FFFFFF","FF","FF","FF"]:B})(T),B=parseInt(E[1],16),M=parseInt(E[2],16),D=parseInt(E[3],16);return lw(B,M,D,1)},mw=(T,E,B,M)=>{let D=parseInt(T,10),er=parseInt(E,10),ea=parseInt(B,10),es=parseFloat(M);return lw(D,er,ea,es)},gw=T=>{if("transparent"===T)return A.some(lw(0,0,0,0));let E=mu.exec(T);if(null!==E)return A.some(mw(E[1],E[2],E[3],"1"));let B=mf.exec(T);return null!==B?A.some(mw(B[1],B[2],B[3],B[4])):A.none()},pw=T=>`rgba(${T.red},${T.green},${T.blue},${T.alpha})`,mx=lw(255,0,0,1),fw=(T,E)=>{T.dispatch("ResizeContent",E)},bw=(T,E)=>{T.dispatch("TextColorChange",E)},vw=(T,E)=>T.dispatch("ResolveName",{name:E.nodeName.toLowerCase(),target:E}),yw=(T,E)=>()=>{T(),E()},xw=T=>Sw(T,"NodeChange",E=>{E.setEnabled(T.selection.isEditable())}),ww=(T,E)=>B=>{let M=xw(T)(B),D=(B=>{let M=oc(),s=()=>{B.setActive(T.formatter.match(E));let D=T.formatter.formatChanged(E,B.setActive);M.set(D)};return T.initialized?s():T.once("init",s),()=>{T.off("init",s),M.clear()}})(B);return()=>{M(),D()}},Sw=(T,E,B)=>M=>{let s=()=>B(M),r=()=>{B(M),T.on(E,s)};return T.initialized?r():T.once("init",r),()=>{T.off("init",r),T.off(E,s)}},kw=T=>E=>()=>{T.undoManager.transact(()=>{T.focus(),T.execCommand("mceToggleFormat",!1,E.format)})},Cw=(T,E)=>()=>T.execCommand(E);var my=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");let mk={},Tw=T=>be(mk,T).getOrThunk(()=>{let B=`tinymce-custom-colors-${T}`,M=my.getItem(B);if(m(M)){let T=my.getItem("tinymce-custom-colors");my.setItem(B,g(T)?T:"[]")}let D=((T,B=10)=>{let M=my.getItem(T),D=E(M)?JSON.parse(M):[],er=B-D.length<0?D.slice(0,B):D,i=T=>{er.splice(T,1)};return{add:E=>{F(er,E).each(i),er.unshift(E),er.length>B&&er.pop(),my.setItem(T,JSON.stringify(er))},state:()=>er.slice(0)}})(B,10);return mk[T]=D,D}),Ew=(T,E)=>{Tw(T).add(E)},Aw=(T,E,B)=>({hue:T,saturation:E,value:B}),Mw=T=>{let E=0,B=T.red/255,M=T.green/255,D=T.blue/255,er=Math.min(B,Math.min(M,D)),ea=Math.max(B,Math.max(M,D));return er===ea?Aw(0,0,100*er):Aw(Math.round(60*((B===er?3:D===er?1:5)-(B===er?M-D:D===er?B-M:D-B)/(ea-er))),Math.round(100*((ea-er)/ea)),Math.round(100*ea))},Dw=T=>ow(dw(T)),Bw=T=>(Qx(T)?A.some({value:ew(T)}):A.none()).orThunk(()=>gw(T).map(ow)).getOrThunk(()=>{let E=document.createElement("canvas");E.height=1,E.width=1;let B=E.getContext("2d");B.clearRect(0,0,E.width,E.height),B.fillStyle="#FFFFFF",B.fillStyle=T,B.fillRect(0,0,1,1);let M=B.getImageData(0,0,1,1).data,D=M[0],er=M[1],ea=M[2],es=M[3];return ow(lw(D,er,ea,es))}),mO="forecolor",m_="hilitecolor",Rw=T=>{let E=[];for(let B=0;B<T.length;B+=2)E.push({text:T[B+1],value:"#"+Bw(T[B]).value,icon:"checkmark",type:"choiceitem"});return E},Nw=T=>E=>E.options.get(T),mM="#000000",zw=(T,E)=>E===mO&&T.options.isSet("color_map_foreground")?Nw("color_map_foreground")(T):E===m_&&T.options.isSet("color_map_background")?Nw("color_map_background")(T):Nw("color_map")(T),Lw=(T,E="default")=>Math.max(5,Math.ceil(Math.sqrt(zw(T,E).length))),Hw=(T,E)=>{let B=Nw("color_cols")(T),M=Lw(T,E);return B===Lw(T)?M:B},Pw=(T,E="default")=>Math.round(E===mO?Nw("color_cols_foreground")(T):E===m_?Nw("color_cols_background")(T):Nw("color_cols")(T)),mR=Nw("custom_colors"),mL=Nw("color_default_foreground"),mH=Nw("color_default_background"),Gw=(T,E)=>{let B=Fe(T.selection.getStart()),M="hilitecolor"===E?Rs(B,T=>{if(eV(T)){let E=Rt(T,"background-color");return Ce(gw(E).exists(T=>0!==T.alpha),E)}return A.none()}).getOr("rgba(0, 0, 0, 0)"):Rt(B,"color");return gw(M).map(T=>"#"+ow(T).value)},$w=T=>{let E="choiceitem",B={type:E,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return T?[B,{type:E,text:"Custom color",icon:"color-picker",value:"custom"}]:[B]},qw=(T,E,B,M)=>{"custom"===B?oS(T)(B=>{B.each(B=>{Ew(E,B),T.execCommand("mceApplyTextcolor",E,B),M(B)})},Gw(T,E).getOr(mM)):"remove"===B?(M(""),T.execCommand("mceRemoveTextcolor",E)):(M(B),T.execCommand("mceApplyTextcolor",E,B))},Yw=(T,E,B)=>T.concat(L(Tw(E).state(),T=>({type:"choiceitem",text:T,icon:"checkmark",value:T})).concat($w(B))),Xw=(T,E,B)=>M=>{M(Yw(T,E,B))},Kw=(T,E,B)=>{T.setIconFill("forecolor"===E?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",B)},Jw=(T,E)=>{T.setTooltip(E)},Zw=(T,E)=>B=>{let M=Gw(T,E);return xe(M,B.toUpperCase())},Qw=(T,E,B)=>{if(Be(B))return"forecolor"===E?"Text color":"Background color";let M="forecolor"===E?"Text color {0}":"Background color {0}",D=Yw(zw(T,E),E,!1),er=G(D,T=>T.value===B).getOr({text:""}).text;return T.translate([M,T.translate(er)])},eS=(T,E,B,M)=>{T.ui.registry.addSplitButton(E,{tooltip:Qw(T,B,M.get()),presets:"color",icon:"forecolor"===E?"text-color":"highlight-bg-color",select:Zw(T,B),columns:Pw(T,B),fetch:Xw(zw(T,B),B,mR(T)),onAction:E=>{qw(T,B,M.get(),b)},onItemAction:(D,er)=>{qw(T,B,er,B=>{M.set(B),bw(T,{name:E,color:B})})},onSetup:D=>{Kw(D,E,M.get());let r=M=>{M.name===E&&(Kw(D,M.name,M.color),Jw(D,Qw(T,B,M.color)))};return T.on("TextColorChange",r),yw(xw(T)(D),()=>{T.off("TextColorChange",r)})}})},tS=(T,E,B,M,D)=>{T.ui.registry.addNestedMenuItem(E,{text:M,icon:"forecolor"===E?"text-color":"highlight-bg-color",onSetup:M=>(Jw(M,Qw(T,B,D.get())),Kw(M,E,D.get()),xw(T)(M)),getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"colorswatch",select:Zw(T,B),initData:{storageKey:B},onAction:M=>{qw(T,B,M.value,B=>{D.set(B),bw(T,{name:E,color:B})})}}]})},oS=T=>(E,B)=>{let M=!1;T.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:B},onAction:(T,E)=>{"hex-valid"===E.name&&(M=E.value)},onSubmit:B=>{let D=B.getData().colorpicker;M?(E(A.from(D)),B.close()):T.windowManager.alert(T.translate(["Invalid hex color code: {0}",D]))},onClose:b,onCancel:()=>{E(A.none())}})},nS=(T,E,B,M,D,er,ea,es)=>{let eu=ey(E),eg=sS(E,B,M,"color"!==D?"normal":"color",er,ea,es);return ny(T,eu,eg,M,{menuType:D})},sS=(T,E,B,M,D,er,ea)=>we(L(T,es=>"choiceitem"===es.type?Yn("choicemenuitem",uG,es).fold(ty,es=>A.some(((T,E,B,M,D,er,ea,es=!0)=>{let eu=Gx({presets:B,textContent:E?T.text:A.none(),htmlContent:A.none(),ariaLabel:T.text,iconContent:T.icon,shortcutContent:E?T.shortcut:A.none(),checkMark:E?A.some(Wx(ea.icons)):A.none(),caret:A.none(),value:T.value},ea,es);return tM(Rx({data:Nx(T),enabled:T.enabled,getApi:T=>({setActive:E=>{s4.set(T,E)},isActive:()=>s4.isOn(T),isEnabled:()=>!aj.isDisabled(T),setEnabled:E=>aj.set(T,!E)}),onAction:E=>M(T.value),onSetup:T=>(T.setActive(D),b),triggersSubmenu:!1,itemBehaviours:[]},eu,er,ea),{toggling:{toggleClass:dp,toggleOnExecute:!1,selected:T.active,exclusive:!0}})})(es,1===B,M,E,er(es.value),D,ea,ey(T)))):A.none())),rS=(T,E)=>{let B=Bv(E);return 1===T?{mode:"menu",moveOnTab:!0}:"auto"===T?{mode:"grid",selector:"."+B.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===E?"tox-swatches__row":"tox-collection__group"),previousSelector:T=>"color"===E?vi(T.element,"[aria-checked=true]"):A.none()}},mN=ca("cell-over"),mW=ca("cell-execute"),lS=(T,E,B)=>{let n=B=>Rr(B,mW,{row:T,col:E}),s=(T,E)=>{E.stop(),n(T)};return ci({dom:{tag:"div",attributes:{role:"button","aria-label":B}},behaviours:Tl([th("insert-table-picker-cell",[Wr(tQ(),s3.focus),Wr(ox(),n),Wr(t6(),s),Wr(ok(),s)]),s4.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),s3.config({onFocus:B=>Rr(B,mN,{row:T,col:E})})])})},cS=T=>Y(T,T=>L(T,ka)),dS=(T,E)=>ri(`${E}x${T}`),mz={inserttable:(T,E)=>{let B=((T,E,B)=>{let M=[];for(let E=0;E<10;E++){let B=[];for(let M=0;M<10;M++){let D=T(E+1,M+1);B.push(lS(E,M,D))}M.push(B)}return M})((T,B)=>E.shared.providers.translate(["{0} columns, {1} rows",B,T])),M=dS(0,0),D=Xh({dom:{tag:"span",classes:["tox-insert-table-picker__label"]},components:[M],behaviours:Tl([sQ.config({})])});return{type:"widget",data:{value:ca("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[u7.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:cS(B).concat(D.asSpec()),behaviours:Tl([th("insert-table-picker",[oZ(T=>{sQ.set(D.get(T),[M])}),qr(mN,(T,E,M)=>{let{row:er,col:ea}=M.event;((T,E,B,M,D)=>{for(let M=0;M<10;M++)for(let D=0;D<10;D++)s4.set(T[M][D],M<=E&&D<=B)})(B,er,ea),sQ.set(D.get(T),[dS(er+1,ea+1)])}),qr(mW,(E,B,M)=>{let{row:D,col:er}=M.event;T.onAction({numRows:D+1,numColumns:er+1}),Fr(E,oE())})]),sZ.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:(T,E)=>{let B=((T,E)=>{let B=T.initData.allowCustomColors&&E.colorinput.hasCustomColors();return T.initData.colors.fold(()=>Yw(E.colorinput.getColors(T.initData.storageKey),T.initData.storageKey,B),T=>T.concat($w(B)))})(T,E),M=E.colorinput.getColorCols(T.initData.storageKey),D="color",er={...nS(ca("menu-value"),B,E=>{T.onAction({value:E})},M,D,c8.CLOSE_ON_EXECUTE,T.select.getOr(eg),E.shared.providers),markers:Bv(D),movement:rS(M,D)};return{type:"widget",data:{value:ca("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[u7.widget(ik.sketch(er))]}}},mS=T=>({type:"separator",dom:{tag:"div",classes:[dr,"tox-collection__group-heading"]},components:T.text.map(ri).toArray()});var mP=Object.freeze({__proto__:null,getCoupled:(T,E,B,M)=>B.getOrCreate(T,E,M),getExistingCoupled:(T,E,B,M)=>B.getExisting(T,E,M)}),mU=[ss("others",qn(tE.value,tH()))],mG=Object.freeze({__proto__:null,init:()=>{let T={},t=(E,B)=>{if(0===eO(E.others).length)throw Error("Cannot find any known coupled components");return be(T,B)},E=x({});return Ta({readState:E,getExisting:(T,E,B)=>t(E,B).orThunk(()=>(be(E.others,B).getOrDie("No information found for coupled component: "+B),A.none())),getOrCreate:(E,B,M)=>t(B,M).getOrThunk(()=>{let D=be(B.others,M).getOrDie("No information found for coupled component: "+M)(E),er=E.getSystem().build(D);return T[M]=er,er})})}});let m$=Al({fields:mU,name:"coupling",apis:mP,state:mG}),bS=T=>{let E=A.none(),B=[],n=T=>{s()?r(T):B.push(T)},s=()=>E.isSome(),r=T=>{E.each(E=>{setTimeout(()=>{T(E)},0)})};return T(T=>{s()||(E=A.some(T),H(B,r),B=[])}),{get:n,map:T=>bS(E=>{n(B=>{E(T(B))})}),isReady:s}},mj={nu:bS,pure:T=>bS(E=>{E(T)})},yS=T=>{setTimeout(()=>{throw T},0)},xS=T=>{let t=E=>{T().then(E,yS)};return{map:E=>xS(()=>T().then(E)),bind:E=>xS(()=>T().then(T=>E(T).toPromise())),anonBind:E=>xS(()=>T().then(()=>E.toPromise())),toLazy:()=>mj.nu(t),toCached:()=>{let E=null;return xS(()=>(null===E&&(E=T()),E))},toPromise:T,get:t}},wS=T=>xS(()=>new Promise(T)),SS=T=>xS(()=>Promise.resolve(T)),mY=x("sink"),mX=x(aE({name:mY(),overrides:x({dom:{tag:"div"},behaviours:Tl([rN.config({useFixed:ep})]),events:Hr([Yr(t2()),Yr(tq()),Yr(t6())])})})),OS=(T,E)=>{let B=T.getHotspot(E).getOr(E),M="hotspot",D=T.getAnchorOverrides();return T.layouts.fold(()=>({type:M,hotspot:B,overrides:D}),T=>({type:M,hotspot:B,overrides:D,layouts:T}))},_S=(T,E,B,M,D,er,ea)=>{let es=((T,E,B,M,D,er,ea)=>{let es=(0,T.fetch)(M).map(E),eu=AS(M,T);return es.map(T=>T.bind(T=>A.from(iL.sketch({...er.menu(),uid:fa(""),data:T,highlightOnOpen:ea,onOpenMenu:(T,E)=>{let M=eu().getOrDie();rN.position(M,E,{anchor:B}),rG.decloak(D)},onOpenSubmenu:(T,E,B)=>{let M=eu().getOrDie();rN.position(M,B,{anchor:{type:"submenu",item:E}}),rG.decloak(D)},onRepositionMenu:(T,E,M)=>{let D=eu().getOrDie();rN.position(D,E,{anchor:B}),H(M,T=>{rN.position(D,T.triggeredMenu,{anchor:{type:"submenu",item:T.triggeringItem}})})},onEscape:()=>(s3.focus(M),rG.close(D),A.some(!0))}))))})(T,E,OS(T,B),B,M,D,ea);return es.map(T=>(T.fold(()=>{rG.isOpen(M)&&rG.close(M)},T=>{rG.cloak(M),rG.open(M,T),er(M)}),M))},TS=(T,E,B,M,D,er,ea)=>(rG.close(M),SS(M)),ES=(T,E,B,M,D,er)=>{let ea=m$.getCoupled(B,"sandbox");return(rG.isOpen(ea)?TS:_S)(T,E,B,ea,M,D,er)},AS=(T,E)=>T.getSystem().getByUid(E.uid+"-"+mY()).map(T=>()=>tE.value(T)).getOrThunk(()=>E.lazySink.fold(()=>()=>tE.error(Error("No internal sink is specified, nor could an external sink be found")),E=>()=>E(T))),MS=T=>{rG.getState(T).each(T=>{iL.repositionMenus(T)})},DS=(T,E,B)=>{let M=wi(),D=AS(E,T);return{dom:{tag:"div",classes:T.sandboxClasses,attributes:{id:M.id,role:"listbox"}},behaviours:wu(T.sandboxBehaviours,[r2.config({store:{mode:"memory",initialValue:E}}),rG.config({onOpen:(D,er)=>{let ea=OS(T,E);M.link(E.element),T.matchWidth&&((T,E,B)=>{var M;let D=az.getCurrent(E).getOr(E),er=Zt(T.element);B?Bt(D.element,"min-width",er+"px"):(M=D.element,e$.set(M,er))})(ea.hotspot,er,T.useMinWidth),T.onOpen(ea,D,er),void 0!==B&&void 0!==B.onOpen&&B.onOpen(D,er)},onClose:(T,D)=>{M.unlink(E.element),void 0!==B&&void 0!==B.onClose&&B.onClose(T,D)},isPartOf:(T,B,M)=>Si(B,M)||Si(E,M),getAttachPoint:()=>D().getOrDie()}),az.config({find:T=>rG.getState(T).bind(T=>az.getCurrent(T))}),n0.config({channels:{...nu({isExtraPart:eg}),...ru({doReposition:MS})}})])}},BS=T=>{let E=m$.getCoupled(T,"sandbox");MS(E)},IS=()=>[xs("sandboxClasses",[]),yu("sandboxBehaviours",[az,n0,rG,r2])],mq=x([ns("dom"),ns("fetch"),Ri("onOpen"),Ni("onExecute"),xs("getHotspot",A.some),xs("getAnchorOverrides",x({})),Oc(),yu("dropdownBehaviours",[s4,m$,sZ,s3]),ns("toggleClass"),xs("eventOrder",{}),ms("lazySink"),xs("matchWidth",!1),xs("useMinWidth",!1),ms("role")].concat(IS())),mK=x([a_({schema:[Bi(),xs("fakeFocus",!1)],name:"menu",defaults:T=>({onExecute:T.onExecute})}),mX()]),mZ=wm({name:"Dropdown",configFields:mq(),partFields:mK(),factory:(T,E,B,M)=>{let s=T=>{rG.getState(T).each(T=>{iL.highlightPrimary(T)})},r=(E,B,D)=>ES(T,w,E,M,B,D),D={expand:T=>{s4.isOn(T)||r(T,b,l2.HighlightNone).get(b)},open:T=>{s4.isOn(T)||r(T,b,l2.HighlightMenuAndItem).get(b)},refetch:E=>m$.getExistingCoupled(E,"sandbox").fold(()=>r(E,b,l2.HighlightMenuAndItem).map(b),B=>_S(T,w,E,B,M,b,l2.HighlightMenuAndItem).map(b)),isOpen:s4.isOn,close:T=>{s4.isOn(T)&&r(T,b,l2.HighlightMenuAndItem).get(b)},repositionMenus:T=>{s4.isOn(T)&&BS(T)}},i=(T,E)=>(Nr(T),A.some(!0));return{uid:T.uid,dom:T.dom,components:E,behaviours:wu(T.dropdownBehaviours,[s4.config({toggleClass:T.toggleClass,aria:{mode:"expanded"}}),m$.config({others:{sandbox:E=>DS(T,E,{onOpen:()=>s4.on(E),onClose:()=>s4.off(E)})}}),sZ.config({mode:"special",onSpace:i,onEnter:i,onDown:(T,E)=>{if(mZ.isOpen(T)){let E=m$.getCoupled(T,"sandbox");s(E)}else mZ.open(T);return A.some(!0)},onEscape:(T,E)=>mZ.isOpen(T)?(mZ.close(T),A.some(!0)):A.none()}),s3.config({})]),events:fh(A.some(T=>{r(T,s,l2.HighlightMenuAndItem).get(b)})),eventOrder:{...T.eventOrder,[ox()]:["disabling","toggling","alloy.base.behaviour"]},apis:D,domModification:{attributes:{"aria-haspopup":"true",...T.role.fold(()=>({}),T=>({role:T})),..."button"===T.dom.tag?{type:be(T.dom,"attributes").bind(T=>be(T,"type")).getOr("button")}:{}}}}},apis:{open:(T,E)=>T.open(E),refetch:(T,E)=>T.refetch(E),expand:(T,E)=>T.expand(E),close:(T,E)=>T.close(E),isOpen:(T,E)=>T.isOpen(E),repositionMenus:(T,E)=>T.repositionMenus(E)}}),VS=(T,E,B)=>{jv(T).each(T=>{((T,E)=>{Tt(E.element,"id").each(E=>Ct(T.element,"aria-activedescendant",E))})(T,B),($a(E.element,dN)?A.some(E.element):vi(E.element,"."+dN)).each(E=>{Tt(E,"id").each(E=>Ct(T.element,"aria-controls",E))})}),Ct(B.element,"aria-selected","true")},zS=(T,E,B)=>{Ct(B.element,"aria-selected","false")},LS=T=>m$.getExistingCoupled(T,"sandbox").bind(jv).map($v).map(T=>T.fetchPattern).getOr("");(h0=h2||(h2={}))[h0.ContentFocus=0]="ContentFocus",h0[h0.UiFocus=1]="UiFocus";let PS=(T,E,B,M,D)=>{let er=B.shared.providers,a=T=>D?{...T,shortcut:A.none(),icon:T.text.isSome()?A.none():T.icon}:T;switch(T.type){case"menuitem":return Yn("menuitem",uq,T).fold(ty,T=>A.some(((T,E,B,M=!0)=>{let D=Gx({presets:"normal",iconContent:T.icon,textContent:T.text,htmlContent:A.none(),ariaLabel:T.text,caret:A.none(),checkMark:A.none(),shortcutContent:T.shortcut},B,M);return Rx({data:Nx(T),getApi:T=>({isEnabled:()=>!aj.isDisabled(T),setEnabled:E=>aj.set(T,!E)}),enabled:T.enabled,onAction:T.onAction,onSetup:T.onSetup,triggersSubmenu:!1,itemBehaviours:[]},D,E,B)})(a(T),E,er,M)));case"nestedmenuitem":return Yn("nestedmenuitem",uK,T).fold(ty,T=>A.some(((T,E,B,M=!0,D=!1)=>{let er=D?zx("chevron-down",B.icons,[dy]):zx("chevron-right",B.icons,[dy]),ea=Gx({presets:"normal",iconContent:T.icon,textContent:T.text,htmlContent:A.none(),ariaLabel:T.text,caret:A.some(er),checkMark:A.none(),shortcutContent:T.shortcut},B,M);return Rx({data:Nx(T),getApi:T=>({isEnabled:()=>!aj.isDisabled(T),setEnabled:E=>aj.set(T,!E),setIconFill:(E,B)=>{vi(T.element,`svg path[class="${E}"], rect[class="${E}"]`).each(T=>{Ct(T,"fill",B)})},setTooltip:E=>{let M=B.translate(E);Ot(T.element,{"aria-label":M,title:M})}}),enabled:T.enabled,onAction:b,onSetup:T.onSetup,triggersSubmenu:!0,itemBehaviours:[]},ea,E,B)})(a(T),E,er,M,D)));case"togglemenuitem":return Yn("togglemenuitem",uZ,T).fold(ty,T=>A.some(((T,E,B,M=!0)=>{let D=Gx({iconContent:T.icon,textContent:T.text,htmlContent:A.none(),ariaLabel:T.text,checkMark:A.some(Wx(B.icons)),caret:A.none(),shortcutContent:T.shortcut,presets:"normal",meta:T.meta},B,M);return tM(Rx({data:Nx(T),enabled:T.enabled,getApi:T=>({setActive:E=>{s4.set(T,E)},isActive:()=>s4.isOn(T),isEnabled:()=>!aj.isDisabled(T),setEnabled:E=>aj.set(T,!E)}),onAction:T.onAction,onSetup:T.onSetup,triggersSubmenu:!1,itemBehaviours:[]},D,E,B),{toggling:{toggleClass:dp,toggleOnExecute:!1,selected:T.active}})})(a(T),E,er,M)));case"separator":return Yn("separatormenuitem",un,T).fold(ty,T=>A.some(mS(T)));case"fancymenuitem":return Yn("fancymenuitem",uX,T).fold(ty,T=>be(mz,T.fancytype).map(E=>E(T,B)));default:return console.error("Unknown item in general menu",T),A.none()}},US=(T,E,B,M,D,er,ea)=>{let es=1===M,eu=!es||ey(T);return we(L(T,T=>{switch(T.type){case"separator":return Yn("Autocompleter.Separator",un,T).fold(ty,T=>A.some(mS(T)));case"cardmenuitem":return Yn("cardmenuitem",uU,T).fold(ty,T=>A.some(((T,E,B,M)=>{let D={dom:jx(T.label),optComponents:[A.some({dom:{tag:"div",classes:[dO,d_]},components:Yx(T.items,M)})]};return Rx({data:Nx({text:A.none(),...T}),enabled:T.enabled,getApi:T=>({isEnabled:()=>!aj.isDisabled(T),setEnabled:E=>{aj.set(T,!E),H(Zc(T.element,"*"),B=>{T.getSystem().getByDom(B).each(T=>{T.hasConfigured(aj)&&aj.set(T,!E)})})}}),onAction:T.onAction,onSetup:T.onSetup,triggersSubmenu:!1,itemBehaviours:A.from(M.itemBehaviours).getOr([])},D,E,B.providers)})({...T,onAction:E=>{T.onAction(E),B(T.value,T.meta)}},D,er,{itemBehaviours:$x(T.meta,er),cardText:{matchText:E,highlightOn:ea}})));default:return Yn("Autocompleter.Item",ur,T).fold(ty,T=>A.some(((T,E,B,M,D,er,ea,es=!0)=>{let eu=Gx({presets:M,textContent:A.none(),htmlContent:B?T.text.map(T=>qx(T,E)):A.none(),ariaLabel:T.text,iconContent:T.icon,shortcutContent:A.none(),checkMark:A.none(),caret:A.none(),value:T.value},ea.providers,es,T.icon);return Rx({data:Nx(T),enabled:T.enabled,getApi:x({}),onAction:E=>D(T.value,T.meta),onSetup:x(b),triggersSubmenu:!1,itemBehaviours:$x(T.meta,ea)},eu,er,ea.providers)})(T,E,es,"normal",B,D,er,eu)))}}))},WS=(T,E,B,M,D,er)=>{let ea=ey(E),es=we(L(E,T=>{var E;return E="nestedmenuitem"===T.type&&T.getSubmenuItems().length<=0?{...T,enabled:!1}:T,PS(E,B,M,D?!ve(E,"text"):ea,D)})),eu="no-search"===er.searchMode?{menuType:"normal"}:{menuType:"searchable",searchMode:er};return(D?oy:ny)(T,ea,es,1,eu)},jS=T=>iL.singleData(T.value,T),GS=(T,E)=>{let B=ca("autocompleter"),M=As(!1),D=As(!1),er=ci(iH.sketch({dom:{tag:"div",classes:["tox-autocompleter"],attributes:{id:B}},components:[],fireDismissalEventInstead:{},inlineBehaviours:Tl([th("dismissAutocompleter",[Wr(oP(),()=>d()),Wr(oq(),(E,B)=>{Tt(B.event.target,"id").each(E=>Ct(Fe(T.getBody()),"aria-activedescendant",E))})])]),lazySink:E.getSink})),a=()=>iH.isOpen(er),ea=D.get,l=()=>{if(a()){iH.hide(er),T.dom.remove(B,!1);let E=Fe(T.getBody());Tt(E,"aria-owns").filter(T=>T===B).each(()=>{At(E,"aria-owns"),At(E,"aria-activedescendant")})}},c=()=>iH.getContent(er).bind(T=>te(T.components(),0)),d=()=>T.execCommand("mceAutocompleterClose"),u=D=>{let ea=(B=>{let D=re(B,T=>A.from(T.columns)).getOr(1);return Y(B,B=>{let er=B.items;return US(er,B.matchText,(E,D)=>{var er;let ea=T.selection.getRng();(er=T.dom,hv(Fe(ea.startContainer)).map(T=>{let E=er.createRng();return E.selectNode(T.dom),E})).each(er=>{M.set(!0),B.onAction({hide:()=>d(),reload:E=>{l(),T.execCommand("mceAutocompleterReload",!1,{fetchOptions:E})}},er,E,D),M.set(!1)})},D,c8.BUBBLE_TO_SANDBOX,E,B.highlightOn)})})(D);ea.length>0?(vi(Fe(T.getBody()),c4).each(E=>{let B=re(D,T=>A.from(T.columns)).getOr(1);iH.showMenuAt(er,{anchor:{type:"node",root:Fe(T.getBody()),node:A.from(E)}},((T,E,B,M)=>{let D=rS(E,M),er=Bv(M);return{data:jS({...T,movement:D,menuBehaviours:ux("auto"!==E?[]:[oZ((T,E)=>{dx(T,4,er.item).each(({numColumns:E,numRows:B})=>{sZ.setGridSize(T,B,E)})})])}),menu:{markers:Bv(M),fakeFocus:B===h2.ContentFocus}}})(ny("autocompleter-value",!0,ea,B,{menuType:"normal"}),B,h2.ContentFocus,"normal"))}),c().each(aq.highlightFirst),Ct(Fe(T.getBody()),"aria-owns",B),T.inline||m()):l()},m=()=>{T.dom.get(B)&&T.dom.remove(B,!1);let E=T.getDoc().documentElement,M=T.selection.getNode(),D=na(er.element,!0);It(D,{border:"0",clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0",position:"absolute",width:"1px",top:`${M.offsetTop}px`,left:`${M.offsetLeft}px`}),T.dom.add(E,D.dom),vi(D,'[role="menu"]').each(T=>{Ht(T,"position"),Ht(T,"max-height")})};T.on("AutocompleterStart",({lookupData:T})=>{D.set(!0),M.set(!1),u(T)}),T.on("AutocompleterUpdate",({lookupData:T})=>u(T)),T.on("AutocompleterEnd",()=>{l(),D.set(!1),M.set(!1)}),((T,E)=>{let o=(T,E)=>{Rr(T,t2(),{raw:E})},n=()=>T.getMenu().bind(aq.getHighlighted);E.on("keydown",E=>{let B=E.which;T.isActive()&&(T.isMenuOpen()?13===B?(n().each(Nr),E.preventDefault()):40===B?(n().fold(()=>{T.getMenu().each(aq.highlightFirst)},T=>{o(T,E)}),E.preventDefault(),E.stopImmediatePropagation()):37!==B&&38!==B&&39!==B||n().each(T=>{o(T,E),E.preventDefault(),E.stopImmediatePropagation()}):13!==B&&38!==B&&40!==B||T.cancelIfNecessary())}),E.on("NodeChange",E=>{T.isActive()&&!T.isProcessingAction()&&hv(Fe(E.element)).isNone()&&T.cancelIfNecessary()})})({cancelIfNecessary:d,isMenuOpen:a,isActive:ea,isProcessingAction:M.get,getMenu:c},T)},mJ=["visible","hidden","clip"],qS=T=>eD(T).length>0&&!R(mJ,T),YS=T=>{if(Ge(T)){let E=Rt(T,"overflow-x"),B=Rt(T,"overflow-y");return qS(E)||qS(B)}return!1},XS=(T,E)=>uv(T)?(T=>{let E=Jc(T,YS),B=0===E.length?vt(T).map(yt).map(T=>Jc(T,YS)).getOr([]):E;return oe(B).map(T=>({element:T,others:B.slice(1)}))})(E):A.none(),KS=T=>{let E=[...L(T.others,Zo),tn()];return j(E,(T,E)=>en(T,E),Zo(T.element))},JS=(T,E,B)=>yi(T,E,B).isSome(),ZS=(T,E)=>{let B=null;return{cancel:()=>{null!==B&&(clearTimeout(B),B=null)},schedule:(...M)=>{B=setTimeout(()=>{T.apply(null,M),B=null},E)}}},QS=T=>{let E=T.raw;return void 0===E.touches||1!==E.touches.length?A.none():A.some(E.touches[0])},ek=(T,E)=>{let B={stopBackspace:!0,...E},M=(T=>{let E=nc(),B=As(!1),M=ZS(E=>{T.triggerEvent(oO(),E),B.set(!0)},400),D=Bs([{key:t$(),value:T=>(QS(T).each(D=>{M.cancel();let er={x:D.clientX,y:D.clientY,target:T.target};M.schedule(T),B.set(!1),E.set(er)}),A.none())},{key:tj(),value:T=>(M.cancel(),QS(T).each(T=>{E.on(B=>{((T,E)=>{let B=Math.abs(T.clientX-E.x),M=Math.abs(T.clientY-E.y);return B>5||M>5})(T,B)&&E.clear()})}),A.none())},{key:tY(),value:D=>(M.cancel(),E.get().filter(T=>Qe(T.target,D.target)).map(E=>B.get()?(D.prevent(),!1):T.triggerEvent(ok(),D)))}]);return{fireIfReady:(T,E)=>be(D,E).bind(E=>E(T))}})(B),D=L(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),E=>rc(T,E,T=>{M.fireIfReady(T,E).each(E=>{E&&T.kill()}),B.triggerEvent(E,T)&&T.kill()})),er=nc(),ea=rc(T,"paste",T=>{M.fireIfReady(T,"paste").each(E=>{E&&T.kill()}),B.triggerEvent("paste",T)&&T.kill(),er.set(setTimeout(()=>{B.triggerEvent(og(),T)},0))}),es=rc(T,"keydown",T=>{B.triggerEvent("keydown",T)?T.kill():!B.stopBackspace||8!==T.raw.which||R(["input","textarea"],We(T.target))||JS(T.target,'[contenteditable="true"]')||T.prevent()}),eu=rc(T,"focusin",T=>{B.triggerEvent("focusin",T)&&T.kill()}),eg=nc(),ep=rc(T,"focusout",T=>{B.triggerEvent("focusout",T)&&T.kill(),eg.set(setTimeout(()=>{B.triggerEvent(ou(),T)},0))});return{unbind:()=>{H(D,T=>{T.unbind()}),es.unbind(),eu.unbind(),ep.unbind(),ea.unbind(),er.on(clearTimeout),eg.on(clearTimeout)}}},tk=(T,E)=>{let B=be(T,"target").getOr(E);return As(B)},mQ=Ms([{stopped:[]},{resume:["element"]},{complete:[]}]),nk=(T,E,B,M,D,er)=>{let ea=T(E,M),es=((T,E)=>{let B=As(!1),M=As(!1);return{stop:()=>{B.set(!0)},cut:()=>{M.set(!0)},isStopped:B.get,isCut:M.get,event:T,setSource:E.set,getSource:E.get}})(B,D);return ea.fold(()=>(er.logEventNoHandlers(E,M),mQ.complete()),T=>{let B=T.descHandler;return Ma(B)(es),es.isStopped()?(er.logEventStopped(E,T.element,B.purpose),mQ.stopped()):es.isCut()?(er.logEventCut(E,T.element,B.purpose),mQ.complete()):rt(T.element).fold(()=>(er.logNoParent(E,T.element,B.purpose),mQ.complete()),M=>(er.logEventResponse(E,T.element,B.purpose),mQ.resume(M)))})},sk=(T,E,B,M,D,er)=>nk(T,E,B,M,D,er).fold(ep,M=>sk(T,E,B,M,D,er),eg),rk=(T,E,B,M,D)=>{let er=tk(B,M);return sk(T,E,B,M,er,D)},ak=()=>{let T=(()=>{let T={};return{registerId:(E,B,M)=>{le(M,(M,D)=>{let er=void 0!==T[D]?T[D]:{};er[B]={cHandler:k.apply(void 0,[M.handler].concat(E)),purpose:M.purpose},T[D]=er})},unregisterId:E=>{le(T,(T,B)=>{ve(T,E)&&delete T[E]})},filterByType:E=>be(T,E).map(T=>pe(T,(T,E)=>({id:E,descHandler:T}))).getOr([]),find:(E,B,M)=>be(T,B).bind(T=>Rs(M,E=>ha(E).bind(E=>be(T,E)).map(T=>({element:E,descHandler:T})),E))}})(),E={},o=B=>{ha(B.element).each(B=>{delete E[B],T.unregisterId(B)})};return{find:(E,B,M)=>T.find(E,B,M),filter:E=>T.filterByType(E),register:B=>{let M=(T=>{let E=T.element;return ha(E).getOrThunk(()=>((T,E)=>{let B=ca(no+"uid-");return pa(E,B),B})(0,T.element))})(B);ye(E,M)&&((T,B)=>{let M=E[B];if(M!==T)throw Error('The tagId "'+B+'" is already used by: '+sa(M.element)+"\nCannot use it for: "+sa(T.element)+"\nThe conflicting element is"+(xt(M.element)?" ":" not ")+"already in the DOM");o(T)})(B,M);let D=[B];T.registerId(D,M,B.events),E[M]=B},unregister:o,getById:T=>be(E,T)}},m0=xm({name:"Container",factory:T=>{let{attributes:E,...B}=T.dom;return{uid:T.uid,dom:{tag:"div",attributes:{role:"presentation",...E},...B},components:T.components,behaviours:xu(T.containerBehaviours),events:T.events,domModification:T.domModification,eventOrder:T.eventOrder}},configFields:[xs("components",[]),yu("containerBehaviours",[]),xs("events",{}),xs("domModification",{}),xs("eventOrder",{})]}),lk=T=>{let t=E=>rt(T.element).fold(ep,T=>Qe(E,T)),E=ak(),n=(T,B)=>E.find(t,T,B),B=ek(T.element,{triggerEvent:(T,E)=>_i(T,E.target,B=>rk(n,T,E,E.target,B))}),M={debugInfo:x("real"),triggerEvent:(T,E,B)=>{_i(T,E,M=>rk(n,T,B,E,M))},triggerFocus:(T,E)=>{ha(T).fold(()=>{Rl(T)},B=>{_i(od(),T,B=>(((T,E,B,M,D)=>{let er=tk(B,M);nk(T,E,B,M,er,D)})(n,od(),{originator:E,kill:b,prevent:b,target:T},T,B),!1))})},triggerEscape:(T,E)=>{M.triggerEvent("keydown",T.element,E.event)},getByUid:T=>p(T),getByDom:T=>h(T),build:ci,buildOrPatch:li,addToGui:T=>{l(T)},removeFromGui:T=>{c(T)},addToWorld:T=>{a(T)},removeFromWorld:T=>{i(T)},broadcast:T=>{u(T)},broadcastOn:(T,E)=>{m(T,E)},broadcastEvent:(T,E)=>{g(T,E)},isConnected:ep},a=T=>{T.connect(M),eH(T.element)||(E.register(T),H(T.components(),a),M.triggerEvent(oR(),T.element,{target:T.element}))},i=T=>{eH(T.element)||(H(T.components(),i),E.unregister(T)),T.disconnect()},l=E=>{Id(T,E)},c=T=>{Nd(T)},d=T=>{let B=E.filter(of());H(B,E=>{let B=E.descHandler;Ma(B)(T)})},u=T=>{d({universal:!0,data:T})},m=(T,E)=>{d({universal:!1,channels:T,data:E})},g=(T,B)=>((T,E,B)=>{let M=(T=>{let E=As(!1);return{stop:()=>{E.set(!0)},cut:b,isStopped:E.get,isCut:eg,event:T,setSource:O("Cannot set source of a broadcasted event"),getSource:O("Cannot get source of a broadcasted event")}})(E);return H(T,T=>{let E=T.descHandler;Ma(E)(M)}),M.isStopped()})(E.filter(T),B),p=T=>E.getById(T).fold(()=>tE.error(Error('Could not find component with uid: "'+T+'" in system.')),tE.value),h=T=>{let E=ha(T).getOr("not found");return p(E)};return a(T),{root:T,element:T.element,destroy:()=>{B.unbind(),Uo(T.element)},add:l,remove:c,getByUid:p,getByDom:h,addToWorld:a,removeFromWorld:i,broadcast:u,broadcastOn:m,broadcastEvent:g}},m1=x([xs("prefix","form-field"),yu("fieldBehaviours",[az,r2])]),m2=x([aE({schema:[ns("dom")],name:"label"}),aE({factory:{sketch:T=>({uid:T.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:T.text}})},schema:[ns("text")],name:"aria-descriptor"}),aT({factory:{sketch:T=>{let E=((T,E)=>{let B={};return le(T,(T,M)=>{R(E,M)||(B[M]=T)}),B})(T,["factory"]);return T.factory.sketch(E)}},schema:[ns("factory")],name:"field"})]),m3=wm({name:"FormField",configFields:m1(),partFields:m2(),factory:(T,E,B,M)=>{let D=wu(T.fieldBehaviours,[az.config({find:E=>am(E,T,"field")}),r2.config({store:{mode:"manual",getValue:T=>az.getCurrent(T).bind(r2.getValue),setValue:(T,E)=>{az.getCurrent(T).each(T=>{r2.setValue(T,E)})}}})]),er=Hr([oZ((E,B)=>{let M=lm(E,T,["label","field","aria-descriptor"]);M.field().each(E=>{let B=ca(T.prefix);M.label().each(T=>{Ct(T.element,"for",B),Ct(E.element,"id",B)}),M["aria-descriptor"]().each(B=>{let M=ca(T.prefix);Ct(B.element,"id",M),Ct(E.element,"aria-describedby",M)})})})]);return{uid:T.uid,dom:T.dom,components:E,behaviours:D,events:er,apis:{getField:E=>am(E,T,"field"),getLabel:E=>am(E,T,"label")}}},apis:{getField:(T,E)=>T.getField(E),getLabel:(T,E)=>T.getLabel(E)}});var m5=Object.freeze({__proto__:null,exhibit:(T,E)=>Aa({attributes:Bs([{key:E.tabAttr,value:"true"}])})}),m9=[xs("tabAttr","data-alloy-tabstop")];let m6=Al({fields:m9,name:"tabstopping",active:m5});var m4=tinymce.util.Tools.resolve("tinymce.html.Entities");let fk=(T,E,B,M)=>{let D=bk(T,E,B,M);return m3.sketch(D)},bk=(T,E,B,M)=>({dom:vk(B),components:T.toArray().concat([E]),fieldBehaviours:Tl(M)}),vk=T=>({tag:"div",classes:["tox-form__group"].concat(T)}),yk=(T,E)=>m3.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[ri(E.translate(T))]}),m8=ca("form-component-change"),m7=ca("form-close"),go=ca("form-cancel"),gn=ca("form-action"),gr=ca("form-submit"),ga=ca("form-block"),gc=ca("form-unblock"),gg=ca("form-tabchange"),gh=ca("form-resize"),Ak=(T,E,B)=>{var M;let D=T.label.map(T=>yk(T,E)),er=E.icons(),r=T=>(E,B)=>{yi(B.event.target,"[data-collection-item-value]").each(M=>{T(E,B,M,_t(M,"data-collection-item-value"))})},ea=r((B,M,D,er)=>{M.stop(),E.isDisabled()||Rr(B,gn,{name:T.name,value:er})}),es=[Wr(tQ(),r((T,E,B)=>{Rl(B)})),Wr(t6(),ea),Wr(ok(),ea),Wr(t0(),r((T,E,B)=>{vi(T.element,"."+dk).each(T=>{Ga(T,dk)}),Wa(B,dk)})),Wr(t1(),r(T=>{vi(T.element,"."+dk).each(T=>{Ga(T,dk)})})),o0(r((E,B,M,D)=>{Rr(E,gn,{name:T.name,value:D})}))],l=(T,E)=>L(Zc(T.element,".tox-collection__item"),E),eu=m3.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==T.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:w},behaviours:Tl([aj.config({disabled:E.isDisabled,onDisabled:T=>{l(T,T=>{Wa(T,"tox-collection__item--state-disabled"),Ct(T,"aria-disabled",!0)})},onEnabled:T=>{l(T,T=>{Ga(T,"tox-collection__item--state-disabled"),At(T,"aria-disabled")})}}),Ox(),sQ.config({}),r2.config({store:{mode:"memory",initialValue:B.getOr([])},onSetValue:(B,M)=>{((B,M)=>{let D=L(M,B=>{var M,D;let ea=lG.translate(B.text),es=1===T.columns?`<div class="tox-collection__item-label">${ea}</div>`:"",eu=`<div class="tox-collection__item-icon">${null!==(D=er[M=B.icon])&&void 0!==D?D:M}</div>`,eg={_:" "," - ":" ","-":" "},ep=ea.replace(/\_| \- |\-/g,T=>eg[T]);return`<div class="tox-collection__item${E.isDisabled()?" tox-collection__item--state-disabled":""}" tabindex="-1" data-collection-item-value="${m4.encodeAllRaw(B.value)}" title="${ep}" aria-label="${ep}">${eu}${es}</div>`}),ea="auto"!==T.columns&&T.columns>1?z(D,T.columns):[D],es=L(ea,T=>`<div class="tox-collection__group">${T.join("")}</div>`);oa(B.element,es.join(""))})(B,M),"auto"===T.columns&&dx(B,5,"tox-collection__item").each(({numRows:T,numColumns:E})=>{sZ.setGridSize(B,T,E)}),Fr(B,gh)}}),m6.config({}),sZ.config(1===(M=T.columns)?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===M?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:`.${dr}`}}),th("collection-events",es)]),eventOrder:{[ox()]:["disabling","alloy.base.behaviour","collection-events"]}});return fk(D,eu,["tox-form__group--collection"],[])},gf=["input","textarea"],Dk=T=>{let E=We(T);return R(gf,E)},Bk=(T,E)=>{let B=E.getRoot(T).getOr(T.element);Ga(B,E.invalidClass),E.notify.each(E=>{Dk(T.element)&&Ct(T.element,"aria-invalid",!1),E.getContainer(T).each(T=>{oa(T,E.validHtml)}),E.onValid(T)})},Ik=(T,E,B,M)=>{let D=E.getRoot(T).getOr(T.element);Wa(D,E.invalidClass),E.notify.each(E=>{Dk(T.element)&&Ct(T.element,"aria-invalid",!0),E.getContainer(T).each(T=>{oa(T,M)}),E.onInvalid(T,M)})},Fk=(T,E,B)=>E.validator.fold(()=>SS(tE.value(!0)),E=>E.validate(T)),Rk=(T,E,B)=>(E.notify.each(E=>{E.onValidate(T)}),Fk(T,E).map(B=>T.getSystem().isConnected()?B.fold(B=>(Ik(T,E,0,B),tE.error(B)),B=>(Bk(T,E),tE.value(B))):tE.error("No longer in system")));var gb=Object.freeze({__proto__:null,markValid:Bk,markInvalid:Ik,query:Fk,run:Rk,isInvalid:(T,E)=>{let B=E.getRoot(T).getOr(T.element);return $a(B,E.invalidClass)}}),gv=Object.freeze({__proto__:null,events:(T,E)=>T.validator.map(E=>Hr([Wr(E.onEvent,E=>{Rk(E,T).get(w)})].concat(E.validateOnLoad?[oZ(E=>{Rk(E,T).get(b)})]:[]))).getOr({})}),gx=[ns("invalidClass"),xs("getRoot",A.none),ys("notify",[xs("aria","alert"),xs("getContainer",A.none),xs("validHtml",""),Ri("onValid"),Ri("onInvalid"),Ri("onValidate")]),ys("validator",[ns("validate"),xs("onEvent","input"),xs("validateOnLoad",!0)])];let gy=Al({fields:gx,name:"invalidating",active:gv,apis:gb,extra:{validation:T=>E=>{let B=r2.getValue(E);return SS(T(B))}}}),gS=Al({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:()=>Hr([Pr(on(),ep)]),exhibit:()=>Aa({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})})}),gT=ca("color-input-change"),gk=ca("color-swatch-change"),gO=ca("color-picker-cancel"),g_=aE({schema:[ns("dom")],name:"label"}),Gk=T=>aE({name:T+"-edge",overrides:E=>E.model.manager.edgeActions[T].fold(()=>({}),T=>({events:Hr([jr(t$(),(E,B,M)=>T(E,M),[E]),jr(tq(),(E,B,M)=>T(E,M),[E]),jr(tK(),(E,B,M)=>{M.mouseIsDown.get()&&T(E,M)},[E])])}))}),gB=Gk("top-left"),gM=Gk("top"),gR=Gk("top-right"),gL=Gk("right"),gV=Gk("bottom-right"),gH=Gk("bottom"),gN=Gk("bottom-left"),gW=Gk("left"),gz=aT({name:"thumb",defaults:x({dom:{styles:{position:"absolute"}}}),overrides:T=>({events:Hr([$r(t$(),T,"spectrum"),$r(tj(),T,"spectrum"),$r(tY(),T,"spectrum"),$r(tq(),T,"spectrum"),$r(tK(),T,"spectrum"),$r(tJ(),T,"spectrum")])})}),tC=T=>ug(T.event);var gP=[g_,gW,gL,gM,gH,gB,gR,gN,gV,gz,aT({schema:[ts("mouseIsDown",()=>As(!1))],name:"spectrum",overrides:T=>{let E=T.model.manager,o=(B,M)=>E.getValueFromEvent(M).map(M=>E.setValueFrom(B,T,M));return{behaviours:Tl([sZ.config({mode:"special",onLeft:(B,M)=>E.onLeft(B,T,tC(M)),onRight:(B,M)=>E.onRight(B,T,tC(M)),onUp:(B,M)=>E.onUp(B,T,tC(M)),onDown:(B,M)=>E.onDown(B,T,tC(M))}),m6.config({}),s3.config({})]),events:Hr([Wr(t$(),o),Wr(tj(),o),Wr(tq(),o),Wr(tK(),(E,B)=>{T.mouseIsDown.get()&&o(E,B)})])}}})];let gU=x("slider.change.value"),sC=T=>{let E=T.event.raw;return -1!==E.type.indexOf("touch")?void 0!==E.touches&&1===E.touches.length?A.some(E.touches[0]).map(T=>$t(T.clientX,T.clientY)):A.none():void 0!==E.clientX?A.some(E).map(T=>$t(T.clientX,T.clientY)):A.none()},rC=T=>T.model.minX,aC=T=>T.model.minY,iC=T=>T.model.minX-1,lC=T=>T.model.minY-1,cC=T=>T.model.maxX,dC=T=>T.model.maxY,uC=T=>T.model.maxX+1,mC=T=>T.model.maxY+1,gC=(T,E,B)=>E(T)-B(T),pC=T=>gC(T,cC,rC),hC=T=>gC(T,dC,aC),fC=T=>pC(T)/2,bC=T=>hC(T)/2,vC=(T,E)=>E?T.stepSize*T.speedMultiplier:T.stepSize,yC=T=>T.snapToGrid,xC=T=>T.snapStart,wC=T=>T.rounded,SC=(T,E)=>void 0!==T[E+"-edge"],kC=T=>SC(T,"left"),CC=T=>SC(T,"right"),OC=T=>SC(T,"top"),_C=T=>SC(T,"bottom"),TC=T=>T.model.value.get(),EC=(T,E)=>({x:T,y:E}),AC=(T,E)=>{Rr(T,gU(),{value:E})},MC=(T,E,B,M)=>T<E?T:T>B?B:T===E?E-1:Math.max(E,T-M),DC=(T,E,B,M)=>T>B?T:T<E?E:T===B?B+1:Math.min(B,T+M),BC=(T,E,B)=>Math.max(E,Math.min(B,T)),IC=T=>{let{min:E,max:B,range:M,value:D,step:er,snap:ea,snapStart:es,rounded:eu,hasMinEdge:eg,hasMaxEdge:ep,minBound:eh,maxBound:ef,screenRange:ex}=T,eC=eg?E-1:E,eO=ep?B+1:B;if(D<eh)return eC;if(D>ef)return eO;{let T=BC((Math.min(ef,Math.max(D,eh))-eh)/ex*M+E,eC,eO);return ea&&T>=E&&T<=B?es.fold(()=>BC(E+Math.round((T-E)/er)*er,E-1,B+1),E=>Math.max(E,E+Math.min(Math.floor((B-E)/er),Math.floor((T-E)/er)+Math.round((T-E)%er/er))*er)):eu?Math.round(T):T}},FC=T=>{let{min:E,max:B,range:M,value:D,hasMinEdge:er,hasMaxEdge:ea,maxBound:es,maxOffset:eu,centerMinEdge:eg,centerMaxEdge:ep}=T;return D<E?er?0:eg:D>B?ea?es:ep:(D-E)/M*eu},gG="right",g$="bottom",gj="left",LC=T=>T.element.dom.getBoundingClientRect(),HC=(T,E)=>T[E],PC=T=>{let E=LC(T);return HC(E,gj)},UC=T=>{let E=LC(T);return HC(E,gG)},WC=T=>{let E=LC(T);return HC(E,"top")},jC=T=>{let E=LC(T);return HC(E,g$)},GC=T=>{let E=LC(T);return HC(E,"width")},$C=T=>{let E=LC(T);return HC(E,"height")},qC=(T,E,B)=>(T+E)/2-B,YC=(T,E)=>{let B=LC(T),M=LC(E),D=HC(B,gj),er=HC(B,gG),ea=HC(M,gj);return qC(D,er,ea)},XC=(T,E)=>{let B=LC(T),M=LC(E),D=HC(B,"top"),er=HC(B,g$),ea=HC(M,"top");return qC(D,er,ea)},KC=(T,E)=>{Rr(T,gU(),{value:E})},JC=(T,E,B)=>{let M={min:rC(E),max:cC(E),range:pC(E),value:B,step:vC(E),snap:yC(E),snapStart:xC(E),rounded:wC(E),hasMinEdge:kC(E),hasMaxEdge:CC(E),minBound:PC(T),maxBound:UC(T),screenRange:GC(T)};return IC(M)},ZC=T=>(E,B,M)=>((T,E,B,M)=>{let D=(T>0?DC:MC)(TC(B),rC(B),cC(B),vC(B,M));return KC(E,D),A.some(D)})(T,E,B,M).map(ep),QC=(T,E,B,M,D,er)=>{let ea=((T,E,B,M,D)=>{let er=GC(T),ea=M.bind(E=>A.some(YC(E,T))).getOr(0),es=D.bind(E=>A.some(YC(E,T))).getOr(er),eu={min:rC(E),max:cC(E),range:pC(E),value:B,hasMinEdge:kC(E),hasMaxEdge:CC(E),minBound:PC(T),minOffset:0,maxBound:UC(T),maxOffset:er,centerMinEdge:ea,centerMaxEdge:es};return FC(eu)})(E,er,B,M,D);return PC(E)-PC(T)+ea},gY=ZC(-1),gX=ZC(1),gq=A.none,gK=A.none,gZ={"top-left":A.none(),top:A.none(),"top-right":A.none(),right:A.some((T,E)=>{AC(T,uC(E))}),"bottom-right":A.none(),bottom:A.none(),"bottom-left":A.none(),left:A.some((T,E)=>{AC(T,iC(E))})};var gJ=Object.freeze({__proto__:null,setValueFrom:(T,E,B)=>{let M=JC(T,E,B);return KC(T,M),M},setToMin:(T,E)=>{let B=rC(E);KC(T,B)},setToMax:(T,E)=>{let B=cC(E);KC(T,B)},findValueOfOffset:JC,getValueFromEvent:T=>sC(T).map(T=>T.left),findPositionOfValue:QC,setPositionFromValue:(T,E,B,M)=>{let D=TC(B),er=QC(T,M.getSpectrum(T),D,M.getLeftEdge(T),M.getRightEdge(T),B),ea=Zt(E.element)/2;Bt(E.element,"left",er-ea+"px")},onLeft:gY,onRight:gX,onUp:gq,onDown:gK,edgeActions:gZ});let aO=(T,E)=>{Rr(T,gU(),{value:E})},iO=(T,E,B)=>{let M={min:aC(E),max:dC(E),range:hC(E),value:B,step:vC(E),snap:yC(E),snapStart:xC(E),rounded:wC(E),hasMinEdge:OC(E),hasMaxEdge:_C(E),minBound:WC(T),maxBound:jC(T),screenRange:$C(T)};return IC(M)},lO=T=>(E,B,M)=>((T,E,B,M)=>{let D=(T>0?DC:MC)(TC(B),aC(B),dC(B),vC(B,M));return aO(E,D),A.some(D)})(T,E,B,M).map(ep),cO=(T,E,B,M,D,er)=>{let ea=((T,E,B,M,D)=>{let er=$C(T),ea=M.bind(E=>A.some(XC(E,T))).getOr(0),es=D.bind(E=>A.some(XC(E,T))).getOr(er),eu={min:aC(E),max:dC(E),range:hC(E),value:B,hasMinEdge:OC(E),hasMaxEdge:_C(E),minBound:WC(T),minOffset:0,maxBound:jC(T),maxOffset:er,centerMinEdge:ea,centerMaxEdge:es};return FC(eu)})(E,er,B,M,D);return WC(E)-WC(T)+ea},gQ=A.none,g0=A.none,g1=lO(-1),g2=lO(1),g3={"top-left":A.none(),top:A.some((T,E)=>{AC(T,lC(E))}),"top-right":A.none(),right:A.none(),"bottom-right":A.none(),bottom:A.some((T,E)=>{AC(T,mC(E))}),"bottom-left":A.none(),left:A.none()};var g5=Object.freeze({__proto__:null,setValueFrom:(T,E,B)=>{let M=iO(T,E,B);return aO(T,M),M},setToMin:(T,E)=>{let B=aC(E);aO(T,B)},setToMax:(T,E)=>{let B=dC(E);aO(T,B)},findValueOfOffset:iO,getValueFromEvent:T=>sC(T).map(T=>T.top),findPositionOfValue:cO,setPositionFromValue:(T,E,B,M)=>{let D=TC(B),er=cO(T,M.getSpectrum(T),D,M.getTopEdge(T),M.getBottomEdge(T),B),ea=jt(E.element)/2;Bt(E.element,"top",er-ea+"px")},onLeft:gQ,onRight:g0,onUp:g1,onDown:g2,edgeActions:g3});let fO=(T,E)=>{Rr(T,gU(),{value:E})},bO=(T,E)=>({x:T,y:E}),vO=(T,E)=>(B,M,D)=>((T,E,B,M,D)=>{let er=T>0?DC:MC,ea=E?TC(M).x:er(TC(M).x,rC(M),cC(M),vC(M,D)),es=E?er(TC(M).y,aC(M),dC(M),vC(M,D)):TC(M).y;return fO(B,bO(ea,es)),A.some(ea)})(T,E,B,M,D).map(ep),g9=vO(-1,!1),g6=vO(1,!1),g4=vO(-1,!0),g8=vO(1,!0),g7={"top-left":A.some((T,E)=>{AC(T,EC(iC(E),lC(E)))}),top:A.some((T,E)=>{AC(T,EC(fC(E),lC(E)))}),"top-right":A.some((T,E)=>{AC(T,EC(uC(E),lC(E)))}),right:A.some((T,E)=>{AC(T,EC(uC(E),bC(E)))}),"bottom-right":A.some((T,E)=>{AC(T,EC(uC(E),mC(E)))}),bottom:A.some((T,E)=>{AC(T,EC(fC(E),mC(E)))}),"bottom-left":A.some((T,E)=>{AC(T,EC(iC(E),mC(E)))}),left:A.some((T,E)=>{AC(T,EC(iC(E),bC(E)))})};var pt=Object.freeze({__proto__:null,setValueFrom:(T,E,B)=>{let M=JC(T,E,B.left),D=iO(T,E,B.top),er=bO(M,D);return fO(T,er),er},setToMin:(T,E)=>{let B=rC(E),M=aC(E);fO(T,bO(B,M))},setToMax:(T,E)=>{let B=cC(E),M=dC(E);fO(T,bO(B,M))},getValueFromEvent:T=>sC(T),setPositionFromValue:(T,E,B,M)=>{let D=TC(B),er=QC(T,M.getSpectrum(T),D.x,M.getLeftEdge(T),M.getRightEdge(T),B),ea=cO(T,M.getSpectrum(T),D.y,M.getTopEdge(T),M.getBottomEdge(T),B),es=Zt(E.element)/2,eu=jt(E.element)/2;Bt(E.element,"left",er-es+"px"),Bt(E.element,"top",ea-eu+"px")},onLeft:g9,onRight:g6,onUp:g4,onDown:g8,edgeActions:g7});let po=wm({name:"Slider",configFields:[xs("stepSize",1),xs("speedMultiplier",10),xs("onChange",b),xs("onChoose",b),xs("onInit",b),xs("onDragStart",b),xs("onDragEnd",b),xs("snapToGrid",!1),xs("rounded",!0),ms("snapStart"),ss("model",Zn("mode",{x:[xs("minX",0),xs("maxX",100),ts("value",T=>As(T.mode.minX)),ns("getInitialValue"),Li("manager",gJ)],y:[xs("minY",0),xs("maxY",100),ts("value",T=>As(T.mode.minY)),ns("getInitialValue"),Li("manager",g5)],xy:[xs("minX",0),xs("maxX",100),xs("minY",0),xs("maxY",100),ts("value",T=>As({x:T.mode.minX,y:T.mode.minY})),ns("getInitialValue"),Li("manager",pt)]})),yu("sliderBehaviours",[sZ,r2]),ts("mouseIsDown",()=>As(!1))],partFields:gP,factory:(T,E,B,M)=>{let s=E=>im(E,T,"thumb"),r=E=>im(E,T,"spectrum"),a=E=>am(E,T,"left-edge"),i=E=>am(E,T,"right-edge"),l=E=>am(E,T,"top-edge"),c=E=>am(E,T,"bottom-edge"),D=T.model,er=D.manager,m=(E,B)=>{er.setPositionFromValue(E,B,T,{getLeftEdge:a,getRightEdge:i,getTopEdge:l,getBottomEdge:c,getSpectrum:r})},g=(T,E)=>{D.value.set(E);let B=s(T);m(T,B)},p=E=>{let B=T.mouseIsDown.get();T.mouseIsDown.set(!1),B&&am(E,T,"thumb").each(B=>{let M=D.value.get();T.onChoose(E,B,M)})},h=(E,B)=>{B.stop(),T.mouseIsDown.set(!0),T.onDragStart(E,s(E))},f=(E,B)=>{B.stop(),T.onDragEnd(E,s(E)),p(E)},b=E=>{am(E,T,"spectrum").map(sZ.focusIn)};return{uid:T.uid,dom:T.dom,components:E,behaviours:wu(T.sliderBehaviours,[sZ.config({mode:"special",focusIn:b}),r2.config({store:{mode:"manual",getValue:T=>D.value.get(),setValue:g}}),n0.config({channels:{[rY()]:{onReceive:p}}})]),events:Hr([Wr(gU(),(E,B)=>{((E,B)=>{g(E,B);let M=s(E);T.onChange(E,M,B),A.some(!0)})(E,B.event.value)}),oZ((E,B)=>{let M=D.getInitialValue();D.value.set(M);let er=s(E);m(E,er);let ea=r(E);T.onInit(E,er,ea,D.value.get())}),Wr(t$(),h),Wr(tY(),f),Wr(tq(),(T,E)=>{b(T),h(T,E)}),Wr(tJ(),f)]),apis:{resetToMin:E=>{er.setToMin(E,T)},resetToMax:E=>{er.setToMax(E,T)},setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{setValue:(T,E,B)=>{T.setValue(E,B)},resetToMin:(T,E)=>{T.resetToMin(E)},resetToMax:(T,E)=>{T.resetToMax(E)},refresh:(T,E)=>{T.refresh(E)}}}),pr=ca("rgb-hex-update"),pu=ca("slider-update"),pm=ca("palette-update"),ph="form",pf=[yu("formBehaviours",[r2])],DO=T=>"<alloy.field."+T+">",BO=(T,E)=>({uid:T.uid,dom:T.dom,components:E,behaviours:wu(T.formBehaviours,[r2.config({store:{mode:"manual",getValue:E=>{let B=cm(E,T);return ce(B,(T,E)=>T().bind(T=>{var B,M;return B=az.getCurrent(T),M=Error(`Cannot find a current component to extract the value from for form part '${E}': `+sa(T.element)),B.fold(()=>tE.error(M),tE.value)}).map(r2.getValue))},setValue:(E,B)=>{le(B,(B,M)=>{am(E,T,M).each(T=>{az.getCurrent(T).each(T=>{r2.setValue(T,B)})})})}}})]),apis:{getField:(E,B)=>am(E,T,B).bind(az.getCurrent)}}),pb={getField:Oa((T,E,B)=>T.getField(E,B)),sketch:T=>{let E=(()=>{let T=[];return{field:(E,B)=>(T.push(E),tm(ph,DO(E),B)),record:x(T)}})(),B=T(E),M=E.record(),D=L(M,T=>aT({name:T,pname:DO(T)}));return fm(ph,pf,D,BO,B)}},pv=ca("valid-input"),px=ca("invalid-input"),py=ca("validating-input"),pS="colorcustom.rgb.",zO=(T,E,B,M)=>{let s=(B,M)=>gy.config({invalidClass:E("invalid"),notify:{onValidate:T=>{Rr(T,py,{type:B})},onValid:T=>{Rr(T,pv,{type:B,value:r2.getValue(T)})},onInvalid:T=>{Rr(T,px,{type:B,value:r2.getValue(T)})}},validator:{validate:E=>{let B=r2.getValue(E),D=M(B)?tE.value(!0):tE.error(T("aria.input.invalid"));return SS(D)},validateOnLoad:!1}}),r=(B,M,D,er,ea)=>{let es=T(pS+"range"),eu=m3.parts.label({dom:{tag:"label",attributes:{"aria-label":er}},components:[ri(D)]}),eg=m3.parts.field({data:ea,factory:dR,inputAttributes:{type:"text",..."hex"===M?{"aria-live":"polite"}:{}},inputClasses:[E("textfield")],inputBehaviours:Tl([s(M,B),m6.config({})]),onSetValue:T=>{gy.isInvalid(T)&&gy.run(T).get(b)}}),ep="hex"!==M?[m3.parts["aria-descriptor"]({text:es})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:[eu,eg].concat(ep)}},a=(T,E)=>{let B=E.red,M=E.green,D=E.blue;r2.setValue(T,{red:B,green:M,blue:D})},D=Xh({dom:{tag:"div",classes:[E("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),l=(T,E)=>{D.getOpt(T).each(T=>{Bt(T.element,"background-color","#"+E.value)})},er=xm({factory:()=>{let er={red:As(A.some(255)),green:As(A.some(255)),blue:As(A.some(255)),hex:As(A.some("ffffff"))},c=T=>er[T].get(),d=(T,E)=>{er[T].set(E)},u=T=>{let E=T.red,B=T.green,M=T.blue;d("red",A.some(E)),d("green",A.some(B)),d("blue",A.some(M))},m=(T,E)=>{let B=E.event;"hex"!==B.type?d(B.type,A.none()):M(T)},g=(T,E)=>{let M=E.event;"hex"===M.type?((T,E)=>{B(T);let M=Kx(E);d("hex",A.some(M.value));let D=uw(M);a(T,D),u(D),Rr(T,pr,{hex:M}),l(T,M)})(T,M.value):((T,E,B)=>{let M=parseInt(B,10);d(E,A.some(M)),c("red").bind(T=>c("green").bind(E=>c("blue").map(B=>lw(T,E,B,1)))).each(E=>{let B=((T,E)=>{let B=ow(E);return pb.getField(T,"hex").each(E=>{s3.isFocused(E)||r2.setValue(T,{hex:B.value})}),B})(T,E);Rr(T,pr,{hex:B}),l(T,B)})})(T,M.type,M.value)},p=E=>({label:T(pS+E+".label"),description:T(pS+E+".description")}),ea=p("red"),es=p("green"),eu=p("blue"),eg=p("hex");return tM(pb.sketch(B=>({dom:{tag:"form",classes:[E("rgb-form")],attributes:{"aria-label":T("aria.color.picker")}},components:[B.field("red",m3.sketch(r(cw,"red",ea.label,ea.description,255))),B.field("green",m3.sketch(r(cw,"green",es.label,es.description,255))),B.field("blue",m3.sketch(r(cw,"blue",eu.label,eu.description,255))),B.field("hex",m3.sketch(r(Qx,"hex",eg.label,eg.description,"ffffff"))),D.asSpec()],formBehaviours:Tl([gy.config({invalidClass:E("form-invalid")}),th("rgb-form-events",[Wr(pv,g),Wr(px,m),Wr(py,m)])])})),{apis:{updateHex:(T,E)=>{r2.setValue(T,{hex:E.value}),((T,E)=>{let B=uw(E);a(T,B),u(B)})(T,E),l(T,E)}}})},name:"RgbForm",configFields:[],apis:{updateHex:(T,E,B)=>{T.updateHex(E,B)}},extraApis:{}});return er},LO=(T,E)=>{let B=xm({name:"ColourPicker",configFields:[ns("dom"),xs("onValidHex",b),xs("onInvalidHex",b)],factory:B=>{let M=zO(T,E,B.onValidHex,B.onInvalidHex),D=((T,E)=>{let B=po.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[E("sv-palette-spectrum")]}}),M=po.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[E("sv-palette-thumb")],innerHtml:`<div class=${E("sv-palette-inner-thumb")} role="presentation"></div>`}}),s=(T,E)=>{let{width:B,height:M}=T,D=T.getContext("2d");if(null===D)return;D.fillStyle=E,D.fillRect(0,0,B,M);let er=D.createLinearGradient(0,0,B,0);er.addColorStop(0,"rgba(255,255,255,1)"),er.addColorStop(1,"rgba(255,255,255,0)"),D.fillStyle=er,D.fillRect(0,0,B,M);let ea=D.createLinearGradient(0,0,0,M);ea.addColorStop(0,"rgba(0,0,0,0)"),ea.addColorStop(1,"rgba(0,0,0,1)"),D.fillStyle=ea,D.fillRect(0,0,B,M)};return xm({factory:D=>{let er=x({x:0,y:0}),ea=Tl([az.config({find:A.some}),s3.config({})]);return po.sketch({dom:{tag:"div",attributes:{role:"slider","aria-valuetext":T(["Saturation {0}%, Brightness {1}%",0,0])},classes:[E("sv-palette")]},model:{mode:"xy",getInitialValue:er},rounded:!1,components:[B,M],onChange:(E,B,M)=>{eu(M)||Ct(E.element,"aria-valuetext",T(["Saturation {0}%, Brightness {1}%",Math.floor(M.x),Math.floor(100-M.y)])),Rr(E,pm,{value:M})},onInit:(T,E,B,M)=>{s(B.element.dom,pw(mx))},sliderBehaviours:ea})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:(T,E,B)=>{((T,E)=>{let B=T.components()[0].element.dom,M=Aw(E,100,100),D=dw(M);s(B,pw(D))})(E,B)},setThumb:(E,B,M)=>{((E,B)=>{let M=Mw(uw(B));po.setValue(E,{x:M.saturation,y:100-M.value}),Ct(E.element,"aria-valuetext",T(["Saturation {0}%, Brightness {1}%",M.saturation,M.value]))})(B,M)}},extraApis:{}})})(T,E),er={paletteRgba:As(mx),paletteHue:As(0)},ea=Xh(((T,E)=>{let B=po.parts.spectrum({dom:{tag:"div",classes:[E("hue-slider-spectrum")],attributes:{role:"presentation"}}}),M=po.parts.thumb({dom:{tag:"div",classes:[E("hue-slider-thumb")],attributes:{role:"presentation"}}});return po.sketch({dom:{tag:"div",classes:[E("hue-slider")],attributes:{role:"slider","aria-valuemin":0,"aria-valuemax":360,"aria-valuenow":120}},rounded:!1,model:{mode:"y",getInitialValue:x(0)},components:[B,M],sliderBehaviours:Tl([s3.config({})]),onChange:(T,E,B)=>{Ct(T.element,"aria-valuenow",Math.floor(360-3.6*B)),Rr(T,pu,{value:B})}})})(0,E)),es=Xh(D.sketch({})),eg=Xh(M.sketch({})),c=(T,E,B)=>{es.getOpt(T).each(T=>{D.setHue(T,B)})},d=(T,E)=>{eg.getOpt(T).each(T=>{M.updateHex(T,E)})},u=(T,E,B)=>{ea.getOpt(T).each(T=>{po.setValue(T,100-B/360*100)})},m=(T,E)=>{es.getOpt(T).each(T=>{D.setThumb(T,E)})},g=(T,E,B,M)=>{((T,E)=>{let B=uw(T);er.paletteRgba.set(B),er.paletteHue.set(E)})(E,B),H(M,M=>{M(T,E,B)})};return{uid:B.uid,dom:B.dom,components:[es.asSpec(),ea.asSpec(),eg.asSpec()],behaviours:Tl([th("colour-picker-events",[Wr(pr,(()=>{let T=[c,u,m];return(E,B)=>{let M=B.event.hex,D=Mw(uw(M));g(E,M,D.hue,T)}})()),Wr(pm,(()=>{let T=[d];return(E,B)=>{let M=B.event.value,D=er.paletteHue.get(),ea=Aw(D,M.x,100-M.y),es=Dw(ea);g(E,es,D,T)}})()),Wr(pu,(()=>{let T=[c,d];return(E,B)=>{let M=(100-B.event.value)/100*360,D=er.paletteRgba.get(),ea=Mw(D),es=Aw(M,ea.saturation,ea.value),eu=Dw(es);g(E,eu,M,T)}})())]),az.config({find:T=>eg.getOpt(T)}),sZ.config({mode:"acyclic"})])}}});return B},HO=()=>az.config({find:A.some}),PO=T=>az.config({find:E=>ct(E.element,T).bind(T=>E.getSystem().getByDom(T).toOptional())}),pk=Bn([xs("preprocess",w),xs("postprocess",w)]),WO=(T,E)=>{let B=Kn("RepresentingConfigs.memento processors",pk,E);return r2.config({store:{mode:"manual",getValue:E=>{let M=T.get(E),D=r2.getValue(M);return B.postprocess(D)},setValue:(E,M)=>{let D=B.preprocess(M),er=T.get(E);r2.setValue(er,D)}}})},jO=(T,E,B)=>r2.config({store:{mode:"manual",...T.map(T=>({initialValue:T})).getOr({}),getValue:E,setValue:B}}),GO=(T,E,B)=>jO(T,T=>E(T.element),(T,E)=>B(T.element,E)),$O=T=>r2.config({store:{mode:"memory",initialValue:T}}),pO={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"};var p_=tinymce.util.Tools.resolve("tinymce.Resource"),pB=tinymce.util.Tools.resolve("tinymce.util.Tools");let KO=(T,E)=>{let B=null,n=()=>{D(B)||(clearTimeout(B),B=null)};return{cancel:n,throttle:(...M)=>{n(),B=setTimeout(()=>{B=null,T.apply(null,M)},E)}}},pF=ca("alloy-fake-before-tabstop"),pM=ca("alloy-fake-after-tabstop"),QO=T=>({dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:T},behaviours:Tl([s3.config({ignore:!0}),m6.config({})])}),e_=(T,E)=>({dom:{tag:"div",classes:["tox-navobj",...T.getOr([])]},components:[QO([pF]),E,QO([pM])],behaviours:Tl([PO(1)])}),t_=(T,E)=>{Rr(T,t2(),{raw:{which:9,shiftKey:E}})},o_=(T,E)=>{let B=E.element;$a(B,pF)?t_(T,!0):$a(B,pM)&&t_(T,!1)},n_=T=>JS(T,["."+pF,"."+pM].join(","),eg),pR=ca("update-dialog"),pL=ca("update-title"),pH=ca("update-body"),pN=ca("update-footer"),pW=ca("body-send-message"),pz=ca("dialog-focus-shifted"),pP=Bo().browser,pU=pP.isSafari(),pG=pP.isFirefox(),p$=pU||pG,pj=pP.isChromium(),h_=({scrollTop:T,scrollHeight:E,clientHeight:B})=>Math.ceil(T)+B>=E,f_=(T,E)=>T.scrollTo(0,"bottom"===E?99999999:E),b_=(T,E,B)=>{let M=T.dom;A.from(M.contentDocument).fold(B,T=>{let B=0,D=((T,E)=>{let B=T.body;return A.from(!/^<!DOCTYPE (html|HTML)/.test(E)&&(!pj&&!pU||g(B)&&(0!==B.scrollTop||Math.abs(B.scrollHeight-B.clientHeight)>1))?B:T.documentElement)})(T,E).map(T=>(B=T.scrollTop,T)).forall(h_),r=()=>{let T=M.contentWindow;g(T)&&(D?f_(T,"bottom"):!D&&p$&&0!==B&&f_(T,B))};pU&&M.addEventListener("load",r,{once:!0}),T.open(),T.write(E),T.close(),pU||r()})},pY=Ce(p$,pU?500:200).map(T=>{let E,B;return E=null,B=null,{cancel:()=>{D(E)||(clearTimeout(E),E=null,B=null)},throttle:(...M)=>{B=M,D(E)&&(E=setTimeout(()=>{let T=B;E=null,B=null,b_.apply(null,T)},T))}}}),pX=ca("toolbar.button.execute"),pq=ca("common-button-display-events"),pK={[ox()]:["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],[oW()]:["toolbar-button-events",pq],[tq()]:["focusing","alloy.base.behaviour",pq]},S_=T=>Bt(T.element,"width",Rt(T.element,"width")),k_=(T,E,B)=>ob(T,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:B},E),C_=(T,E)=>k_(T,E,[]),O_=(T,E)=>k_(T,E,[sQ.config({})]),__=(T,E,B)=>({dom:{tag:"span",classes:[`${E}__select-label`]},components:[ri(B.translate(T))],behaviours:Tl([sQ.config({})])}),pZ=ca("update-menu-text"),pJ=ca("update-menu-icon"),A_=(T,E,B)=>{let M=As(b),D=T.text.map(T=>Xh(__(T,E,B.providers))),er=T.icon.map(T=>Xh(O_(T,B.providers.icons))),a=(T,E)=>{let B=r2.getValue(T);return s3.focus(B),Rr(B,"keydown",{raw:E.event.raw}),mZ.close(B),A.some(!0)},ea=T.role.fold(()=>({}),T=>({role:T})),es=T.tooltip.fold(()=>({}),T=>{let E=B.providers.translate(T);return{title:E,"aria-label":E}}),eu=ob("chevron-down",{tag:"div",classes:[`${E}__select-chevron`]},B.providers.icons),eg=ca("common-button-display-events"),ep=Xh(mZ.sketch({...T.uid?{uid:T.uid}:{},...ea,dom:{tag:"button",classes:[E,`${E}--select`].concat(L(T.classes,T=>`${E}--${T}`)),attributes:{...es}},components:we([er.map(T=>T.asSpec()),D.map(T=>T.asSpec()),A.some(eu)]),matchWidth:!0,useMinWidth:!0,onOpen:(E,B,M)=>{T.searchable&&(T=>{jv(T).each(T=>s3.focus(T))})(M)},dropdownBehaviours:Tl([...T.dropdownBehaviours,_x(()=>T.disabled||B.providers.isDisabled()),Ox(),gS.config({}),sQ.config({}),th("dropdown-events",[Mx(T,M),Dx(T,M)]),th(eg,[oZ((T,E)=>S_(T))]),th("menubutton-update-display-text",[Wr(pZ,(T,E)=>{D.bind(E=>E.getOpt(T)).each(T=>{sQ.set(T,[ri(B.providers.translate(E.event.text))])})}),Wr(pJ,(T,E)=>{er.bind(E=>E.getOpt(T)).each(T=>{sQ.set(T,[O_(E.event.icon,B.providers.icons)])})})])]),eventOrder:tM(pK,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"],[oW()]:["toolbar-button-events","dropdown-events",eg]}),sandboxBehaviours:Tl([sZ.config({mode:"special",onLeft:a,onRight:a}),th("dropdown-sandbox-events",[Wr(dL,(T,E)=>{(T=>{let E=r2.getValue(T),B=jv(T).map($v);mZ.refetch(E).get(()=>{let T=m$.getCoupled(E,"sandbox");B.each(E=>jv(T).each(T=>{r2.setValue(T,E.fetchPattern),T.element.dom.selectionStart=E.selectionStart,T.element.dom.selectionEnd=E.selectionEnd}))})})(T),E.stop()}),Wr(dV,(T,E)=>{((T,E)=>{rG.getState(T).bind(aq.getHighlighted).bind(aq.getHighlighted).each(B=>{((T,E,B,M)=>{let D={...M,target:E};T.getSystem().triggerEvent(B,E,D)})(T,B.element,E.event.eventType,E.event.interactionEvent)})})(T,E),E.stop()})])]),lazySink:B.getSink,toggleClass:`${E}--active`,parts:{menu:{...Rv(0,T.columns,T.presets),fakeFocus:T.searchable,onHighlightItem:VS,onCollapseMenu:(T,E,B)=>{aq.getHighlighted(B).each(E=>{VS(T,B,E)})},onDehighlightItem:zS}},getAnchorOverrides:()=>({maxHeightFunction:(T,E)=>{n7()(T,E-10)}}),fetch:E=>wS(k(T.fetch,E))}));return ep.asSpec()},M_=T=>"separator"===T.type,pQ={type:"separator"},B_=(T,B)=>{let M=((T,B)=>{let M=j(T,(T,M)=>E(M)?""===M?T:"|"===M?T.length>0&&!M_(T[T.length-1])?T.concat([pQ]):T:ve(B,M.toLowerCase())?T.concat([B[M.toLowerCase()]]):T:T.concat([M]),[]);return M.length>0&&M_(M[M.length-1])&&M.pop(),M})(E(T)?T.split(" "):T,B);return W(M,(T,E)=>{if(ve(E,"getSubmenuItems")){let M=(T=>{let E=be(T,"value").getOrThunk(()=>ca("generated-menu-item"));return tM({value:E},T)})(E),D=((T,E)=>{let B=T.getSubmenuItems(),M=B_(B,E);return{item:T,menus:tM(M.menus,{[T.value]:M.items}),expansions:tM(M.expansions,{[T.value]:T.value})}})(M,B);return{menus:tM(T.menus,D.menus),items:[D.item,...T.items],expansions:tM(T.expansions,D.expansions)}}return{...T,items:[E,...T.items]}},{menus:{},expansions:{},items:[]})},I_=(T,E,B,M)=>{let D=ca("primary-menu"),er=B_(T,B.shared.providers.menuItems());if(0===er.items.length)return A.none();let ea=M.search.fold(()=>({searchMode:"no-search"}),T=>({searchMode:"search-with-field",placeholder:T.placeholder})),es=WS(D,er.items,E,B,M.isHorizontalMenu,ea),eu=M.search.fold(()=>({searchMode:"no-search"}),T=>({searchMode:"search-with-results"})),eg=ce(er.menus,(T,M)=>WS(M,T,E,B,!1,eu)),ep=tM(eg,Ds(D,es));return A.from(iL.tieredData(D,ep,er.expansions))},F_=T=>!ve(T,"items"),p0="data-value",N_=(T,E,B,M)=>L(B,B=>F_(B)?{type:"togglemenuitem",text:B.text,value:B.value,active:B.value===M,onAction:()=>{r2.setValue(T,B.value),Rr(T,m8,{name:E}),s3.focus(T)}}:{type:"nestedmenuitem",text:B.text,getSubmenuItems:()=>N_(T,E,B.items,M)}),V_=(T,E)=>re(T,T=>F_(T)?Ce(T.value===E,T):V_(T.items,E)),p1=xm({name:"HtmlSelect",configFields:[ns("options"),yu("selectBehaviours",[s3,r2]),xs("selectClasses",[]),xs("selectAttributes",{}),ms("data")],factory:(T,E)=>{let B=L(T.options,T=>({dom:{tag:"option",value:T.value,innerHtml:T.text}})),M=T.data.map(T=>Ds("initialValue",T)).getOr({});return{uid:T.uid,dom:{tag:"select",classes:T.selectClasses,attributes:T.selectAttributes},components:B,behaviours:wu(T.selectBehaviours,[s3.config({}),r2.config({store:{mode:"manual",getValue:T=>Ka(T.element),setValue:(E,B)=>{let M=oe(T.options);G(T.options,T=>T.value===B).isSome()?Ja(E.element,B):-1===E.element.dom.selectedIndex&&""===B&&M.each(T=>Ja(E.element,T.value))},...M}})])}}}),p2=x([xs("field1Name","field1"),xs("field2Name","field2"),Vi("onLockedChange"),Ii(["lockClass"]),xs("locked",!1),yu("coupledFieldBehaviours",[az,r2])]),H_=(T,E)=>aT({factory:m3,name:T,overrides:T=>({fieldBehaviours:Tl([th("coupled-input-behaviour",[Wr(t5(),B=>{am(B,T,E).bind(az.getCurrent).each(E=>{am(B,T,"lock").each(M=>{s4.isOn(M)&&T.onLockedChange(B,E,M)})})})])])})}),p3=x([H_("field1","field2"),H_("field2","field1"),aT({factory:iW,schema:[ns("dom")],name:"lock",overrides:T=>({buttonBehaviours:Tl([s4.config({selected:T.locked,toggleClass:T.markers.lockClass,aria:{mode:"pressed"}})])})})]),p5=wm({name:"FormCoupledInputs",configFields:p2(),partFields:p3(),factory:(T,E,B,M)=>({uid:T.uid,dom:T.dom,components:E,behaviours:wu(T.coupledFieldBehaviours,[az.config({find:A.some}),r2.config({store:{mode:"manual",getValue:E=>{let B=um(E,T,["field1","field2"]);return{[T.field1Name]:r2.getValue(B.field1()),[T.field2Name]:r2.getValue(B.field2())}},setValue:(E,B)=>{let M=um(E,T,["field1","field2"]);ye(B,T.field1Name)&&r2.setValue(M.field1(),B[T.field1Name]),ye(B,T.field2Name)&&r2.setValue(M.field2(),B[T.field2Name])}}})]),apis:{getField1:E=>am(E,T,"field1"),getField2:E=>am(E,T,"field2"),getLock:E=>am(E,T,"lock")}}),apis:{getField1:(T,E)=>T.getField1(E),getField2:(T,E)=>T.getField2(E),getLock:(T,E)=>T.getLock(E)}}),W_=T=>{let E=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(T);if(null!==E){let T=parseFloat(E[1]),B=E[2];return tE.value({value:T,unit:B})}return tE.error(T)},j_=(T,E)=>{let B={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},n=T=>ve(B,T);return T.unit===E?A.some(T.value):n(T.unit)&&n(E)?B[T.unit]===B[E]?A.some(T.value):A.some(T.value/B[T.unit]*B[E]):A.none()},G_=T=>A.none(),$_=(T,E)=>{let B=T.label.map(T=>yk(T,E)),M=[aj.config({disabled:()=>T.disabled||E.isDisabled()}),Ox(),sZ.config({mode:"execution",useEnter:!0!==T.multiline,useControlEnter:!0===T.multiline,execute:T=>(Fr(T,gr),A.some(!0))}),th("textfield-change",[Wr(t5(),(E,B)=>{Rr(E,m8,{name:T.name})}),Wr(og(),(E,B)=>{Rr(E,m8,{name:T.name})})]),m6.config({})],D=T.validation.map(T=>gy.config({getRoot:T=>at(T.element),invalidClass:"tox-invalid",validator:{validate:E=>{let B=r2.getValue(E),M=T.validator(B);return SS(!0===M?tE.value(B):tE.error(M))},validateOnLoad:T.validateOnLoad}})).toArray(),er={...T.placeholder.fold(x({}),T=>({placeholder:E.translate(T)})),...T.inputMode.fold(x({}),T=>({inputmode:T}))},ea=m3.parts.field({tag:!0===T.multiline?"textarea":"input",...T.data.map(T=>({data:T})).getOr({}),inputAttributes:er,inputClasses:[T.classname],inputBehaviours:Tl(q([M,D])),selectOnFocus:!1,factory:dR}),es=T.multiline?{dom:{tag:"div",classes:["tox-textarea-wrap"]},components:[ea]}:ea,eu=(T.flex?["tox-form__group--stretched"]:[]).concat(T.maximized?["tox-form-group--maximize"]:[]),eg=[aj.config({disabled:()=>T.disabled||E.isDisabled(),onDisabled:T=>{m3.getField(T).each(aj.disable)},onEnabled:T=>{m3.getField(T).each(aj.enable)}}),Ox()];return fk(B,es,eu,eg)},q_=(T,E)=>E.getAnimationRoot.fold(()=>T.element,E=>E(T)),Y_=T=>T.dimension.property,X_=(T,E)=>T.dimension.getDimension(E),K_=(T,E)=>{let B=q_(T,E);Ya(B,[E.shrinkingClass,E.growingClass])},J_=(T,E)=>{Ga(T.element,E.openClass),Wa(T.element,E.closedClass),Bt(T.element,Y_(E),"0px"),Pt(T.element)},Z_=(T,E)=>{Ga(T.element,E.closedClass),Wa(T.element,E.openClass),Ht(T.element,Y_(E))},Q_=(T,E,B,M)=>{B.setCollapsed(),Bt(T.element,Y_(E),X_(E,T.element)),K_(T,E),J_(T,E),E.onStartShrink(T),E.onShrunk(T)},eT=(T,E,B,M)=>{let D=M.getOrThunk(()=>X_(E,T.element));B.setCollapsed(),Bt(T.element,Y_(E),D),Pt(T.element);let er=q_(T,E);Ga(er,E.growingClass),Wa(er,E.shrinkingClass),J_(T,E),E.onStartShrink(T)},tT=(T,E,B)=>{let M=X_(E,T.element);("0px"===M?Q_:eT)(T,E,B,A.some(M))},oT=(T,E,B)=>{let M=q_(T,E),D=$a(M,E.shrinkingClass),er=X_(E,T.element);Z_(T,E);let ea=X_(E,T.element);(D?()=>{Bt(T.element,Y_(E),er),Pt(T.element)}:()=>{J_(T,E)})(),Ga(M,E.shrinkingClass),Wa(M,E.growingClass),Z_(T,E),Bt(T.element,Y_(E),ea),B.setExpanded(),E.onStartGrow(T)},nT=(T,E,B)=>{let M=q_(T,E);return!0===$a(M,E.growingClass)},sT=(T,E,B)=>{let M=q_(T,E);return!0===$a(M,E.shrinkingClass)};var p9=Object.freeze({__proto__:null,refresh:(T,E,B)=>{if(B.isExpanded()){Ht(T.element,Y_(E));let B=X_(E,T.element);Bt(T.element,Y_(E),B)}},grow:(T,E,B)=>{B.isExpanded()||oT(T,E,B)},shrink:(T,E,B)=>{B.isExpanded()&&tT(T,E,B)},immediateShrink:(T,E,B)=>{B.isExpanded()&&Q_(T,E,B)},hasGrown:(T,E,B)=>B.isExpanded(),hasShrunk:(T,E,B)=>B.isCollapsed(),isGrowing:nT,isShrinking:sT,isTransitioning:(T,E,B)=>nT(T,E)||sT(T,E),toggleGrow:(T,E,B)=>{(B.isExpanded()?tT:oT)(T,E,B)},disableTransitions:K_,immediateGrow:(T,E,B)=>{B.isExpanded()||(Z_(T,E),Bt(T.element,Y_(E),X_(E,T.element)),K_(T,E),B.setExpanded(),E.onStartGrow(T),E.onGrown(T))}}),p6=Object.freeze({__proto__:null,exhibit:(T,E,B)=>{let M=E.expanded;return Aa(M?{classes:[E.openClass],styles:{}}:{classes:[E.closedClass],styles:Ds(E.dimension.property,"0px")})},events:(T,E)=>Hr([Kr(t8(),(B,M)=>{M.event.raw.propertyName===T.dimension.property&&(K_(B,T),E.isExpanded()&&Ht(B.element,T.dimension.property),(E.isExpanded()?T.onGrown:T.onShrunk)(B))})])}),p4=[ns("closedClass"),ns("openClass"),ns("shrinkingClass"),ns("growingClass"),ms("getAnimationRoot"),Ri("onShrunk"),Ri("onStartShrink"),Ri("onGrown"),Ri("onStartGrow"),xs("expanded",!1),ss("dimension",Zn("property",{width:[Li("property","width"),Li("getDimension",T=>Zt(T)+"px")],height:[Li("property","height"),Li("getDimension",T=>jt(T)+"px")]}))];let p8=Al({fields:p4,name:"sliding",active:p6,apis:p9,state:Object.freeze({__proto__:null,init:T=>{let E=As(T.expanded);return Ta({isExpanded:()=>!0===E.get(),isCollapsed:()=>!1===E.get(),setCollapsed:k(E.set,!1),setExpanded:k(E.set,!0),readState:()=>"expanded: "+E.get()})}})}),cT=T=>({isEnabled:()=>!aj.isDisabled(T),setEnabled:E=>aj.set(T,!E),setActive:E=>{let B=T.element;E?(Wa(B,"tox-tbtn--enabled"),Ct(B,"aria-pressed",!0)):(Ga(B,"tox-tbtn--enabled"),At(B,"aria-pressed"))},isActive:()=>$a(T.element,"tox-tbtn--enabled"),setText:E=>{Rr(T,pZ,{text:E})},setIcon:E=>Rr(T,pJ,{icon:E})}),dT=(T,E,B,M,D=!0)=>A_({text:T.text,icon:T.icon,tooltip:T.tooltip,searchable:T.search.isSome(),role:M,fetch:(E,M)=>{let D={pattern:T.search.isSome()?LS(E):""};T.fetch(E=>{M(I_(E,c8.CLOSE_ON_EXECUTE,B,{isHorizontalMenu:!1,search:T.search}))},D,cT(E))},onSetup:T.onSetup,getApi:cT,columns:1,presets:"normal",classes:[],dropdownBehaviours:[...D?[m6.config({})]:[]]},E,B.shared),uT=(T,E,B)=>{let n=T=>M=>{let D=!M.isActive();M.setActive(D),T.storage.set(D),B.shared.getSink().each(B=>{E().getOpt(B).each(E=>{Rl(E.element),Rr(E,gn,{name:T.name,value:T.storage.get()})})})},s=T=>E=>{E.setActive(T.storage.get())};return E=>{E(L(T,T=>{let E=T.text.fold(()=>({}),T=>({text:T}));return{type:T.type,active:!1,...E,onAction:n(T),onSetup:s(T)}}))}},mT=T=>({dom:{tag:"span",classes:["tox-tree__label"],attributes:{title:T,"aria-label":T}},components:[ri(T)]}),p7=ca("leaf-label-event-id"),pT=({leaf:T,onLeafAction:E,visible:B,treeId:M,selectedId:D,backstage:er})=>{let ea=T.menu.map(T=>dT(T,"tox-mbtn",er,A.none(),B)),es=[mT(T.title)];return ea.each(T=>es.push(T)),iW.sketch({dom:{tag:"div",classes:["tox-tree--leaf__label","tox-trbtn"].concat(B?["tox-tree--leaf__label--visible"]:[])},components:es,role:"treeitem",action:B=>{E(T.id),B.getSystem().broadcastOn([`update-active-item-${M}`],{value:T.id})},eventOrder:{[t2()]:[p7,"keying"]},buttonBehaviours:Tl([...B?[m6.config({})]:[],s4.config({toggleClass:"tox-trbtn--enabled",toggleOnExecute:!1,aria:{mode:"selected"}}),n0.config({channels:{[`update-active-item-${M}`]:{onReceive:(E,B)=>{(B.value===T.id?s4.on:s4.off)(E)}}}}),th(p7,[oZ((E,B)=>{D.each(B=>{(B===T.id?s4.on:s4.off)(E)})}),Wr(t2(),(T,E)=>{let B="ArrowLeft"===E.event.raw.code,M="ArrowRight"===E.event.raw.code;B?(fi(T.element,".tox-tree--directory").each(E=>{T.getSystem().getByDom(E).each(T=>{bi(E,".tox-tree--directory__label").each(E=>{T.getSystem().getByDom(E).each(s3.focus)})})}),E.stop()):M&&E.stop()})])])})},ht=ca("directory-label-event-id"),fT=({directory:T,visible:E,noChildren:B,backstage:M})=>{var D;let er=T.menu.map(T=>dT(T,"tox-mbtn",M,A.none())),ea=[{dom:{tag:"div",classes:["tox-chevron"]},components:[ob("chevron-right",{tag:"span",classes:["tox-tree__icon-wrap","tox-icon"],behaviours:[]},M.shared.providers.icons)]},mT(T.title)];er.each(T=>{ea.push(T)});let l=E=>{fi(E.element,".tox-tree--directory").each(B=>{E.getSystem().getByDom(B).each(B=>{let M=!s4.isOn(B);s4.toggle(B),Rr(E,"expand-tree-node",{expanded:M,node:T.id})})})};return iW.sketch({dom:{tag:"div",classes:["tox-tree--directory__label","tox-trbtn"].concat(E?["tox-tree--directory__label--visible"]:[])},components:ea,action:l,eventOrder:{[t2()]:[ht,"keying"]},buttonBehaviours:Tl([...E?[m6.config({})]:[],th(ht,[Wr(t2(),(T,E)=>{let M="ArrowRight"===E.event.raw.code,D="ArrowLeft"===E.event.raw.code;M&&B&&E.stop(),(M||D)&&fi(T.element,".tox-tree--directory").each(B=>{T.getSystem().getByDom(B).each(B=>{!s4.isOn(B)&&M||s4.isOn(B)&&D?(l(T),E.stop()):D&&!s4.isOn(B)&&(fi(B.element,".tox-tree--directory").each(T=>{bi(T,".tox-tree--directory__label").each(T=>{B.getSystem().getByDom(T).each(s3.focus)})}),E.stop())})})})])])})},bT=({children:T,onLeafAction:E,visible:B,treeId:M,expandedIds:D,selectedId:er,backstage:ea})=>({dom:{tag:"div",classes:["tox-tree--directory__children"]},components:T.map(T=>"leaf"===T.type?pT({leaf:T,selectedId:er,onLeafAction:E,visible:B,treeId:M,backstage:ea}):yT({directory:T,expandedIds:D,selectedId:er,onLeafAction:E,labelTabstopping:B,treeId:M,backstage:ea})),behaviours:Tl([p8.config({dimension:{property:"height"},closedClass:"tox-tree--directory__children--closed",openClass:"tox-tree--directory__children--open",growingClass:"tox-tree--directory__children--growing",shrinkingClass:"tox-tree--directory__children--shrinking",expanded:B}),sQ.config({})])}),ho=ca("directory-event-id"),yT=({directory:T,onLeafAction:E,labelTabstopping:B,treeId:M,backstage:D,expandedIds:er,selectedId:ea})=>{let{children:es}=T,eu=As(er),eg=er.includes(T.id);return{dom:{tag:"div",classes:["tox-tree--directory"],attributes:{role:"treeitem"}},components:[fT({directory:T,visible:B,noChildren:0===T.children.length,backstage:D}),bT({children:es,expandedIds:er,selectedId:ea,onLeafAction:E,visible:eg,treeId:M,backstage:D})],behaviours:Tl([th(ho,[oZ((T,E)=>{s4.set(T,eg)}),Wr("expand-tree-node",(T,E)=>{let{expanded:B,node:M}=E.event;eu.set(B?[...eu.get(),M]:eu.get().filter(T=>T!==M))})]),s4.config({...T.children.length>0?{aria:{mode:"expanded"}}:{},toggleClass:"tox-tree--directory--expanded",onToggled:(T,B)=>{let er=T.components()[1],eg=es.map(T=>"leaf"===T.type?pT({leaf:T,selectedId:ea,onLeafAction:E,visible:B,treeId:M,backstage:D}):yT({directory:T,expandedIds:eu.get(),selectedId:ea,onLeafAction:E,labelTabstopping:B,treeId:M,backstage:D}));B?p8.grow(er):p8.shrink(er),sQ.set(er,eg)}})])}},hr=ca("tree-event-id");var hu=Object.freeze({__proto__:null,events:(T,E)=>{let B=T.stream.streams.setup(T,E);return Hr([Wr(T.event,B),oJ(()=>E.cancel())].concat(T.cancelEvent.map(T=>[Wr(T,()=>E.cancel())]).getOr([])))}});let ST=T=>{let E=As(null);return Ta({readState:()=>({timer:null!==E.get()?"set":"unset"}),setTimer:T=>{E.set(T)},cancel:()=>{let T=E.get();null!==T&&T.cancel()}})};var hf=Object.freeze({__proto__:null,throttle:ST,init:T=>T.stream.streams.state(T)}),hb=[ss("stream",Zn("mode",{throttle:[ns("delay"),xs("stopEvent",!0),Li("streams",{setup:(T,E)=>{let B=T.stream,M=KO(T.onStream,B.delay);return E.setTimer(M),(T,E)=>{M.throttle(T,E),B.stopEvent&&E.stop()}},state:ST})]})),xs("event","input"),ms("cancelEvent"),Vi("onStream")];let hy=Al({fields:hb,name:"streaming",active:hu,state:hf}),_T=(T,E,B)=>{let M=r2.getValue(B);r2.setValue(E,M),ET(E)},TT=(T,E)=>{let B=T.element,M=Ka(B),D=B.dom;"number"!==_t(B,"type")&&E(D,M)},ET=T=>{TT(T,(T,E)=>T.setSelectionRange(E.length,E.length))},hw=x("alloy.typeahead.itemexecute"),hA=x([ms("lazySink"),ns("fetch"),xs("minChars",5),xs("responseTime",1e3),Ri("onOpen"),xs("getHotspot",A.some),xs("getAnchorOverrides",x({})),xs("layouts",A.none()),xs("eventOrder",{}),Es("model",{},[xs("getDisplayText",T=>void 0!==T.meta&&void 0!==T.meta.text?T.meta.text:T.value),xs("selectsOver",!0),xs("populateFromBrowse",!0)]),Ri("onSetValue"),Ni("onExecute"),Ri("onItemExecute"),xs("inputClasses",[]),xs("inputAttributes",{}),xs("inputStyles",{}),xs("matchWidth",!0),xs("useMinWidth",!1),xs("dismissOnBlur",!0),Ii(["openClass"]),ms("initialData"),yu("typeaheadBehaviours",[s3,r2,hy,sZ,s4,m$]),ts("lazyTypeaheadComp",()=>As(A.none)),ts("previewing",()=>As(!0))].concat(dI()).concat(IS())),hS=x([a_({schema:[Bi()],name:"menu",overrides:T=>({fakeFocus:!0,onHighlightItem:(E,B,M)=>{T.previewing.get()?T.lazyTypeaheadComp.get().each(E=>{((T,E,B)=>{if(T.selectsOver){let M=r2.getValue(E),D=T.getDisplayText(M),er=r2.getValue(B);return 0===T.getDisplayText(er).indexOf(D)?A.some(()=>{var T;_T(0,E,B),T=D.length,TT(E,(E,B)=>E.setSelectionRange(T,B.length))}):A.none()}return A.none()})(T.model,E,M).fold(()=>{T.model.selectsOver?(aq.dehighlight(B,M),T.previewing.set(!0)):T.previewing.set(!1)},E=>{E(),T.previewing.set(!1)})}):T.lazyTypeaheadComp.get().each(E=>{T.model.populateFromBrowse&&_T(T.model,E,M),Tt(M.element,"id").each(T=>Ct(E.element,"aria-activedescendant",T))})},onExecute:(E,B)=>T.lazyTypeaheadComp.get().map(T=>(Rr(T,hw(),{item:B}),!0)),onHover:(E,B)=>{T.previewing.set(!1),T.lazyTypeaheadComp.get().each(E=>{T.model.populateFromBrowse&&_T(T.model,E,B)})}})})]),hT=wm({name:"Typeahead",configFields:hA(),partFields:hS(),factory:(T,E,B,M)=>{let s=(E,B,D)=>{T.previewing.set(!1);let er=m$.getCoupled(E,"sandbox");rG.isOpen(er)?az.getCurrent(er).each(T=>{aq.getHighlighted(T).fold(()=>{D(T)},()=>{Lr(er,T.element,"keydown",B)})}):_S(T,a(E),E,er,M,T=>{az.getCurrent(T).each(D)},l2.HighlightMenuAndItem).get(b)},D=Vv(T),a=T=>E=>E.map(E=>{let B=fe(E.menus),M=Y(B,T=>U(T.items,T=>"item"===T.type));return r2.getState(T).update(L(M,T=>T.data)),E}),i=T=>az.getCurrent(T),er="typeaheadevents",ea=[s3.config({}),r2.config({onSetValue:T.onSetValue,store:{mode:"dataset",getDataKey:T=>Ka(T.element),getFallbackEntry:T=>({value:T,meta:{}}),setValue:(E,B)=>{Ja(E.element,T.model.getDisplayText(B))},...T.initialData.map(T=>Ds("initialValue",T)).getOr({})}}),hy.config({stream:{mode:"throttle",delay:T.responseTime,stopEvent:!1},onStream:(E,B)=>{let D=m$.getCoupled(E,"sandbox");if(s3.isFocused(E)&&Ka(E.element).length>=T.minChars){let B=i(D).bind(T=>aq.getHighlighted(T).map(r2.getValue));T.previewing.set(!0),_S(T,a(E),E,D,M,E=>{i(D).each(E=>{B.fold(()=>{T.model.selectsOver&&aq.highlightFirst(E)},T=>{aq.highlightBy(E,E=>r2.getValue(E).value===T.value),aq.getHighlighted(E).orThunk(()=>(aq.highlightFirst(E),A.none()))})})},l2.HighlightJustMenu).get(b)}},cancelEvent:oM()}),sZ.config({mode:"special",onDown:(T,E)=>(s(T,E,aq.highlightFirst),A.some(!0)),onEscape:T=>{let E=m$.getCoupled(T,"sandbox");return rG.isOpen(E)?(rG.close(E),A.some(!0)):A.none()},onUp:(T,E)=>(s(T,E,aq.highlightLast),A.some(!0)),onEnter:E=>{let B=m$.getCoupled(E,"sandbox"),M=rG.isOpen(B);if(M&&!T.previewing.get())return i(B).bind(T=>aq.getHighlighted(T)).map(T=>(Rr(E,hw(),{item:T}),!0));{let D=r2.getValue(E);return Fr(E,oM()),T.onExecute(B,E,D),M&&rG.close(B),A.some(!0)}}}),s4.config({toggleClass:T.markers.openClass,aria:{mode:"expanded"}}),m$.config({others:{sandbox:E=>DS(T,E,{onOpen:()=>s4.on(E),onClose:()=>{T.lazyTypeaheadComp.get().each(T=>At(T.element,"aria-activedescendant")),s4.off(E)}})}}),th(er,[oZ(E=>{T.lazyTypeaheadComp.set(A.some(E))}),oJ(E=>{T.lazyTypeaheadComp.set(A.none())}),o0(E=>{ES(T,a(E),E,M,b,l2.HighlightMenuAndItem).get(b)}),Wr(hw(),(E,B)=>{let M=m$.getCoupled(E,"sandbox");_T(T.model,E,B.event.item),Fr(E,oM()),T.onItemExecute(E,M,B.event.item,r2.getValue(E)),rG.close(M),ET(E)})].concat(T.dismissOnBlur?[Wr(ou(),T=>{let E=m$.getCoupled(T,"sandbox");Ll(E.element).isNone()&&rG.close(E)})]:[]))],es={[oz()]:[r2.name(),hy.name(),er],...T.eventOrder};return{uid:T.uid,dom:Lv(tM(T,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:{...D,...wu(T.typeaheadBehaviours,ea)},eventOrder:es}}}),IT=T=>({...T,toCached:()=>IT(T.toCached()),bindFuture:E=>IT(T.bind(T=>T.fold(T=>SS(tE.error(T)),T=>E(T)))),bindResult:E=>IT(T.map(T=>T.bind(E))),mapResult:E=>IT(T.map(T=>T.map(E))),mapError:E=>IT(T.map(T=>T.mapError(E))),foldResult:(E,B)=>T.map(T=>T.fold(E,B)),withTimeout:(E,B)=>IT(wS(M=>{let D=!1,er=setTimeout(()=>{D=!0,M(tE.error(B()))},E);T.get(T=>{D||(clearTimeout(er),M(T))})}))}),FT=T=>IT(wS(T)),RT=(T,E,B=[],M,D,er)=>{let ea=E.fold(()=>({}),T=>({action:T})),es={buttonBehaviours:Tl([_x(()=>!T.enabled||er.isDisabled()),Ox(),m6.config({}),th("button press",[Ur("click"),Ur("mousedown")])].concat(B)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]},...ea},eu=tM(es,{dom:M});return tM(eu,{components:D})},NT=(T,E,B,M=[])=>{let D={tag:"button",classes:["tox-tbtn"],attributes:T.tooltip.map(T=>({"aria-label":B.translate(T),title:B.translate(T)})).getOr({})},er=T.icon.map(T=>C_(T,B.icons)),ea=we([er]);return RT(T,E,M,D,ea,B)},VT=T=>{switch(T){case"primary":return["tox-button"];case"toolbar":return["tox-tbtn"];default:return["tox-button","tox-button--secondary"]}},zT=(T,E,B,M=[],D=[])=>{let er=B.translate(T.text),ea=T.icon.map(T=>C_(T,B.icons)),es=[ea.getOrThunk(()=>ri(er))],eu=T.buttonType.getOr(T.primary||T.borderless?"primary":"secondary"),eg=[...VT(eu),...ea.isSome()?["tox-button--icon"]:[],...T.borderless?["tox-button--naked"]:[],...D];return RT(T,E,M,{tag:"button",classes:eg,attributes:{title:er}},es,B)},LT=(T,E,B,M=[],D=[])=>{let er=zT(T,A.some(E),B,M,D);return iW.sketch(er)},HT=(T,E)=>B=>{"custom"===E?Rr(B,gn,{name:T,value:{}}):"submit"===E?Fr(B,gr):"cancel"===E?Fr(B,go):console.error("Unknown button type: ",E)},PT=(T,E,B)=>{if("menu"===E){let E={...T,type:"menubutton",search:A.none(),onSetup:E=>(E.setEnabled(T.enabled),b),fetch:uT(T.items,()=>M,B)},M=Xh(dT(E,"tox-tbtn",B,A.none()));return M.asSpec()}if("custom"===E||"cancel"===E||"submit"===E){let M=HT(T.name,E),D={...T,borderless:!1};return LT(D,M,B.shared.providers,[])}if("togglebutton"===E)return((T,E)=>{var B,M;let D=T.icon.map(T=>O_(T,E.icons)).map(Xh),er=T.buttonType.getOr(T.primary?"primary":"secondary"),ea={...T,name:null!==(B=T.name)&&void 0!==B?B:"",primary:"primary"===er,tooltip:A.from(T.tooltip),enabled:null!==(M=T.enabled)&&void 0!==M&&M,borderless:!1},es=ea.tooltip.map(T=>({"aria-label":E.translate(T),title:E.translate(T)})).getOr({}),eu=VT(null!=er?er:"secondary"),eg=T.icon.isSome()&&T.text.isSome(),ep={tag:"button",classes:[...eu.concat(T.icon.isSome()?["tox-button--icon"]:[]),...T.active?["tox-button--enabled"]:[],...eg?["tox-button--icon-and-text"]:[]],attributes:es},eh=E.translate(T.text.getOr("")),ef=ri(eh),ex=[...we([D.map(T=>T.asSpec())]),...T.text.isSome()?[ef]:[]],eC=RT(ea,A.some(B=>{Rr(B,gn,{name:T.name,value:{setIcon:T=>{D.map(M=>M.getOpt(B).each(B=>{sQ.set(B,[O_(T,E.icons)])}))}}})}),[],ep,ex,E);return iW.sketch(eC)})(T,B.shared.providers);throw console.error("Unknown footer button type: ",E),Error("Unknown footer button type")},hk={type:"separator"},WT=T=>({type:"menuitem",value:T.url,text:T.title,meta:{attach:T.attach},onAction:b}),jT=(T,E)=>({type:"menuitem",value:E,text:T,meta:{attach:void 0},onAction:b}),GT=(T,E)=>L(U(E,E=>E.type===T),WT),$T=T=>GT("header",T.targets),qT=T=>GT("anchor",T.targets),YT=T=>A.from(T.anchorTop).map(T=>jT("<top>",T)).toArray(),XT=T=>A.from(T.anchorBottom).map(T=>jT("<bottom>",T)).toArray(),KT=(T,E)=>{let B=T.toLowerCase();return U(E,T=>{var E;let M=void 0!==T.meta&&void 0!==T.meta.text?T.meta.text:T.text,D=null!==(E=T.value)&&void 0!==E?E:"";return Te(M.toLowerCase(),B)||Te(D.toLowerCase(),B)})},hO=ca("aria-invalid"),ZT=(T,E)=>{T.dom.checked=E},QT=T=>T.dom.checked,eE=T=>(E,B,M,D)=>be(B,"name").fold(()=>T(B,D,A.none()),er=>E.field(er,T(B,D,be(M,er)))),hB={bar:eE((T,E)=>{var B;return B=E.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:L(T.items,B.interpreter)}}),collection:eE((T,E,B)=>Ak(T,E.shared.providers,B)),alertbanner:eE((T,E)=>((T,E)=>{let B=Qf(T.icon,E.icons);return m0.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in",`tox-notification--${T.level}`]},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:T.url?void 0:B},components:T.url?[iW.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:B,attributes:{title:E.translate(T.iconTooltip)}},action:E=>Rr(E,gn,{name:"alert-banner",value:T.url}),buttonBehaviours:Tl([eb()])})]:void 0},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:E.translate(T.text)}}]})})(T,E.shared.providers)),input:eE((T,E,B)=>{var M;return M=E.shared.providers,$_({name:T.name,multiline:!1,label:T.label,inputMode:T.inputMode,placeholder:T.placeholder,flex:!1,disabled:!T.enabled,classname:"tox-textfield",validation:A.none(),maximized:T.maximized,data:B},M)}),textarea:eE((T,E,B)=>{var M;return M=E.shared.providers,$_({name:T.name,multiline:!0,label:T.label,inputMode:A.none(),placeholder:T.placeholder,flex:!0,disabled:!T.enabled,classname:"tox-textarea",validation:A.none(),maximized:T.maximized,data:B},M)}),label:eE((T,E)=>((T,E)=>{let B="tox-label";return{dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"label",classes:[B,..."center"===T.align?[`${B}--center`]:[],..."end"===T.align?[`${B}--end`]:[]]},components:[ri(E.providers.translate(T.label))]},...L(T.items,E.interpreter)],behaviours:Tl([HO(),sQ.config({}),GO(A.none(),ta,oa),sZ.config({mode:"acyclic"})])}})(T,E.shared)),iframe:(h3=(T,E,B)=>((T,E,B)=>{let M="tox-dialog__iframe",D=T.transparent?[]:[`${M}--opaque`],er=T.border?["tox-navobj-bordered"]:[],ea={...T.label.map(T=>({title:T})).getOr({}),...B.map(T=>({srcdoc:T})).getOr({}),...T.sandboxed?{sandbox:"allow-scripts allow-same-origin"}:{}},es=((T,E)=>{let B=As(T.getOr(""));return{getValue:T=>B.get(),setValue:(T,M)=>{if(B.get()!==M){let B=T.element,s=()=>Ct(B,"srcdoc",M);E?pY.fold(x(b_),T=>T.throttle)(B,M,s):s()}B.set(M)}}})(B,T.streamContent),eu=T.label.map(T=>yk(T,E)),eg=m3.parts.field({factory:{sketch:T=>e_(A.from(er),{uid:T.uid,dom:{tag:"iframe",attributes:ea,classes:[M,...D]},behaviours:Tl([m6.config({}),s3.config({}),jO(B,es.getValue,es.setValue),n0.config({channels:{[pz]:{onReceive:(T,E)=>{E.newFocus.each(E=>{at(T.element).each(B=>{(Qe(T.element,E)?Wa:Ga)(B,"tox-navobj-bordered-focus")})})}}}})])})}});return fk(eu,eg,["tox-form__group--stretched"],[])})(T,E.shared.providers,B),(T,E,B,M)=>{let D=tM(E,{source:"dynamic"});return eE(h3)(T,D,B,M)}),button:eE((T,E)=>((T,E)=>{let B=HT(T.name,"custom");return fk(A.none(),m3.parts.field({factory:iW,...zT(T,A.some(B),E,[$O(""),HO()])}),[],[])})(T,E.shared.providers)),checkbox:eE((T,E,B)=>((T,E,B)=>{let n=T=>(T.element.dom.click(),A.some(!0)),M=m3.parts.field({factory:{sketch:w},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:Tl([HO(),aj.config({disabled:()=>!T.enabled||E.isDisabled(),onDisabled:T=>{at(T.element).each(T=>Wa(T,"tox-checkbox--disabled"))},onEnabled:T=>{at(T.element).each(T=>Ga(T,"tox-checkbox--disabled"))}}),m6.config({}),s3.config({}),GO(B,QT,ZT),sZ.config({mode:"special",onEnter:n,onSpace:n,stopSpaceKeyup:!0}),th("checkbox-events",[Wr(t9(),(E,B)=>{Rr(E,m8,{name:T.name})})])])}),D=m3.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"]},components:[ri(E.translate(T.label))],behaviours:Tl([gS.config({})])}),a=T=>ob("checked"===T?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+T]},E.icons),er=Xh({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[a("checked"),a("unchecked")]});return m3.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[M,er.asSpec(),D],fieldBehaviours:Tl([aj.config({disabled:()=>!T.enabled||E.isDisabled()}),Ox()])})})(T,E.shared.providers,B)),colorinput:eE((T,E,B)=>((T,E,B,M)=>{var D;let er=m3.parts.field({factory:dR,inputClasses:["tox-textfield"],data:M,onSetValue:T=>gy.run(T).get(b),inputBehaviours:Tl([aj.config({disabled:E.providers.isDisabled}),Ox(),m6.config({}),gy.config({invalidClass:"tox-textbox-field-invalid",getRoot:T=>at(T.element),notify:{onValid:T=>{let E=r2.getValue(T);Rr(T,gT,{color:E})}},validator:{validateOnLoad:!1,validate:T=>{let E=r2.getValue(T);if(0===E.length)return SS(tE.value(!0));{let T=Ne("span");Bt(T,"background-color",E);let B=Vt(T,"background-color").fold(()=>tE.error("blah"),T=>tE.value(E));return SS(B)}}}})]),selectOnFocus:!1}),ea=T.label.map(T=>yk(T,E.providers)),a=(T,E)=>{Rr(T,gk,{value:E})},es=Xh((D={dom:{tag:"span",attributes:{"aria-label":E.providers.translate("Color swatch")}},layouts:{onRtl:()=>[cl,ll,gl],onLtr:()=>[ll,cl,gl]},components:[],fetch:Xw(B.getColors(T.storageKey),T.storageKey,B.hasCustomColors()),columns:B.getColorCols(T.storageKey),presets:"color",onItemAction:(E,M)=>{es.getOpt(E).each(E=>{"custom"===M?B.colorPicker(B=>{B.fold(()=>Fr(E,gO),B=>{a(E,B),Ew(T.storageKey,B)})},"#ffffff"):a(E,"remove"===M?"":M)})}},mZ.sketch({dom:D.dom,components:D.components,toggleClass:"mce-active",dropdownBehaviours:Tl([_x(E.providers.isDisabled),Ox(),gS.config({}),m6.config({})]),layouts:D.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:E.getSink,fetch:T=>wS(T=>D.fetch(T)).map(B=>A.from(jS(tM(nS(ca("menu-value"),B,E=>{D.onItemAction(T,E)},D.columns,D.presets,c8.CLOSE_ON_EXECUTE,eg,E.providers),{movement:rS(D.columns,D.presets)})))),parts:{menu:Rv(0,0,D.presets)}})));return m3.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:ea.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[er,es.asSpec()]}]),fieldBehaviours:Tl([th("form-field-events",[Wr(gT,(E,B)=>{es.getOpt(E).each(T=>{Bt(T.element,"background-color",B.event.color)}),Rr(E,m8,{name:T.name})}),Wr(gk,(T,E)=>{m3.getField(T).each(B=>{r2.setValue(B,E.event.value),az.getCurrent(T).each(s3.focus)})}),Wr(gO,(T,E)=>{m3.getField(T).each(E=>{az.getCurrent(T).each(s3.focus)})})])])})})(T,E.shared,E.colorinput,B)),colorpicker:eE((T,B,M)=>((T,B,M)=>{let n=T=>"tox-"+T,D=LO(T=>E(T)?B.translate(pO[T]):B.translate(T),n),er=Xh(D.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:T=>{Rr(T,gn,{name:"hex-valid",value:!0})},onInvalidHex:T=>{Rr(T,gn,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[er.asSpec()],behaviours:Tl([jO(M,T=>{let E=er.get(T);return az.getCurrent(E).bind(T=>r2.getValue(T).hex).map(T=>"#"+_e(T,"#")).getOr("")},(T,E)=>{let B=A.from(/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(E)).bind(T=>te(T,1)),M=er.get(T);az.getCurrent(M).fold(()=>{console.log("Can not find form")},T=>{r2.setValue(T,{hex:B.getOr("")}),pb.getField(T,"hex").each(T=>{Fr(T,t5())})})}),HO()])}})(0,B.shared.providers,M)),dropzone:eE((T,E,B)=>((T,E,B)=>{let n=(T,E)=>{E.stop()},s=T=>(E,B)=>{H(T,T=>{T(E,B)})},r=(T,E)=>{var B;if(!aj.isDisabled(T)){let M=E.event.raw;i(T,null===(B=M.dataTransfer)||void 0===B?void 0:B.files)}},a=(T,E)=>{let B=E.event.raw.target;i(T,B.files)},i=(B,M)=>{M&&(r2.setValue(B,((T,E)=>{let B=pB.explode(E.getOption("images_file_types"));return U(eC(T),T=>N(B,E=>Ae(T.name.toLowerCase(),`.${E.toLowerCase()}`)))})(M,E)),Rr(B,m8,{name:T.name}))},M=Xh({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:Tl([th("input-file-events",[Yr(t6()),Yr(ok())])])}),D=T.label.map(T=>yk(T,E)),er=m3.parts.field({factory:{sketch:T=>({uid:T.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:Tl([$O(B.getOr([])),HO(),aj.config({}),s4.config({toggleClass:"dragenter",toggleOnExecute:!1}),th("dropzone-events",[Wr("dragenter",s([n,s4.toggle])),Wr("dragleave",s([n,s4.toggle])),Wr("dragover",n),Wr("drop",s([n,r])),Wr(t9(),a)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p"},components:[ri(E.translate("Drop an image here"))]},iW.sketch({dom:{tag:"button",styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[ri(E.translate("Browse for an image")),M.asSpec()],action:T=>{M.get(T).element.dom.click()},buttonBehaviours:Tl([m6.config({}),_x(E.isDisabled),Ox()])})]}]})}});return fk(D,er,["tox-form__group--stretched"],[])})(T,E.shared.providers,B)),grid:eE((T,E)=>{var B;return B=E.shared,{dom:{tag:"div",classes:["tox-form__grid",`tox-form__grid--${T.columns}col`]},components:L(T.items,B.interpreter)}}),listbox:eE((T,E,B)=>((T,E,B)=>{let M=E.shared.providers,D=B.bind(E=>V_(T.items,E)).orThunk(()=>oe(T.items).filter(F_)),er=T.label.map(T=>yk(T,M)),ea=m3.parts.field({dom:{},factory:{sketch:B=>A_({uid:B.uid,text:D.map(T=>T.text),icon:A.none(),tooltip:T.label,role:A.none(),fetch:(B,M)=>{let D=N_(B,T.name,T.items,r2.getValue(B));M(I_(D,c8.CLOSE_ON_EXECUTE,E,{isHorizontalMenu:!1,search:A.none()}))},onSetup:x(b),getApi:x({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[m6.config({}),jO(D.map(T=>T.value),T=>_t(T.element,p0),(E,B)=>{V_(T.items,B).each(T=>{Ct(E.element,p0,T.value),Rr(E,pZ,{text:T.text})})})]},"tox-listbox",E.shared)}});return m3.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:q([er.toArray(),[{dom:{tag:"div",classes:["tox-listboxfield"]},components:[ea]}]]),fieldBehaviours:Tl([aj.config({disabled:x(!T.enabled),onDisabled:T=>{m3.getField(T).each(aj.disable)},onEnabled:T=>{m3.getField(T).each(aj.enable)}})])})})(T,E,B)),selectbox:eE((T,E,B)=>((T,E,B)=>{let M=L(T.items,T=>({text:E.translate(T.text),value:T.value})),D=T.label.map(T=>yk(T,E)),er=m3.parts.field({dom:{},...B.map(T=>({data:T})).getOr({}),selectAttributes:{size:T.size},options:M,factory:p1,selectBehaviours:Tl([aj.config({disabled:()=>!T.enabled||E.isDisabled()}),m6.config({}),th("selectbox-change",[Wr(t9(),(E,B)=>{Rr(E,m8,{name:T.name})})])])}),ea=T.size>1?A.none():A.some(ob("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},E.icons)),es={dom:{tag:"div",classes:["tox-selectfield"]},components:q([[er],ea.toArray()])};return m3.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:q([D.toArray(),[es]]),fieldBehaviours:Tl([aj.config({disabled:()=>!T.enabled||E.isDisabled(),onDisabled:T=>{m3.getField(T).each(aj.disable)},onEnabled:T=>{m3.getField(T).each(aj.enable)}}),Ox()])})})(T,E.shared.providers,B)),sizeinput:eE((T,E)=>((T,E)=>{let B=G_,M=ca("ratio-event"),s=T=>ob(T,{tag:"span",classes:["tox-icon","tox-lock-icon__"+T]},E.icons),D=p5.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:E.translate(T.label.getOr("Constrain proportions"))}},components:[s("lock"),s("unlock")],buttonBehaviours:Tl([aj.config({disabled:()=>!T.enabled||E.isDisabled()}),Ox(),m6.config({})])}),a=T=>({dom:{tag:"div",classes:["tox-form__group"]},components:T}),i=B=>m3.parts.field({factory:dR,inputClasses:["tox-textfield"],inputBehaviours:Tl([aj.config({disabled:()=>!T.enabled||E.isDisabled()}),Ox(),m6.config({}),th("size-input-events",[Wr(t0(),(T,E)=>{Rr(T,M,{isField1:B})}),Wr(t9(),(E,B)=>{Rr(E,m8,{name:T.name})})])]),selectOnFocus:!1}),l=T=>({dom:{tag:"label",classes:["tox-label"]},components:[ri(E.translate(T))]}),er=p5.parts.field1(a([m3.parts.label(l("Width")),i(!0)])),ea=p5.parts.field2(a([m3.parts.label(l("Height")),i(!1)]));return p5.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[er,ea,a([l("\xa0"),D])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:(T,E,M)=>{W_(r2.getValue(T)).each(T=>{B(T).each(T=>{r2.setValue(E,(T=>{var E;let B={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},M=T.value.toFixed((E=T.unit)in B?B[E]:1);return -1!==M.indexOf(".")&&(M=M.replace(/\.?0*$/,"")),M+T.unit})(T))})})},coupledFieldBehaviours:Tl([aj.config({disabled:()=>!T.enabled||E.isDisabled(),onDisabled:T=>{p5.getField1(T).bind(m3.getField).each(aj.disable),p5.getField2(T).bind(m3.getField).each(aj.disable),p5.getLock(T).each(aj.disable)},onEnabled:T=>{p5.getField1(T).bind(m3.getField).each(aj.enable),p5.getField2(T).bind(m3.getField).each(aj.enable),p5.getLock(T).each(aj.enable)}}),Ox(),th("size-input-events2",[Wr(M,(T,E)=>{let M=E.event.isField1,D=M?p5.getField1(T):p5.getField2(T),er=M?p5.getField2(T):p5.getField1(T),ea=D.map(r2.getValue).getOr(""),es=er.map(r2.getValue).getOr("");B=((T,E)=>{let B=W_(T).toOptional(),M=W_(E).toOptional();return Se(B,M,(T,E)=>j_(T,E.unit).map(T=>E.value/T).map(T=>{var B;return B=E.unit,E=>j_(E,B).map(E=>({value:E*T,unit:B}))}).getOr(G_)).getOr(G_)})(ea,es)})])])})})(T,E.shared.providers)),slider:eE((T,E,B)=>((T,E,B)=>{let M=po.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[ri(E.translate(T.label))]}),D=po.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),er=po.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return po.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:T.min,maxX:T.max,getInitialValue:x(B.getOrThunk(()=>(Math.abs(T.max)-Math.abs(T.min))/2))},components:[M,D,er],sliderBehaviours:Tl([HO(),s3.config({})]),onChoose:(E,B,M)=>{Rr(E,m8,{name:T.name,value:M})}})})(T,E.shared.providers,B)),urlinput:eE((T,E,B)=>((T,E,B,M)=>{let D=E.shared.providers,r=E=>{let M=r2.getValue(E);B.addToHistory(M.value,T.filetype)},er={...M.map(T=>({initialData:T})).getOr({}),dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":hO,type:"url"},minChars:0,responseTime:0,fetch:M=>{let D=((T,E,B)=>{var M,D;let er=r2.getValue(E),ea=null!==(D=null===(M=null==er?void 0:er.meta)||void 0===M?void 0:M.text)&&void 0!==D?D:er.value;return B.getLinkInformation().fold(()=>[],E=>{let M=KT(ea,L(B.getHistory(T),T=>jT(T,T)));return"file"===T?j([M,KT(ea,$T(E)),KT(ea,q([YT(E),qT(E),XT(E)]))],(T,E)=>0===T.length||0===E.length?T.concat(E):T.concat(hk,E),[]):M})})(T.filetype,M,B),er=I_(D,c8.BUBBLE_TO_SANDBOX,E,{isHorizontalMenu:!1,search:A.none()});return SS(er)},getHotspot:T=>ef.getOpt(T),onSetValue:(T,E)=>{T.hasConfigured(gy)&&gy.run(T).get(b)},typeaheadBehaviours:Tl([...B.getValidationHandler().map(E=>gy.config({getRoot:T=>at(T.element),invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:(T,E)=>{eu.getOpt(T).each(T=>{Ct(T.element,"title",D.translate(E))})}},validator:{validate:B=>{let M=r2.getValue(B);return FT(B=>{E({type:T.filetype,url:M.value},T=>{if("invalid"===T.status){let E=tE.error(T.message);B(E)}else{let E=tE.value(T.message);B(E)}})})},validateOnLoad:!1}})).toArray(),aj.config({disabled:()=>!T.enabled||D.isDisabled()}),m6.config({}),th("urlinput-events",[Wr(t5(),E=>{let B=Ka(E.element),M=B.trim();M!==B&&Ja(E.element,M),"file"===T.filetype&&Rr(E,m8,{name:T.name})}),Wr(t9(),E=>{Rr(E,m8,{name:T.name}),r(E)}),Wr(og(),E=>{Rr(E,m8,{name:T.name}),r(E)})])]),eventOrder:{[t5()]:["streaming","urlinput-events","invalidating"]},model:{getDisplayText:T=>T.value,selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:E.shared.getSink,parts:{menu:Rv(0,0,"normal")},onExecute:(T,E,B)=>{Rr(E,gr,{})},onItemExecute:(E,B,M,D)=>{r(E),Rr(E,m8,{name:T.name})}},ea=m3.parts.field({...er,factory:hT}),es=T.label.map(T=>yk(T,D)),eu=Xh(((T,E,B=T,M=T)=>ob(B,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+T],attributes:{title:D.translate(M),"aria-live":"polite",...E.fold(()=>({}),T=>({id:T}))}},D.icons))("invalid",A.some(hO),"warning")),eg=Xh({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[eu.asSpec()]}),ep=B.getUrlPicker(T.filetype),eh=ca("browser.url.event"),ef=Xh({dom:{tag:"div",classes:["tox-control-wrap"]},components:[ea,eg.asSpec()],behaviours:Tl([aj.config({disabled:()=>!T.enabled||D.isDisabled()})])}),ex=Xh(LT({name:T.name,icon:A.some("browse"),text:T.picker_text.or(T.label).getOr(""),enabled:T.enabled,primary:!1,buttonType:A.none(),borderless:!0},T=>Fr(T,eh),D,[],["tox-browse-url"]));return m3.sketch({dom:vk([]),components:es.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:q([[ef.asSpec()],ep.map(()=>ex.asSpec()).toArray()])}]),fieldBehaviours:Tl([aj.config({disabled:()=>!T.enabled||D.isDisabled(),onDisabled:T=>{m3.getField(T).each(aj.disable),ex.getOpt(T).each(aj.disable)},onEnabled:T=>{m3.getField(T).each(aj.enable),ex.getOpt(T).each(aj.enable)}}),Ox(),th("url-input-events",[Wr(eh,E=>{az.getCurrent(E).each(B=>{let M=r2.getValue(B),D={fieldname:T.name,...M};ep.each(M=>{M(D).get(M=>{r2.setValue(B,M),Rr(E,m8,{name:T.name})})})})})])])})})(T,E,E.urlinput,B)),customeditor:eE(T=>{let E=nc(),B=Xh({dom:{tag:T.tag}}),M=nc();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:Tl([th("custom-editor-events",[oZ(D=>{B.getOpt(D).each(B=>{(ve(T,"init")?T.init(B.element.dom):p_.load(T.scriptId,T.scriptUrl).then(E=>E(B.element.dom,T.settings))).then(T=>{M.on(E=>{T.setValue(E)}),M.clear(),E.set(T)})})})]),jO(A.none(),()=>E.get().fold(()=>M.get().getOr(""),T=>T.getValue()),(T,B)=>{E.get().fold(()=>M.set(B),T=>T.setValue(B))}),HO()]),components:[B.asSpec()]}}),htmlpanel:eE(T=>"presentation"===T.presets?m0.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:T.html}}):m0.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:T.html,attributes:{role:"document"}},containerBehaviours:Tl([m6.config({}),s3.config({})])})),imagepreview:eE((T,E,B)=>((T,E)=>{let B=As(E.getOr({url:""})),M=Xh({dom:{tag:"img",classes:["tox-imagepreview__image"],attributes:E.map(T=>({src:T.url})).getOr({})}}),D=Xh({dom:{tag:"div",classes:["tox-imagepreview__container"],attributes:{role:"presentation"}},components:[M.asSpec()]}),er={};T.height.each(T=>er.height=T);let es=E.map(T=>({url:T.url,zoom:A.from(T.zoom),cachedWidth:A.from(T.cachedWidth),cachedHeight:A.from(T.cachedHeight)}));return{dom:{tag:"div",classes:["tox-imagepreview"],styles:er,attributes:{role:"presentation"}},components:[D.asSpec()],behaviours:Tl([HO(),jO(es,()=>B.get(),(T,E)=>{let er={url:E.url};E.zoom.each(T=>er.zoom=T),E.cachedWidth.each(T=>er.cachedWidth=T),E.cachedHeight.each(T=>er.cachedHeight=T),B.set(er);let a=()=>{let{cachedWidth:E,cachedHeight:B,zoom:M}=er;if(!ea(E)&&!ea(B)){if(ea(M)){let M=((T,E,B)=>{let M=Zt(T),D=jt(T);return Math.min(M/E,D/B,1)})(T.element,E,B);er.zoom=M}let es=((T,E,B,M,D)=>{let er=B*D,ea=M*D;return{left:Math.max(0,T/2-er/2).toString()+"px",top:Math.max(0,E/2-ea/2).toString()+"px",width:er.toString()+"px",height:ea.toString()+"px"}})(Zt(T.element),jt(T.element),E,B,er.zoom);D.getOpt(T).each(T=>{It(T.element,es)})}};M.getOpt(T).each(B=>{let M=B.element;E.url!==_t(M,"src")&&(Ct(M,"src",E.url),Ga(T.element,"tox-imagepreview__loaded")),a(),new Promise((T,E)=>{let o=()=>{r(),T(M)},B=[rc(M,"load",o),rc(M,"error",()=>{r(),E("Unable to load data from image: "+M.dom.src)})],r=()=>H(B,T=>T.unbind());M.dom.complete&&o()}).then(E=>{T.getSystem().isConnected()&&(Wa(T.element,"tox-imagepreview__loaded"),er.cachedWidth=E.dom.naturalWidth,er.cachedHeight=E.dom.naturalHeight,a())})})})])}})(T,B)),table:eE((T,E)=>((T,E)=>{let o=T=>({dom:{tag:"td",innerHtml:E.translate(T)}});return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:L(T.header,T=>({dom:{tag:"th",innerHtml:E.translate(T)}}))}]},{dom:{tag:"tbody"},components:L(T.cells,T=>({dom:{tag:"tr"},components:L(T,o)}))}],behaviours:Tl([m6.config({}),s3.config({})])}})(T,E.shared.providers)),tree:eE((T,E)=>((T,E)=>{let B=T.onLeafAction.getOr(b),M=T.onToggleExpand.getOr(b),D=T.defaultExpandedIds,er=As(D),ea=As(T.defaultSelectedId),es=ca("tree-id"),l=(M,D)=>T.items.map(T=>"leaf"===T.type?pT({leaf:T,selectedId:M,onLeafAction:B,visible:!0,treeId:es,backstage:E}):yT({directory:T,selectedId:M,onLeafAction:B,expandedIds:D,labelTabstopping:!0,treeId:es,backstage:E}));return{dom:{tag:"div",classes:["tox-tree"],attributes:{role:"tree"}},components:l(ea.get(),er.get()),behaviours:Tl([sZ.config({mode:"flow",selector:".tox-tree--leaf__label--visible, .tox-tree--directory__label--visible",cycles:!1}),th(hr,[Wr("expand-tree-node",(T,E)=>{let{expanded:B,node:D}=E.event;er.set(B?[...er.get(),D]:er.get().filter(T=>T!==D)),M(er.get(),{expanded:B,node:D})})]),n0.config({channels:{[`update-active-item-${es}`]:{onReceive:(T,E)=>{ea.set(A.some(E.value)),sQ.set(T,l(A.some(E.value),er.get()))}}}}),sQ.config({})])}})(T,E)),panel:eE((T,E)=>({dom:{tag:"div",classes:T.classes},components:L(T.items,E.shared.interpreter)}))},hF={field:(T,E)=>E,record:x([])},nE=(T,E,B,M)=>{let D=tM(M,{shared:{interpreter:E=>sE(T,E,B,D)}});return sE(T,E,B,D)},sE=(T,E,B,M)=>be(hB,E.type).fold(()=>(console.error(`Unknown factory type "${E.type}", defaulting to container: `,E),E),D=>D(T,E,B,M)),rE=(T,E,B)=>sE(hF,T,E,B),hR="layout-inset",iE=T=>T.x,lE=(T,E)=>T.x+T.width/2-E.width/2,cE=(T,E)=>T.x+T.width-E.width,dE=T=>T.y,uE=(T,E)=>T.y+T.height-E.height,mE=(T,E)=>T.y+T.height/2-E.height/2,gE=(T,E,B)=>Ui(cE(T,E),uE(T,E),B.insetSouthwest(),nU(),"southwest",el(T,{right:0,bottom:3}),hR),pE=(T,E,B)=>Ui(iE(T),uE(T,E),B.insetSoutheast(),nP(),"southeast",el(T,{left:1,bottom:3}),hR),hE=(T,E,B)=>Ui(cE(T,E),dE(T),B.insetNorthwest(),nz(),"northwest",el(T,{right:0,top:2}),hR),fE=(T,E,B)=>Ui(iE(T),dE(T),B.insetNortheast(),nW(),"northeast",el(T,{left:1,top:2}),hR),bE=(T,E,B)=>Ui(lE(T,E),dE(T),B.insetNorth(),nG(),"north",el(T,{top:2}),hR),vE=(T,E,B)=>Ui(lE(T,E),uE(T,E),B.insetSouth(),n$(),"south",el(T,{bottom:3}),hR),yE=(T,E,B)=>Ui(cE(T,E),mE(T,E),B.insetEast(),nY(),"east",el(T,{right:0}),hR),xE=(T,E,B)=>Ui(iE(T),mE(T,E),B.insetWest(),nj(),"west",el(T,{left:1}),hR),wE=T=>{switch(T){case"north":return bE;case"northeast":return fE;case"northwest":return hE;case"south":return vE;case"southeast":return pE;case"southwest":return gE;case"east":return yE;case"west":return xE}},SE=(T,E,B,M,D)=>Zl(M).map(wE).getOr(bE)(T,E,B,M,D),kE=T=>{switch(T){case"north":return vE;case"northeast":return pE;case"northwest":return gE;case"south":return bE;case"southeast":return fE;case"southwest":return hE;case"east":return xE;case"west":return yE}},CE=(T,E,B,M,D)=>Zl(M).map(kE).getOr(bE)(T,E,B,M,D),hL={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},_E=(T,E,B)=>{let M={maxHeightFunction:ro()};return()=>B()?{type:"node",root:bt(eU(T())),node:A.from(T()),bubble:bc(12,12,hL),layouts:{onRtl:()=>[fE],onLtr:()=>[hE]},overrides:M}:{type:"hotspot",hotspot:E(),bubble:bc(-12,12,hL),layouts:{onRtl:()=>[ll,cl,gl],onLtr:()=>[cl,ll,gl]},overrides:M}},TE=(T,E,B,M)=>{let D={maxHeightFunction:ro()};return()=>M()?{type:"node",root:bt(eU(E())),node:A.from(E()),bubble:bc(12,12,hL),layouts:{onRtl:()=>[bE],onLtr:()=>[bE]},overrides:D}:T?{type:"node",root:bt(eU(E())),node:A.from(E()),bubble:bc(0,-Gt(E()),hL),layouts:{onRtl:()=>[ml],onLtr:()=>[ml]},overrides:D}:{type:"hotspot",hotspot:B(),bubble:bc(0,0,hL),layouts:{onRtl:()=>[ml],onLtr:()=>[ml]},overrides:D}},EE=(T,E,B)=>()=>B()?{type:"node",root:bt(eU(T())),node:A.from(T()),layouts:{onRtl:()=>[bE],onLtr:()=>[bE]}}:{type:"hotspot",hotspot:E(),layouts:{onRtl:()=>[gl],onLtr:()=>[gl]}},AE=(T,E)=>()=>({type:"selection",root:E(),getSelection:()=>{let E=T.selection.getRng(),B=T.model.table.getSelectedCells();if(B.length>1){let T=B[0],E=B[B.length-1],M={firstCell:Fe(T),lastCell:Fe(E)};return A.some(M)}return A.some(r_.range(Fe(E.startContainer),E.startOffset,Fe(E.endContainer),E.endOffset))}}),ME=T=>E=>({type:"node",root:T(),node:E}),DE=(T,E,B,M)=>{let D=iv(T),r=()=>Fe(T.getBody()),a=()=>Fe(T.getContentAreaContainer()),i=()=>D||!M();return{inlineDialog:_E(a,E,i),inlineBottomDialog:TE(T.inline,a,B,i),banner:EE(a,E,i),cursor:AE(T,r),node:ME(r)}},BE=T=>(E,B)=>{oS(T)(E,B)},IE=T=>()=>mR(T),FE=T=>E=>zw(T,E),RE=T=>E=>Pw(T,E),NE=T=>()=>cK(T),VE=T=>ye(T,"items"),zE=T=>ye(T,"format"),hH=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],HE=T=>j(T,(T,B)=>{if(ve(B,"items")){let E=HE(B.items);return{customFormats:T.customFormats.concat(E.customFormats),formats:T.formats.concat([{title:B.title,items:E.formats}])}}if(ve(B,"inline")||ve(B,"block")||ve(B,"selector")){let M=`custom-${E(B.name)?B.name:B.title.toLowerCase()}`;return{customFormats:T.customFormats.concat([{name:M,format:B}]),formats:T.formats.concat([{title:B.title,format:M,icon:B.icon}])}}return{...T,formats:T.formats.concat(B)}},{customFormats:[],formats:[]}),PE=T=>cx(T).map(E=>{let B=((T,E)=>{let B=HE(E),n=E=>{H(E,E=>{T.formatter.has(E.name)||T.formatter.register(E.name,E.format)})};return T.formatter?n(B.customFormats):T.on("init",()=>{n(B.customFormats)}),B.formats})(T,E);return cy(T)?hH.concat(B):B}).getOr(hH),UE=(T,E,B)=>({...T,type:"formatter",isSelected:E(T.format),getStylePreview:B(T.format)}),WE=(T,B,M,D)=>{let s=B=>L(B,B=>VE(B)?(T=>{let E=s(T.items);return{...T,type:"submenu",getStyleItems:x(E)}})(B):zE(B)?UE(B,M,D):(T=>{let E=eO(T);return 1===E.length&&R(E,"title")})(B)?{...B,type:"separator"}:(B=>{let er=E(B.name)?B.name:ca(B.title),ea=`custom-${er}`,es={...B,type:"formatter",format:ea,isSelected:M(ea),getStylePreview:D(ea)};return T.formatter.register(er,es),es})(B));return s(B)},hN=pB.trim,GE=T=>E=>!!g(E)&&1===E.nodeType&&(E.contentEditable===T||E.getAttribute("data-mce-contenteditable")===T),hW=GE("true"),hz=GE("false"),YE=(T,E,B,M,D)=>({type:T,title:E,url:B,level:M,attach:D}),XE=T=>T.innerText||T.textContent,KE=T=>T&&"A"===T.nodeName&&void 0!==(T.id||T.name)&&ZE(T),JE=T=>T&&/^(H[1-6])$/.test(T.nodeName),ZE=T=>(T=>{let E=T;for(;E=E.parentNode;){let T=E.contentEditable;if(T&&"inherit"!==T)return hW(E)}return!1})(T)&&!hz(T),QE=T=>JE(T)&&ZE(T),eA=T=>{var E;let B=T.id?T.id:ca("h");return YE("header",null!==(E=XE(T))&&void 0!==E?E:"","#"+B,JE(T)?parseInt(T.nodeName.substr(1),10):0,()=>{T.id=B})},tA=T=>{let E=T.id||T.name,B=XE(T);return YE("anchor",B||"#"+E,"#"+E,0,b)},oA=T=>hN(T.title).length>0,nA=T=>{let E=(T=>{let E=L(Zc(Fe(T),"h1,h2,h3,h4,h5,h6,a:not([href])"),T=>T.dom);return E})(T);return U(L(U(E,QE),eA).concat(L(U(E,KE),tA)),oA)},hP="tinymce-url-history",rA=T=>E(T)&&/^https?/.test(T),aA=T=>B(T)&&he(T,T=>!(M(T)&&T.length<=5&&X(T,rA))).isNone(),iA=()=>{let T;let E=my.getItem(hP);if(null===E)return{};try{T=JSON.parse(E)}catch(T){if(T instanceof SyntaxError)return console.log("Local storage "+hP+" was not valid JSON",T),{};throw T}return aA(T)?T:(console.log("Local storage "+hP+" was not valid format",T),{})},lA=T=>{let E=iA();return be(E,T).getOr([])},cA=(T,E)=>{if(!rA(T))return;let B=iA(),M=be(B,E).getOr([]),D=U(M,E=>E!==T);B[E]=[T].concat(D).slice(0,5),(T=>{if(!aA(T))throw Error("Bad format for history:\n"+JSON.stringify(T));my.setItem(hP,JSON.stringify(T))})(B)},dA=T=>!!T,uA=T=>ce(pB.makeMap(T,/[, ]/),dA),mA=T=>A.from(cU(T)),gA=T=>A.from(T).filter(E).getOrUndefined(),pA=T=>({getHistory:lA,addToHistory:cA,getLinkInformation:()=>cY(T)?A.some({targets:nA(T.getBody()),anchorTop:gA(cX(T)),anchorBottom:gA(cq(T))}):A.none(),getValidationHandler:()=>A.from(cG(T)),getUrlPicker:M=>((T,E)=>{let B=(T=>{let E=A.from(cj(T)).filter(dA).map(uA);return mA(T).fold(eg,T=>E.fold(ep,T=>eO(T).length>0&&T))})(T);return er(B)?B?mA(T):A.none():B[E]?mA(T):A.none()})(T,M).map(D=>er=>wS(ea=>{let es={filetype:M,fieldname:er.fieldname,...A.from(er.meta).getOr({})};D.call(T,(T,M)=>{if(!E(T))throw Error("Expected value to be string");if(void 0!==M&&!B(M))throw Error("Expected meta to be a object");ea({value:T,meta:M})},er.value,es)}))}),hU=x([xs("shell",!1),ns("makeItem"),xs("setupItem",b),yu("listBehaviours",[sQ])]),hG=aE({name:"items",overrides:()=>({behaviours:Tl([sQ.config({})])})}),h$=x([hG]),hj=wm({name:x("CustomList")(),configFields:hU(),partFields:h$(),factory:(T,E,B,M)=>{let D=T.shell?{behaviours:[sQ.config({})],components:[]}:{behaviours:[],components:E};return{uid:T.uid,dom:T.dom,components:D.components,behaviours:wu(T.listBehaviours,D.behaviours),apis:{setItems:(E,B)=>{(T.shell?A.some(E):am(E,T,"items")).fold(()=>{throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),Error("Custom List was defined to not be a shell, but no item container was specified in components")},M=>{let D=sQ.contents(M),er=B.length,ea=er-D.length,es=ea>0?V(ea,()=>T.makeItem()):[],eu=D.slice(er);H(eu,T=>sQ.remove(M,T)),H(es,T=>sQ.append(M,T));let eg=sQ.contents(M);H(eg,(M,D)=>{T.setupItem(E,M,B[D],D)})})}}}},apis:{setItems:(T,E,B)=>{T.setItems(E,B)}}}),hY=x([ns("dom"),xs("shell",!0),yu("toolbarBehaviours",[sQ])]),hX=x([aE({name:"groups",overrides:()=>({behaviours:Tl([sQ.config({})])})})]),hq=wm({name:"Toolbar",configFields:hY(),partFields:hX(),factory:(T,E,B,M)=>{let D=T.shell?{behaviours:[sQ.config({})],components:[]}:{behaviours:[],components:E};return{uid:T.uid,dom:T.dom,components:D.components,behaviours:wu(T.toolbarBehaviours,D.behaviours),apis:{setGroups:(E,B)=>{(T.shell?A.some(E):am(E,T,"groups")).fold(()=>{throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},T=>{sQ.set(T,B)})},refresh:b},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(T,E,B)=>{T.setGroups(E,B)}}}),hK=x([]);var hZ,hJ,hQ,h0,h1,h2,h3,h5=Object.freeze({__proto__:null,setup:b,isDocked:eg,getBehaviours:hK});let AA=T=>(xe(Vt(T,"position"),"fixed")?A.none():it(T)).orThunk(()=>{let E=Ne("span");return rt(T).bind(T=>{Lo(T,E);let B=it(E);return Uo(E),B})}),MA=T=>AA(T).map(Xt).getOrThunk(()=>$t(0,0)),DA=(T,E)=>{let B=T.element;Wa(B,E.transitionClass),Ga(B,E.fadeOutClass),Wa(B,E.fadeInClass),E.onShow(T)},BA=(T,E)=>{let B=T.element;Wa(B,E.transitionClass),Ga(B,E.fadeInClass),Wa(B,E.fadeOutClass),E.onHide(T)},IA=(T,E)=>T.y>=E.y,FA=(T,E)=>T.bottom<=E.bottom,RA=(T,E,B)=>({location:"top",leftX:E,topY:B.bounds.y-T.y}),NA=(T,E,B)=>({location:"bottom",leftX:E,bottomY:T.bottom-B.bounds.bottom}),VA=T=>T.box.x-T.win.x,zA=(T,E,B)=>B.getInitialPos().map(B=>{let M=((T,E)=>{let B=E.optScrollEnv.fold(x(T.bounds.y),E=>E.scrollElmTop+(T.bounds.y-E.currentScrollTop));return $t(T.bounds.x,B)})(B,E);return{box:Jo(M.left,M.top,Zt(T),jt(T)),location:B.location}}),LA=(T,E,B,M,D)=>{let er=((T,E)=>{let B=E.optScrollEnv.fold(x(T.y),E=>T.y+E.currentScrollTop-E.scrollElmTop);return $t(T.x,B)})(E,B),ea=Jo(er.left,er.top,E.width,E.height);M.setInitialPos({style:zt(T),position:Rt(T,"position")||"static",bounds:ea,location:D.location})},HA=(T,E,B)=>B.getInitialPos().bind(M=>{var D;switch(B.clearInitialPos(),M.position){case"static":return A.some({morph:"static"});case"absolute":let er=AA(T).getOr(wt()),ea=Zo(er),es=null!==(D=er.dom.scrollTop)&&void 0!==D?D:0;return A.some({morph:"absolute",positionCss:Pl("absolute",be(M.style,"left").map(T=>E.x-ea.x),be(M.style,"top").map(T=>E.y-ea.y+es),be(M.style,"right").map(T=>ea.right-E.right),be(M.style,"bottom").map(T=>ea.bottom-E.bottom))});default:return A.none()}}),PA=T=>{switch(T.location){case"top":return A.some({morph:"fixed",positionCss:Pl("fixed",A.some(T.leftX),A.some(T.topY),A.none(),A.none())});case"bottom":return A.some({morph:"fixed",positionCss:Pl("fixed",A.some(T.leftX),A.none(),A.none(),A.some(T.bottomY))});default:return A.none()}},UA=(T,E,B)=>{let M=T.element;return xe(Vt(M,"position"),"fixed")?zA(M,E,B).filter(({box:T})=>X(B.getModes(),B=>{switch(B){case"bottom":return FA(T,E.bounds);case"top":return IA(T,E.bounds)}})).bind(({box:T})=>HA(M,T,B)).orThunk(()=>E.optScrollEnv.bind(T=>zA(M,E,B)).bind(({box:T,location:B})=>{let M=tn(),D=VA({win:M,box:T}),er="top"===B?RA(M,D,E):NA(M,D,E);return PA(er)})):((T,E,B)=>{let M=Zo(T),D=tn(),er=((T,E,B)=>{let M=E.win,D=E.box,er=VA(E);return re(T,T=>{switch(T){case"bottom":return FA(D,B.bounds)?A.none():A.some(NA(M,er,B));case"top":return IA(D,B.bounds)?A.none():A.some(RA(M,er,B));default:return A.none()}}).getOr({location:"no-dock"})})(B.getModes(),{win:D,box:M},E);return"top"===er.location||"bottom"===er.location?(LA(T,M,E,B,er),PA(er)):A.none()})(M,E,B)},WA=(T,E,B)=>{B.setDocked(!1),H(["left","right","top","bottom","position"],E=>Ht(T.element,E)),E.onUndocked(T)},jA=(T,E,B,M)=>{let D="fixed"===M.position;B.setDocked(D),Ul(T.element,M),(D?E.onDocked:E.onUndocked)(T)},GA=(T,E,B,M,D=!1)=>{E.contextual.each(E=>{E.lazyContext(T).each(er=>{var ea;let es=(ea=M.bounds,er.y<ea.bottom&&er.bottom>ea.y);es!==B.isVisible()&&(B.setVisible(es),D&&!es?(qa(T.element,[E.fadeOutClass]),E.onHide(T)):(es?DA:BA)(T,E))})})},$A=(T,E,B,M,D)=>{GA(T,E,B,M,!0),jA(T,E,B,D.positionCss)},qA=(T,E,B)=>{T.getSystem().isConnected()&&((T,E,B)=>{let M=E.lazyViewport(T);GA(T,E,B,M),UA(T,M,B).each(D=>{((T,E,B,M,D)=>{switch(D.morph){case"static":return WA(T,E,B);case"absolute":return jA(T,E,B,D.positionCss);case"fixed":$A(T,E,B,M,D)}})(T,E,B,M,D)})})(T,E,B)},YA=(T,E,B)=>{B.isDocked()&&((T,E,B)=>{let M=T.element;B.setDocked(!1);let D=E.lazyViewport(T);((T,E,B)=>{let M=T.element;return zA(M,E,B).bind(({box:T})=>HA(M,T,B))})(T,D,B).each(M=>{switch(M.morph){case"static":WA(T,E,B);break;case"absolute":jA(T,E,B,M.positionCss)}}),B.setVisible(!0),E.contextual.each(E=>{Ya(M,[E.fadeInClass,E.fadeOutClass,E.transitionClass]),E.onShow(T)}),qA(T,E,B)})(T,E,B)},XA=T=>(E,B,M)=>{let D=B.lazyViewport(E);((T,E,B,M)=>{let D=Zo(T),er=tn(),ea=M(er,VA({win:er,box:D}),E);return"bottom"===ea.location||"top"===ea.location?(((T,E,B,M,D)=>{M.getInitialPos().fold(()=>LA(T,E,B,M,D),()=>b)})(T,D,E,B,ea),PA(ea)):A.none()})(E.element,D,M,T).each(T=>{$A(E,B,M,D,T)})},h9=XA(RA),h6=XA(NA);var h4=Object.freeze({__proto__:null,refresh:qA,reset:YA,isDocked:(T,E,B)=>B.isDocked(),getModes:(T,E,B)=>B.getModes(),setModes:(T,E,B,M)=>B.setModes(M),forceDockToTop:h9,forceDockToBottom:h6}),h8=Object.freeze({__proto__:null,events:(T,E)=>Hr([Kr(t8(),(B,M)=>{T.contextual.each(T=>{$a(B.element,T.transitionClass)&&(Ya(B.element,[T.transitionClass,T.fadeInClass]),(E.isVisible()?T.onShown:T.onHidden)(B)),M.stop()})}),Wr(oH(),(B,M)=>{qA(B,T,E)}),Wr(oj(),(B,M)=>{qA(B,T,E)}),Wr(oN(),(B,M)=>{YA(B,T,E)})])}),h7=[ys("contextual",[as("fadeInClass"),as("fadeOutClass"),as("transitionClass"),ls("lazyContext"),Ri("onShow"),Ri("onShown"),Ri("onHide"),Ri("onHidden")]),_s("lazyViewport",()=>({bounds:tn(),optScrollEnv:A.none()})),Ts("modes",["top","bottom"],tW),Ri("onDocked"),Ri("onUndocked")];let ft=Al({fields:h7,name:"docking",active:h8,apis:h4,state:Object.freeze({__proto__:null,init:T=>{let E=As(!1),B=As(!0),M=nc(),D=As(T.modes);return Ta({isDocked:E.get,setDocked:E.set,getInitialPos:M.get,setInitialPos:M.set,clearInitialPos:M.clear,isVisible:B.get,setVisible:B.set,getModes:D.get,setModes:D.set,readState:()=>`docked:  ${E.get()}, visible: ${B.get()}, modes: ${D.get().join(",")}`})}})}),fr=x(ca("toolbar-height-change")),fc={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},fu="tox-tinymce--toolbar-sticky-on",ff="tox-tinymce--toolbar-sticky-off",aM=(T,E)=>R(ft.getModes(T),E),iM=T=>{let E=T.element;at(E).each(B=>{let M="padding-"+ft.getModes(T)[0];if(ft.isDocked(T)){let T=Zt(B);Bt(E,"width",T+"px"),Bt(B,M,Gt(E)+(parseInt(Rt(E,"margin-top"),10)||0)+(parseInt(Rt(E,"margin-bottom"),10)||0)+"px")}else Ht(E,"width"),Ht(B,M)})},lM=(T,E)=>{E?(Ga(T,fc.fadeOutClass),qa(T,[fc.transitionClass,fc.fadeInClass])):(Ga(T,fc.fadeInClass),qa(T,[fc.fadeOutClass,fc.transitionClass]))},cM=(T,E)=>{let B=Fe(T.getContainer());E?(Wa(B,fu),Ga(B,ff)):(Wa(B,ff),Ga(B,fu))},dM=(T,E)=>{let B=nc(),M=E.getSink,s=T=>{M().each(E=>T(E.element))},r=E=>{T.inline||iM(E),cM(T,ft.isDocked(E)),E.getSystem().broadcastOn([rj()],{}),M().each(T=>T.getSystem().broadcastOn([rj()],{}))},D=T.inline?[]:[n0.config({channels:{[fr()]:{onReceive:iM}}})];return[s3.config({}),ft.config({contextual:{lazyContext:E=>{let B=Gt(E.element),M=T.inline?T.getContentAreaContainer():T.getContainer();return A.from(M).map(M=>{let D=Zo(Fe(M));return XS(T,E.element).fold(()=>{let T=D.height-B,M=D.y+(aM(E,"top")?0:B);return Jo(D.x,M,D.width,T)},T=>{let M=en(D,KS(T)),er=aM(E,"top")?M.y:M.y+B;return Jo(M.x,er,M.width,M.height-B)})})},onShow:()=>{s(T=>lM(T,!0))},onShown:T=>{s(T=>Ya(T,[fc.transitionClass,fc.fadeInClass])),B.get().each(E=>{((T,E)=>{let B=tt(E);zl(B).filter(T=>!Qe(E,T)).filter(E=>Qe(E,Fe(B.dom.body))||et(T,E)).each(()=>Rl(E))})(T.element,E),B.clear()})},onHide:T=>{Ll(T.element).orThunk(()=>M().toOptional().bind(T=>Ll(T.element))).fold(B.clear,B.set),s(T=>lM(T,!1))},onHidden:()=>{s(T=>Ya(T,[fc.transitionClass]))},...fc},lazyViewport:E=>XS(T,E.element).fold(()=>{let B=tn(),M=cW(T),D=B.y+(aM(E,"top")?M:0),er=B.height-(aM(E,"bottom")?M:0);return{bounds:Jo(B.x,D,B.width,er),optScrollEnv:A.none()}},T=>({bounds:KS(T),optScrollEnv:A.some({currentScrollTop:T.element.dom.scrollTop,scrollElmTop:Xt(T.element).top})})),modes:[E.header.getDockingMode()],onDocked:r,onUndocked:r}),...D]};var fb=Object.freeze({__proto__:null,setup:(T,E,B)=>{T.inline||(E.header.isPositionedAtTop()||T.on("ResizeEditor",()=>{B().each(ft.reset)}),T.on("ResizeWindow ResizeEditor",()=>{B().each(iM)}),T.on("SkinLoaded",()=>{B().each(T=>{ft.isDocked(T)?ft.reset(T):ft.refresh(T)})}),T.on("FullscreenStateChanged",()=>{B().each(ft.reset)})),T.on("AfterScrollIntoView",T=>{B().each(E=>{ft.refresh(E);let B=E.element;zg(B)&&((T,E)=>{let B=tt(E),M=st(E).dom.innerHeight,D=Wo(B),er=Fe(T.elm),ea=Qo(er),es=jt(er),eu=ea.y,eg=eu+es,ep=Xt(E),eh=jt(E),ef=ep.top,ex=ef+eh,eC=2>Math.abs(ef-D.top),eO=2>Math.abs(ex-(D.top+M));if(eC&&eu<ex)jo(D.left,eu-eh,B);else if(eO&&eg>ef){let T=eu-M+es+eh;jo(D.left,T,B)}})(T,B)})}),T.on("PostRender",()=>{cM(T,!1)})},isDocked:T=>T().map(ft.isDocked).getOr(!1),getBehaviours:dM});let fv=Bn([dW,ss("items",Fn([tV([dz,us("items",tW)]),tW]))].concat(ua)),fx=[hs("text"),hs("tooltip"),hs("icon"),ws("search",!1,Fn([tz,Bn([hs("placeholder")])],T=>er(T)?T?A.some({placeholder:A.none()}):A.none():A.some(T))),ls("fetch"),_s("onSetup",()=>b)],fy=Bn([dW,...fx]),hM=T=>Yn("menubutton",fy,T),fA=Bn([dW,d1,d0,dQ,d5,dY,dZ,Cs("presets","normal",["normal","color","listpreview"]),Ty(1),dq,dK]);var fS=xm({factory:(T,E)=>{let B={focus:sZ.focusIn,setMenus:(T,B)=>{let M=L(B,T=>{let B={type:"menubutton",text:T.text,fetch:E=>{E(T.getItems())}},M=hM(B).mapError(T=>Jn(T)).getOrDie();return dT(M,"tox-mbtn",E.backstage,A.some("menuitem"))});sQ.set(T,M)}};return{uid:T.uid,dom:T.dom,components:[],behaviours:Tl([sQ.config({}),th("menubar-events",[oZ(E=>{T.onSetup(E)}),Wr(tQ(),(T,E)=>{vi(T.element,".tox-mbtn--active").each(B=>{yi(E.event.target,".tox-mbtn").each(E=>{Qe(B,E)||T.getSystem().getByDom(B).each(B=>{T.getSystem().getByDom(E).each(T=>{mZ.expand(T),mZ.close(B),s3.focus(T)})})})})}),Wr(oG(),(T,E)=>{E.event.prevFocus.bind(E=>T.getSystem().getByDom(E).toOptional()).each(B=>{E.event.newFocus.bind(E=>T.getSystem().getByDom(E).toOptional()).each(T=>{mZ.isOpen(B)&&(mZ.expand(T),mZ.close(B))})})})]),sZ.config({mode:"flow",selector:".tox-mbtn",onEscape:E=>(T.onEscape(E),A.some(!0))}),m6.config({})]),apis:B,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[ns("dom"),ns("uid"),ns("onEscape"),ns("backstage"),xs("onSetup",b)],apis:{focus:(T,E)=>{T.focus(E)},setMenus:(T,E,B)=>{T.setMenus(E,B)}}});let fF="container",fM=[yu("slotBehaviours",[])],xM=T=>"<alloy.field."+T+">",wM=(T,E)=>{let o=E=>dm(T),n=(E,B)=>(M,D)=>am(M,T,D).map(T=>E(T,D)).getOr(B),s=(T,E)=>"true"!==_t(T.element,"aria-hidden"),B=n(s,!1),M=n((T,E)=>{if(s(T)){let B=T.element;Bt(B,"display","none"),Ct(B,"aria-hidden","true"),Rr(T,o$(),{name:E,visible:!1})}}),i=(T,E)=>{H(E,E=>M(T,E))},D=n((T,E)=>{if(!s(T)){let B=T.element;Ht(B,"display"),At(B,"aria-hidden"),Rr(T,o$(),{name:E,visible:!0})}});return{uid:T.uid,dom:T.dom,components:E,behaviours:xu(T.slotBehaviours),apis:{getSlotNames:o,getSlot:(E,B)=>am(E,T,B),isShowing:B,hideSlot:M,hideAllSlots:T=>i(T,o()),showSlot:D}}},fI=ce({getSlotNames:(T,E)=>T.getSlotNames(E),getSlot:(T,E,B)=>T.getSlot(E,B),isShowing:(T,E,B)=>T.isShowing(E,B),hideSlot:(T,E,B)=>T.hideSlot(E,B),hideAllSlots:(T,E)=>T.hideAllSlots(E),showSlot:(T,E,B)=>T.showSlot(E,B)},T=>Oa(T)),fR={...fI,sketch:T=>{let E=(()=>{let T=[];return{slot:(E,B)=>(T.push(E),tm(fF,xM(E),B)),record:x(T)}})(),B=T(E),M=E.record(),D=L(M,T=>aT({name:T,pname:xM(T)}));return fm(fF,fM,D,wM,B)}},fL=Bn([d0,d1,_s("onShow",b),_s("onHide",b),dZ]),OM=T=>({element:()=>T.element.dom}),_M=(T,E)=>{let B=L(eO(E),T=>{let B=E[T],M=Xn(Yn("sidebar",fL,B));return{name:T,getApi:OM,onSetup:M.onSetup,onShow:M.onShow,onHide:M.onHide}});return L(B,E=>{let M=As(b);return T.slot(E.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:ux([Mx(E,M),Dx(E,M),Wr(o$(),(T,E)=>{let M=E.event,D=G(B,T=>T.name===M.name);D.each(E=>{(M.visible?E.onShow:E.onHide)(E.getApi(T))})})])})})},TM=T=>fR.sketch(E=>({dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:_M(E,T),slotBehaviours:ux([oZ(T=>fR.hideAllSlots(T))])})),EM=(T,E)=>{Ct(T,"role",E)},AM=T=>az.getCurrent(T).bind(T=>p8.isGrowing(T)||p8.hasGrown(T)?az.getCurrent(T).bind(T=>G(fR.getSlotNames(T),E=>fR.isShowing(T,E))):A.none()),fH=ca("FixSizeEvent"),fN=ca("AutoSizeEvent");var fW=Object.freeze({__proto__:null,block:(T,E,B,M)=>{Ct(T.element,"aria-busy",!0);let D=E.getRoot(T).getOr(T),er=Tl([sZ.config({mode:"special",onTab:()=>A.some(!0),onShiftTab:()=>A.some(!0)}),s3.config({})]),ea=M(D,er),es=D.getSystem().build(ea);sQ.append(D,ka(es)),es.hasConfigured(sZ)&&E.focus&&sZ.focusIn(es),B.isBlocked()||E.onBlock(T),B.blockWith(()=>sQ.remove(D,es))},unblock:(T,E,B)=>{At(T.element,"aria-busy"),B.isBlocked()&&E.onUnblock(T),B.clear()},isBlocked:(T,E,B)=>B.isBlocked()}),fz=[_s("getRoot",A.none),Os("focus",!0),Ri("onBlock"),Ri("onUnblock")];let fP=Al({fields:fz,name:"blocking",apis:fW,state:Object.freeze({__proto__:null,init:()=>{let T=tc(T=>T.destroy());return Ta({readState:T.isSet,blockWith:E=>{T.set({destroy:E})},clear:T.clear,isBlocked:T.isSet})}})}),RM=T=>az.getCurrent(T).each(T=>Rl(T.element,!0)),NM=(T,E,B)=>{let M=As(!1),D=nc(),r=B=>{!M.get()||"focusin"===B.type&&(B.composed?oe(B.composedPath()):A.from(B.target)).map(Fe).filter(eV).exists(T=>$a(T,"mce-pastebin"))||(B.preventDefault(),RM(E()),T.editorManager.setActive(T))};T.inline||T.on("PreInit",()=>{T.dom.bind(T.getWin(),"focusin",r),T.on("BeforeExecCommand",T=>{"mcefocus"===T.command.toLowerCase()&&!0!==T.value&&r(T)})});let a=D=>{D!==M.get()&&(M.set(D),((T,E,B,M)=>{let D=E.element;if(((T,E)=>{let B="tabindex",M=`data-mce-${B}`;A.from(T.iframeElement).map(Fe).each(T=>{E?(Tt(T,B).each(E=>Ct(T,M,E)),Ct(T,B,-1)):(At(T,B),Tt(T,M).each(E=>{Ct(T,B,E),At(T,M)}))})})(T,B),B)fP.block(E,(T,E)=>({dom:{tag:"div",attributes:{"aria-label":M.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:Yh('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]})),Ht(D,"display"),At(D,"aria-hidden"),T.hasFocus()&&RM(E);else{let B=az.getCurrent(E).exists(T=>Vl(T.element));fP.unblock(E),Bt(D,"display","none"),Ct(D,"aria-hidden","true"),B&&T.focus()}})(T,E(),D,B.providers),((T,E)=>{T.dispatch("AfterProgressState",{state:E})})(T,D))};T.on("ProgressState",E=>{if(D.on(clearTimeout),eu(E.time)){let B=iN.setEditorTimeout(T,()=>a(E.state),E.time);D.set(B)}else a(E.state),D.clear()})},VM=(T,E,B)=>({within:T,extra:E,withinWidth:B}),zM=(T,E,B)=>{let M=j(T,(T,E)=>((T,E)=>{let M=B(T);return A.some({element:T,start:E,finish:E+M,width:M})})(E,T.len).fold(x(T),E=>({len:E.finish,list:T.list.concat([E])})),{len:0,list:[]}).list,D=U(M,T=>T.finish<=E),er=W(D,(T,E)=>T+E.width,0);return{within:D,extra:M.slice(D.length),withinWidth:er}},LM=T=>L(T,T=>T.element),HM=(T,E)=>{let B=L(E,T=>ka(T));hq.setGroups(T,B)},PM=(T,E,B)=>{let M=E.builtGroups.get();if(0===M.length)return;let D=im(T,E,"primary"),er=m$.getCoupled(T,"overflowGroup");Bt(D.element,"visibility","hidden");let ea=M.concat([er]),es=re(ea,T=>Ll(T.element).bind(E=>T.getSystem().getByDom(E).toOptional()));B([]),HM(D,ea);let eu=((T,E,B,M)=>{let D=((T,E,B)=>{let M=zM(E,T,B);return 0===M.extra.length?A.some(M):A.none()})(T,E,B).getOrThunk(()=>zM(E,T-B(M),B)),er=D.within,ea=D.extra,es=D.withinWidth;return 1===ea.length&&ea[0].width<=B(M)?((T,E,B)=>{let M=LM(T.concat(E));return VM(M,[],B)})(er,ea,es):ea.length>=1?((T,E,B,M)=>{let D=LM(T).concat([B]);return VM(D,LM(E),M)})(er,ea,M,es):VM(LM(er),[],es)})(Zt(D.element),E.builtGroups.get(),T=>Zt(T.element),er);0===eu.extra.length?(sQ.remove(D,er),B([])):(HM(D,eu.within),B(eu.extra)),Ht(D.element,"visibility"),Pt(D.element),es.each(s3.focus)},fU=x([yu("splitToolbarBehaviours",[m$]),ts("builtGroups",()=>As([]))]),fG=x([Ii(["overflowToggledClass"]),bs("getOverflowBounds"),ns("lazySink"),ts("overflowGroups",()=>As([])),Ri("onOpened"),Ri("onClosed")].concat(fU())),f$=x([aT({factory:hq,schema:hY(),name:"primary"}),a_({schema:hY(),name:"overflow"}),a_({name:"overflow-button"}),a_({name:"overflow-group"})]),fj=x((T,E)=>{((T,E)=>{let B=e$.max(T,E,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);Bt(T,"max-width",B+"px")})(T,Math.floor(E))}),fY=x([Ii(["toggledClass"]),ns("lazySink"),ls("fetch"),bs("getBounds"),ys("fireDismissalEventInstead",[xs("event",oP())]),Oc(),Ri("onToggled")]),fX=x([a_({name:"button",overrides:T=>({dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:Tl([s4.config({toggleClass:T.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1,onToggled:T.onToggled})])})}),a_({factory:hq,schema:hY(),name:"toolbar",overrides:T=>({toolbarBehaviours:Tl([sZ.config({mode:"cyclic",onEscape:E=>(am(E,T,"button").each(s3.focus),A.none())})])})})]),fq=nc(),XM=(T,E)=>{let B=m$.getCoupled(T,"toolbarSandbox");rG.isOpen(B)?rG.close(B):rG.open(B,E.toolbar())},KM=(T,E,B,M)=>{let D=B.getBounds.map(T=>T()),er=B.lazySink(T).getOrDie();rN.positionWithinBounds(er,E,{anchor:{type:"hotspot",hotspot:T,layouts:M,overrides:{maxWidthFunction:fj()}}},D)},JM=(T,E,B,M,D)=>{hq.setGroups(E,D),KM(T,E,B,M),s4.on(T)},fK=wm({name:"FloatingToolbarButton",factory:(T,E,B,M)=>({...iW.sketch({...M.button(),action:T=>{XM(T,M)},buttonBehaviours:wu({dump:M.button().buttonBehaviours},[m$.config({others:{toolbarSandbox:E=>((T,E,B)=>{let M=wi();return{dom:{tag:"div",attributes:{id:M.id}},behaviours:Tl([sZ.config({mode:"special",onEscape:T=>(rG.close(T),A.some(!0))}),rG.config({onOpen:(D,er)=>{let ea=fq.get().getOr(!1);B.fetch().get(D=>{JM(T,er,B,E.layouts,D),M.link(T.element),ea||sZ.focusIn(er)})},onClose:()=>{s4.off(T),fq.get().getOr(!1)||s3.focus(T),M.unlink(T.element)},isPartOf:(E,B,M)=>Si(B,M)||Si(T,M),getAttachPoint:()=>B.lazySink(T).getOrDie()}),n0.config({channels:{...nu({isExtraPart:eg,...B.fireDismissalEventInstead.map(T=>({fireEventInstead:{event:T.event}})).getOr({})}),...ru({doReposition:()=>{rG.getState(m$.getCoupled(T,"toolbarSandbox")).each(M=>{KM(T,M,B,E.layouts)})}})}})])}})(E,B,T)}})])}),apis:{setGroups:(E,M)=>{rG.getState(m$.getCoupled(E,"toolbarSandbox")).each(D=>{JM(E,D,T,B.layouts,M)})},reposition:E=>{rG.getState(m$.getCoupled(E,"toolbarSandbox")).each(M=>{KM(E,M,T,B.layouts)})},toggle:T=>{XM(T,M)},toggleWithoutFocusing:T=>{fq.set(!0),XM(T,M),fq.clear()},getToolbar:T=>rG.getState(m$.getCoupled(T,"toolbarSandbox")),isOpen:T=>rG.isOpen(m$.getCoupled(T,"toolbarSandbox"))}}),configFields:fY(),partFields:fX(),apis:{setGroups:(T,E,B)=>{T.setGroups(E,B)},reposition:(T,E)=>{T.reposition(E)},toggle:(T,E)=>{T.toggle(E)},toggleWithoutFocusing:(T,E)=>{T.toggleWithoutFocusing(E)},getToolbar:(T,E)=>T.getToolbar(E),isOpen:(T,E)=>T.isOpen(E)}}),fZ=x([ns("items"),Ii(["itemSelector"]),yu("tgroupBehaviours",[sZ])]),fJ=x([aB({name:"items",unit:"item"})]),fQ=wm({name:"ToolbarGroup",configFields:fZ(),partFields:fJ(),factory:(T,E,B,M)=>({uid:T.uid,dom:T.dom,components:E,behaviours:wu(T.tgroupBehaviours,[sZ.config({mode:"flow",selector:T.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}})}),oD=T=>L(T,T=>ka(T)),nD=(T,E,B)=>{PM(T,B,M=>{B.overflowGroups.set(M),E.getOpt(T).each(T=>{fK.setGroups(T,oD(M))})})},f0=wm({name:"SplitFloatingToolbar",configFields:fG(),partFields:f$(),factory:(T,E,B,M)=>{let D=Xh(fK.sketch({fetch:()=>wS(E=>{E(oD(T.overflowGroups.get()))}),layouts:{onLtr:()=>[cl,ll],onRtl:()=>[ll,cl],onBottomLtr:()=>[ul,dl],onBottomRtl:()=>[dl,ul]},getBounds:B.getOverflowBounds,lazySink:T.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:T.markers.overflowToggledClass},parts:{button:M["overflow-button"](),toolbar:M.overflow()},onToggled:(E,B)=>T[B?"onOpened":"onClosed"](E)}));return{uid:T.uid,dom:T.dom,components:E,behaviours:wu(T.splitToolbarBehaviours,[m$.config({others:{overflowGroup:()=>fQ.sketch({...M["overflow-group"](),items:[D.asSpec()]})}})]),apis:{setGroups:(E,B)=>{T.builtGroups.set(L(B,E.getSystem().build)),nD(E,D,T)},refresh:E=>nD(E,D,T),toggle:T=>{D.getOpt(T).each(T=>{fK.toggle(T)})},toggleWithoutFocusing:T=>{D.getOpt(T).each(fK.toggleWithoutFocusing)},isOpen:T=>D.getOpt(T).map(fK.isOpen).getOr(!1),reposition:T=>{D.getOpt(T).each(T=>{fK.reposition(T)})},getOverflow:T=>D.getOpt(T).bind(fK.getToolbar)},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(T,E,B)=>{T.setGroups(E,B)},refresh:(T,E)=>{T.refresh(E)},reposition:(T,E)=>{T.reposition(E)},toggle:(T,E)=>{T.toggle(E)},toggleWithoutFocusing:(T,E)=>{T.toggle(E)},isOpen:(T,E)=>T.isOpen(E),getOverflow:(T,E)=>T.getOverflow(E)}}),f1=x([Ii(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Ri("onOpened"),Ri("onClosed")].concat(fU())),f2=x([aT({factory:hq,schema:hY(),name:"primary"}),aT({factory:hq,schema:hY(),name:"overflow",overrides:T=>({toolbarBehaviours:Tl([p8.config({dimension:{property:"height"},closedClass:T.markers.closedClass,openClass:T.markers.openClass,shrinkingClass:T.markers.shrinkingClass,growingClass:T.markers.growingClass,onShrunk:E=>{am(E,T,"overflow-button").each(T=>{s4.off(T),s3.focus(T)}),T.onClosed(E)},onGrown:E=>{sZ.focusIn(E),T.onOpened(E)},onStartGrow:E=>{am(E,T,"overflow-button").each(s4.on)}}),sZ.config({mode:"acyclic",onEscape:E=>(am(E,T,"overflow-button").each(s3.focus),A.some(!0))})])})}),a_({name:"overflow-button",overrides:T=>({buttonBehaviours:Tl([s4.config({toggleClass:T.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])})}),a_({name:"overflow-group"})]),iD=(T,E)=>{am(T,E,"overflow-button").bind(()=>am(T,E,"overflow")).each(B=>{lD(T,E),p8.toggleGrow(B)})},lD=(T,E)=>{am(T,E,"overflow").each(B=>{PM(T,E,T=>{let E=L(T,T=>ka(T));hq.setGroups(B,E)}),am(T,E,"overflow-button").each(T=>{p8.hasGrown(B)&&s4.on(T)}),p8.refresh(B)})},f3=wm({name:"SplitSlidingToolbar",configFields:f1(),partFields:f2(),factory:(T,E,B,M)=>{let D="alloy.toolbar.toggle";return{uid:T.uid,dom:T.dom,components:E,behaviours:wu(T.splitToolbarBehaviours,[m$.config({others:{overflowGroup:T=>fQ.sketch({...M["overflow-group"](),items:[iW.sketch({...M["overflow-button"](),action:E=>{Fr(T,D)}})]})}}),th("toolbar-toggle-events",[Wr(D,E=>{iD(E,T)})])]),apis:{setGroups:(E,B)=>{((E,B)=>{let M=L(B,E.getSystem().build);T.builtGroups.set(M)})(E,B),lD(E,T)},refresh:E=>lD(E,T),toggle:E=>iD(E,T),isOpen:E=>am(E,T,"overflow").map(p8.hasGrown).getOr(!1)},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(T,E,B)=>{T.setGroups(E,B)},refresh:(T,E)=>{T.refresh(E)},toggle:(T,E)=>{T.toggle(E)},isOpen:(T,E)=>T.isOpen(E)}}),dD=T=>{let E=T.title.fold(()=>({}),T=>({attributes:{title:T}}));return{dom:{tag:"div",classes:["tox-toolbar__group"],...E},components:[fQ.parts.items({})],items:T.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled]), .tox-number-input:not([disabled])"},tgroupBehaviours:Tl([m6.config({}),s3.config({})])}},uD=T=>fQ.sketch(dD(T)),mD=(T,E)=>{let B=oZ(E=>{let B=L(T.initGroups,uD);hq.setGroups(E,B)});return Tl([Ex(T.providers.isDisabled),Ox(),sZ.config({mode:E,onEscape:T.onEscape,selector:".tox-toolbar__group"}),th("toolbar-events",[B])])},gD=T=>{let E=T.cyclicKeying?"cyclic":"acyclic";return{uid:T.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":dD({title:A.none(),items:[]}),"overflow-button":NT({name:"more",icon:A.some("more-drawer"),enabled:!0,tooltip:A.some("Reveal or hide additional toolbar items"),primary:!1,buttonType:A.none(),borderless:!1},A.none(),T.providers)},splitToolbarBehaviours:mD(T,E)}},pD=T=>{let E=gD(T),B=f0.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return f0.sketch({...E,lazySink:T.getSink,getOverflowBounds:()=>{let E=T.moreDrawerData.lazyHeader().element,B=Qo(E),M=nt(E),D=Qo(M),er=Math.max(M.dom.scrollHeight,D.height);return Jo(B.x+4,D.y,B.width-8,er)},parts:{...E.parts,overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:T.attributes}}},components:[B],markers:{overflowToggledClass:"tox-tbtn--enabled"},onOpened:E=>T.onToggled(E,!0),onClosed:E=>T.onToggled(E,!1)})},hD=T=>{let E=f3.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),B=f3.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),M=gD(T);return f3.sketch({...M,components:[E,B],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:E=>{E.getSystem().broadcastOn([fr()],{type:"opened"}),T.onToggled(E,!0)},onClosed:E=>{E.getSystem().broadcastOn([fr()],{type:"closed"}),T.onToggled(E,!1)}})},fD=T=>{let E=T.cyclicKeying?"cyclic":"acyclic";return hq.sketch({uid:T.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(T.type===l5.scrolling?["tox-toolbar--scrolling"]:[])},components:[hq.parts.groups({})],toolbarBehaviours:mD(T,E)})},f5=[dQ,d0,hs("tooltip"),Cs("buttonType","secondary",["primary","secondary"]),Os("borderless",!1),ls("onAction")],f9={button:[...f5,dU,is("type",["button"])],togglebutton:[...f5,Os("active",!1),is("type",["togglebutton"])]},f6=[is("type",["group"]),Ts("buttons",[],Zn("type",f9))],f4=Zn("type",{...f9,group:f6}),f8=Bn([Ts("buttons",[],f4),ls("onShow"),ls("onHide")]),SD=(T,E)=>((T,E)=>{var B,M;let D="togglebutton"===T.type,er=T.icon.map(T=>O_(T,E.icons)).map(Xh),ea={...T,name:D?T.text.getOr(T.icon.getOr("")):null!==(B=T.text)&&void 0!==B?B:T.icon.getOr(""),primary:"primary"===T.buttonType,buttonType:A.from(T.buttonType),tooltip:T.tooltip,icon:T.icon,enabled:!0,borderless:T.borderless},es=VT(null!==(M=T.buttonType)&&void 0!==M?M:"secondary"),eu=D?T.text.map(E.translate):A.some(E.translate(T.text)),eg=eu.map(ri),ep=ea.tooltip.or(eu).map(T=>({"aria-label":E.translate(T),title:E.translate(T)})).getOr({}),eh=er.map(T=>T.asSpec()),ef=we([eh,eg]),ex=T.icon.isSome()&&eg.isSome(),eC={tag:"button",classes:es.concat(...T.icon.isSome()&&!ex?["tox-button--icon"]:[]).concat(...ex?["tox-button--icon-and-text"]:[]).concat(...T.borderless?["tox-button--naked"]:[]).concat(..."togglebutton"===T.type&&T.active?["tox-button--enabled"]:[]),attributes:ep},eO=RT(ea,A.some(B=>{let n=T=>{er.map(M=>M.getOpt(B).each(B=>{sQ.set(B,[O_(T,E.icons)])}))};return D?T.onAction({setIcon:n,setActive:T=>{let E=B.element;T?(Wa(E,"tox-button--enabled"),Ct(E,"aria-pressed",!0)):(Ga(E,"tox-button--enabled"),At(E,"aria-pressed"))},isActive:()=>$a(B.element,"tox-button--enabled")}):"button"===T.type?T.onAction({setIcon:n}):void 0}),[],eC,ef,E);return iW.sketch(eO)})(T,E),f7=Bo().deviceType,bn=f7.isPhone(),br=f7.isTablet();var ba=wm({name:"silver.View",configFields:[ns("viewConfig")],partFields:[aE({factory:{sketch:T=>{let E=!1,B=L(T.buttons,B=>{var M;return"group"===B.type?(E=!0,M=T.providers,{dom:{tag:"div",classes:["tox-view__toolbar__group"]},components:L(B.buttons,T=>SD(T,M))}):SD(B,T.providers)});return{uid:T.uid,dom:{tag:"div",classes:[E?"tox-view__toolbar":"tox-view__header",...bn||br?["tox-view--mobile","tox-view--scrolling"]:[]]},behaviours:Tl([s3.config({}),sZ.config({mode:"flow",selector:"button, .tox-button",focusInside:l1.OnEnterOrSpaceMode})]),components:E?B:[m0.sketch({dom:{tag:"div",classes:["tox-view__header-start"]},components:[]}),m0.sketch({dom:{tag:"div",classes:["tox-view__header-end"]},components:B})]}}},schema:[ns("buttons"),ns("providers")],name:"header"}),aE({factory:{sketch:T=>({uid:T.uid,dom:{tag:"div",classes:["tox-view__pane"]}})},schema:[],name:"pane"})],factory:(T,E,B,M)=>({uid:T.uid,dom:T.dom,components:E,apis:{getPane:E=>aR.getPart(E,T,"pane"),getOnShow:E=>T.viewConfig.onShow,getOnHide:E=>T.viewConfig.onHide}}),apis:{getPane:(T,E)=>T.getPane(E),getOnShow:(T,E)=>T.getOnShow(E),getOnHide:(T,E)=>T.getOnHide(E)}});let TD=(T,E,B)=>pe(E,(E,M)=>{let D=Xn(Yn("view",f8,E));return T.slot(M,ba.sketch({dom:{tag:"div",classes:["tox-view"]},viewConfig:D,components:[...D.buttons.length>0?[ba.parts.header({buttons:D.buttons,providers:B})]:[],ba.parts.pane({})]}))}),ED=(T,E)=>fR.sketch(B=>({dom:{tag:"div",classes:["tox-view-wrap__slot-container"]},components:TD(B,T,E),slotBehaviours:ux([oZ(T=>fR.hideAllSlots(T))])})),AD=T=>G(fR.getSlotNames(T),E=>fR.isShowing(T,E)),MD=(T,E,B)=>{fR.getSlot(T,E).each(T=>{ba.getPane(T).each(E=>{B(T)({getContainer:x(E.element.dom)})})})};var bu=xm({factory:(T,E)=>({uid:T.uid,dom:{tag:"div",classes:["tox-view-wrap"],attributes:{"aria-hidden":"true"},styles:{display:"none"}},components:[],behaviours:Tl([sQ.config({}),az.config({find:T=>{let E=sQ.contents(T);return oe(E)}})]),apis:{setViews:(T,B)=>{sQ.set(T,[ED(B,E.backstage.shared.providers)])},whichView:T=>az.getCurrent(T).bind(AD),toggleView:(T,E,B,M)=>az.getCurrent(T).exists(D=>{let er=AD(D),ea=er.exists(T=>M===T),es=fR.getSlot(D,M).isSome();return es&&(fR.hideAllSlots(D),ea?((T=>{let E=T.element;Bt(E,"display","none"),Ct(E,"aria-hidden","true")})(T),E()):(B(),(T=>{let E=T.element;Ht(E,"display"),At(E,"aria-hidden")})(T),fR.showSlot(D,M),MD(D,M,ba.getOnShow)),er.each(T=>MD(D,T,ba.getOnHide))),es})}}),name:"silver.ViewWrapper",configFields:[ns("backstage")],apis:{setViews:(T,E,B)=>T.setViews(E,B),toggleView:(T,E,B,M,D)=>T.toggleView(E,B,M,D),whichView:(T,E)=>T.whichView(E)}});let bp=aI.optional({factory:fS,name:"menubar",schema:[ns("backstage")]}),bh=aI.optional({factory:{sketch:T=>hj.sketch({uid:T.uid,dom:T.dom,listBehaviours:Tl([sZ.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:()=>fD({type:T.type,uid:ca("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:T.providers,onEscape:()=>(T.onEscape(),A.some(!0))}),setupItem:(T,E,B,M)=>{hq.setGroups(E,B)},shell:!0})},name:"multiple-toolbar",schema:[ns("dom"),ns("onEscape")]}),bf=aI.optional({factory:{sketch:T=>{let E=T.type===l5.sliding?hD:T.type===l5.floating?pD:fD;return E({type:T.type,uid:T.uid,onEscape:()=>(T.onEscape(),A.some(!0)),onToggled:(E,B)=>T.onToolbarToggled(B),cyclicKeying:!1,initGroups:[],getSink:T.getSink,providers:T.providers,moreDrawerData:{lazyToolbar:T.lazyToolbar,lazyMoreButton:T.lazyMoreButton,lazyHeader:T.lazyHeader},attributes:T.attributes})}},name:"toolbar",schema:[ns("dom"),ns("onEscape"),ns("getSink")]}),bb=aI.optional({factory:{sketch:T=>{let E=T.editor,B=T.sticky?dM:hK;return{uid:T.uid,dom:T.dom,components:T.components,behaviours:Tl(B(E,T.sharedBackstage))}}},name:"header",schema:[ns("dom")]}),bv=aI.optional({factory:{sketch:T=>({uid:T.uid,dom:T.dom,components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/tinymce-self-hosted-premium-features/?utm_source=TinyMCE&utm_medium=SPAP&utm_campaign=SPAP&utm_id=editorreferral",rel:"noopener",target:"_blank","aria-hidden":"true"},classes:["tox-promotion-link"],innerHtml:"Upgrade"}}]})},name:"promotion",schema:[ns("dom")]}),bx=aI.optional({name:"socket",schema:[ns("dom")]}),by=aI.optional({factory:{sketch:T=>({uid:T.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"presentation"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:Tl([m6.config({}),s3.config({}),p8.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:T=>{az.getCurrent(T).each(fR.hideAllSlots),Fr(T,fN)},onGrown:T=>{Fr(T,fN)},onStartGrow:T=>{Rr(T,fH,{width:Vt(T.element,"width").getOr("")})},onStartShrink:T=>{Rr(T,fH,{width:Zt(T.element)+"px"})}}),sQ.config({}),az.config({find:T=>{let E=sQ.contents(T);return oe(E)}})])}],behaviours:Tl([PO(0),th("sidebar-sliding-events",[Wr(fH,(T,E)=>{Bt(T.element,"width",E.event.width)}),Wr(fN,(T,E)=>{Ht(T.element,"width")})])])})},name:"sidebar",schema:[ns("dom")]}),bA=aI.optional({factory:{sketch:T=>({uid:T.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:Tl([sQ.config({}),fP.config({focus:!1}),az.config({find:T=>oe(T.components())})]),components:[]})},name:"throbber",schema:[ns("dom")]}),bM=aI.optional({factory:bu,name:"viewWrapper",schema:[ns("backstage")]}),bD=aI.optional({factory:{sketch:T=>({uid:T.uid,dom:{tag:"div",classes:["tox-editor-container"]},components:T.components})},name:"editorContainer",schema:[]});var bI=wm({name:"OuterContainer",factory:(T,B,M)=>{let D=!1,er={getSocket:E=>aR.getPart(E,T,"socket"),setSidebar:(B,M,D)=>{aR.getPart(B,T,"sidebar").each(T=>((T,B,M)=>{az.getCurrent(T).each(D=>{sQ.set(D,[TM(B)]);let er=null==M?void 0:M.toLowerCase();E(er)&&ve(B,er)&&az.getCurrent(D).each(E=>{fR.showSlot(E,er),p8.immediateGrow(D),Ht(D.element,"width"),EM(T.element,"region")})})})(T,M,D))},toggleSidebar:(E,B)=>{aR.getPart(E,T,"sidebar").each(T=>((T,E)=>{az.getCurrent(T).each(B=>{az.getCurrent(B).each(M=>{p8.hasGrown(B)?fR.isShowing(M,E)?(p8.shrink(B),EM(T.element,"presentation")):(fR.hideAllSlots(M),fR.showSlot(M,E),EM(T.element,"region")):(fR.hideAllSlots(M),fR.showSlot(M,E),p8.grow(B),EM(T.element,"region"))})})})(T,B))},whichSidebar:E=>aR.getPart(E,T,"sidebar").bind(AM).getOrNull(),getHeader:E=>aR.getPart(E,T,"header"),getToolbar:E=>aR.getPart(E,T,"toolbar"),setToolbar:(E,B)=>{aR.getPart(E,T,"toolbar").each(T=>{let E=L(B,uD);T.getApis().setGroups(T,E)})},setToolbars:(E,B)=>{aR.getPart(E,T,"multiple-toolbar").each(T=>{let E=L(B,T=>L(T,uD));hj.setItems(T,E)})},refreshToolbar:E=>{aR.getPart(E,T,"toolbar").each(T=>T.getApis().refresh(T))},toggleToolbarDrawer:E=>{aR.getPart(E,T,"toolbar").each(T=>{ke(T.getApis().toggle,E=>E(T))})},toggleToolbarDrawerWithoutFocusing:E=>{aR.getPart(E,T,"toolbar").each(T=>{ke(T.getApis().toggleWithoutFocusing,E=>E(T))})},isToolbarDrawerToggled:E=>aR.getPart(E,T,"toolbar").bind(T=>A.from(T.getApis().isOpen).map(E=>E(T))).getOr(!1),getThrobber:E=>aR.getPart(E,T,"throbber"),focusToolbar:E=>{aR.getPart(E,T,"toolbar").orThunk(()=>aR.getPart(E,T,"multiple-toolbar")).each(T=>{sZ.focusIn(T)})},setMenubar:(E,B)=>{aR.getPart(E,T,"menubar").each(T=>{fS.setMenus(T,B)})},focusMenubar:E=>{aR.getPart(E,T,"menubar").each(T=>{fS.focus(T)})},setViews:(E,B)=>{aR.getPart(E,T,"viewWrapper").each(T=>{bu.setViews(T,B)})},toggleView:(E,B)=>aR.getPart(E,T,"viewWrapper").exists(T=>bu.toggleView(T,()=>er.showMainView(E),()=>er.hideMainView(E),B)),whichView:E=>aR.getPart(E,T,"viewWrapper").bind(bu.whichView).getOrNull(),hideMainView:E=>{(D=er.isToolbarDrawerToggled(E))&&er.toggleToolbarDrawer(E),aR.getPart(E,T,"editorContainer").each(T=>{let E=T.element;Bt(E,"display","none"),Ct(E,"aria-hidden","true")})},showMainView:E=>{D&&er.toggleToolbarDrawer(E),aR.getPart(E,T,"editorContainer").each(T=>{let E=T.element;Ht(E,"display"),At(E,"aria-hidden")})}};return{uid:T.uid,dom:T.dom,components:B,apis:er,behaviours:T.behaviours}},configFields:[ns("dom"),ns("behaviours")],partFields:[bb,bp,bf,bh,bx,by,bv,bA,bM,bD],apis:{getSocket:(T,E)=>T.getSocket(E),setSidebar:(T,E,B,M)=>{T.setSidebar(E,B,M)},toggleSidebar:(T,E,B)=>{T.toggleSidebar(E,B)},whichSidebar:(T,E)=>T.whichSidebar(E),getHeader:(T,E)=>T.getHeader(E),getToolbar:(T,E)=>T.getToolbar(E),setToolbar:(T,E,B)=>{T.setToolbar(E,B)},setToolbars:(T,E,B)=>{T.setToolbars(E,B)},refreshToolbar:(T,E)=>T.refreshToolbar(E),toggleToolbarDrawer:(T,E)=>{T.toggleToolbarDrawer(E)},toggleToolbarDrawerWithoutFocusing:(T,E)=>{T.toggleToolbarDrawerWithoutFocusing(E)},isToolbarDrawerToggled:(T,E)=>T.isToolbarDrawerToggled(E),getThrobber:(T,E)=>T.getThrobber(E),setMenubar:(T,E,B)=>{T.setMenubar(E,B)},focusMenubar:(T,E)=>{T.focusMenubar(E)},focusToolbar:(T,E)=>{T.focusToolbar(E)},setViews:(T,E,B)=>{T.setViews(E,B)},toggleView:(T,E,B)=>T.toggleView(E,B),whichView:(T,E)=>T.whichView(E)}});let bR={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template inserttemplate codesample inserttable accordion | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents footnotes | mergetags | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontfamily fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"aidialog aishortcuts | spellchecker spellcheckerlanguage | autocorrect capitalization | a11ycheck code typography wordcount addtemplate"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},jD=T=>T.split(" "),GD=(T,B)=>{let M={...bR,...B.menus},D=eO(B.menus).length>0,er=void 0===B.menubar||!0===B.menubar?jD("file edit view insert format tools table help"):jD(!1===B.menubar?"":B.menubar),ea=U(er,T=>{let E=ve(bR,T);return D?E||be(B.menus,T).exists(T=>ve(T,"items")):E}),es=L(ea,E=>{let D=M[E];return((T,E,B)=>{let M=cD(B).split(/[ ,]/);return{text:T.title,getItems:()=>Y(T.items,T=>{let B=T.toLowerCase();return 0===B.trim().length||N(M,T=>T===B)?[]:"separator"===B||"|"===B?[{type:"separator"}]:E.menuItems[B]?[E.menuItems[B]]:[]})}})({title:D.title,items:jD(D.items)},B,T)});return U(es,T=>T.getItems().length>0&&N(T.getItems(),T=>E(T)||"separator"!==T.type))},$D=(T,E,B)=>(T.on("remove",()=>B.unload(E)),B.load(E)),qD=(T,E,B,M)=>(T.on("remove",()=>M.unloadRawCss(E)),M.loadRawCss(E,B)),YD=async(T,B)=>{let M="ui/"+ev(T).getOr("default")+"/skin.css",D=tinymce.Resource.get(M);return E(D)?Promise.resolve(qD(T,M,D,T.ui.styleSheetLoader)):$D(T,B+"/skin.min.css",T.ui.styleSheetLoader)},XD=async(T,B)=>{if(vt(Fe(T.getElement())).isSome()){let M=B+"/skin.shadowdom.css",D=tinymce.Resource.get(M);return E(D)?(qD(T,M,D,l6.DOM.styleSheetLoader),Promise.resolve()):$D(T,B+"/skin.shadowdom.min.css",l6.DOM.styleSheetLoader)}},KD=(T,B)=>(async(T,B)=>{ev(B).fold(()=>{let E=Qb(B);E&&B.contentCSS.push(E+(T?"/content.inline":"/content")+".min.css")},M=>{let D="ui/"+M+(T?"/content.inline":"/content")+".css",er=tinymce.Resource.get(D);if(E(er))qD(B,D,er,B.ui.styleSheetLoader);else{let E=Qb(B);E&&B.contentCSS.push(E+(T?"/content.inline":"/content")+".min.css")}});let M=Qb(B);if(!Jb(B)&&E(M))return Promise.all([YD(B,M),XD(B,M)]).then()})(T,B).then((T=>{let t=()=>{T._skinLoaded=!0,(T=>{T.dispatch("SkinLoaded")})(T)};return()=>{T.initialized?t():T.on("init",t)}})(B),()=>((T,E)=>{T.dispatch("SkinLoadError",E)})(B,{message:"Skin could not be loaded"})),bL=k(KD,!1),bH=k(KD,!0),QD=(T,E,B)=>T.translate([E,T.translate(B)]),eB=(T,E,B)=>{let n=(T,M,D,er)=>{let ea=E.shared.providers.translate(T.title);if("separator"===T.type)return A.some({type:"separator",text:ea});if("submenu"===T.type){let E=Y(T.getStyleItems(),T=>s(T,M,er));return 0===M&&E.length<=0?A.none():A.some({type:"nestedmenuitem",text:ea,enabled:E.length>0,getSubmenuItems:()=>Y(T.getStyleItems(),T=>s(T,M,er))})}return A.some({type:"togglemenuitem",text:ea,icon:T.icon,active:T.isSelected(er),enabled:!D,onAction:B.onAction(T),...T.getStylePreview().fold(()=>({}),T=>({meta:{style:T}}))})},s=(T,E,M)=>{let D="formatter"===T.type&&B.isInvalid(T);return 0===E?D?[]:n(T,E,!1,M).toArray():n(T,E,D,M).toArray()},r=T=>{let E=B.getCurrentValue(),M=B.shouldHide?0:1;return Y(T,T=>s(T,M,E))};return{validateItems:r,getFetch:(T,E)=>(B,M)=>{let D=E(),er=r(D);M(I_(er,c8.CLOSE_ON_EXECUTE,T,{isHorizontalMenu:!1,search:A.none()}))}}},tB=(T,E,B)=>{let M=B.dataset,D="basic"===M.type?()=>L(M.data,T=>UE(T,B.isSelectedFor,B.getPreviewFor)):M.getData;return{items:eB(0,E,B),getStyleItems:D}},oB=(T,E,B,M,D)=>{let{items:er,getStyleItems:ea}=tB(0,E,B);return A_({text:B.icon.isSome()?A.none():B.text,icon:B.icon,tooltip:A.from(B.tooltip),role:A.none(),fetch:er.getFetch(E,ea),onSetup:E=>{let r=B=>E.setTooltip(QD(T,M,B.value));return T.on(D,r),yw(Sw(T,"NodeChange",E=>{let M=E.getComponent();B.updateText(M),aj.set(E.getComponent(),!T.selection.isEditable())})(E),()=>T.off(D,r))},getApi:T=>({getComponent:x(T),setTooltip:B=>{let M=E.shared.providers.translate(B);Ot(T.element,{"aria-label":M,title:M})}}),columns:1,presets:"normal",classes:B.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",E.shared)};(tl=tg||(tg={}))[tl.SemiColon=0]="SemiColon",tl[tl.Space=1]="Space";let sB=(T,E,B)=>{var M;let D=(M=T.options.get(E),L(B===tg.SemiColon?M.replace(/;$/,"").split(";"):M.split(" "),T=>{let E=T,B=T,M=T.split("=");return M.length>1&&(E=M[0],B=M[1]),{title:E,format:B}}));return{type:"basic",data:D}},bN="Alignment {0}",bW="left",bz=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],lB=T=>({tooltip:QD(T,bN,bW),text:A.none(),icon:A.some("align-left"),isSelectedFor:E=>()=>T.formatter.match(E),getCurrentValue:A.none,getPreviewFor:T=>A.none,onAction:E=>()=>G(bz,T=>T.format===E.format).each(E=>T.execCommand(E.command)),updateText:E=>{let B=G(bz,E=>T.formatter.match(E.format)).fold(x(bW),T=>T.title.toLowerCase());Rr(E,pJ,{icon:`align-${B}`}),((T,E)=>{T.dispatch("AlignTextUpdate",E)})(T,{value:B})},dataset:{type:"basic",data:bz},shouldHide:!1,isInvalid:E=>!T.formatter.canApply(E.format)}),cB=(T,E)=>{let B=E(),M=L(B,T=>T.format);return A.from(T.formatter.closest(M)).bind(T=>G(B,E=>E.format===T)).orThunk(()=>Ce(T.formatter.match("p"),{title:"Paragraph",format:"p"}))},bP="Block {0}",bU="Paragraph",mB=T=>{let E=sB(T,"block_formats",tg.SemiColon);return{tooltip:QD(T,bP,bU),text:A.some(bU),icon:A.none(),isSelectedFor:E=>()=>T.formatter.match(E),getCurrentValue:A.none,getPreviewFor:E=>()=>{let B=T.formatter.get(E);return B?A.some({tag:B.length>0&&(B[0].inline||B[0].block)||"div",styles:T.dom.parseStyle(T.formatter.getCssText(E))}):A.none()},onAction:kw(T),updateText:B=>{let M=cB(T,()=>E.data).fold(x(bU),T=>T.title);Rr(B,pZ,{text:M}),((T,E)=>{T.dispatch("BlocksTextUpdate",E)})(T,{value:M})},dataset:E,shouldHide:!1,isInvalid:E=>!T.formatter.canApply(E.format)}},bG="Font {0}",b$="System Font",bj=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],fB=T=>{let E=T.split(/\s*,\s*/);return L(E,T=>T.replace(/^['"]+|['"]+$/g,""))},bB=(T,E)=>E.length>0&&X(E,E=>T.indexOf(E.toLowerCase())>-1),vB=T=>{let t=()=>{let t=T=>T?fB(T)[0]:"",B=T.queryCommandValue("FontName"),M=E.data,D=B?B.toLowerCase():"",er=c9(T),ea=G(M,T=>{let E=T.format;return E.toLowerCase()===D||t(E).toLowerCase()===t(D).toLowerCase()}).orThunk(()=>Ce(((T,E)=>{if(0===T.indexOf("-apple-system")||E.length>0){let B=fB(T.toLowerCase());return bB(B,bj)||bB(B,E)}return!1})(D,er),{title:b$,format:D}));return{matchOpt:ea,font:B}},E=sB(T,"font_family_formats",tg.SemiColon);return{tooltip:QD(T,bG,b$),text:A.some(b$),icon:A.none(),isSelectedFor:T=>E=>E.exists(E=>E.format===T),getCurrentValue:()=>{let{matchOpt:T}=t();return T},getPreviewFor:T=>()=>A.some({tag:"div",styles:-1===T.indexOf("dings")?{"font-family":T}:{}}),onAction:E=>()=>{T.undoManager.transact(()=>{T.focus(),T.execCommand("FontName",!1,E.format)})},updateText:E=>{let{matchOpt:B,font:M}=t(),D=B.fold(x(M),T=>T.title);Rr(E,pZ,{text:D}),((T,E)=>{T.dispatch("FontFamilyTextUpdate",E)})(T,{value:D})},dataset:E,shouldHide:!1,isInvalid:eg}},bY={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},bX=(()=>{let T="[0-9]+",E="[eE][+-]?"+T,o=T=>`(?:${T})?`,B=["Infinity",T+"\\."+o(T)+o(E),"\\."+T+o(E),T+o(E)].join("|");return RegExp(`^([+-]?(?:${B}))(.*)$`)})(),wB=(T,E)=>A.from(bX.exec(T)).bind(T=>{let B=Number(T[1]),M=T[2];return N(E,T=>N(bY[T],T=>M===T))?A.some({value:B,unit:M}):A.none()}),bq={tab:x(9),escape:x(27),enter:x(13),backspace:x(8),delete:x(46),left:x(37),up:x(38),right:x(39),down:x(40),space:x(32),home:x(36),end:x(35),pageUp:x(33),pageDown:x(34)},bK="Font size {0}",bZ="12pt",bJ={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},bQ={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},TB=(T,E)=>/[0-9.]+px$/.test(T)?((T,E)=>{let B=Math.pow(10,E);return Math.round(T*B)/B})(72*parseInt(T,10)/96,E||0)+"pt":be(bQ,T).getOr(T),EB=T=>be(bJ,T).getOr(""),AB=T=>{let t=()=>{let E=A.none(),M=B.data,D=T.queryCommandValue("FontSize");if(D)for(let T=3;E.isNone()&&T>=0;T--){let B=TB(D,T),er=EB(B);E=G(M,T=>T.format===D||T.format===B||T.format===er)}return{matchOpt:E,size:D}},E=x(A.none),B=sB(T,"font_size_formats",tg.Space);return{tooltip:QD(T,bK,bZ),text:A.some(bZ),icon:A.none(),isSelectedFor:T=>E=>E.exists(E=>E.format===T),getPreviewFor:E,getCurrentValue:()=>{let{matchOpt:T}=t();return T},onAction:E=>()=>{T.undoManager.transact(()=>{T.focus(),T.execCommand("FontSize",!1,E.format)})},updateText:E=>{let{matchOpt:B,size:M}=t(),D=B.fold(x(M),T=>T.title);Rr(E,pZ,{text:D}),((T,E)=>{T.dispatch("FontSizeTextUpdate",E)})(T,{value:D})},dataset:B,shouldHide:!1,isInvalid:eg}},b0="Format {0}",DB=(T,E)=>{let B="Paragraph";return{tooltip:QD(T,b0,B),text:A.some(B),icon:A.none(),isSelectedFor:E=>()=>T.formatter.match(E),getCurrentValue:A.none,getPreviewFor:E=>()=>{let B=T.formatter.get(E);return void 0!==B?A.some({tag:B.length>0&&(B[0].inline||B[0].block)||"div",styles:T.dom.parseStyle(T.formatter.getCssText(E))}):A.none()},onAction:kw(T),updateText:E=>{let n=T=>VE(T)?Y(T.items,n):zE(T)?[{title:T.title,format:T.format}]:[],M=Y(PE(T),n),D=cB(T,x(M)).fold(x(B),T=>T.title);Rr(E,pZ,{text:D}),((T,E)=>{T.dispatch("StylesTextUpdate",E)})(T,{value:D})},shouldHide:ck(T),isInvalid:E=>!T.formatter.canApply(E.format),dataset:E}},b1=x([ns("toggleClass"),ns("fetch"),Vi("onExecute"),xs("getHotspot",A.some),xs("getAnchorOverrides",x({})),Oc(),Vi("onItemExecute"),ms("lazySink"),ns("dom"),Ri("onOpen"),yu("splitDropdownBehaviours",[m$,sZ,s3]),xs("matchWidth",!1),xs("useMinWidth",!1),xs("eventOrder",{}),ms("role")].concat(IS())),b2=aT({factory:iW,schema:[ns("dom")],name:"arrow",defaults:()=>({buttonBehaviours:Tl([s3.revoke()])}),overrides:T=>({dom:{tag:"span",attributes:{role:"presentation"}},action:E=>{E.getSystem().getByUid(T.uid).each(Nr)},buttonBehaviours:Tl([s4.config({toggleOnExecute:!1,toggleClass:T.toggleClass})])})}),b3=aT({factory:iW,schema:[ns("dom")],name:"button",defaults:()=>({buttonBehaviours:Tl([s3.revoke()])}),overrides:T=>({dom:{tag:"span",attributes:{role:"presentation"}},action:E=>{E.getSystem().getByUid(T.uid).each(B=>{T.onExecute(B,E)})}})}),b5=x([b2,b3,aE({factory:{sketch:T=>({uid:T.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:T.text}})},schema:[ns("text")],name:"aria-descriptor"}),a_({schema:[Bi()],name:"menu",defaults:T=>({onExecute:(E,B)=>{E.getSystem().getByUid(T.uid).each(M=>{T.onItemExecute(M,E,B)})}})}),mX()]),b9=wm({name:"SplitDropdown",configFields:b1(),partFields:b5(),factory:(T,E,B,M)=>{let s=T=>{az.getCurrent(T).each(T=>{aq.highlightFirst(T),sZ.focusIn(T)})},r=E=>{ES(T,w,E,M,s,l2.HighlightMenuAndItem).get(b)},a=E=>{let B=im(E,T,"button");return Nr(B),A.some(!0)},D={...Hr([oZ((E,B)=>{am(E,T,"aria-descriptor").each(T=>{let B=ca("aria");Ct(T.element,"id",B),Ct(E.element,"aria-describedby",B)})})]),...fh(A.some(r))};return{uid:T.uid,dom:T.dom,components:E,apis:{repositionMenus:T=>{s4.isOn(T)&&BS(T)}},eventOrder:{...T.eventOrder,[ox()]:["disabling","toggling","alloy.base.behaviour"]},events:D,behaviours:wu(T.splitDropdownBehaviours,[m$.config({others:{sandbox:E=>{let B=im(E,T,"arrow");return DS(T,E,{onOpen:()=>{s4.on(B),s4.on(E)},onClose:()=>{s4.off(B),s4.off(E)}})}}}),sZ.config({mode:"special",onSpace:a,onEnter:a,onDown:T=>(r(T),A.some(!0))}),s3.config({}),s4.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:T.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:(T,E)=>T.repositionMenus(E)}}),VB=T=>({isEnabled:()=>!aj.isDisabled(T),setEnabled:E=>aj.set(T,!E),setText:E=>Rr(T,pZ,{text:E}),setIcon:E=>Rr(T,pJ,{icon:E})}),zB=T=>({setActive:E=>{s4.set(T,E)},isActive:()=>s4.isOn(T),isEnabled:()=>!aj.isDisabled(T),setEnabled:E=>aj.set(T,!E),setText:E=>Rr(T,pZ,{text:E}),setIcon:E=>Rr(T,pJ,{icon:E})}),LB=(T,E)=>T.map(T=>({"aria-label":E.translate(T),title:E.translate(T)})).getOr({}),b6=ca("focus-button"),PB=(T,E,B,M,D)=>{let er=E.map(T=>Xh(__(T,"tox-tbtn",D))),ea=T.map(T=>Xh(O_(T,D.icons)));return{dom:{tag:"button",classes:["tox-tbtn"].concat(E.isSome()?["tox-tbtn--select"]:[]),attributes:LB(B,D)},components:we([ea.map(T=>T.asSpec()),er.map(T=>T.asSpec())]),eventOrder:{[tq()]:["focusing","alloy.base.behaviour",pq],[oW()]:[pq,"toolbar-group-button-events"]},buttonBehaviours:Tl([Ex(D.isDisabled),Ox(),th(pq,[oZ((T,E)=>S_(T)),Wr(pZ,(T,E)=>{er.bind(E=>E.getOpt(T)).each(T=>{sQ.set(T,[ri(D.translate(E.event.text))])})}),Wr(pJ,(T,E)=>{ea.bind(E=>E.getOpt(T)).each(T=>{sQ.set(T,[O_(E.event.icon,D.icons)])})}),Wr(tq(),(T,E)=>{E.event.prevent(),Fr(T,b6)})])].concat(M.getOr([])))}},UB=(T,E,B)=>{var M,D;let er=As(b),ea=PB(T.icon,T.text,T.tooltip,A.none(),B);return iW.sketch({dom:ea.dom,components:ea.components,eventOrder:pK,buttonBehaviours:{...Tl([th("toolbar-button-events",[(M={onAction:T.onAction,getApi:E.getApi},o0((T,E)=>{Ax(M,T)(E=>{Rr(T,pX,{buttonApi:E}),M.onAction(E)})})),Mx(E,er),Dx(E,er)]),Ex(()=>!T.enabled||B.isDisabled()),Ox()].concat(E.toolbarButtonBehaviours)),[pq]:null===(D=ea.buttonBehaviours)||void 0===D?void 0:D[pq]}})},WB=(T,E,B)=>UB(T,{toolbarButtonBehaviours:B.length>0?[th("toolbarButtonWith",B)]:[],getApi:VB,onSetup:T.onSetup},E),jB=(T,E,B)=>UB(T,{toolbarButtonBehaviours:[sQ.config({}),s4.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(B.length>0?[th("toolbarToggleButtonWith",B)]:[]),getApi:zB,onSetup:T.onSetup},E),GB=(T,E,B)=>M=>wS(T=>E.fetch(T)).map(D=>A.from(jS(tM(nS(ca("menu-value"),D,B=>{E.onItemAction(T(M),B)},E.columns,E.presets,c8.CLOSE_ON_EXECUTE,E.select.getOr(eg),B),{movement:rS(E.columns,E.presets),menuBehaviours:ux("auto"!==E.columns?[]:[oZ((T,B)=>{dx(T,4,Av(E.presets)).each(({numRows:E,numColumns:B})=>{sZ.setGridSize(T,E,B)})})])})))),b4=[{name:"history",items:["undo","redo"]},{name:"ai",items:["aidialog","aishortcuts"]},{name:"styles",items:["styles"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],qB=(T,E)=>(B,M,D)=>{let er=T(B).mapError(T=>Jn(T)).getOrDie();return E(er,M,D)},b8={button:qB(Ny,(T,E)=>WB(T,E.shared.providers,[])),togglebutton:qB(Ly,(T,E)=>jB(T,E.shared.providers,[])),menubutton:qB(hM,(T,E)=>dT(T,"tox-tbtn",E,A.none(),!1)),splitbutton:qB(T=>Yn("SplitButton",fA,T),(T,E)=>((T,E)=>{let o=T=>({isEnabled:()=>!aj.isDisabled(T),setEnabled:E=>aj.set(T,!E),setIconFill:(E,B)=>{vi(T.element,`svg path[class="${E}"], rect[class="${E}"]`).each(T=>{Ct(T,"fill",B)})},setActive:E=>{Ct(T.element,"aria-pressed",E),vi(T.element,"span").each(B=>{T.getSystem().getByDom(B).each(T=>s4.set(T,E))})},isActive:()=>vi(T.element,"span").exists(E=>T.getSystem().getByDom(E).exists(s4.isOn)),setText:E=>vi(T.element,"span").each(B=>T.getSystem().getByDom(B).each(T=>Rr(T,pZ,{text:E}))),setIcon:E=>vi(T.element,"span").each(B=>T.getSystem().getByDom(B).each(T=>Rr(T,pJ,{icon:E}))),setTooltip:B=>{let M=E.providers.translate(B);Ot(T.element,{"aria-label":M,title:M})}}),B=As(b),M={getApi:o,onSetup:T.onSetup};return b9.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:{"aria-pressed":!1,...LB(T.tooltip,E.providers)}},onExecute:E=>{let B=o(E);B.isEnabled()&&T.onAction(B)},onItemExecute:(T,E,B)=>{},splitDropdownBehaviours:Tl([Tx(E.providers.isDisabled),Ox(),th("split-dropdown-events",[oZ((T,E)=>S_(T)),Wr(b6,s3.focus),Mx(M,B),Dx(M,B)]),gS.config({})]),eventOrder:{[oW()]:["alloy.base.behaviour","split-dropdown-events"]},toggleClass:"tox-tbtn--enabled",lazySink:E.getSink,fetch:GB(o,T,E.providers),parts:{menu:Rv(0,T.columns,T.presets)},components:[b9.parts.button(PB(T.icon,T.text,A.none(),A.some([s4.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),E.providers)),b9.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Qf("chevron-down",E.providers.icons)},buttonBehaviours:Tl([Tx(E.providers.isDisabled),Ox(),eb()])}),b9.parts["aria-descriptor"]({text:E.providers.translate("To open the popup, press Shift+Enter")})]})})(T,E.shared)),grouptoolbarbutton:qB(T=>Yn("GroupToolbarButton",fv,T),(T,E,B)=>{let M=B.ui.registry.getAll().buttons,D={[rr]:E.shared.header.isPositionedAtTop()?l0.TopToBottom:l0.BottomToTop};if(cI(B)===l5.floating)return((T,E,B,M)=>{let D=E.shared,er=As(b),ea={toolbarButtonBehaviours:[],getApi:VB,onSetup:T.onSetup},es=[th("toolbar-group-button-events",[Mx(ea,er),Dx(ea,er)])];return fK.sketch({lazySink:D.getSink,fetch:()=>wS(E=>{E(L(B(T.items),uD))}),markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:PB(T.icon,T.text,T.tooltip,A.some(es),D.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:M}}}})})(T,E,T=>KB(B,{buttons:M,toolbar:T,allowToolbarGroups:!1},E,A.none()),D);throw Error("Toolbar groups are only supported when using floating toolbar mode")})},b7={styles:(T,E)=>{let B={type:"advanced",...E.styles};return oB(T,E,DB(T,B),b0,"StylesTextUpdate")},fontsize:(T,E)=>oB(T,E,AB(T),bK,"FontSizeTextUpdate"),fontsizeinput:(T,E)=>((T,E,B)=>{let M=A.none(),D=Sw(T,"NodeChange SwitchMode",E=>{let D=E.getComponent();M=A.some(D),B.updateInputValue(D),aj.set(D,!T.selection.isEditable())}),r=T=>({getComponent:x(T)}),er=As(b),ea=ca("custom-number-input-events"),l=(T,E,D)=>{let er=M.map(T=>r2.getValue(T)).getOr(""),ea=B.getNewValue(er,T),es=er.length-`${ea}`.length,eu=M.map(T=>T.element.dom.selectionStart-es),eg=M.map(T=>T.element.dom.selectionEnd-es);B.onAction(ea,D),M.each(T=>{r2.setValue(T,ea),E&&(eu.each(E=>T.element.dom.selectionStart=E),eg.each(E=>T.element.dom.selectionEnd=E))})},c=(T,E)=>l((T,E)=>T-E,T,E),d=(T,E)=>l((T,E)=>T+E,T,E),u=T=>at(T.element).fold(A.none,T=>(Rl(T),A.some(!0))),m=T=>Vl(T.element)?(dt(T.element).each(T=>Rl(T)),A.some(!0)):A.none(),g=(B,M,D,er)=>{let ea=As(b),es=E.shared.providers.translate(D),eu=ca("altExecuting"),eg=Sw(T,"NodeChange SwitchMode",E=>{aj.set(E.getComponent(),!T.selection.isEditable())}),u=T=>{aj.isDisabled(T)||B(!0)};return iW.sketch({dom:{tag:"button",attributes:{title:es,"aria-label":es},classes:er.concat(M)},components:[C_(M,E.shared.providers.icons)],buttonBehaviours:Tl([aj.config({}),th(eu,[Mx({onSetup:eg,getApi:r},ea),Dx({getApi:r},ea),Wr(t2(),(T,E)=>{E.event.raw.keyCode!==bq.space()&&E.event.raw.keyCode!==bq.enter()||aj.isDisabled(T)||B(!1)}),Wr(t6(),u),Wr(tY(),u)])]),eventOrder:{[t2()]:[eu,"keying"],[t6()]:[eu,"alloy.base.behaviour"],[tY()]:[eu,"alloy.base.behaviour"]}})},es=Xh(g(T=>c(!1,T),"minus","Decrease font size",[])),eu=Xh(g(T=>d(!1,T),"plus","Increase font size",[])),eg=Xh({dom:{tag:"div",classes:["tox-input-wrapper"]},components:[dR.sketch({inputBehaviours:Tl([aj.config({}),th(ea,[Mx({onSetup:D,getApi:r},er),Dx({getApi:r},er)]),th("input-update-display-text",[Wr(pZ,(T,E)=>{r2.setValue(T,E.event.text)}),Wr(t1(),T=>{B.onAction(r2.getValue(T))}),Wr(t9(),T=>{B.onAction(r2.getValue(T))})]),sZ.config({mode:"special",onEnter:T=>(l(w,!0,!0),A.some(!0)),onEscape:u,onUp:T=>(d(!0,!1),A.some(!0)),onDown:T=>(c(!0,!1),A.some(!0)),onLeft:(T,E)=>(E.cut(),A.none()),onRight:(T,E)=>(E.cut(),A.none())})])})],behaviours:Tl([s3.config({}),sZ.config({mode:"special",onEnter:m,onSpace:m,onEscape:u}),th("input-wrapper-events",[Wr(tQ(),T=>{H([es,eu],E=>{let B=Fe(E.get(T).element.dom);Vl(B)&&Nl(B)})})])])});return{dom:{tag:"div",classes:["tox-number-input"]},components:[es.asSpec(),eg.asSpec(),eu.asSpec()],behaviours:Tl([s3.config({}),sZ.config({mode:"flow",focusInside:l1.OnEnterOrSpaceMode,cycles:!1,selector:"button, .tox-input-wrapper",onEscape:T=>Vl(T.element)?A.none():(Rl(T.element),A.some(!0))})])}})(T,E,(T=>{let t=()=>T.queryCommandValue("FontSize");return{updateInputValue:T=>Rr(T,pZ,{text:t()}),onAction:(E,B)=>T.execCommand("FontSize",!1,E,{skip_focus:!B}),getNewValue:(E,B)=>{var M;wB(E,["unsupportedLength","empty"]);let D=t(),er=wB(E,["unsupportedLength","empty"]).or(wB(D,["unsupportedLength","empty"])),ea=er.map(T=>T.value).getOr(16),es=c$(T),eu=er.map(T=>T.unit).filter(T=>""!==T).getOr(es),eg=B(ea,(null!==(M=({em:{step:.1},cm:{step:.1},in:{step:.1},pc:{step:.1},ch:{step:.1},rem:{step:.1}})[eu])&&void 0!==M?M:{step:1}).step),ep=`${eg>=0?eg:ea}${eu}`;return ep!==D&&((T,E)=>{T.dispatch("FontSizeInputTextUpdate",E)})(T,{value:ep}),ep}}})(T)),fontfamily:(T,E)=>oB(T,E,vB(T),bG,"FontFamilyTextUpdate"),blocks:(T,E)=>oB(T,E,mB(T),bP,"BlocksTextUpdate"),align:(T,E)=>oB(T,E,lB(T),bN,"AlignTextUpdate")},KB=(T,B,M,D)=>{let er=(T=>{let B=T.toolbar,M=T.buttons;return!1===B?[]:void 0===B||!0===B?(T=>{let E=L(b4,E=>{let B=U(E.items,E=>ve(T,E)||ve(b7,E));return{name:E.name,items:B}});return U(E,T=>T.items.length>0)})(M):E(B)?(T=>{let E=T.split("|");return L(E,T=>({items:T.trim().split(" ")}))})(B):f(B,T=>ve(T,"name")&&ve(T,"items"))?B:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])})(B),ea=L(er,E=>{let er=Y(E.items,E=>{var er,ea;return 0===E.trim().length?[]:(er=B.buttons,ea=B.allowToolbarGroups,be(er,E.toLowerCase()).orThunk(()=>D.bind(T=>re(T,T=>be(er,T+E.toLowerCase())))).fold(()=>be(b7,E.toLowerCase()).map(E=>E(T,M)),B=>"grouptoolbarbutton"!==B.type||ea?be(b8,B.type).fold(()=>(console.error("skipping button defined by",B),A.none()),E=>A.some(E(B,M,T))):(console.warn(`Ignoring the '${E}' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.`),A.none()))).toArray()});return{title:A.from(T.translate(E.name)),items:er}});return U(ea,T=>T.items.length>0)},JB=(T,B,M,D)=>{let er=B.mainUi.outerContainer,ea=M.toolbar,es=M.buttons;if(f(ea,E)){let E=ea.map(E=>{let B={toolbar:E,buttons:es,allowToolbarGroups:M.allowToolbarGroups};return KB(T,B,D,A.none())});bI.setToolbars(er,E)}else bI.setToolbar(er,KB(T,M,D,A.none()))},vo=Bo(),vn=vo.os.isiOS()&&vo.os.version.major<=12;var vr=Object.freeze({__proto__:null,render:(T,E,B,M,er)=>{var ea;let{mainUi:es,uiMotherships:eu}=E,eg=As(0),ep=es.outerContainer;bL(T);let eh=Fe(er.targetNode),ef=bt(eU(eh));Ld(eh,es.mothership),uv(T)&&Ld(E.mainUi.mothership.element,E.popupUi.mothership),zd(ef,E.dialogUi.mothership),T.on("SkinLoaded",()=>{bI.setSidebar(ep,B.sidebar,c2(T)),JB(T,E,B,M),eg.set(T.getWin().innerWidth),bI.setMenubar(ep,GD(T,B)),bI.setViews(ep,B.views),((T,E)=>{let{uiMotherships:B}=E,M=T.dom,D=T.getWin(),er=T.getDoc().documentElement,ea=As($t(D.innerWidth,D.innerHeight)),es=As($t(er.offsetWidth,er.offsetHeight)),l=()=>{let E=ea.get();E.left===D.innerWidth&&E.top===D.innerHeight||(ea.set($t(D.innerWidth,D.innerHeight)),fw(T))},c=()=>{let E=T.getDoc().documentElement,B=es.get();B.left===E.offsetWidth&&B.top===E.offsetHeight||(es.set($t(E.offsetWidth,E.offsetHeight)),fw(T))},d=E=>{((T,E)=>{T.dispatch("ScrollContent",E)})(T,E)};M.bind(D,"resize",l),M.bind(D,"scroll",d);let eu=ac(Fe(T.getBody()),"load",c);T.on("hide",()=>{H(B,T=>{Bt(T.element,"display","none")})}),T.on("show",()=>{H(B,T=>{Ht(T.element,"display")})}),T.on("NodeChange",c),T.on("remove",()=>{eu.unbind(),M.unbind(D,"resize",l),M.unbind(D,"scroll",d),D=null})})(T,E)});let ex=bI.getSocket(ep).getOrDie("Could not find expected socket element");if(vn){let E;It(ex.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});let B=(ea=()=>{T.dispatch("ScrollContent")},E=null,{cancel:()=>{D(E)||(clearTimeout(E),E=null)},throttle:(...T)=>{D(E)&&(E=setTimeout(()=>{E=null,ea.apply(null,T)},20))}}),M=rc(ex.element,"scroll",B.throttle);T.on("remove",M.unbind)}Cx(T,E),T.addCommand("ToggleSidebar",(E,B)=>{bI.toggleSidebar(ep,B),T.dispatch("ToggleSidebar")}),T.addQueryValueHandler("ToggleSidebar",()=>{var T;return null!==(T=bI.whichSidebar(ep))&&void 0!==T?T:""}),T.addCommand("ToggleView",(E,B)=>{if(bI.toggleView(ep,B)){let E=ep.element;es.mothership.broadcastOn([r$()],{target:E}),H(eu,T=>{T.broadcastOn([r$()],{target:E})}),D(bI.whichView(ep))&&(T.focus(),T.nodeChanged(),bI.refreshToolbar(ep))}}),T.addQueryValueHandler("ToggleView",()=>{var T;return null!==(T=bI.whichView(ep))&&void 0!==T?T:""});let eC=cI(T);return eC!==l5.sliding&&eC!==l5.floating||T.on("ResizeWindow ResizeEditor ResizeContent",()=>{let B=T.getWin().innerWidth;B!==eg.get()&&(bI.refreshToolbar(E.mainUi.outerContainer),eg.set(B))}),{iframeContainer:ex.element.dom,editorContainer:ep.element.dom,api:{setEnabled:T=>{kx(E,!T)},isEnabled:()=>!aj.isDisabled(ep)}}}});let tI=T=>/^[0-9\.]+(|px)$/i.test(""+T)?A.some(parseInt(""+T,10)):A.none(),oI=T=>eu(T)?T+"px":T,nI=(T,E,B)=>{let M=E.filter(E=>T<E),D=B.filter(E=>T>E);return M.or(D).getOr(T)},sI=T=>{let E=cr(T),B=cc(T),M=cf(T);return tI(E).map(T=>nI(T,B,M))},{ToolbarLocation:vu,ToolbarMode:vm}=c6,iI=(T,E,B,M,D)=>{let{mainUi:er,uiMotherships:ea}=B,es=l6.DOM,eu=iv(T),eg=dv(T),ep=cf(T).or(sI(T)),eh=M.shared.header,ef=eh.isPositionedAtTop,ex=cI(T),eC=ex===vm.sliding||ex===vm.floating,eO=As(!1),f=()=>eO.get()&&!T.removed,b=T=>eC?T.fold(x(0),T=>T.components().length>1?jt(T.components()[1].element):0):0,v=()=>{H(ea,T=>{T.broadcastOn([rj()],{})})},y=B=>{if(!f())return;eu||D.on(T=>{let B=ep.getOrThunk(()=>{let T=tI(Rt(wt(),"margin-left")).getOr(0);return Zt(wt())-Xt(E).left+T});Bt(T.element,"max-width",B+"px")});let M=eu?A.none():(()=>{if(eu)return A.none();if(Xt(er.outerContainer.element).left+Qt(er.outerContainer.element)>=window.innerWidth-40||Vt(er.outerContainer.element,"width").isSome()){Bt(er.outerContainer.element,"position","absolute"),Bt(er.outerContainer.element,"left","0px"),Ht(er.outerContainer.element,"width");let T=Qt(er.outerContainer.element);return A.some(T)}return A.none()})();eC&&bI.refreshToolbar(er.outerContainer),eu||D.on(B=>{var D;let ea=bI.getToolbar(er.outerContainer),es=b(ea),eu=Zo(E),{top:eg,left:ep}=(D=er.outerContainer.element,uv(T)?AA(D):A.none()).fold(()=>({top:ef()?Math.max(eu.y-jt(B.element)+es,0):eu.bottom,left:eu.x}),T=>{var E;let M=Zo(T),D=null!==(E=T.dom.scrollTop)&&void 0!==E?E:0,er=Qe(T,wt()),ea=er?Math.max(eu.y-jt(B.element)+es,0):eu.y-M.y+D-jt(B.element)+es;return{top:ef()?ea:eu.bottom,left:er?eu.x:eu.x-M.x}}),eh=M.map(T=>{let E=Wo(),B=window.innerWidth-(ep-E.left);return{width:Math.max(Math.min(T,B),150)+"px"}}).getOr({});It(er.outerContainer.element,{position:"absolute",left:Math.round(ep)+"px",top:Math.round(eg)+"px",...eh})}),eg&&D.on(B),v()},w=()=>!(eu||!eg||!f())&&D.get().exists(B=>{let M=eh.getDockingMode(),ea=(B=>{switch(cL(T)){case vu.auto:let M=bI.getToolbar(er.outerContainer),D=b(M),ea=jt(B.element)-D,es=Zo(E);if(es.y>ea)return"top";{let T=nt(E),B=Math.max(T.dom.scrollHeight,jt(T));return es.bottom<B-ea||tn().bottom<es.bottom-ea?"bottom":"top"}case vu.bottom:return"bottom";case vu.top:default:return"top"}})(B);return ea!==M&&(D.on(T=>{ft.setModes(T,[ea]),eh.setDockingMode(ea);let E=ef()?l0.TopToBottom:l0.BottomToTop;Ct(T.element,rr,E)}),!0)});return{isVisible:f,isPositionedAtTop:ef,show:()=>{eO.set(!0),Bt(er.outerContainer.element,"display","flex"),es.addClass(T.getBody(),"mce-edit-focus"),H(ea,T=>{Ht(T.element,"display")}),w(),uv(T)?y(T=>ft.isDocked(T)?ft.reset(T):ft.refresh(T)):y(ft.refresh)},hide:()=>{eO.set(!1),Bt(er.outerContainer.element,"display","none"),es.removeClass(T.getBody(),"mce-edit-focus"),H(ea,T=>{Bt(T.element,"display","none")})},update:y,updateMode:()=>{w()&&y(ft.reset)},repositionPopups:v}},lI=(T,E)=>{let B=Zo(T);return{pos:E?B.y:B.bottom,bounds:B}};var vg=Object.freeze({__proto__:null,render:(T,E,B,M,D)=>{let{mainUi:er}=E,ea=nc(),es=Fe(D.targetNode),eu=iI(T,es,E,M,ea),eg=cN(T);bH(T);let d=()=>{if(ea.isSet())return void eu.show();ea.set(bI.getHeader(er.outerContainer).getOrDie());let D=lv(T);uv(T)?(Ld(es,er.mothership),Ld(es,E.popupUi.mothership)):zd(D,er.mothership),zd(D,E.dialogUi.mothership),JB(T,E,B,M),bI.setMenubar(er.outerContainer,GD(T,B)),eu.show(),((T,E,B,M)=>{let D=As(lI(E,B.isPositionedAtTop())),r=M=>{let{pos:er,bounds:ea}=lI(E,B.isPositionedAtTop()),{pos:es,bounds:eu}=D.get(),eg=ea.height!==eu.height||ea.width!==eu.width;D.set({pos:er,bounds:ea}),eg&&fw(T,M),B.isVisible()&&(es!==er?B.update(ft.reset):eg&&(B.updateMode(),B.repositionPopups()))};M||(T.on("activate",B.show),T.on("deactivate",B.hide)),T.on("SkinLoaded ResizeWindow",()=>B.update(ft.reset)),T.on("NodeChange keydown",T=>{requestAnimationFrame(()=>r(T))});let er=0,ea=KO(()=>B.update(ft.refresh),33);T.on("ScrollWindow",()=>{let T=Wo().left;T!==er&&(er=T,ea.throttle()),B.updateMode()}),uv(T)&&T.on("ElementScroll",T=>{B.update(ft.refresh)});let es=oc();es.set(ac(Fe(T.getBody()),"load",T=>r(T.raw))),T.on("remove",()=>{es.clear()})})(T,es,eu,eg),T.nodeChanged()};T.on("show",d),T.on("hide",eu.hide),eg||(T.on("focus",d),T.on("blur",eu.hide)),T.on("init",()=>{(T.hasFocus()||eg)&&d()}),Cx(T,E);let ep={show:d,hide:eu.hide,setEnabled:T=>{kx(E,!T)},isEnabled:()=>!aj.isDisabled(er.outerContainer)};return{editorContainer:er.outerContainer.element.dom,api:ep}}});let vh="contexttoolbar-hide",uI=(T,E)=>Wr(pX,(B,M)=>{var D;let er=(D=T.get(B),{hide:()=>Fr(D,oE()),getValue:()=>r2.getValue(D)});E.onAction(er,M.event.buttonApi)}),mI=(T,E)=>{let B=T.label.fold(()=>({}),T=>({"aria-label":T})),M=Xh(dR.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:T.initValue(),inputAttributes:B,selectOnFocus:!0,inputBehaviours:Tl([sZ.config({mode:"special",onEnter:T=>D.findPrimary(T).map(T=>(Nr(T),!0)),onLeft:(T,E)=>(E.cut(),A.none()),onRight:(T,E)=>(E.cut(),A.none())})])})),D=((T,E,B)=>{let M=L(E,E=>Xh("contextformtogglebutton"===E.type?((T,E,B)=>{let{primary:M,...D}=E.original,er=Xn(Ly({...D,type:"togglebutton",onAction:b}));return jB(er,B,[uI(T,E)])})(T,E,B):((T,E,B)=>{let{primary:M,...D}=E.original,er=Xn(Ny({...D,type:"button",onAction:b}));return WB(er,B,[uI(T,E)])})(T,E,B)));return{asSpecs:()=>L(M,T=>T.asSpec()),findPrimary:T=>re(E,(E,B)=>E.primary?A.from(M[B]).bind(E=>E.getOpt(T)).filter(C(aj.isDisabled)):A.none())}})(M,T.commands,E);return[{title:A.none(),items:[M.asSpec()]},{title:A.none(),items:D.asSpecs()}]},gI=(T,E,B)=>E.bottom-T.y>=B&&T.bottom-E.y>=B,pI=T=>{let E=(T=>{let E=T.getBoundingClientRect();if(E.height<=0&&E.width<=0){let B=mt(Fe(T.startContainer),T.startOffset).element;return(eH(B)?rt(B):A.some(B)).filter(eV).map(T=>T.dom.getBoundingClientRect()).getOr(E)}return E})(T.selection.getRng());if(T.inline){let T=Wo();return Jo(T.left+E.left,T.top+E.top,E.width,E.height)}{let B=Qo(Fe(T.getBody()));return Jo(B.x+E.left,B.y+E.top,E.width,E.height)}},hI=(T,E,B,M=0)=>{let D=$o(window),er=Zo(Fe(T.getContentAreaContainer())),ea=Zb(T)||ov(T)||sv(T),{x:es,width:eu}=((T,E,B)=>{let M=Math.max(T.x+B,E.x);return{x:M,width:Math.min(T.right-B,E.right)-M}})(er,D,M);if(T.inline&&!ea)return Jo(es,D.y,eu,D.height);{let ea=E.header.isPositionedAtTop(),{y:eg,bottom:ep}=((T,E,B,M,D,er)=>{let ea=Fe(T.getContainer()),es=vi(ea,".tox-editor-header").getOr(ea),eu=Zo(es),eg=eu.y>=E.bottom,ep=M&&!eg;if(T.inline&&ep)return{y:Math.max(eu.bottom+er,B.y),bottom:B.bottom};if(T.inline&&!ep)return{y:B.y,bottom:Math.min(eu.y-er,B.bottom)};let eh="line"===D?Zo(ea):E;return ep?{y:Math.max(eu.bottom+er,B.y),bottom:Math.min(eh.bottom-er,B.bottom)}:{y:Math.max(eh.y+er,B.y),bottom:Math.min(eu.y-er,B.bottom)}})(T,er,D,ea,B,M);return Jo(es,eg,eu,ep-eg)}},vf={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},vb={maxHeightFunction:ro(),maxWidthFunction:fj()},vI=T=>"node"===T,yI=(T,E,B,M,D)=>{let er=pI(T),ea=M.lastElement().exists(T=>Qe(B,T));return((T,E)=>{let B=T.selection.getRng(),M=mt(Fe(B.startContainer),B.startOffset);return B.startContainer===B.endContainer&&B.startOffset===B.endOffset-1&&Qe(M.element,E)})(T,B)?ea?SE:bE:ea?((T,B,D)=>{let ea=Vt(T,"position");Bt(T,"position",B);let es=gI(er,Zo(E),-20)&&!M.isReposition()?CE:SE;return ea.each(E=>Bt(T,"position",E)),es})(E,M.getMode()):("fixed"===M.getMode()?D.y+Wo().top:D.y)+(jt(E)+12)<=er.y?bE:vE},xI=(T,E,B,M)=>{let s=E=>(M,D,er,ea,es)=>({...yI(T,ea,E,B,es)({...M,y:es.y,height:es.height},D,er,ea,es),alwaysFit:!0}),r=T=>vI(M)?[s(T)]:[];return E?{onLtr:T=>[gl,ll,cl,dl,ul,ml].concat(r(T)),onRtl:T=>[gl,cl,ll,ul,dl,ml].concat(r(T))}:{onLtr:T=>[ml,gl,dl,ll,ul,cl].concat(r(T)),onRtl:T=>[ml,gl,ul,cl,dl,ll].concat(r(T))}},wI=(T,E)=>{let B=U(E,E=>E.predicate(T.dom)),{pass:M,fail:D}=P(B,T=>"contexttoolbar"===T.type);return{contextToolbars:M,contextForms:D}},SI=(T,E)=>{let B={},M=[],D=[],er={},ea={},es=eO(T);return H(es,es=>{let eu=T[es];"contextform"===eu.type?((T,es)=>{let eu=Xn(Yn("ContextForm",uB,es));B[T]=eu,eu.launch.map(B=>{er["form:"+T]={...es.launch,type:"contextformtogglebutton"===B.type?"togglebutton":"button",onAction:()=>{E(eu)}}}),"editor"===eu.scope?D.push(eu):M.push(eu),ea[T]=eu})(es,eu):"contexttoolbar"===eu.type&&((T,E)=>{Yn("ContextToolbar",uM,E).each(B=>{"editor"===E.scope?D.push(B):M.push(B),ea[T]=B})})(es,eu)}),{forms:B,inNodeScope:M,inEditorScope:D,lookupTable:ea,formNavigators:er}},vv=ca("forward-slide"),vx=ca("backward-slide"),vy=ca("change-slide-event"),vA="tox-pop--resizing",vS="tox-pop--transition",EI=(T,E,B,M)=>{let D=M.backstage,er=D.shared,ea=Bo().deviceType.isTouch,es=nc(),eu=nc(),eg=nc(),ep=ci((T=>{let E=As([]);return iH.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:T=>{E.set([]),iH.getContent(T).each(T=>{Ht(T.element,"visibility")}),Ga(T.element,vA),Ht(T.element,"width")},inlineBehaviours:Tl([th("context-toolbar-events",[Kr(t8(),(T,E)=>{"width"===E.event.raw.propertyName&&(Ga(T.element,vA),Ht(T.element,"width"))}),Wr(vy,(T,E)=>{let B=T.element;Ht(B,"width");let M=Zt(B);iH.setContent(T,E.event.contents),Wa(B,vA);let D=Zt(B);Bt(B,"width",M+"px"),iH.getContent(T).each(T=>{E.event.focus.bind(T=>(Rl(T),Ll(B))).orThunk(()=>(sZ.focusIn(T),zl(eU(B))))}),setTimeout(()=>{Bt(T.element,"width",D+"px")},0)}),Wr(vv,(T,B)=>{iH.getContent(T).each(B=>{E.set(E.get().concat([{bar:B,focus:zl(eU(T.element))}]))}),Rr(T,vy,{contents:B.event.forwardContents,focus:A.none()})}),Wr(vx,(T,B)=>{ne(E.get()).each(B=>{E.set(E.get().slice(0,E.get().length-1)),Rr(T,vy,{contents:ka(B.bar),focus:B.focus})})})]),sZ.config({mode:"special",onEscape:B=>ne(E.get()).fold(()=>T.onEscape(),T=>(Fr(B,vx),A.some(!0)))})]),lazySink:()=>tE.value(T.sink)})})({sink:B,onEscape:()=>(T.focus(),A.some(!0))})),u=()=>{let E=eg.get().getOr("node"),B=vI(E)?1:0;return hI(T,er,E,B)},m=()=>!(T.removed||ea()&&D.isContextMenuOpen()),g=()=>{if(m()){let E=u(),B=xe(eg.get(),"node")?es.get().filter(T=>xt(T)&&Ge(T)).map(Qo).getOrThunk(()=>pI(T)):pI(T);return E.height<=0||!gI(B,E,.01)}return!0},p=()=>{es.clear(),eu.clear(),eg.clear(),iH.hide(ep)},h=()=>{if(iH.isOpen(ep)){let T=ep.element;Ht(T,"display"),g()?Bt(T,"display","none"):(eu.set(0),iH.reposition(ep))}},f=E=>({dom:{tag:"div",classes:["tox-pop__dialog"]},components:[E],behaviours:Tl([sZ.config({mode:"acyclic"}),th("pop-dialog-wrap-events",[oZ(E=>{T.shortcuts.add("ctrl+F9","focus statusbar",()=>sZ.focusIn(E))}),oJ(E=>{T.shortcuts.remove("ctrl+F9")})])])}),eh=eo(()=>SI(E,T=>{let E=y([T]);Rr(ep,vv,{forwardContents:f(E)})})),y=E=>{let{buttons:B}=T.ui.registry.getAll(),D={...B,...eh().formNavigators},ea=cI(T)===l5.scrolling?l5.scrolling:l5.default,es=q(L(E,E=>"contexttoolbar"===E.type?KB(T,{buttons:D,toolbar:E.items,allowToolbarGroups:!1},M.backstage,A.some(["form:"])):mI(E,er.providers)));return fD({type:ea,uid:ca("context-toolbar"),initGroups:es,onEscape:A.none,cyclicKeying:!0,providers:er.providers})},x=(E,M)=>{if(ex.cancel(),!m())return;let D=y(E),eh=E[0].position,ef=((E,M)=>{var D,eg;let ep="node"===E?er.anchors.node(M):er.anchors.cursor(),eh=(D=ea(),eg={lastElement:es.get,isReposition:()=>xe(eu.get(),0),getMode:()=>rN.getMode(B)},"line"===E?{bubble:bc(12,0,vf),layouts:{onLtr:()=>[pl],onRtl:()=>[hl]},overrides:vb}:{bubble:bc(0,12,vf,1/12),layouts:xI(T,D,eg,E),overrides:vb});return tM(ep,eh)})(eh,M);eg.set(eh),eu.set(1);let eC=ep.element;Ht(eC,"display"),xe(Se(M,es.get(),Qe),!0)||(Ga(eC,vS),rN.reset(B,ep)),iH.showWithinBounds(ep,f(D),{anchor:ef,transition:{classes:[vS],mode:"placement"}},()=>A.some(u())),M.fold(es.clear,es.set),g()&&Bt(eC,"display","none")},ef=!1,ex=KO(()=>{!T.hasFocus()||T.removed||ef||($a(ep.element,vS)?ex.throttle():((T,E)=>{let B=Fe(E.getBody()),n=T=>Qe(T,B),M=Fe(E.selection.getNode());return n(M)||et(B,M)?((T,E,B)=>{let M=wI(T,E);if(M.contextForms.length>0)return A.some({elem:T,toolbars:[M.contextForms[0]]});{let E=wI(T,B);if(E.contextForms.length>0)return A.some({elem:T,toolbars:[E.contextForms[0]]});if(M.contextToolbars.length>0||E.contextToolbars.length>0){let B=(T=>{if(T.length<=1)return T;{let t=E=>N(T,T=>T.position===E),o=E=>U(T,T=>T.position===E),E=t("selection"),B=t("node");if(E||B){if(B&&E){let T=o("node"),E=L(o("selection"),T=>({...T,position:"node"}));return T.concat(E)}return o(E?"selection":"node")}return o("line")}})(M.contextToolbars.concat(E.contextToolbars));return A.some({elem:T,toolbars:B})}return A.none()}})(M,T.inNodeScope,T.inEditorScope).orThunk(()=>n(M)?A.none():Fs(M,E=>{if(eV(E)){let{contextToolbars:B,contextForms:M}=wI(E,T.inNodeScope),D=M.length>0?M:(T=>{if(T.length<=1)return T;{let t=E=>G(T,T=>T.position===E);return t("selection").orThunk(()=>t("node")).orThunk(()=>t("line")).map(T=>T.position).fold(()=>[],E=>U(T,T=>T.position===E))}})(B);return D.length>0?A.some({elem:E,toolbars:D}):A.none()}return A.none()},n)):A.none()})(eh(),T).fold(p,T=>{x(T.toolbars,A.some(T.elem))}))},17);T.on("init",()=>{T.on("remove",p),T.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",h),T.on("click keyup focus SetContent",ex.throttle),T.on(vh,p),T.on("contexttoolbar-show",E=>{let B=eh();be(B.lookupTable,E.toolbarKey).each(B=>{x([B],Ce(E.target!==T,E.target)),iH.getContent(ep).each(sZ.focusIn)})}),T.on("focusout",E=>{iN.setEditorTimeout(T,()=>{Ll(B.element).isNone()&&Ll(ep.element).isNone()&&p()},0)}),T.on("SwitchMode",()=>{T.mode.isReadOnly()&&p()}),T.on("AfterProgressState",E=>{E.state?p():T.hasFocus()&&ex.throttle()}),T.on("dragstart",()=>{ef=!0}),T.on("dragend drop",()=>{ef=!1}),T.on("NodeChange",T=>{Ll(ep.element).fold(ex.throttle,b)})})},AI=(T,E)=>{let o=()=>{let B=E.getOptions(T),M=E.getCurrent(T).map(E.hash),D=nc();return L(B,B=>({type:"togglemenuitem",text:E.display(B),onSetup:er=>{let a=T=>{T&&(D.on(T=>T.setActive(!1)),D.set(er)),er.setActive(T)};a(xe(M,E.hash(B)));let ea=E.watcher(T,B,a);return()=>{D.clear(),ea()}},onAction:()=>E.setCurrent(T,B)}))};T.ui.registry.addMenuButton(E.name,{tooltip:E.text,icon:E.icon,fetch:T=>T(o()),onSetup:E.onToolbarSetup}),T.ui.registry.addNestedMenuItem(E.name,{type:"nestedmenuitem",text:E.text,getSubmenuItems:o,onSetup:E.onMenuSetup})},MI=T=>{AI(T,{name:"lineheight",text:"Line height",icon:"line-height",getOptions:tv,hash:T=>wB(T,["fixed","relative","empty"]).map(({value:T,unit:E})=>T+E).getOr(T),display:w,watcher:(T,E,B)=>T.formatter.formatChanged("lineheight",B,!1,{value:E}).unbind,getCurrent:T=>A.from(T.queryCommandValue("LineHeight")),setCurrent:(T,E)=>T.execCommand("LineHeight",!1,E),onToolbarSetup:xw(T),onMenuSetup:xw(T)}),A.from(c_(T)).map(E=>({name:"language",text:"Language",icon:"language",getOptions:x(E),hash:T=>ea(T.customCode)?T.code:`${T.code}/${T.customCode}`,display:T=>T.title,watcher:(T,E,B)=>{var M;return T.formatter.formatChanged("lang",B,!1,{value:E.code,customValue:null!==(M=E.customCode)&&void 0!==M?M:null}).unbind},getCurrent:T=>{let E=Fe(T.selection.getNode());return Rs(E,T=>A.some(T).filter(eV).bind(T=>Tt(T,"lang").map(E=>({code:E,customCode:Tt(T,"data-mce-lang").getOrUndefined(),title:""}))))},setCurrent:(T,E)=>T.execCommand("Lang",!1,E),onToolbarSetup:E=>{let B=oc();return E.setActive(T.formatter.match("lang",{},void 0,!0)),B.set(T.formatter.formatChanged("lang",E.setActive,!0)),yw(B.clear,xw(T)(E))},onMenuSetup:xw(T)})).each(E=>AI(T,E))},DI=T=>Sw(T,"NodeChange",E=>{E.setEnabled(T.queryCommandState("outdent")&&T.selection.isEditable())}),BI=(T,E)=>B=>{B.setActive(E.get());let n=T=>{E.set(T.state),B.setActive(T.state)};return T.on("PastePlainTextToggle",n),yw(()=>T.off("PastePlainTextToggle",n),xw(T)(B))},II=(T,E)=>()=>{T.execCommand("mceToggleFormat",!1,E)},FI=T=>{(T=>{pB.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(E,B)=>{T.ui.registry.addToggleButton(E.name,{tooltip:E.text,icon:E.icon,onSetup:ww(T,E.name),onAction:II(T,E.name)})});for(let E=1;E<=6;E++){let B="h"+E;T.ui.registry.addToggleButton(B,{text:B.toUpperCase(),tooltip:"Heading "+E,onSetup:ww(T,B),onAction:II(T,B)})}})(T),pB.each([{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"print",text:"Print",action:"mcePrint",icon:"print"}],E=>{T.ui.registry.addButton(E.name,{tooltip:E.text,icon:E.icon,onAction:Cw(T,E.action)})}),pB.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],E=>{T.ui.registry.addButton(E.name,{tooltip:E.text,icon:E.icon,onSetup:xw(T),onAction:Cw(T,E.action)})}),pB.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],E=>{T.ui.registry.addToggleButton(E.name,{tooltip:E.text,icon:E.icon,onAction:Cw(T,E.action),onSetup:ww(T,E.name)})}),pB.each([{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"},{name:"print",text:"Print...",action:"mcePrint",icon:"print",shortcut:"Meta+P"}],E=>{T.ui.registry.addMenuItem(E.name,{text:E.text,icon:E.icon,shortcut:E.shortcut,onAction:Cw(T,E.action)})}),pB.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],E=>{T.ui.registry.addMenuItem(E.name,{text:E.text,icon:E.icon,shortcut:E.shortcut,onSetup:xw(T),onAction:Cw(T,E.action)})}),T.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onSetup:xw(T),onAction:II(T,"code")})},RI=(T,E)=>Sw(T,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",B=>{B.setEnabled(!T.mode.isReadOnly()&&T.undoManager[E]())}),NI=T=>Sw(T,"VisualAid",E=>{E.setActive(T.hasVisual)}),VI=(T,E)=>{H([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],E=>{T.ui.registry.addToggleButton(E.name,{tooltip:E.text,icon:E.icon,onAction:Cw(T,E.cmd),onSetup:ww(T,E.name)})}),T.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onSetup:xw(T),onAction:Cw(T,"JustifyNone")}),FI(T),((T,E)=>{let B=tB(0,E,lB(T));T.ui.registry.addNestedMenuItem("align",{text:E.shared.providers.translate("Align"),onSetup:xw(T),getSubmenuItems:()=>B.items.validateItems(B.getStyleItems())})})(T,E),((T,E)=>{let B=tB(0,E,vB(T));T.ui.registry.addNestedMenuItem("fontfamily",{text:E.shared.providers.translate("Fonts"),onSetup:xw(T),getSubmenuItems:()=>B.items.validateItems(B.getStyleItems())})})(T,E),((T,E)=>{let B={type:"advanced",...E.styles},M=tB(0,E,DB(T,B));T.ui.registry.addNestedMenuItem("styles",{text:"Formats",onSetup:xw(T),getSubmenuItems:()=>M.items.validateItems(M.getStyleItems())})})(T,E),((T,E)=>{let B=tB(0,E,mB(T));T.ui.registry.addNestedMenuItem("blocks",{text:"Blocks",onSetup:xw(T),getSubmenuItems:()=>B.items.validateItems(B.getStyleItems())})})(T,E),((T,E)=>{let B=tB(0,E,AB(T));T.ui.registry.addNestedMenuItem("fontsize",{text:"Font sizes",onSetup:xw(T),getSubmenuItems:()=>B.items.validateItems(B.getStyleItems())})})(T,E),T.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:RI(T,"hasUndo"),onAction:Cw(T,"undo")}),T.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:RI(T,"hasRedo"),onAction:Cw(T,"redo")}),T.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",enabled:!1,onSetup:RI(T,"hasUndo"),onAction:Cw(T,"undo")}),T.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",enabled:!1,onSetup:RI(T,"hasRedo"),onAction:Cw(T,"redo")}),(T=>{T.addCommand("mceApplyTextcolor",(E,B)=>{((T,E,B)=>{T.undoManager.transact(()=>{T.focus(),T.formatter.apply(E,{value:B}),T.nodeChanged()})})(T,E,B)}),T.addCommand("mceRemoveTextcolor",E=>{((T,E)=>{T.undoManager.transact(()=>{T.focus(),T.formatter.remove(E,{value:null},void 0,!0),T.nodeChanged()})})(T,E)});let E=mL(T),B=mH(T),M=As(E),D=As(B);eS(T,"forecolor","forecolor",M),eS(T,"backcolor","hilitecolor",D),tS(T,"forecolor","forecolor","Text color",M),tS(T,"backcolor","hilitecolor","Background color",D)})(T),(T=>{T.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:Cw(T,"mceToggleVisualAid")})})(T),(T=>{T.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:NI(T),onAction:Cw(T,"mceToggleVisualAid")})})(T),T.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:DI(T),onAction:Cw(T,"outdent")}),T.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onSetup:xw(T),onAction:Cw(T,"indent")}),MI(T),(T=>{let E=As(c1(T)),o=()=>T.execCommand("mceTogglePlainTextPaste");T.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:o,onSetup:BI(T,E)}),T.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:o,onSetup:BI(T,E)})})(T)},zI=T=>E(T)?T.split(/[ ,]/):T,LI=T=>E=>E.options.get(T),vT=LI("contextmenu_never_use_native"),v_=LI("contextmenu_avoid_overlap"),UI=T=>{let E=T.ui.registry.getAll().contextMenus,B=T.options.get("contextmenu");return T.options.isSet("contextmenu")?B:U(B,T=>ve(E,T))},WI=(T,E)=>({type:"makeshift",x:T,y:E}),jI=T=>"longpress"===T.type||0===T.type.indexOf("touch"),GI=(T,E)=>"contextmenu"===E.type||"longpress"===E.type?T.inline?(T=>{if(jI(T)){let E=T.touches[0];return WI(E.pageX,E.pageY)}return WI(T.pageX,T.pageY)})(E):((T,E)=>{var B,M;let D=l6.DOM.getPos(T);return B=D.x,M=D.y,WI(E.x+B,E.y+M)})(T.getContentAreaContainer(),(T=>{if(jI(T)){let E=T.touches[0];return WI(E.clientX,E.clientY)}return WI(T.clientX,T.clientY)})(E)):$I(T),$I=T=>({type:"selection",root:Fe(T.selection.getNode())}),qI=(T,E,B)=>{switch(B){case"node":return{type:"node",node:A.some(Fe(T.selection.getNode())),root:Fe(T.getBody())};case"point":return GI(T,E);case"selection":return $I(T)}},YI=(T,E,B,M,D,er)=>{let ea=B(),es=qI(T,E,er);I_(ea,c8.CLOSE_ON_EXECUTE,M,{isHorizontalMenu:!1,search:A.none()}).map(T=>{E.preventDefault(),iH.showMenuAt(D,{anchor:es},{menu:{markers:Bv("normal")},data:T})})},vM={onLtr:()=>[gl,ll,cl,dl,ul,ml,bE,vE,fE,pE,hE,gE],onRtl:()=>[gl,cl,ll,ul,dl,ml,bE,vE,hE,gE,fE,pE]},vD={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},JI=(T,E,B,M,D,er)=>{let ea=Bo(),es=ea.os.isiOS(),eu=ea.os.isMacOS(),eg=ea.os.isAndroid(),ep=ea.deviceType.isTouch(),u=()=>{let ea=B();((T,E,B,M,D,er,ea)=>{let es=((T,E,B)=>{let M=qI(T,E,B);return{bubble:bc(0,"point"===B?12:0,vD),layouts:vM,overrides:{maxWidthFunction:fj(),maxHeightFunction:ro()},...M}})(T,E,er);I_(B,c8.CLOSE_ON_EXECUTE,M,{isHorizontalMenu:!0,search:A.none()}).map(B=>{E.preventDefault();let eu=ea?l2.HighlightMenuAndItem:l2.HighlightNone;iH.showMenuWithinBounds(D,{anchor:es},{menu:{markers:Bv("normal"),highlightOnOpen:eu},data:B,type:"horizontal"},()=>A.some(hI(T,M.shared,"node"===er?"node":"selection"))),T.dispatch(vh)})})(T,E,ea,M,D,er,!(eg||es||eu&&ep))};if((eu||es)&&"node"!==er){let o=()=>{(T=>{let E=T.selection.getRng(),o=()=>{iN.setEditorTimeout(T,()=>{T.selection.setRng(E)},10),r()};T.once("touchend",o);let n=T=>{T.preventDefault(),T.stopImmediatePropagation()};T.on("mousedown",n,!0);let s=()=>r();T.once("longpresscancel",s);let r=()=>{T.off("touchend",o),T.off("longpresscancel",s),T.off("mousedown",n)}})(T),u()};((T,E)=>{let B=T.selection;if(B.isCollapsed()||E.touches.length<1)return!1;{let M=E.touches[0],D=B.getRng();return td(T.getWin(),r_.domRange(D)).exists(T=>T.left<=M.clientX&&T.right>=M.clientX&&T.top<=M.clientY&&T.bottom>=M.clientY)}})(T,E)?o():(T.once("selectionchange",o),T.once("touchend",()=>T.off("selectionchange",o)))}else u()},ZI=T=>E(T)?"|"===T:"separator"===T.type,vR={type:"separator"},eF=T=>{let t=T=>({text:T.text,icon:T.icon,enabled:T.enabled,shortcut:T.shortcut});if(E(T))return T;switch(T.type){case"separator":return vR;case"submenu":return{type:"nestedmenuitem",...t(T),getSubmenuItems:()=>{let B=T.getSubmenuItems();return E(B)?B:L(B,eF)}};default:return{type:"menuitem",...t(T),onAction:v(T.onAction)}}},tF=(T,E)=>{if(0===E.length)return T;let B=ne(T).filter(T=>!ZI(T)).fold(()=>[],T=>[vR]);return T.concat(B).concat(E).concat([vR])},oF=(T,E)=>!("longpress"===E.type||ve(E,"touches"))&&(2!==E.button||E.target===T.getBody()&&""===E.pointerType),nF=(T,E)=>oF(T,E)?T.selection.getStart(!0):E.target,sF=(T,B,D)=>{let er=Bo().deviceType.isTouch,ea=ci(iH.sketch({dom:{tag:"div"},lazySink:B,onEscape:()=>T.focus(),onShow:()=>D.setContextMenuState(!0),onHide:()=>D.setContextMenuState(!1),fireDismissalEventInstead:{},inlineBehaviours:Tl([th("dismissContextMenu",[Wr(oP(),(E,B)=>{rG.close(E),T.focus()})])])})),a=()=>iH.hide(ea),i=B=>{if(vT(T)&&B.preventDefault(),B.ctrlKey&&!vT(T)||0===UI(T).length)return;let es=((T,E)=>{let B=v_(T),M=oF(T,E)?"selection":"point";if(De(B)){let D=nF(T,E);return JS(Fe(D),B)?"node":M}return M})(T,B);(er()?JI:YI)(T,B,()=>{let D=nF(T,B),er=T.ui.registry.getAll(),ea=UI(T);return((T,B,D)=>{let er=j(B,(B,er)=>be(T,er.toLowerCase()).map(T=>{let er=T.update(D);if(E(er)&&De(eD(er)))return tF(B,er.split(" "));if(M(er)&&er.length>0){let T=L(er,eF);return tF(B,T)}return B}).getOrThunk(()=>B.concat([er])),[]);return er.length>0&&ZI(er[er.length-1])&&er.pop(),er})(er.contextMenus,ea,D)},D,ea,es)};T.on("init",()=>{let E="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(er()?"":" ResizeWindow");T.on(E,a),T.on("longpress contextmenu",i)})},vL=Ms([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),aF=T=>E=>E.translate(-T.left,-T.top),iF=T=>E=>E.translate(T.left,T.top),lF=T=>(E,B)=>j(T,(T,E)=>E(T),$t(E,B)),cF=(T,E,B)=>T.fold(lF([iF(B),aF(E)]),lF([aF(E)]),lF([])),dF=(T,E,B)=>T.fold(lF([iF(B)]),lF([]),lF([iF(E)])),uF=(T,E,B)=>T.fold(lF([]),lF([aF(B)]),lF([iF(E),aF(B)])),mF=(T,E,B)=>{let M=T.fold((T,E)=>({position:A.some("absolute"),left:A.some(T+"px"),top:A.some(E+"px")}),(T,E)=>({position:A.some("absolute"),left:A.some(T-B.left+"px"),top:A.some(E-B.top+"px")}),(T,E)=>({position:A.some("fixed"),left:A.some(T+"px"),top:A.some(E+"px")}));return{right:A.none(),bottom:A.none(),...M}},gF=(T,E,B,M)=>{let s=(T,D)=>(er,ea)=>{let es=T(E,B,M);return D(er.getOr(es.left),ea.getOr(es.top))};return T.fold(s(uF,vH),s(dF,vN),s(cF,vW))},vH=vL.offset,vN=vL.absolute,vW=vL.fixed,bF=(T,E)=>{let B=_t(T,E);return ea(B)?NaN:parseInt(B,10)},vF=(T,E,B,M,D,er)=>{let ea=((T,E)=>{let B=T.element,M=bF(B,E.leftAttr),D=bF(B,E.topAttr);return isNaN(M)||isNaN(D)?A.none():A.some($t(M,D))})(T,E).fold(()=>B,T=>vW(T.left+M.left,T.top+M.top)),es=E.mustSnap?xF(T,E,ea,D,er):wF(T,E,ea,D,er),eu=cF(ea,D,er);return((T,E,B)=>{let M=T.element;Ct(M,E.leftAttr,B.left+"px"),Ct(M,E.topAttr,B.top+"px")})(T,E,eu),es.fold(()=>({coord:vW(eu.left,eu.top),extra:A.none()}),T=>({coord:T.output,extra:T.extra}))},yF=(T,E,B,M)=>re(T,T=>{let D=T.sensor,er=((T,E,B,M,D,er)=>{let ea=dF(T,D,er),es=dF(E,D,er);return Math.abs(ea.left-es.left)<=B&&Math.abs(ea.top-es.top)<=M})(E,D,T.range.left,T.range.top,B,M);return er?A.some({output:gF(T.output,E,B,M),extra:T.extra}):A.none()}),xF=(T,E,B,M,D)=>{let er=E.getSnapPoints(T);return yF(er,B,M,D).orThunk(()=>{let T=j(er,(T,E)=>{let er=E.sensor,ea=((T,E,B,M,D,er)=>{let ea=dF(T,D,er),es=dF(E,D,er),eu=Math.abs(ea.left-es.left),eg=Math.abs(ea.top-es.top);return $t(eu,eg)})(B,er,E.range.left,E.range.top,M,D);return T.deltas.fold(()=>({deltas:A.some(ea),snap:A.some(E)}),B=>(ea.left+ea.top)/2<=(B.left+B.top)/2?{deltas:A.some(ea),snap:A.some(E)}:T)},{deltas:A.none(),snap:A.none()});return T.snap.map(T=>({output:gF(T.output,B,M,D),extra:T.extra}))})},wF=(T,E,B,M,D)=>{let er=E.getSnapPoints(T);return yF(er,B,M,D)};var vz=Object.freeze({__proto__:null,snapTo:(T,E,B,M)=>{let D=E.getTarget(T.element);if(E.repositionTarget){let E=tt(T.element),B=Wo(E),er=MA(D),ea={coord:gF(M.output,M.output,B,er),extra:M.extra},es=mF(ea.coord,0,er);Ft(D,es)}}});let vP="data-initial-z-index",CF=(T,E)=>{T.getSystem().addToGui(E),(T=>{rt(T.element).filter(eV).each(E=>{Vt(E,"z-index").each(T=>{Ct(E,vP,T)}),Bt(E,"z-index",Rt(T.element,"z-index"))})})(E)},OF=T=>{(T=>{rt(T.element).filter(eV).each(T=>{Tt(T,vP).fold(()=>Ht(T,"z-index"),E=>Bt(T,"z-index",E)),At(T,vP)})})(T),T.getSystem().removeFromGui(T)},_F=(T,E,B)=>T.getSystem().build(m0.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[E]},events:B}));var vU=ys("snaps",[ns("getSnapPoints"),Ri("onSensor"),ns("leftAttr"),ns("topAttr"),xs("lazyViewport",tn),xs("mustSnap",!1)]);let vG=[xs("useFixed",eg),ns("blockerClass"),xs("getTarget",w),xs("onDrag",b),xs("repositionTarget",!0),xs("onDrop",b),_s("getBounds",tn),vU],AF=T=>{var E,B,M,D,er;return(E=Vt(T,"left"),B=Vt(T,"top"),M=Vt(T,"position"),E.isSome()&&B.isSome()&&M.isSome()?A.some((D=E.getOrDie(),er=B.getOrDie(),("fixed"===M.getOrDie()?vW:vH)(parseInt(D,10),parseInt(er,10)))):A.none()).getOrThunk(()=>{let E=Xt(T);return vN(E.left,E.top)})},MF=(T,E)=>({bounds:T.getBounds(),height:Gt(E.element),width:Qt(E.element)}),DF=(T,E,B,M,D)=>{let er=B.update(M,D),ea=B.getStartData().getOrThunk(()=>MF(E,T));er.each(B=>{((T,E,B,M)=>{let D=E.getTarget(T.element);if(E.repositionTarget){let er=tt(T.element),ea=Wo(er),es=MA(D),eu=AF(D),eg=((T,E,B,M,D)=>{let er=D.bounds,ea=dF(E,B,M),es=Qi(ea.left,er.x,er.x+er.width-D.width),eu=Qi(ea.top,er.y,er.y+er.height-D.height),eg=vN(es,eu);return E.fold(()=>{let T=uF(eg,B,M);return vH(T.left,T.top)},x(eg),()=>{let T=cF(eg,B,M);return vW(T.left,T.top)})})(0,E.snaps.fold(()=>{var T,E;let B=(T=M.left,E=M.top,eu.fold((B,M)=>vH(B+T,M+E),(B,M)=>vN(B+T,M+E),(B,M)=>vW(B+T,M+E))),D=cF(B,ea,es);return vW(D.left,D.top)},E=>{let B=vF(T,E,eu,M,ea,es);return B.extra.each(B=>{E.onSensor(T,B)}),B.coord}),ea,es,B),ep=mF(eg,0,es);Ft(D,ep)}E.onDrag(T,D,M)})(T,E,ea,B)})},BF=(T,E,B,M)=>{E.each(OF),B.snaps.each(E=>{((T,E)=>{let B=T.element;At(B,E.leftAttr),At(B,E.topAttr)})(T,E)});let D=B.getTarget(T.element);M.reset(),B.onDrop(T,D)},IF=T=>(E,B)=>{let n=T=>{B.setStartData(MF(E,T))};return Hr([Wr(oH(),T=>{B.getStartData().each(()=>n(T))}),...T(E,B,n)])};var v$=Object.freeze({__proto__:null,getData:T=>A.from($t(T.x,T.y)),getDelta:(T,E)=>$t(E.left-T.left,E.top-T.top)});let RF=(T,E,B)=>[Wr(tq(),(M,D)=>{if(0!==D.event.raw.button)return;D.stop();let r=()=>BF(M,A.some(es),T,E),er=ZS(r,200),ea={drop:r,delayDrop:er.schedule,forceDrop:r,move:B=>{er.cancel(),DF(M,T,E,v$,B)}},es=_F(M,T.blockerClass,Hr([Wr(tq(),ea.forceDrop),Wr(tJ(),ea.drop),Wr(tK(),(T,E)=>{ea.move(E.event)}),Wr(tZ(),ea.delayDrop)]));B(M),CF(M,es)})],vj=[...vG,Li("dragger",{handlers:IF(RF)})];var vY=Object.freeze({__proto__:null,getData:T=>{let E=T.raw.touches;return 1===E.length?(T=>{let E=T[0];return A.some($t(E.clientX,E.clientY))})(E):A.none()},getDelta:(T,E)=>$t(E.left-T.left,E.top-T.top)});let zF=(T,E,B)=>{let M=nc(),s=B=>{BF(B,M.get(),T,E),M.clear()};return[Wr(t$(),(D,er)=>{var ea;er.stop();let i=()=>s(D),es=_F(D,T.blockerClass,(ea={drop:i,delayDrop:b,forceDrop:i,move:B=>{DF(D,T,E,vY,B)}},Hr([Wr(t$(),ea.forceDrop),Wr(tY(),ea.drop),Wr(tX(),ea.drop),Wr(tj(),(T,E)=>{ea.move(E.event)})])));M.set(es),B(D),CF(D,es)}),Wr(tj(),(B,M)=>{M.stop(),DF(B,T,E,vY,M.event)}),Wr(tY(),(T,E)=>{E.stop(),s(T)}),Wr(tX(),s)]},vX=[...vG,Li("dragger",{handlers:IF(zF)})],vq=[...vG,Li("dragger",{handlers:IF((T,E,B)=>[...RF(T,E,B),...zF(T,E,B)])})];var vK=Object.freeze({__proto__:null,mouse:vj,touch:vX,mouseOrTouch:vq}),vZ=Object.freeze({__proto__:null,init:()=>{let T=A.none(),E=A.none(),B=x({});return Ta({readState:B,reset:()=>{T=A.none(),E=A.none()},update:(E,B)=>E.getData(B).bind(B=>((E,B)=>{let M=T.map(T=>E.getDelta(T,B));return T=A.some(B),M})(E,B)),getStartData:()=>E,setStartData:T=>{E=A.some(T)}})}});let vJ=Dl({branchKey:"mode",branches:vK,name:"dragging",active:{events:(T,E)=>T.dragger.handlers(T,E)},extra:{snap:T=>({sensor:T.sensor,range:T.range,output:T.output,extra:A.from(T.extra)})},state:vZ,apis:vz}),GF=(T,E,B,M,D,er)=>T.fold(()=>vJ.snap({sensor:vN(B-20,M-20),range:$t(D,er),output:vN(A.some(B),A.some(M)),extra:{td:E}}),T=>{let D=B-20,er=M-20,ea=T.element.dom.getBoundingClientRect();return vJ.snap({sensor:vN(D,er),range:$t(40,40),output:vN(A.some(B-ea.width/2),A.some(M-ea.height/2)),extra:{td:E}})}),$F=(T,E,B)=>({getSnapPoints:T,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:(T,M)=>{let D=M.td;E.get().exists(T=>Qe(T,D))||(E.set(D),B(D))},mustSnap:!0}),qF=T=>Xh(iW.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:Tl([vJ.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:T}),gS.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}})),YF=(T,E)=>{let B=As([]),M=As([]),D=As(!1),er=nc(),ea=nc(),i=T=>{let B=Qo(T);return GF(eg.getOpt(E),T,B.x,B.y,B.width,B.height)},l=T=>{let B=Qo(T);return GF(ep.getOpt(E),T,B.right,B.bottom,B.width,B.height)},es=$F(()=>L(B.get(),T=>i(T)),er,E=>{ea.get().each(B=>{T.dispatch("TableSelectorChange",{start:E,finish:B})})}),eu=$F(()=>L(M.get(),T=>l(T)),ea,E=>{er.get().each(B=>{T.dispatch("TableSelectorChange",{start:B,finish:E})})}),eg=qF(es),ep=qF(eu),eh=ci(eg.asSpec()),ef=ci(ep.asSpec()),h=(E,B,M,D)=>{let er=M(B);vJ.snapTo(E,er),((E,B,M,er)=>{let ea=B.dom.getBoundingClientRect();Ht(E.element,"display");let es=st(Fe(T.getBody())).dom.innerHeight,eu=ea[D]<0,eg=ea[D]>es;(eu||eg)&&Bt(E.element,"display","none")})(E,B)},f=T=>h(eh,T,i,"top"),b=T=>h(ef,T,l,"bottom");Bo().deviceType.isTouch()&&(T.on("TableSelectionChange",T=>{D.get()||(Id(E,eh),Id(E,ef),D.set(!0)),er.set(T.start),ea.set(T.finish),T.otherCells.each(E=>{B.set(E.upOrLeftCells),M.set(E.downOrRightCells),f(T.start),b(T.finish)})}),T.on("ResizeEditor ResizeWindow ScrollContent",()=>{er.get().each(f),ea.get().each(b)}),T.on("TableSelectionClear",()=>{D.get()&&(Nd(eh),Nd(ef),D.set(!1)),er.clear(),ea.clear()}))},XF=(T,E,B)=>{var M;let D=null!==(M=E.delimiter)&&void 0!==M?M:"";return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:Tl([sZ.config({mode:"flow",selector:"div[role=button]"}),aj.config({disabled:B.isDisabled}),Ox(),m6.config({}),sQ.config({}),th("elementPathEvents",[oZ((E,M)=>{T.shortcuts.add("alt+F11","focus statusbar elementpath",()=>sZ.focusIn(E)),T.on("NodeChange",M=>{let er=(E=>{var B;let M=[],D=E.length;for(;D-- >0;){let er=E[D];if(1===er.nodeType&&"BR"!==(B=er).nodeName&&!B.getAttribute("data-mce-bogus")&&"bookmark"!==B.getAttribute("data-mce-type")){let E=vw(T,er);if(E.isDefaultPrevented()||M.push({name:E.name,element:er}),E.isPropagationStopped())break}}return M})(M.parents),ea=er.length>0?j(er,(E,M,er)=>{var ea,es;let eu=(ea=M.name,es=M.element,iW.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{"data-index":er,"aria-level":er+1}},components:[ri(ea)],action:E=>{T.focus(),T.selection.select(es),T.nodeChanged()},buttonBehaviours:Tl([_x(B.isDisabled),Ox()])}));return 0===er?E.concat([eu]):E.concat([{dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0}},components:[ri(` ${D} `)]},eu])},[]):[];sQ.set(E,ea)})})])]),components:[]}};(tu=tf||(tf={}))[tu.None=0]="None",tu[tu.Both=1]="Both",tu[tu.Vertical=2]="Vertical";let JF=(T,E,B)=>{let M=Fe(T.getContainer()),D=((T,E,B,M,D)=>{let er={height:nI(M+E.top,cu(T),cb(T))};return B===tf.Both&&(er.width=nI(D+E.left,cc(T),cf(T))),er})(T,E,B,jt(M),Zt(M));le(D,(T,E)=>{eu(T)&&Bt(M,E,oI(T))}),(T=>{T.dispatch("ResizeEditor")})(T)},ZF=(T,E,B,M)=>{let D=$t(20*B,20*M);return JF(T,D,E),A.some(!0)},QF=(T,E)=>{let o=()=>{let B=[],M=c5(T),D=cJ(T),er=cQ(T)||T.hasPlugin("wordcount");return D&&B.push(XF(T,{},E)),M&&B.push((()=>{let T=Vx("Alt+0");return{dom:{tag:"div",classes:["tox-statusbar__help-text"]},components:[ri(lG.translate(["Press {0} for help",T]))]}})()),er&&B.push((()=>{let B=[];return T.hasPlugin("wordcount")&&B.push(((T,E)=>{let o=(T,B,M)=>sQ.set(T,[ri(E.translate(["{0} "+M,B[M]]))]);return iW.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:Tl([_x(E.isDisabled),Ox(),m6.config({}),sQ.config({}),r2.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),th("wordcount-events",[o0(T=>{let E=r2.getValue(T),B="words"===E.mode?"characters":"words";r2.setValue(T,{mode:B,count:E.count}),o(T,E.count,B)}),oZ(E=>{T.on("wordCountUpdate",T=>{let{mode:B}=r2.getValue(E);r2.setValue(E,{mode:B,count:T.wordCount}),o(E,T.wordCount,B)})})])]),eventOrder:{[ox()]:["disabling","alloy.base.behaviour","wordcount-events"]}})})(T,E)),cQ(T)&&B.push({dom:{tag:"span",classes:["tox-statusbar__branding"]},components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/powered-by-tiny?utm_campaign=editor_referral&utm_medium=poweredby&utm_source=tinymce&utm_content=v6",rel:"noopener",target:"_blank","aria-label":lG.translate(["Powered by {0}","Tiny"])},innerHtml:'<svg width="50px" height="16px" viewBox="0 0 50 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.143 0c2.608.015 5.186 2.178 5.186 5.331 0 0 .077 3.812-.084 4.87-.361 2.41-2.164 4.074-4.65 4.496-1.453.284-2.523.49-3.212.623-.373.071-.634.122-.785.152-.184.038-.997.145-1.35.145-2.732 0-5.21-2.04-5.248-5.33 0 0 0-3.514.03-4.442.093-2.4 1.758-4.342 4.926-4.963 0 0 3.875-.752 4.036-.782.368-.07.775-.1 1.15-.1Zm1.826 2.8L5.83 3.989v2.393l-2.455.475v5.968l6.137-1.189V9.243l2.456-.476V2.8ZM5.83 6.382l3.682-.713v3.574l-3.682.713V6.382Zm27.173-1.64-.084-1.066h-2.226v9.132h2.456V7.743c-.008-1.151.998-2.064 2.149-2.072 1.15-.008 1.987.92 1.995 2.072v5.065h2.455V7.359c-.015-2.18-1.657-3.929-3.837-3.913a3.993 3.993 0 0 0-2.908 1.296Zm-6.3-4.266L29.16 0v2.387l-2.456.475V.476Zm0 3.2v9.132h2.456V3.676h-2.456Zm18.179 11.787L49.11 3.676H46.58l-1.612 4.527-.46 1.382-.384-1.382-1.611-4.527H39.98l3.3 9.132L42.15 16l2.732-.537ZM22.867 9.738c0 .752.568 1.075.921 1.075.353 0 .668-.047.998-.154l.537 1.765c-.23.154-.92.537-2.225.537-1.305 0-2.655-.997-2.686-2.686a136.877 136.877 0 0 1 0-4.374H18.8V3.676h1.612v-1.98l2.455-.476v2.456h2.302V5.9h-2.302v3.837Z"/>\n</svg>\n'.trim()},behaviours:Tl([s3.config({})])}]}),{dom:{tag:"div",classes:["tox-statusbar__right-container"]},components:B}})()),B.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container",...(()=>{let T="tox-statusbar__text-container--flex-start",E="tox-statusbar__text-container--flex-end";if(M){let B="tox-statusbar__text-container-3-cols";return er||D?er&&!D?[B,E]:[B,T]:[B,"tox-statusbar__text-container--space-around"]}return[er&&!D?E:T]})()]},components:B}]:[]};return{dom:{tag:"div",classes:["tox-statusbar"]},components:(()=>{let B=o(),M=((T,E)=>{let B=(T=>{let E=c0(T);return!1===E?tf.None:"both"===E?tf.Both:tf.Vertical})(T);if(B===tf.None)return A.none();let M=B===tf.Both?"Press the arrow keys to resize the editor.":"Press the Up and Down arrow keys to resize the editor.";return A.some(ob("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:E.translate("Resize"),"aria-label":E.translate(M)},behaviours:[vJ.config({mode:"mouse",repositionTarget:!1,onDrag:(E,M,D)=>JF(T,D,B),blockerClass:"tox-blocker"}),sZ.config({mode:"special",onLeft:()=>ZF(T,B,-1,0),onRight:()=>ZF(T,B,1,0),onUp:()=>ZF(T,B,0,-1),onDown:()=>ZF(T,B,0,1)}),m6.config({}),s3.config({})]},E.icons))})(T,E);return B.concat(M.toArray())})()}},eR=(T,E)=>E.get().getOrDie(`UI for ${T} has not been rendered`),tR=(T,E)=>{let B=T.inline,M=B?vg:vr,D=dv(T)?fb:h5,er=(()=>{let T=nc(),E=nc(),B=nc();return{dialogUi:T,popupUi:E,mainUi:B,getUiMotherships:()=>{let B=T.get().map(T=>T.mothership),M=E.get().map(T=>T.mothership);return B.fold(()=>M.toArray(),T=>M.fold(()=>[T],E=>Qe(T.element,E.element)?[T]:[T,E]))},lazyGetInOuterOrDie:(T,E)=>()=>B.get().bind(T=>E(T.outerContainer)).getOrDie(`Could not find ${T} element in OuterContainer`)}})(),ea=nc(),es=nc(),eu=nc(),eg=Bo().deviceType.isTouch()?["tox-platform-touch"]:[],ep=rv(T),eh=cI(T),ef=Xh({dom:{tag:"div",classes:["tox-anchorbar"]}}),ex=Xh({dom:{tag:"div",classes:["tox-bottom-anchorbar"]}}),p=()=>er.mainUi.get().map(T=>T.outerContainer).bind(bI.getHeader),eC=er.lazyGetInOuterOrDie("anchor bar",ef.getOpt),eM=er.lazyGetInOuterOrDie("bottom anchor bar",ex.getOpt),eD=er.lazyGetInOuterOrDie("toolbar",bI.getToolbar),eI=er.lazyGetInOuterOrDie("throbber",bI.getThrobber),eL=((T,E,B,M)=>{let D=As(!1),er=(T=>{let E=As(rv(T)?"bottom":"top");return{isPositionedAtTop:()=>"top"===E.get(),getDockingMode:E.get,setDockingMode:E.set}})(E),ea={icons:()=>E.ui.registry.getAll().icons,menuItems:()=>E.ui.registry.getAll().menuItems,translate:lG.translate,isDisabled:()=>E.mode.isReadOnly()||!E.ui.isEnabled(),getOption:E.options.get},es=pA(E),eu=(T=>{let t=E=>()=>T.formatter.match(E),o=E=>()=>{let B=T.formatter.get(E);return void 0!==B?A.some({tag:B.length>0&&(B[0].inline||B[0].block)||"div",styles:T.dom.parseStyle(T.formatter.getCssText(E))}):A.none()},E=As([]),B=As([]),M=As(!1);return T.on("PreInit",B=>{let M=PE(T),D=WE(T,M,t,o);E.set(D)}),T.on("addStyleModifications",E=>{let D=WE(T,E.items,t,o);B.set(D),M.set(E.replace)}),{getData:()=>{let T=M.get()?[]:E.get(),D=B.get();return T.concat(D)}}})(E),eg={colorPicker:BE(E),hasCustomColors:IE(E),getColors:FE(E),getColorCols:RE(E)},ep={isDraggableModal:NE(E)},eh={shared:{providers:ea,anchors:DE(E,B,M,er.isPositionedAtTop),header:er},urlinput:es,styles:eu,colorinput:eg,dialog:ep,isContextMenuOpen:()=>D.get(),setContextMenuState:T=>D.set(T)},ef={...eh,shared:{...eh.shared,interpreter:T=>rE(T,{},ef),getSink:T.popup}},ex={...eh,shared:{...eh.shared,interpreter:T=>rE(T,{},ex),getSink:T.dialog}};return{popup:ef,dialog:ex}})({popup:()=>tE.fromOption(er.popupUi.get().map(T=>T.sink),"(popup) UI has not been rendered"),dialog:()=>tE.fromOption(er.dialogUi.get().map(T=>T.sink),"UI has not been rendered")},T,eC,eM),x=()=>{let E=(()=>{let E={attributes:{[rr]:ep?l0.BottomToTop:l0.TopToBottom}},B=bI.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:eL.popup,onEscape:()=>{T.focus()}}),M=bI.parts.toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:eL.popup.shared.getSink,providers:eL.popup.shared.providers,onEscape:()=>{T.focus()},onToolbarToggled:E=>{((T,E)=>{T.dispatch("ToggleToolbarDrawer",{state:E})})(T,E)},type:eh,lazyToolbar:eD,lazyHeader:()=>p().getOrDie("Could not find header element"),...E}),D=bI.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:eL.popup.shared.providers,onEscape:()=>{T.focus()},type:eh}),er=sv(T),ea=ov(T),es=Zb(T),eu=c3(T),eg=bI.parts.promotion({dom:{tag:"div",classes:["tox-promotion"]}}),ex=er||ea||es,eC=eu?[eg,B]:[B];return bI.parts.header({dom:{tag:"div",classes:["tox-editor-header"].concat(ex?[]:["tox-editor-header--empty"]),...E},components:q([es?eC:[],er?[D]:ea?[M]:[],iv(T)?[]:[ef.asSpec()]]),sticky:dv(T),editor:T,sharedBackstage:eL.popup.shared})})(),M={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[bI.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),bI.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}})]},D=bI.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:eL.popup}),er=bI.parts.viewWrapper({backstage:eL.popup}),es=cZ(T)&&!B?A.some(QF(T,eL.popup.shared.providers)):A.none(),eu=q([ep?[]:[E],B?[]:[M],ep?[E]:[]]),eC=bI.parts.editorContainer({components:q([eu,B?[]:[ex.asSpec(),...es.toArray()]])}),eO=cv(T),eM={role:"application",...lG.isRtl()?{dir:"rtl"}:{},...eO?{"aria-hidden":"true"}:{}},eI=ci(bI.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(B?["tox-tinymce-inline"]:[]).concat(ep?["tox-tinymce--toolbar-bottom"]:[]).concat(eg),styles:{visibility:"hidden",...eO?{opacity:"0",border:"0"}:{}},attributes:eM},components:[eC,...B?[]:[er],D],behaviours:Tl([Ox(),aj.config({disableClass:"tox-tinymce--disabled"}),sZ.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),eV=lk(eI);return ea.set(eV),{mothership:eV,outerContainer:eI}},w=E=>{let B=oI((T=>{let E=(T=>{let E=co(T),B=cu(T),M=cb(T);return tI(E).map(T=>nI(T,B,M))})(T);return E.getOr(co(T))})(T)),M=oI(sI(T).getOr(cr(T)));return T.inline||(Lt("div","width",M)&&Bt(E.element,"width",M),Lt("div","height",B)?Bt(E.element,"height",B):Bt(E.element,"height","400px")),B};return{popups:{backstage:eL.popup,getMothership:()=>eR("popups",eu)},dialogs:{backstage:eL.dialog,getMothership:()=>eR("dialogs",es)},renderUI:()=>{let B=x(),ea=(()=>{let E=lv(T),B=Qe(wt(),E)&&"grid"===Rt(E,"display"),M={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(eg),attributes:{...lG.isRtl()?{dir:"rtl"}:{}}},behaviours:Tl([rN.config({useFixed:()=>D.isDocked(p)})])},er={dom:{styles:{width:document.body.clientWidth+"px"}},events:Hr([Wr(oN(),T=>{Bt(T.element,"width",document.body.clientWidth+"px")})])},ea=ci(tM(M,B?er:{})),eu=lk(ea);return es.set(eu),{sink:ea,mothership:eu}})(),ep=uv(T)?(()=>{let T={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-silver-popup-sink","tox-tinymce-aux"].concat(eg),attributes:{...lG.isRtl()?{dir:"rtl"}:{}}},behaviours:Tl([rN.config({useFixed:()=>D.isDocked(p),getBounds:()=>E.getPopupSinkBounds()})])},B=ci(T),M=lk(B);return eu.set(M),{sink:B,mothership:M}})():(eu.set(ea.mothership),ea);return er.dialogUi.set(ea),er.popupUi.set(ep),er.mainUi.set(B),(E=>{var B;let{mainUi:er,popupUi:ea,uiMotherships:es}=E;ce(cR(T),(E,B)=>{T.ui.registry.addGroupToolbarButton(B,E)});let{buttons:eu,menuItems:eg,contextToolbars:ep,sidebars:ef,views:ex}=T.ui.registry.getAll(),eC=nv(T),eM={menuItems:eg,menus:mv(T),menubar:cz(T),toolbar:eC.getOrThunk(()=>cP(T)),allowToolbarGroups:eh===l5.floating,buttons:eu,sidebar:ef,views:ex};B=er.outerContainer,T.addShortcut("alt+F9","focus menubar",()=>{bI.focusMenubar(B)}),T.addShortcut("alt+F10","focus toolbar",()=>{bI.focusToolbar(B)}),T.addCommand("ToggleToolbarDrawer",(T,E)=>{(null==E?void 0:E.skipFocus)?bI.toggleToolbarDrawerWithoutFocusing(B):bI.toggleToolbarDrawer(B)}),T.addQueryStateHandler("ToggleToolbarDrawer",()=>bI.isToolbarDrawerToggled(B)),((T,E,B)=>{let n=(T,M)=>{H([E,...B],E=>{E.broadcastEvent(T,M)})},s=(T,M)=>{H([E,...B],E=>{E.broadcastOn([T],M)})},r=T=>s(r$(),{target:T.target}),M=qo(),D=rc(M,"touchstart",r),er=rc(M,"touchmove",T=>n(oL(),T)),ea=rc(M,"touchend",T=>n(oV(),T)),es=rc(M,"mousedown",r),eu=rc(M,"mouseup",T=>{0===T.raw.button&&s(rY(),{target:T.target})}),m=T=>s(r$(),{target:Fe(T.target)}),g=T=>{0===T.button&&s(rY(),{target:Fe(T.target)})},p=()=>{H(T.editorManager.get(),E=>{T!==E&&E.dispatch("DismissPopups",{relatedTarget:T})})},h=T=>n(oH(),Io(T)),f=T=>{s(rj(),{}),n(oN(),Io(T))},eg=eU(Fe(T.getElement())),ep=ac(eg,"scroll",B=>{requestAnimationFrame(()=>{if(null!=T.getContainer()){let M=XS(T,E.element).map(T=>[T.element,...T.others]).getOr([]);N(M,T=>Qe(T,B.target))&&(T.dispatch("ElementScroll",{target:B.target.dom}),n(oj(),B))}})}),y=()=>s(rj(),{}),x=E=>{E.state&&s(r$(),{target:Fe(T.getContainer())})},w=T=>{s(r$(),{target:Fe(T.relatedTarget.getContainer())})};T.on("PostRender",()=>{T.on("click",m),T.on("tap",m),T.on("mouseup",g),T.on("mousedown",p),T.on("ScrollWindow",h),T.on("ResizeWindow",f),T.on("ResizeEditor",y),T.on("AfterProgressState",x),T.on("DismissPopups",w)}),T.on("remove",()=>{T.off("click",m),T.off("tap",m),T.off("mouseup",g),T.off("mousedown",p),T.off("ScrollWindow",h),T.off("ResizeWindow",f),T.off("ResizeEditor",y),T.off("AfterProgressState",x),T.off("DismissPopups",w),es.unbind(),D.unbind(),er.unbind(),ea.unbind(),eu.unbind(),ep.unbind()}),T.on("detach",()=>{H([E,...B],Pd),H([E,...B],T=>T.destroy())})})(T,er.mothership,es),D.setup(T,eL.popup.shared,p),VI(T,eL.popup),sF(T,eL.popup.shared.getSink,eL.popup),(T=>{let{sidebars:E}=T.ui.registry.getAll();H(eO(E),B=>{let M=E[B],s=()=>xe(A.from(T.queryCommandValue("ToggleSidebar")),B);T.ui.registry.addToggleButton(B,{icon:M.icon,tooltip:M.tooltip,onAction:E=>{T.execCommand("ToggleSidebar",!1,B),E.setActive(s())},onSetup:E=>{E.setActive(s());let o=()=>E.setActive(s());return T.on("ToggleSidebar",o),()=>{T.off("ToggleSidebar",o)}}})})})(T),NM(T,eI,eL.popup.shared),EI(T,ep,ea.sink,{backstage:eL.popup}),YF(T,ea.sink);let eD={targetNode:T.getElement(),height:w(er.outerContainer)};return M.render(T,E,eM,eL.popup,eD)})({popupUi:ep,dialogUi:ea,mainUi:B,uiMotherships:er.getUiMotherships()})}}},vQ=x([ns("lazySink"),ms("dragBlockClass"),_s("getBounds",tn),xs("useTabstopAt",ep),xs("firstTabstop",0),xs("eventOrder",{}),yu("modalBehaviours",[sZ]),Ni("onExecute"),zi("onEscape")]),v0={sketch:w},v1=x([aE({name:"draghandle",overrides:(T,E)=>({behaviours:Tl([vJ.config({mode:"mouse",getTarget:T=>fi(T,'[role="dialog"]').getOr(T),blockerClass:T.dragBlockClass.getOrDie(Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(E,null,2)).message),getBounds:T.getDragBounds})])})}),aT({schema:[ns("dom")],name:"title"}),aT({factory:v0,schema:[ns("dom")],name:"close"}),aT({factory:v0,schema:[ns("dom")],name:"body"}),aE({factory:v0,schema:[ns("dom")],name:"footer"}),a_({factory:{sketch:(T,E)=>({...T,dom:E.dom,components:E.components})},schema:[xs("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),xs("components",[])],name:"blocker"})]),v2=wm({name:"ModalDialog",configFields:vQ(),partFields:v1(),factory:(T,E,B,M)=>{let D=nc(),er=ca("modal-events"),ea={...T.eventOrder,[oW()]:[er].concat(T.eventOrder["alloy.system.attached"]||[])};return{uid:T.uid,dom:T.dom,components:E,apis:{show:E=>{D.set(E);let B=T.lazySink(E).getOrDie(),er=M.blocker(),ea=B.getSystem().build({...er,components:er.components.concat([ka(E)]),behaviours:Tl([s3.config({}),th("dialog-blocker-events",[Kr(t0(),()=>{fP.isBlocked(E)||sZ.focusIn(E)})])])});Id(B,ea),sZ.focusIn(E)},hide:T=>{D.clear(),rt(T.element).each(E=>{T.getSystem().getByDom(E).each(T=>{Nd(T)})})},getBody:E=>im(E,T,"body"),getFooter:E=>am(E,T,"footer"),setIdle:T=>{fP.unblock(T)},setBusy:(T,E)=>{fP.block(T,E)}},eventOrder:ea,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:wu(T.modalBehaviours,[sQ.config({}),sZ.config({mode:"cyclic",onEnter:T.onExecute,onEscape:T.onEscape,useTabstopAt:T.useTabstopAt,firstTabstop:T.firstTabstop}),fP.config({getRoot:D.get}),th(er,[oZ(E=>{((T,E)=>{let B=Tt(T,"id").fold(()=>{let T=ca("dialog-label");return Ct(E,"id",T),T},w);Ct(T,"aria-labelledby",B)})(E.element,im(E,T,"title").element)})])])}},apis:{show:(T,E)=>{T.show(E)},hide:(T,E)=>{T.hide(E)},getBody:(T,E)=>T.getBody(E),getFooter:(T,E)=>T.getFooter(E),setBusy:(T,E,B)=>{T.setBusy(E,B)},setIdle:(T,E)=>{T.setIdle(E)}}}),v3=Bn([dW,dz].concat(uP)),v5=[Dy("button"),d0,Cs("align","end",["start","end"]),d8,d4,fs("buttonType",["primary","secondary"])],v9=[...v5,dU],v6=[is("type",["submit","cancel","custom"]),...v9],v4=[is("type",["menu"]),dQ,d1,d0,us("items",v3),...v5],v8=[...v5,is("type",["togglebutton"]),as("tooltip"),d0,dQ,Os("active",!1)],v7=Zn("type",{submit:v6,cancel:v6,custom:v6,menu:v4,togglebutton:v8}),xo=[dW,dU,is("level",["info","warn","error","success"]),d$,xs("url","")],xr=Bn(xo),xi=[dW,dU,d4,Dy("button"),d0,d6,fs("buttonType",["primary","secondary","toolbar"]),d8],xd=Bn(xi),xp=[dW,dz],xb=xp.concat([d2]),xv=xp.concat([dP,d4]),xx=Bn(xv),xy=xb.concat([Ty("auto")]),xA=Bn(xy),xT=tV([dj,dU,d$]),xk=xb.concat([ks("storageKey","default")]),xO=Bn(xk),x_=Bn(xb),xB=xp.concat([ks("tag","textarea"),as("scriptId"),as("scriptUrl"),ws("settings",void 0,tU)]),xD=xp.concat([ks("tag","textarea"),ls("init")]),xR=$n(T=>Yn("customeditor.old",Dn(xD),T).orThunk(()=>Yn("customeditor.new",Dn(xB),T))),xL=Bn(xb),xH=In(tL),VR=T=>[dW,rs("columns"),T],xN=[dW,as("html"),Cs("presets","presentation",["presentation","document"])],xW=Bn(xN),xz=xb.concat([Os("border",!1),Os("sandboxed",!0),Os("streamContent",!1),Os("transparent",!0)]),xP=Bn(xz),xU=Bn(xp.concat([hs("height")])),xG=Bn([as("url"),ps("zoom"),ps("cachedWidth"),ps("cachedHeight")]),x$=xb.concat([hs("inputMode"),hs("placeholder"),Os("maximized",!1),d4]),xj=Bn(x$),YR=T=>[dW,dP,T,Cs("align","start",["start","center","end"])],xY=[dU,dj],xX=[dU,us("items",Qn(0,()=>xq))],xq=Fn([Bn(xY),Bn(xX)]),xK=xb.concat([us("items",xq),d4]),xZ=Bn(xK),xJ=xb.concat([ds("items",[dU,dj]),Ss("size",1),d4]),xQ=Bn(xJ),x0=xb.concat([Os("constrain",!0),d4]),x1=Bn(x0),x2=Bn([as("width"),as("height")]),x3=xp.concat([dP,Ss("min",0),Ss("max",0)]),x5=Bn(x3),x9=[dW,us("header",tW),us("cells",In(tW))],x6=Bn(x9),x4=xb.concat([hs("placeholder"),Os("maximized",!1),d4]),x8=Bn(x4),x7=[is("type",["directory","leaf"]),dG,as("id"),gs("menu",fy)],yo=Bn(x7),yr=x7.concat([us("children",Qn(0,()=>Gn("type",{directory:ya,leaf:yo})))]),ya=Bn(yr),yc=Gn("type",{directory:ya,leaf:yo}),yd=[dW,us("items",yc),bs("onLeafAction"),bs("onToggleExpand"),Ts("defaultExpandedIds",[],tW),hs("defaultSelectedId")],ym=Bn(yd),yh=xb.concat([Cs("filetype","file",["image","media","file"]),d4,hs("picker_text")]),yb=Bn(yh),yv=Bn([dj,d7]),ON=T=>pn("items","items",{tag:"required",process:{}},In($n(E=>Yn(`Checking item of ${T}`,yx,E).fold(T=>tE.error(Jn(T)),T=>tE.value(T))))),yx=An(()=>Gn("type",{alertbanner:xr,bar:Bn([dW,ON("bar")]),button:xd,checkbox:xx,colorinput:xO,colorpicker:x_,dropzone:xL,grid:Bn(VR(ON("grid"))),iframe:xP,input:xj,listbox:xZ,selectbox:xQ,sizeinput:x1,slider:x5,textarea:x8,urlinput:yb,customeditor:xR,htmlpanel:xW,imagepreview:xU,collection:xA,label:Bn(YR(ON("label"))),table:x6,tree:ym,panel:yA})),yy=[dW,xs("classes",[]),us("items",yx)],yA=Bn(yy),yO=[Dy("tab"),dG,us("items",yx)],y_=[dW,ds("tabs",yO)],yB=Bn(y_),yM=Bn([as("title"),ss("body",Gn("type",{panel:yA,tabpanel:yB})),ks("size","normal"),Ts("buttons",[],v7),xs("initialData",{}),_s("onAction",b),_s("onChange",b),_s("onSubmit",b),_s("onClose",b),_s("onCancel",b),_s("onTabChange",b)]),yD=Bn([is("type",["cancel","custom"]),...v9]),yR=Bn([as("title"),as("url"),ps("height"),ps("width"),vs("buttons",yD),_s("onAction",b),_s("onCancel",b),_s("onClose",b),_s("onMessage",b)]),VN=T=>B(T)?[T].concat(Y(fe(T),VN)):M(T)?Y(T,VN):[],zN=T=>E(T.type)&&E(T.name),yL={checkbox:tz,colorinput:tW,colorpicker:tW,dropzone:xH,input:tW,iframe:tW,imagepreview:xG,selectbox:tW,sizeinput:x2,slider:tN,listbox:tW,size:x2,textarea:tW,urlinput:yv,customeditor:tW,collection:xT,togglemenuitem:tz},HN=T=>{let E=U(VN(T),zN),B=Y(E,T=>A.from(yL[T.type]).fold(()=>[],E=>[ss(T.name,E)]));return Bn(B)},PN=T=>{var E;return{internalDialog:Xn(Yn("dialog",yM,T)),dataValidator:HN(T),initialData:null!==(E=T.initialData)&&void 0!==E?E:{}}},yH={open:(T,E)=>{let B=PN(E);return T(B.internalDialog,B.initialData,B.dataValidator)},openUrl:(T,E)=>T(Xn(Yn("dialog",yR,E))),redial:T=>PN(T)};var yN=Object.freeze({__proto__:null,events:(T,E)=>{let o=(B,M)=>{T.updateState.each(T=>{let D=T(B,M);E.set(D)}),T.renderComponents.each(D=>{let er=D(M,E.get());(T.reuseDom?qp:$p)(B,er)})};return Hr([Wr(of(),(E,B)=>{if(!B.universal){let M=T.channel;R(B.channels,M)&&o(E,B.data)}}),oZ((E,B)=>{T.initialData.each(T=>{o(E,T)})})])}}),yW=Object.freeze({__proto__:null,getState:(T,E,B)=>B}),yz=[ns("channel"),ms("renderComponents"),ms("updateState"),ms("initialData"),Os("reuseDom",!0)];let yP=Al({fields:yz,name:"reflecting",active:yN,apis:yW,state:Object.freeze({__proto__:null,init:()=>{let T=As(A.none());return{readState:()=>T.get().getOr("none"),get:T.get,set:T.set,clear:()=>T.set(A.none())}}})}),qN=T=>{let E=[],B={};return le(T,(T,M)=>{T.fold(()=>{E.push(M)},T=>{B[M]=T})}),E.length>0?tE.error(E):tE.value(B)},YN=(T,E,B)=>{let M=Xh(pb.sketch(M=>({dom:{tag:"div",classes:["tox-form"].concat(T.classes)},components:L(T.items,T=>nE(M,T,E,B))})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[M.asSpec()]}],behaviours:Tl([sZ.config({mode:"acyclic",useTabstopAt:C(n_)}),az.config({find:M.getOpt}),WO(M,{postprocess:T=>qN(T).fold(T=>(console.error(T),{}),w)}),th("dialog-body-panel",[Wr(t0(),(T,E)=>{T.getSystem().broadcastOn([pz],{newFocus:A.some(E.event.target)})})])])}},yU=xm({name:"TabButton",configFields:[xs("uid",void 0),ns("value"),pn("dom","dom",wn(()=>({attributes:{role:"tab",id:ca("aria"),"aria-selected":"false"}})),tH()),ms("action"),xs("domModification",{}),yu("tabButtonBehaviours",[s3,sZ,r2]),ns("view")],factory:(T,E)=>({uid:T.uid,dom:T.dom,components:T.components,events:fh(T.action),behaviours:wu(T.tabButtonBehaviours,[s3.config({}),sZ.config({mode:"execution",useSpace:!0,useEnter:!0}),r2.config({store:{mode:"memory",initialValue:T.value}})]),domModification:T.domModification})}),yG=x([ns("tabs"),ns("dom"),xs("clickToDismiss",!1),yu("tabbarBehaviours",[aq,sZ]),Ii(["tabClass","selectedClass"])]),y$=aB({factory:yU,name:"tabs",unit:"tab",overrides:T=>{let t=(T,E)=>{aq.dehighlight(T,E),Rr(T,oX(),{tabbar:T,button:E})},o=(T,E)=>{aq.highlight(T,E),Rr(T,oY(),{tabbar:T,button:E})};return{action:E=>{let B=E.getSystem().getByUid(T.uid).getOrDie(),M=aq.isHighlighted(B,E);(M&&T.clickToDismiss?t:M?b:o)(B,E)},domModification:{classes:[T.markers.tabClass]}}}}),yj=x([y$]),yY=wm({name:"Tabbar",configFields:yG(),partFields:yj(),factory:(T,E,B,M)=>({uid:T.uid,dom:T.dom,components:E,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:wu(T.tabbarBehaviours,[aq.config({highlightClass:T.markers.selectedClass,itemClass:T.markers.tabClass,onHighlight:(T,E)=>{Ct(E.element,"aria-selected","true")},onDehighlight:(T,E)=>{Ct(E.element,"aria-selected","false")}}),sZ.config({mode:"flow",getInitial:T=>aq.getHighlighted(T).map(T=>T.element),selector:"."+T.markers.tabClass,executeOnMove:!0})])})}),yX=xm({name:"Tabview",configFields:[yu("tabviewBehaviours",[sQ])],factory:(T,E)=>({uid:T.uid,dom:T.dom,behaviours:wu(T.tabviewBehaviours,[sQ.config({})]),domModification:{attributes:{role:"tabpanel"}}})}),yq=x([xs("selectFirst",!0),Ri("onChangeTab"),Ri("onDismissTab"),xs("tabs",[]),yu("tabSectionBehaviours",[])]),yK=aT({factory:yY,schema:[ns("dom"),cs("markers",[ns("tabClass"),ns("selectedClass")])],name:"tabbar",defaults:T=>({tabs:T.tabs})}),yZ=aT({factory:yX,name:"tabview"}),yJ=x([yK,yZ]),yQ=wm({name:"TabSection",configFields:yq(),partFields:yJ(),factory:(T,E,B,M)=>{let s=(E,B)=>{am(E,T,"tabbar").each(T=>{B(T).each(Nr)})};return{uid:T.uid,dom:T.dom,components:E,behaviours:xu(T.tabSectionBehaviours),events:Hr(q([T.selectFirst?[oZ((T,E)=>{s(T,aq.getFirst)})]:[],[Wr(oY(),(E,B)=>{(E=>{let B=r2.getValue(E);am(E,T,"tabview").each(M=>{G(T.tabs,T=>T.value===B).each(B=>{let D=B.view();Tt(E.element,"id").each(T=>{Ct(M.element,"aria-labelledby",T)}),sQ.set(M,D),T.onChangeTab(M,E,D)})})})(B.event.button)}),Wr(oX(),(E,B)=>{let M=B.event.button;T.onDismissTab(E,M)})]])),apis:{getViewItems:E=>am(E,T,"tabview").map(T=>sQ.contents(T)).getOr([]),showTab:(T,E)=>{s(T,T=>{let B=aq.getCandidates(T);return G(B,T=>r2.getValue(T)===E).filter(E=>!aq.isHighlighted(T,E))})}}}},apis:{getViewItems:(T,E)=>T.getViewItems(E),showTab:(T,E,B)=>{T.showTab(E,B)}}}),aV=(T,E)=>{Bt(T,"height",E+"px"),Bt(T,"flex-basis",E+"px")},iV=(T,E,B)=>{fi(T,'[role="dialog"]').each(T=>{vi(T,'[role="tablist"]').each(M=>{B.get().map(B=>(Bt(E,"height","0"),Bt(E,"flex-basis","0"),Math.min(B,((T,E,B)=>{let M;let D=nt(T).dom,er=fi(T,".tox-dialog-wrap").getOr(T);M="fixed"===Rt(er,"position")?Math.max(D.clientHeight,window.innerHeight):Math.max(D.offsetHeight,D.scrollHeight);let ea=jt(E),es=E.dom.offsetLeft>=B.dom.offsetLeft+Zt(B)?Math.max(jt(B),ea):ea,eu=parseInt(Rt(T,"margin-top"),10)||0,eg=parseInt(Rt(T,"margin-bottom"),10)||0;return M-(jt(T)+eu+eg-es)})(T,E,M)))).each(T=>{aV(E,T)})})})},lV=T=>vi(T,'[role="tabpanel"]'),y0="send-data-to-section",y1="send-data-to-view",uV=(T,E,B)=>{let M=As({}),s=T=>{let E=r2.getValue(T),B=qN(E).getOr({}),D=M.get(),er=tM(D,B);M.set(er)},r=T=>{let E=M.get();r2.setValue(T,E)},D=As(null),er=L(T.tabs,T=>({value:T.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"]},components:[ri(B.shared.providers.translate(T.title))],view:()=>[pb.sketch(M=>({dom:{tag:"div",classes:["tox-form"]},components:L(T.items,T=>nE(M,T,E,B)),formBehaviours:Tl([sZ.config({mode:"acyclic",useTabstopAt:C(n_)}),th("TabView.form.events",[oZ(r),oJ(s)]),n0.config({channels:Bs([{key:y0,value:{onReceive:s}},{key:y1,value:{onReceive:r}}])})])}))]})),ea=(T=>{let E=nc(),B=[oZ(B=>{let M=B.element;lV(M).each(D=>{Bt(D,"visibility","hidden"),B.getSystem().getByDom(D).toOptional().each(B=>{let M=L(T,(E,M)=>{sQ.set(B,T[M].view());let er=D.dom.getBoundingClientRect();return sQ.set(B,[]),er.height}),er=oe(ee(M,(T,E)=>T>E?-1:T<E?1:0));er.fold(E.clear,E.set)}),iV(M,D,E),Ht(D,"visibility"),((T,E)=>{oe(T).each(T=>yQ.showTab(E,T.value))})(T,B),requestAnimationFrame(()=>{iV(M,D,E)})})}),Wr(oN(),T=>{let B=T.element;lV(B).each(T=>{iV(B,T,E)})}),Wr(gh,(T,B)=>{let M=T.element;lV(M).each(T=>{let B=zl(eU(T));Bt(T,"visibility","hidden");let D=Vt(T,"height").map(T=>parseInt(T,10));Ht(T,"height"),Ht(T,"flex-basis");let er=T.dom.getBoundingClientRect().height;D.forall(T=>er>T)?(E.set(er),iV(M,T,E)):D.each(E=>{aV(T,E)}),Ht(T,"visibility"),B.each(Rl)})})];return{extraEvents:B,selectFirst:!1}})(er);return yQ.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:(T,E,B)=>{let M=r2.getValue(E);Rr(T,gg,{name:M,oldName:D.get()}),D.set(M)},tabs:er,components:[yQ.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[yY.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:Tl([m6.config({})])}),yQ.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:ea.selectFirst,tabSectionBehaviours:Tl([th("tabpanel",ea.extraEvents),sZ.config({mode:"acyclic"}),az.config({find:T=>oe(yQ.getViewItems(T))}),jO(A.none(),T=>(T.getSystem().broadcastOn([y0],{}),M.get()),(T,E)=>{M.set(E),T.getSystem().broadcastOn([y1],{})})])})},mV=(T,E,B,M,D)=>({dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:{...B.map(T=>({id:T})).getOr({}),...D?{"aria-live":"polite"}:{}}},components:[],behaviours:Tl([PO(0),yP.config({channel:`${pH}-${E}`,updateState:(T,E)=>A.some({isTabPanel:()=>"tabpanel"===E.body.type}),renderComponents:T=>{let E=T.body;return"tabpanel"===E.type?[uV(E,T.initialData,M)]:[YN(E,T.initialData,M)]},initialData:T})])}),y2=l8.deviceType.isTouch(),pV=(T,E)=>({dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[T,E]}),hV=(T,E)=>v2.parts.close(iW.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":E.translate("Close")}},action:T,buttonBehaviours:Tl([m6.config({})])})),fV=()=>v2.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}}),bV=(T,E)=>v2.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:Yh(`<p>${$f(E.translate(T))}</p>`)}]}]}),vV=T=>v2.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:T}),yV=(T,E)=>[m0.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:T}),m0.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:E})],xV=T=>{let E="tox-dialog",B=E+"-wrap",M=B+"__backdrop",D=E+"__disable-scroll";return v2.sketch({lazySink:T.lazySink,onEscape:E=>(T.onEscape(E),A.some(!0)),useTabstopAt:T=>!n_(T),firstTabstop:T.firstTabstop,dom:{tag:"div",classes:[E].concat(T.extraClasses),styles:{position:"relative",...T.extraStyles}},components:[T.header,T.body,...T.footer.toArray()],parts:{blocker:{dom:Yh(`<div class="${B}"></div>`),components:[{dom:{tag:"div",classes:y2?[M,M+"--opaque"]:[M]}}]}},dragBlockClass:B,modalBehaviours:Tl([s3.config({}),th("dialog-events",T.dialogEvents.concat([Kr(t0(),(T,E)=>{fP.isBlocked(T)||sZ.focusIn(T)}),Wr(oG(),(T,E)=>{T.getSystem().broadcastOn([pz],{newFocus:E.event.newFocus})})])),th("scroll-lock",[oZ(()=>{Wa(wt(),D)}),oJ(()=>{Ga(wt(),D)})]),...T.extraBehaviours]),eventOrder:{[ox()]:["dialog-events"],[oW()]:["scroll-lock","dialog-events","alloy.base.behaviour"],[oz()]:["alloy.base.behaviour","dialog-events","scroll-lock"],...T.eventOrder}})},wV=T=>iW.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":T.translate("Close"),title:T.translate("Close")}},buttonBehaviours:Tl([m6.config({})]),components:[ob("close",{tag:"span",classes:["tox-icon"]},T.icons)],action:T=>{Fr(T,go)}}),SV=(T,E,B,M)=>({dom:{tag:"div",classes:["tox-dialog__title"],attributes:{...B.map(T=>({id:T})).getOr({})}},components:[],behaviours:Tl([yP.config({channel:`${pL}-${E}`,initialData:T,renderComponents:T=>[ri(M.translate(T.title))]})])}),kV=()=>({dom:Yh('<div class="tox-dialog__draghandle"></div>')}),CV=(T,E,B)=>((T,E,B)=>{let M=v2.parts.title(SV(T,E,A.none(),B)),D=v2.parts.draghandle(kV()),er=v2.parts.close(wV(B)),ea=[M].concat(T.draggable?[D]:[]).concat([er]);return m0.sketch({dom:Yh('<div class="tox-dialog__header"></div>'),components:ea})})({title:B.shared.providers.translate(T),draggable:B.dialog.isDraggableModal()},E,B.shared.providers),OV=(T,E,B,M)=>({dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":B.translate(T)},styles:{left:"0px",right:"0px",bottom:"0px",top:`${M.getOr(0)}px`,position:"absolute"}},behaviours:E,components:[{dom:Yh('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),_V=(T,E,B)=>({onClose:()=>B.closeWindow(),onBlock:B=>{let M=vi(T().element,".tox-dialog__header").map(T=>jt(T));v2.setBusy(T(),(T,D)=>OV(B.message,D,E,M))},onUnblock:()=>{v2.setIdle(T())}}),y3="tox-dialog--fullscreen",y5="tox-dialog--width-lg",y9="tox-dialog--width-md",MV=T=>{switch(T){case"large":return A.some(y5);case"medium":return A.some(y9);default:return A.none()}},DV=(T,E)=>{let B=Fe(E.element.dom);$a(B,y3)||(Ya(B,[y5,y9]),MV(T).each(T=>Wa(B,T)))},BV=(T,E)=>{let B=Fe(T.element.dom),M=Xa(B),D=G(M,T=>T===y5||T===y9).or(MV(E));H([y3,...D.toArray()],T=>{La(B)?B.dom.classList.toggle(T):R(Ha(B),T)?Ua(B,T):Pa(B,T),ja(B)})},IV=(T,E,B)=>ci(xV({...T,firstTabstop:1,lazySink:B.shared.getSink,extraBehaviours:[$O({}),...T.extraBehaviours],onEscape:T=>{Fr(T,go)},dialogEvents:E,eventOrder:{[of()]:[yP.name(),n0.name()],[oW()]:["scroll-lock",yP.name(),"messages","dialog-events","alloy.base.behaviour"],[oz()]:["alloy.base.behaviour","dialog-events","messages",yP.name(),"scroll-lock"]}})),FV=(T,E={})=>L(T,T=>"menu"===T.type?(T=>{let B=L(T.items,T=>{let B=be(E,T.name).getOr(As(!1));return{...T,storage:B}});return{...T,items:B}})(T):T),RV=T=>j(T,(T,E)=>"menu"===E.type?j(E.items,(T,E)=>(T[E.name]=E.storage,T),T):T,{}),NV=(T,E)=>[qr(t0(),o_),T(m7,(T,B,M,D)=>{zl(eU(D.element)).fold(b,Nl),E.onClose(),B.onClose()}),T(go,(T,E,B,M)=>{E.onCancel(T),Fr(M,m7)}),Wr(gc,(T,B)=>E.onUnblock()),Wr(ga,(T,B)=>E.onBlock(B.event))],VV=(T,E,B)=>{let n=(E,B)=>Wr(E,(E,M)=>{s(E,(D,er)=>{B(T(),D,M.event,E)})}),s=(T,E)=>{yP.getState(T).get().each(B=>{E(B.internalDialog,T)})};return[...NV(n,E),n(gr,(T,E)=>E.onSubmit(T)),n(m8,(T,E,B)=>{E.onChange(T,{name:B.name})}),n(gn,(T,E,M,D)=>{let r=()=>D.getSystem().isConnected()?sZ.focusIn(D):void 0,a=T=>Et(T,"disabled")||Tt(T,"aria-disabled").exists(T=>"true"===T),er=eU(D.element),ea=zl(er);E.onAction(T,{name:M.name,value:M.value}),zl(er).fold(r,T=>{a(T)||ea.exists(E=>et(T,E)&&a(E))?r():B().toOptional().filter(E=>!et(E.element,T)).each(r)})}),n(gg,(T,E,B)=>{E.onTabChange(T,{newTabName:B.name,oldTabName:B.oldName})}),oJ(E=>{let B=T();r2.setValue(E,B.getData())})]},zV=(T,E)=>{let B=E.map(T=>T.footerButtons).getOr([]),M=P(B,T=>"start"===T.align),s=(T,E)=>m0.sketch({dom:{tag:"div",classes:[`tox-dialog__footer-${T}`]},components:L(E,T=>T.memento.asSpec())});return[s("start",M.pass),s("end",M.fail)]},LV=(T,E,B)=>({dom:Yh('<div class="tox-dialog__footer"></div>'),components:[],behaviours:Tl([yP.config({channel:`${pN}-${E}`,initialData:T,updateState:(T,E)=>{let M=L(E.buttons,T=>{let E=Xh(PT(T,T.type,B));return{name:T.name,align:T.align,memento:E}});return A.some({lookupByName:E=>G(M,T=>T.name===E).bind(E=>E.memento.getOpt(T)),footerButtons:M})},renderComponents:zV})])}),HV=(T,E,B)=>v2.parts.footer(LV(T,E,B)),PV=(T,E)=>{if(T.getRoot().getSystem().isConnected()){let B=az.getCurrent(T.getFormWrapper()).getOr(T.getFormWrapper());return pb.getField(B,E).orThunk(()=>{let B=T.getFooter().bind(T=>yP.getState(T).get());return B.bind(T=>T.lookupByName(E))})}return A.none()},UV=(T,B,M)=>{let n=E=>{let B=T.getRoot();B.getSystem().isConnected()&&E(B)},D={getData:()=>{let E=T.getRoot(),B=E.getSystem().isConnected()?T.getFormWrapper():E;return{...r2.getValue(B),...ce(M,T=>T.get())}},setData:E=>{n(B=>{let er=D.getData(),ea=tM(er,E),es=((T,E)=>{let B=T.getRoot();return yP.getState(B).get().map(T=>Xn(Yn("data",T.dataValidator,E))).getOr(E)})(T,ea),eu=T.getFormWrapper();r2.setValue(eu,es),le(M,(T,E)=>{ve(ea,E)&&T.set(ea[E])})})},setEnabled:(E,B)=>{PV(T,E).each(B?aj.enable:aj.disable)},focus:E=>{PV(T,E).each(s3.focus)},block:T=>{if(!E(T))throw Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");n(E=>{Rr(E,ga,{message:T})})},unblock:()=>{n(T=>{Fr(T,gc)})},showTab:E=>{n(B=>{let M=T.getBody();yP.getState(M).get().exists(T=>T.isTabPanel())&&az.getCurrent(M).each(T=>{yQ.showTab(T,E)})})},redial:E=>{n(er=>{let ea=T.getId(),es=B(E),eu=FV(es.internalDialog.buttons,M);er.getSystem().broadcastOn([`${pR}-${ea}`],es),er.getSystem().broadcastOn([`${pL}-${ea}`],es.internalDialog),er.getSystem().broadcastOn([`${pH}-${ea}`],es.internalDialog),er.getSystem().broadcastOn([`${pN}-${ea}`],{...es.internalDialog,buttons:eu}),D.setData(es.initialData)})},close:()=>{n(T=>{Fr(T,m7)})},toggleFullscreen:T.toggleFullscreen};return D},WV=(T,E,B,M=!1,D)=>{var er,ea;let es=ca("dialog"),eu=ca("dialog-label"),eg=ca("dialog-content"),ep=T.internalDialog,eh=As(ep.size),ef=MV(eh.get()).toArray(),ex=Xh((er={title:ep.title,draggable:!0},ea=B.shared.providers,m0.sketch({dom:Yh('<div class="tox-dialog__header"></div>'),components:[SV(er,es,A.some(eu),ea),kV(),wV(ea)],containerBehaviours:Tl([vJ.config({mode:"mouse",blockerClass:"blocker",getTarget:T=>yi(T,'[role="dialog"]').getOrDie(),snaps:{getSnapPoints:()=>[],leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),eC=Xh(mV({body:ep.body,initialData:ep.initialData},es,A.some(eg),B,M)),eO=FV(ep.buttons),eM=RV(eO),eD=Ce(0!==eO.length,Xh(LV({buttons:eO},es,B))),eI=VV(()=>eV,{onBlock:T=>{fP.block(eL,(E,M)=>{let D=ex.getOpt(eL).map(T=>jt(T.element));return OV(T.message,M,B.shared.providers,D)})},onUnblock:()=>{fP.unblock(eL)},onClose:()=>E.closeWindow()},B.shared.getSink),eL=ci({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline",...ef],attributes:{role:"dialog","aria-labelledby":eu}},eventOrder:{[of()]:[yP.name(),n0.name()],[ox()]:["execute-on-form"],[oW()]:["reflecting","execute-on-form"]},behaviours:Tl([sZ.config({mode:"cyclic",onEscape:T=>(Fr(T,m7),A.some(!0)),useTabstopAt:T=>!n_(T)&&("button"!==We(T)||"disabled"!==_t(T,"disabled")),firstTabstop:1}),yP.config({channel:`${pR}-${es}`,updateState:(T,E)=>(eh.set(E.internalDialog.size),DV(E.internalDialog.size,T),D(),A.some(E)),initialData:T}),s3.config({}),th("execute-on-form",eI.concat([Kr(t0(),(T,E)=>{sZ.focusIn(T)}),Wr(oG(),(T,E)=>{T.getSystem().broadcastOn([pz],{newFocus:E.event.newFocus})})])),fP.config({getRoot:()=>A.some(eL)}),sQ.config({}),$O({})]),components:[ex.asSpec(),eC.asSpec(),...eD.map(T=>T.asSpec()).toArray()]}),eV=UV({getId:x(es),getRoot:x(eL),getFooter:()=>eD.map(T=>T.get(eL)),getBody:()=>eC.get(eL),getFormWrapper:()=>{let T=eC.get(eL);return az.getCurrent(T).getOr(T)},toggleFullscreen:()=>{BV(eL,eh.get())}},E.redial,eM);return{dialog:eL,instanceApi:eV}};var y6=tinymce.util.Tools.resolve("tinymce.util.URI");let y4=["insertContent","setContent","execCommand","close","block","unblock"],$V=T=>B(T)&&-1!==y4.indexOf(T.mceAction),qV=(T,M,D,ea)=>{let es=ca("dialog"),eu=CV(T.title,es,ea),eg=(T=>{let E={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[e_(A.none(),{dom:{tag:"iframe",attributes:{src:T.url}},behaviours:Tl([m6.config({}),s3.config({})])})]}],behaviours:Tl([sZ.config({mode:"acyclic",useTabstopAt:C(n_)})])};return v2.parts.body(E)})(T),ep=T.buttons.bind(T=>0===T.length?A.none():A.some(HV({buttons:T},es,ea))),eh=((T,E)=>{let o=(T,E)=>Wr(T,(T,B)=>{n(T,(M,D)=>{E(eL,M,B.event,T)})}),n=(T,E)=>{yP.getState(T).get().each(B=>{E(B,T)})};return[...NV(o,E),o(gn,(T,E,B)=>{E.onAction(T,{name:B.name})})]})(0,_V(()=>eI,ea.shared.providers,M)),ef={...T.height.fold(()=>({}),T=>({height:T+"px","max-height":T+"px"})),...T.width.fold(()=>({}),T=>({width:T+"px","max-width":T+"px"}))},ex=T.width.isNone()&&T.height.isNone()?["tox-dialog--width-lg"]:[],eC=new y6(T.url,{base_uri:new y6(window.location.href)}),eO=`${eC.protocol}://${eC.host}${eC.port?":"+eC.port:""}`,eM=oc(),eD=[yP.config({channel:`${pR}-${es}`,updateState:(T,E)=>A.some(E),initialData:T}),th("messages",[oZ(()=>{let E=rc(Fe(window),"message",E=>{if(eC.isSameOrigin(new y6(E.raw.origin))){let M=E.raw.data;$V(M)?((T,E,B)=>{switch(B.mceAction){case"insertContent":T.insertContent(B.content);break;case"setContent":T.setContent(B.content);break;case"execCommand":let M=!!er(B.ui)&&B.ui;T.execCommand(B.cmd,M,B.value);break;case"close":E.close();break;case"block":E.block(B.message);break;case"unblock":E.unblock()}})(D,eL,M):!$V(M)&&B(M)&&ve(M,"mceAction")&&T.onMessage(eL,M)}});eM.set(E)}),oJ(eM.clear)]),n0.config({channels:{[pW]:{onReceive:(T,E)=>{vi(T.element,"iframe").each(T=>{let B=T.dom.contentWindow;g(B)&&B.postMessage(E,eO)})}}}})],eI=IV({id:es,header:eu,body:eg,footer:ep,extraClasses:ex,extraBehaviours:eD,extraStyles:ef},eh,ea),eL=(T=>{let t=E=>{T.getSystem().isConnected()&&E(T)};return{block:T=>{if(!E(T))throw Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(E=>{Rr(E,ga,{message:T})})},unblock:()=>{t(T=>{Fr(T,gc)})},close:()=>{t(T=>{Fr(T,m7)})},sendMessage:T=>{t(E=>{E.getSystem().broadcastOn([pW],T)})}}})(eI);return{dialog:eI,instanceApi:eL}},YV=(T,E)=>Xn(Yn("data",E,T)),XV=T=>JS(T,".tox-alert-dialog")||JS(T,".tox-confirm-dialog"),KV=(T,E,B)=>E&&B?[]:[ft.config({contextual:{lazyContext:()=>A.some(Zo(Fe(T.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"],lazyViewport:E=>XS(T,E.element).map(T=>({bounds:KS(T),optScrollEnv:A.some({currentScrollTop:T.element.dom.scrollTop,scrollElmTop:Xt(T.element).top})})).getOrThunk(()=>({bounds:tn(),optScrollEnv:A.none()}))})],JV=T=>{let E=T.editor,B=dv(E),M=(T=>{let E=T.shared;return{open:(B,M)=>{let s=()=>{v2.hide(es),M()},D=Xh(PT({name:"close-alert",text:"OK",primary:!0,buttonType:A.some("primary"),align:"end",enabled:!0,icon:A.none()},"cancel",T)),er=fV(),ea=hV(s,E.providers),es=ci(xV({lazySink:()=>E.getSink(),header:pV(er,ea),body:bV(B,E.providers),footer:A.some(vV(yV([],[D.asSpec()]))),onEscape:s,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Wr(go,s)],eventOrder:{}}));v2.show(es);let eu=D.get(es);s3.focus(eu)}}})(T.backstages.dialog),D=(T=>{let E=T.shared;return{open:(B,M)=>{let s=T=>{v2.hide(eu),M(T)},D=Xh(PT({name:"yes",text:"Yes",primary:!0,buttonType:A.some("primary"),align:"end",enabled:!0,icon:A.none()},"submit",T)),er=PT({name:"no",text:"No",primary:!1,buttonType:A.some("secondary"),align:"end",enabled:!0,icon:A.none()},"cancel",T),ea=fV(),es=hV(()=>s(!1),E.providers),eu=ci(xV({lazySink:()=>E.getSink(),header:pV(ea,es),body:bV(B,E.providers),footer:A.some(vV(yV([],[er,D.asSpec()]))),onEscape:()=>s(!1),extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Wr(go,()=>s(!1)),Wr(gr,()=>s(!0))],eventOrder:{}}));v2.show(eu);let eg=D.get(eu);s3.focus(eg)}}})(T.backstages.dialog),r=(E,B)=>yH.open((E,M,D)=>{let er=((T,E,B)=>{let M=ca("dialog"),D=T.internalDialog,er=CV(D.title,M,B),ea=As(D.size),es=MV(ea.get()).toArray(),eu=((T,E,B)=>{let M=mV(T,E,A.none(),B,!1);return v2.parts.body(M)})({body:D.body,initialData:D.initialData},M,B),eg=FV(D.buttons),ep=RV(eg),eh=Ce(0!==eg.length,HV({buttons:eg},M,B)),ef=VV(()=>eM,_V(()=>eC,B.shared.providers,E),B.shared.getSink),ex={id:M,header:er,body:eu,footer:eh,extraClasses:es,extraBehaviours:[yP.config({channel:`${pR}-${M}`,updateState:(T,E)=>(ea.set(E.internalDialog.size),DV(E.internalDialog.size,T),A.some(E)),initialData:T})],extraStyles:{}},eC=IV(ex,ef,B),eO={getId:x(M),getRoot:x(eC),getBody:()=>v2.getBody(eC),getFooter:()=>v2.getFooter(eC),getFormWrapper:()=>{let T=v2.getBody(eC);return az.getCurrent(T).getOr(T)},toggleFullscreen:()=>{BV(eC,ea.get())}},eM=UV(eO,E.redial,ep);return{dialog:eC,instanceApi:eM}})({dataValidator:D,initialData:M,internalDialog:E},{redial:yH.redial,closeWindow:()=>{v2.hide(er.dialog),B(er.instanceApi)}},T.backstages.dialog);return v2.show(er.dialog),er.instanceApi.setData(M),er.instanceApi},E),a=(M,D,er,ea)=>yH.open((M,es,eu)=>{let eg=YV(es,eu),ep=nc(),eh=T.backstages.popup.shared.header.isPositionedAtTop(),m=()=>ep.on(T=>{iH.reposition(T),B&&eh||ft.refresh(T)}),ef=WV({dataValidator:eu,initialData:eg,internalDialog:M},{redial:yH.redial,closeWindow:()=>{ep.on(iH.hide),E.off("ResizeEditor",m),ep.clear(),er(ef.instanceApi)}},T.backstages.popup,ea.ariaAttrs,m),ex=ci(iH.sketch({lazySink:T.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:ea.persistent?{event:"doNotDismissYet"}:{},...eh?{}:{fireRepositionEventInstead:{}},inlineBehaviours:Tl([th("window-manager-inline-events",[Wr(oP(),(T,E)=>{Fr(ef.dialog,go)})]),...KV(E,B,eh)]),isExtraPart:(T,E)=>XV(E)}));return ep.set(ex),iH.showWithinBounds(ex,ka(ef.dialog),{anchor:D},()=>{let T=E.inline?wt():Fe(E.getContainer()),B=Zo(T);return A.some(B)}),B&&eh||(ft.refresh(ex),E.on("ResizeEditor",m)),ef.instanceApi.setData(eg),sZ.focusIn(ef.dialog),ef.instanceApi},M),i=(B,M,D,er)=>yH.open((B,ea,es)=>{let eu=YV(ea,es),eg=nc(),ep=T.backstages.popup.shared.header.isPositionedAtTop(),u=()=>eg.on(T=>{iH.reposition(T),ft.refresh(T)}),eh=WV({dataValidator:es,initialData:eu,internalDialog:B},{redial:yH.redial,closeWindow:()=>{eg.on(iH.hide),E.off("ResizeEditor ScrollWindow ElementScroll",u),eg.clear(),D(eh.instanceApi)}},T.backstages.popup,er.ariaAttrs,u),ef=ci(iH.sketch({lazySink:T.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:er.persistent?{event:"doNotDismissYet"}:{},...ep?{}:{fireRepositionEventInstead:{}},inlineBehaviours:Tl([th("window-manager-inline-events",[Wr(oP(),(T,E)=>{Fr(eh.dialog,go)})]),ft.config({contextual:{lazyContext:()=>A.some(Zo(Fe(E.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top","bottom"],lazyViewport:T=>XS(E,T.element).map(T=>({bounds:KS(T),optScrollEnv:A.some({currentScrollTop:T.element.dom.scrollTop,scrollElmTop:Xt(T.element).top})})).getOrThunk(()=>({bounds:tn(),optScrollEnv:A.none()}))})]),isExtraPart:(T,E)=>XV(E)}));return eg.set(ef),iH.showWithinBounds(ef,ka(eh.dialog),{anchor:M},()=>T.backstages.popup.shared.getSink().toOptional().bind(T=>{let B=XS(E,T.element).map(T=>KS(T)).getOr(tn()),M=Zo(Fe(E.getContentAreaContainer())),D=en(M,B);return A.some(Jo(D.x,D.y,D.width,D.height-15))})),ft.refresh(ef),E.on("ResizeEditor ScrollWindow ElementScroll ResizeWindow",u),eh.instanceApi.setData(eu),sZ.focusIn(eh.dialog),eh.instanceApi},B);return{open:(E,B,M)=>{if(!ea(B)){if("toolbar"===B.inline)return a(E,T.backstages.popup.shared.anchors.inlineDialog(),M,B);if("bottom"===B.inline)return i(E,T.backstages.popup.shared.anchors.inlineBottomDialog(),M,B);if("cursor"===B.inline)return a(E,T.backstages.popup.shared.anchors.cursor(),M,B)}return r(E,M)},openUrl:(B,M)=>yH.openUrl(B=>{let D=qV(B,{closeWindow:()=>{v2.hide(D.dialog),M(D.instanceApi)}},E,T.backstages.dialog);return v2.show(D.dialog),D.instanceApi},B),alert:(T,E)=>{M.open(T,E)},close:T=>{T.close()},confirm:(T,E)=>{D.open(T,E)}}};tO.add("silver",T=>{mb(T),(T=>{let B=T.options.register,o=T=>f(T,E)?{value:Rw(T),valid:!0}:{valid:!1,message:"Must be an array of strings."},n=T=>eu(T)&&T>0?{value:T,valid:!0}:{valid:!1,message:"Must be a positive number."};B("color_map",{processor:o,default:["#BFEDD2","Light Green","#FBEEB8","Light Yellow","#F8CAC6","Light Red","#ECCAFA","Light Purple","#C2E0F4","Light Blue","#2DC26B","Green","#F1C40F","Yellow","#E03E2D","Red","#B96AD9","Purple","#3598DB","Blue","#169179","Dark Turquoise","#E67E23","Orange","#BA372A","Dark Red","#843FA1","Dark Purple","#236FA1","Dark Blue","#ECF0F1","Light Gray","#CED4D9","Medium Gray","#95A5A6","Gray","#7E8C8D","Dark Gray","#34495E","Navy Blue","#000000","Black","#ffffff","White"]}),B("color_map_background",{processor:o}),B("color_map_foreground",{processor:o}),B("color_cols",{processor:n,default:Lw(T)}),B("color_cols_foreground",{processor:n,default:Hw(T,mO)}),B("color_cols_background",{processor:n,default:Hw(T,m_)}),B("custom_colors",{processor:"boolean",default:!0}),B("color_default_foreground",{processor:"string",default:mM}),B("color_default_background",{processor:"string",default:mM})})(T),(T=>{let B=T.options.register;B("contextmenu_avoid_overlap",{processor:"string",default:""}),B("contextmenu_never_use_native",{processor:"boolean",default:!1}),B("contextmenu",{processor:T=>!1===T?{value:[],valid:!0}:E(T)||f(T,E)?{value:zI(T),valid:!0}:{valid:!1,message:"Must be false or a string."},default:"link linkchecker image editimage table spellchecker configurepermanentpen"})})(T);let t=()=>tn(),{dialogs:B,popups:M,renderUI:D}=tR(T,{getPopupSinkBounds:()=>t()});GS(T,M.backstage.shared);let er=JV({editor:T,backstages:{popup:M.backstage,dialog:B.backstage}});return{renderUI:()=>{let E=D();return XS(T,M.getMothership().element).each(T=>{t=()=>KS(T)}),E},getWindowManagerImpl:x(er),getNotificationManagerImpl:()=>((T,E,B)=>{let M=E.backstage.shared,s=()=>{let E=Zo(Fe(T.getContentAreaContainer())),B=tn(),M=Qi(B.x,E.x,E.right),D=Qi(B.y,E.y,E.bottom),er=Math.max(E.right,B.right),ea=Math.max(E.bottom,B.bottom);return A.some(Jo(M,D,er-M,ea-D))};return{open:(E,D)=>{let a=()=>{D(),iH.hide(ea)},er=ci(lX.sketch({text:E.text,level:R(["success","error","warning","warn","info"],E.type)?E.type:void 0,progress:!0===E.progressBar,icon:E.icon,closeButton:E.closeButton,onAction:a,iconProvider:M.providers.icons,translationProvider:M.providers.translate})),ea=ci(iH.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:M.getSink,fireDismissalEventInstead:{},...M.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}}}));B.add(ea),eu(E.timeout)&&E.timeout>0&&iN.setEditorTimeout(T,()=>{a()},E.timeout);let es={close:a,reposition:()=>{let E=ka(er),B={maxHeightFunction:ro()},D=T.notificationManager.getNotifications();if(D[0]===es){let T={...M.anchors.banner(),overrides:B};iH.showWithinBounds(ea,E,{anchor:T},s)}else F(D,es).each(T=>{let M=D[T-1].getEl(),er={type:"node",root:wt(),node:A.some(Fe(M)),overrides:B,layouts:{onRtl:()=>[gl],onLtr:()=>[gl]}};iH.showWithinBounds(ea,E,{anchor:er},s)})},text:T=>{lX.updateText(er,T)},settings:E,getEl:()=>er.element.dom,progressBar:{value:T=>{lX.updateProgress(er,T)}}};return es},close:T=>{T.close()},getArgs:T=>T.settings}})(T,{backstage:M.backstage},M.getMothership())}})}();